/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,a=l(e),s=a[0],o=a[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,o)),u=0,h=o>0?s-4:s;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===o&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===o&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],s=16383,o=0,l=n-i;o<l;o+=s)a.push(c(e,o,o+s>l?l:o+s));return 1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=a.length;s<o;++s)r[s]=a[s],n[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var i,a,s=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},8764:(e,t,r)=>{"use strict";const n=r(9742),i=r(645),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function o(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|p(e,t);let n=o(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return f(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,r);const i=function(e){if(l.isBuffer(e)){const t=0|m(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Y(e.length)?o(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),o(e<0?0:0|m(e))}function d(e){const t=e.length<0?0:0|m(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,l.prototype),n}function m(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return $(e).length;default:if(i)return n?-1:W(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return T(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function A(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,i){let a,s=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(a=r;a<o;a++)if(c(e,a)===c(t,-1===n?0:a-n)){if(-1===n&&(n=a),a-n+1===l)return n*s}else-1!==n&&(a-=a-n),n=-1}else for(r+l>o&&(r=o-l),a=r;a>=0;a--){let r=!0;for(let n=0;n<l;n++)if(c(e,a+n)!==c(t,n)){r=!1;break}if(r)return a}return-1}function y(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const a=t.length;let s;for(n>a/2&&(n=a/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(Y(n))return s;e[r+s]=n}return s}function w(e,t,r,n){return H(W(t,e.length-r),e,r,n)}function _(e,t,r,n){return H(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function E(e,t,r,n){return H($(t),e,r,n)}function x(e,t,r,n){return H(function(e,t){let r,n,i;const a=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,a.push(i),a.push(n);return a}(t,e.length-r),e,r,n)}function S(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function T(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let a=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,o,l;switch(s){case 1:t<128&&(a=t);break;case 2:r=e[i+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(a=l));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(a=l));break;case 4:r=e[i+1],n=e[i+2],o=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&o,l>65535&&l<1114112&&(a=l))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=s}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return function(e,t,r){return u(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},l.allocUnsafe=function(e){return h(e)},l.allocUnsafeSlow=function(e){return h(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=l.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(G(t,Uint8Array))i+t.length>n.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)A(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)A(this,t,t+3),A(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)A(this,t,t+7),A(this,t+1,t+6),A(this,t+2,t+5),A(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?T(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(e,t,r,n,i){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const o=Math.min(a,s),c=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<o;++e)if(c[e]!==u[e]){a=c[e],s=u[e];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let a=!1;for(;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":case"latin1":case"binary":return _(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function I(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function C(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=K[e[n]];return i}function M(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,n,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n,i){V(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function D(e,t,r,n,i){V(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r+7]=a,a>>=8,e[r+6]=a,a>>=8,e[r+5]=a,a>>=8,e[r+4]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function N(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function O(e,t,r,n,a){return t=+t,r>>>=0,a||N(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function z(e,t,r,n,a){return t=+t,r>>>=0,a||N(e,0,r,8),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=J((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=J((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=t,i=1,a=this[e+--n];for(;n>0&&(i*=256);)a+=this[e+--n]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=J((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=J((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=J((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=J((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);B(this,e,t,r,n-1,-n)}let i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);B(this,e,t,r,n-1,-n)}let i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=J((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=J((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,r){return O(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return O(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return z(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return z(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const a=l.isBuffer(e)?e:l.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%s]}return this};const F={};function U(e,t,r){F[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function V(e,t,r,n,i,a){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=a>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(a+1)}${n}`:`>= -(2${n} ** ${8*(a+1)-1}${n}) and < 2 ** ${8*(a+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||Q(t,e.length-(r+1))}(n,i,a)}function q(e,t){if("number"!=typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function Q(e,t,r){if(Math.floor(e)!==e)throw q(e,r),new F.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=j(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const X=/[^+/0-9A-Za-z-_]/g;function W(e,t){let r;t=t||1/0;const n=e.length;let i=null;const a=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function $(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const K=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},2238:e=>{var t;window,t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/index.js")}({"./node_modules/@assemblyscript/loader/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,"instantiate",(function(){return h})),r.d(t,"instantiateSync",(function(){return d})),r.d(t,"instantiateStreaming",(function(){return f})),r.d(t,"demangle",(function(){return m}));const n="undefined"!=typeof BigUint64Array,i=Symbol(),a=new TextDecoder("utf-16le");function s(e,t){const r=new Uint32Array(e)[t+-4>>>2]>>>1,n=new Uint16Array(e,t,r);return r<=32?String.fromCharCode.apply(String,n):a.decode(n)}function o(e){const t={};function r(e,t){return e?s(e.buffer,t):"<yet unknown>"}const n=e.env=e.env||{};return n.abort=n.abort||function(e,i,a,s){const o=t.memory||n.memory;throw Error(`abort: ${r(o,e)} at ${r(o,i)}:${a}:${s}`)},n.trace=n.trace||function(e,i,...a){const s=t.memory||n.memory;console.log(`trace: ${r(s,e)}${i?" ":""}${a.slice(0,i).join(", ")}`)},n.seed=n.seed||Date.now,e.Math=e.Math||Math,e.Date=e.Date||Date,t}function l(e,t){const r=t.exports,i=r.memory,a=r.table,o=r.__new,l=r.__retain,c=r.__rtti_base||-1;function u(e){const t=function(e){const t=new Uint32Array(i.buffer);if((e>>>=0)>=t[c>>>2])throw Error(`invalid id: ${e}`);return t[(c+4>>>2)+2*e]}(e);if(!(7&t))throw Error(`not an array: ${e}, flags=${t}`);return t}function h(e){const t=new Uint32Array(i.buffer);if((e>>>=0)>=t[c>>>2])throw Error(`invalid id: ${e}`);return t[(c+4>>>2)+2*e+1]}function d(e){return 31-Math.clz32(e>>>6&31)}function f(e,t,r){const n=i.buffer;if(r)switch(e){case 2:return new Float32Array(n);case 3:return new Float64Array(n)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(n);case 1:return new(t?Int16Array:Uint16Array)(n);case 2:return new(t?Int32Array:Uint32Array)(n);case 3:return new(t?BigInt64Array:BigUint64Array)(n)}throw Error(`unsupported align: ${e}`)}function p(e){const t=new Uint32Array(i.buffer),r=u(t[e+-8>>>2]),n=d(r);let a=4&r?e:t[e+4>>>2];const s=2&r?t[e+12>>>2]:t[a+-4>>>2]>>>n;return f(n,2048&r,4096&r).subarray(a>>>=n,a+s)}function g(e,t,r){return new e(A(e,t,r))}function A(e,t,r){const n=i.buffer,a=new Uint32Array(n),s=a[r+4>>>2];return new e(n,s,a[s+-4>>>2]>>>t)}function v(t,r,n){e[`__get${r}`]=g.bind(null,t,n),e[`__get${r}View`]=A.bind(null,t,n)}return e.__newString=function(e){if(null==e)return 0;const t=e.length,r=o(t<<1,1),n=new Uint16Array(i.buffer);for(var a=0,s=r>>>1;a<t;++a)n[s+a]=e.charCodeAt(a);return r},e.__getString=function(e){if(!e)return null;const t=i.buffer;if(1!==new Uint32Array(t)[e+-8>>>2])throw Error(`not a string: ${e}`);return s(t,e)},e.__newArray=function(e,t){const r=u(e),n=d(r),a=t.length,s=o(a<<n,4&r?e:0);let c;if(4&r)c=s;else{const t=o(2&r?16:12,e),u=new Uint32Array(i.buffer);u[t+0>>>2]=l(s),u[t+4>>>2]=s,u[t+8>>>2]=a<<n,2&r&&(u[t+12>>>2]=a),c=t}const h=f(n,2048&r,4096&r);if(16384&r)for(let e=0;e<a;++e)h[(s>>>n)+e]=l(t[e]);else h.set(t,s>>>n);return c},e.__getArrayView=p,e.__getArray=function(e){const t=p(e),r=t.length,n=new Array(r);for(let e=0;e<r;e++)n[e]=t[e];return n},e.__getArrayBuffer=function(e){const t=i.buffer,r=new Uint32Array(t)[e+-4>>>2];return t.slice(e,e+r)},[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach((e=>{v(e,e.name,31-Math.clz32(e.BYTES_PER_ELEMENT))})),n&&[BigUint64Array,BigInt64Array].forEach((e=>{v(e,e.name.slice(3),3)})),e.__instanceof=function(e,t){const r=new Uint32Array(i.buffer);let n=r[e+-8>>>2];if(n<=r[c>>>2])do{if(n==t)return!0;n=h(n)}while(n);return!1},e.memory=e.memory||i,e.table=e.table||a,m(r,e)}function c(e){return"undefined"!=typeof Response&&e instanceof Response}function u(e){return e instanceof WebAssembly.Module}async function h(e,t={}){if(c(e=await e))return f(e,t);const r=u(e)?e:await WebAssembly.compile(e),n=o(t),i=await WebAssembly.instantiate(r,t);return{module:r,instance:i,exports:l(n,i)}}function d(e,t={}){const r=u(e)?e:new WebAssembly.Module(e),n=o(t),i=new WebAssembly.Instance(r,t);return{module:r,instance:i,exports:l(n,i)}}async function f(e,t={}){if(!WebAssembly.instantiateStreaming)return h(c(e=await e)?e.arrayBuffer():e,t);const r=o(t),n=await WebAssembly.instantiateStreaming(e,t),i=l(r,n.instance);return{...n,exports:i}}function m(e,t={}){const r=e.__argumentsLength?t=>{e.__argumentsLength.value=t}:e.__setArgumentsLength||e.__setargc||(()=>{});for(let n in e){if(!Object.prototype.hasOwnProperty.call(e,n))continue;const a=e[n];let s=n.split("."),o=t;for(;s.length>1;){let e=s.shift();Object.prototype.hasOwnProperty.call(o,e)||(o[e]={}),o=o[e]}let l=s[0],c=l.indexOf("#");if(c>=0){const t=l.substring(0,c),s=o[t];if(void 0===s||!s.prototype){const e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf(){return this[i]}},e.wrap=function(t){return Object.create(e.prototype,{[i]:{value:t,writable:!1}})},s&&Object.getOwnPropertyNames(s).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t)))),o[t]=e}if(l=l.substring(c+1),o=o[t].prototype,/^(get|set):/.test(l)){if(!Object.prototype.hasOwnProperty.call(o,l=l.substring(4))){let t=e[n.replace("set:","get:")],r=e[n.replace("get:","set:")];Object.defineProperty(o,l,{get(){return t(this[i])},set(e){r(this[i],e)},enumerable:!0})}}else"constructor"===l?(o[l]=(...e)=>(r(e.length),a(...e))).original=a:(o[l]=function(...e){return r(e.length),a(this[i],...e)}).original=a}else/^(get|set):/.test(l)?Object.prototype.hasOwnProperty.call(o,l=l.substring(4))||Object.defineProperty(o,l,{get:e[n.replace("set:","get:")],set:e[n.replace("get:","set:")],enumerable:!0}):"function"==typeof a&&a!==r?(o[l]=(...e)=>(r(e.length),a(...e))).original=a:o[l]=a}return t}t.default={instantiate:h,instantiateSync:d,instantiateStreaming:f,demangle:m}},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js":function(e,t,r){"use strict";{const e=(e,t)=>{var r="function"==typeof t,n="function"==typeof t,i="function"==typeof t;Object.defineProperty(Math,e,{configurable:r,enumerable:i,writable:n,value:t})};e("DEG_PER_RAD",Math.PI/180),e("RAD_PER_DEG",180/Math.PI);const t=new Float32Array(1);e("scale",(function(e,t,r,n,i){return 0===arguments.length||Number.isNaN(e)||Number.isNaN(t)||Number.isNaN(r)||Number.isNaN(n)||Number.isNaN(i)?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n})),e("fscale",(function(e,r,n,i,a){return t[0]=Math.scale(e,r,n,i,a),t[0]})),e("clamp",(function(e,t,r){return Math.min(r,Math.max(t,e))})),e("radians",(function(e){return e*Math.DEG_PER_RAD})),e("degrees",(function(e){return e*Math.RAD_PER_DEG}))}},"./node_modules/eel-wasm/dist/build/parser.js":function(e,t,r){(function(e,n){var i=function(){var e=function(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r},t=[1,18],r=[1,7],n=[1,19],i=[1,20],a=[1,14],s=[1,15],o=[1,16],l=[1,33],c=[1,31],u=[1,23],h=[1,22],d=[1,24],f=[1,25],m=[1,26],p=[1,27],g=[1,28],A=[1,29],v=[1,30],b=[5,8,15,18,20,28,29,32,33,34,35,36,37,38],y=[5,15,18],w=[5,12,15,17,18,24,25,28,29,30],_=[1,57],E=[5,8,12,15,17,18,24,25,28,29,30],x=[15,18],S=[5,8,15,18,28,29,38],T=[5,8,15,18,28,29,32,33,38],k=[5,8,15,18,28,29,32,33,34,37,38],I=[5,8,15,18,28,29,32,33,34,35,36,37,38],C=[5,8,15,18],P=[5,8,15,18,20,22,28,29,32,33,34,35,36,37,38],M={trace:function(){},yy:{},symbols_:{error:2,SCRIPT:3,expression:4,EOF:5,expressionsOptionalTrailingSemi:6,separator:7,";":8,expressions:9,EXPRESSION_BLOCK:10,IDENTIFIER:11,IDENTIFIER_TOKEN:12,argument:13,arguments:14,",":15,FUNCTION_CALL:16,"(":17,")":18,LOGICAL_EXPRESSION:19,LOGICAL_OPERATOR_TOKEN:20,ASSIGNMENT:21,ASSIGNMENT_OPERATOR_TOKEN:22,number:23,DIGITS_TOKEN:24,".":25,NUMBER_LITERAL:26,UNARY_EXPRESSION:27,"-":28,"+":29,"!":30,BINARY_EXPRESSION:31,"*":32,"/":33,"%":34,"&":35,"|":36,"^":37,COMPARISON_TOKEN:38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:";",12:"IDENTIFIER_TOKEN",15:",",17:"(",18:")",20:"LOGICAL_OPERATOR_TOKEN",22:"ASSIGNMENT_OPERATOR_TOKEN",24:"DIGITS_TOKEN",25:".",28:"-",29:"+",30:"!",32:"*",33:"/",34:"%",35:"&",36:"|",37:"^",38:"COMPARISON_TOKEN"},productions_:[0,[3,2],[3,2],[3,1],[7,1],[7,2],[9,2],[9,3],[6,1],[6,2],[10,1],[11,1],[13,1],[13,1],[14,1],[14,3],[16,3],[16,4],[19,3],[21,3],[21,3],[23,1],[23,2],[23,3],[23,2],[23,1],[26,1],[27,2],[27,2],[27,2],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[4,1],[4,1],[4,3],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3]],performAction:function(e,t,r,n,i,a,s){var o=a.length-1;switch(i){case 1:return{type:"SCRIPT",body:[a[o-1]],loc:this._$};case 2:return{type:"SCRIPT",body:a[o-1],loc:this._$};case 3:return{type:"SCRIPT",body:[],loc:this._$};case 6:this.$=[a[o-1]];break;case 7:this.$=a[o-2].concat([a[o-1]]);break;case 8:this.$=a[o];break;case 9:this.$=a[o-1].concat([a[o]]);break;case 10:this.$={type:"EXPRESSION_BLOCK",body:a[o],loc:this._$};break;case 11:this.$={type:"IDENTIFIER",value:a[o].toLowerCase(),loc:this._$};break;case 14:this.$=[a[o]];break;case 15:this.$=a[o-2].concat([a[o]]);break;case 16:this.$={type:"CALL_EXPRESSION",callee:a[o-2],arguments:[],loc:this._$};break;case 17:this.$={type:"CALL_EXPRESSION",callee:a[o-3],arguments:a[o-1],loc:this._$};break;case 18:this.$={type:"LOGICAL_EXPRESSION",left:a[o-2],right:a[o],operator:a[o-1],loc:this._$};break;case 19:case 20:this.$={type:"ASSIGNMENT_EXPRESSION",left:a[o-2],operator:a[o-1],right:a[o],loc:this._$};break;case 21:this.$=Number(a[o]);break;case 22:this.$=Number(a[o-1]);break;case 23:this.$=Number(a[o-2]+a[o-1]+a[o]);break;case 24:this.$=Number("0"+a[o-1]+a[o]);break;case 25:this.$=0;break;case 26:this.$={type:"NUMBER_LITERAL",value:a[o],loc:this._$};break;case 27:case 28:case 29:this.$={type:"UNARY_EXPRESSION",value:a[o],operator:a[o-1],loc:this._$};break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:this.$={type:"BINARY_EXPRESSION",left:a[o-2],right:a[o],operator:a[o-1],loc:this._$};break;case 41:case 47:this.$=a[o-1]}},table:[{3:1,4:2,5:[1,4],6:3,9:13,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{1:[3]},{5:[1,21],7:32,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:v},{5:[1,34]},{1:[2,3]},e(b,[2,39]),e(b,[2,40]),{4:35,6:37,9:13,10:36,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(b,[2,42]),e(b,[2,43]),e(b,[2,44],{22:[1,38]}),e(b,[2,45],{17:[1,40],22:[1,39]}),e(b,[2,46]),e(y,[2,8],{31:5,27:6,26:8,21:9,16:10,11:11,19:12,23:17,4:41,12:t,17:r,24:n,25:i,28:a,29:s,30:o}),{4:42,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:43,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:44,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(b,[2,26]),e([5,8,15,17,18,20,22,28,29,32,33,34,35,36,37,38],[2,11]),e(b,[2,21],{25:[1,45]}),e(b,[2,25],{24:[1,46]}),{1:[2,1]},{4:47,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:48,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:49,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:50,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:51,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:52,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:53,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:54,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:55,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:56,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(w,[2,6],{8:_}),e(E,[2,4]),{1:[2,2]},{7:32,8:l,18:[1,58],20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:v},{18:[1,59]},e(x,[2,10]),{4:60,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:61,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:65,6:37,9:13,10:66,11:11,12:t,13:64,14:63,16:10,17:r,18:[1,62],19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(y,[2,9],{7:67,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:v}),e(S,[2,27],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(S,[2,28],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(S,[2,29],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(b,[2,22],{24:[1,68]}),e(b,[2,24]),e(S,[2,30],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(S,[2,31],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(T,[2,32],{20:c,34:m,35:p,36:g,37:A}),e(T,[2,33],{20:c,34:m,35:p,36:g,37:A}),e(k,[2,34],{20:c,35:p,36:g}),e(I,[2,35],{20:c}),e(I,[2,36],{20:c}),e(k,[2,37],{20:c,35:p,36:g}),e(C,[2,38],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:v}),e(b,[2,18]),e(E,[2,5]),e(b,[2,41]),e(b,[2,47]),e(C,[2,20],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:v}),e(C,[2,19],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:v}),e(P,[2,16]),{15:[1,70],18:[1,69]},e(x,[2,14]),e(x,[2,12],{7:32,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:v}),e(x,[2,13]),e(w,[2,7],{8:_}),e(b,[2,23]),e(P,[2,17]),{4:65,6:37,9:13,10:66,11:11,12:t,13:71,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(x,[2,15])],defaultActions:{4:[2,3],21:[2,1],34:[2,2]},parseError:function(e,t){if(!t.recoverable){var r=new Error(e);throw r.hash=t,r}this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],i=[],a=this.table,s="",o=0,l=0,c=0,u=2,h=1,d=i.slice.call(arguments,1),f=Object.create(this.lexer),m={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(m.yy[p]=this.yy[p]);f.setInput(e,m.yy),m.yy.lexer=f,m.yy.parser=this,void 0===f.yylloc&&(f.yylloc={});var g=f.yylloc;i.push(g);var A=f.options&&f.options.ranges;"function"==typeof m.yy.parseError?this.parseError=m.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var v,b,y,w,_,E,x,S,T,k=function(){var e;return"number"!=typeof(e=f.lex()||h)&&(e=t.symbols_[e]||e),e},I={};;){if(y=r[r.length-1],this.defaultActions[y]?w=this.defaultActions[y]:(null==v&&(v=k()),w=a[y]&&a[y][v]),void 0===w||!w.length||!w[0]){var C="";for(E in T=[],a[y])this.terminals_[E]&&E>u&&T.push("'"+this.terminals_[E]+"'");C=f.showPosition?"Parse error on line "+(o+1)+":\n"+f.showPosition()+"\nExpecting "+T.join(", ")+", got '"+(this.terminals_[v]||v)+"'":"Parse error on line "+(o+1)+": Unexpected "+(v==h?"end of input":"'"+(this.terminals_[v]||v)+"'"),this.parseError(C,{text:f.match,token:this.terminals_[v]||v,line:f.yylineno,loc:g,expected:T})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+v);switch(w[0]){case 1:r.push(v),n.push(f.yytext),i.push(f.yylloc),r.push(w[1]),v=null,b?(v=b,b=null):(l=f.yyleng,s=f.yytext,o=f.yylineno,g=f.yylloc,c>0&&c--);break;case 2:if(x=this.productions_[w[1]][1],I.$=n[n.length-x],I._$={first_line:i[i.length-(x||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(x||1)].first_column,last_column:i[i.length-1].last_column},A&&(I._$.range=[i[i.length-(x||1)].range[0],i[i.length-1].range[1]]),void 0!==(_=this.performAction.apply(I,[s,l,o,m.yy,w[1],n,i].concat(d))))return _;x&&(r=r.slice(0,-1*x*2),n=n.slice(0,-1*x),i=i.slice(0,-1*x)),r.push(this.productions_[w[1]][0]),n.push(I.$),i.push(I._$),S=a[r[r.length-2]][r[r.length-1]],r.push(S);break;case 3:return!0}}return!0}},R={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var a in i)this[a]=i[a];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),a=0;a<i.length;a++)if((r=this._input.match(this.rules[i[a]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=a,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,i[a])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,n){switch(r){case 0:break;case 1:return 24;case 2:return 38;case 3:return 22;case 4:return 20;case 5:return 12;case 6:return 5;case 7:return t.yytext[0]}},rules:[/^(?:\s+)/,/^(?:[0-9]+)/,/^(?:(==|!=|<=|>=|<|>))/,/^(?:[+\-*/%]?=)/,/^(?:(\&\&)|\|\|)/,/^(?:[a-zA-Z_][a-zA-Z0-9._]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7],inclusive:!0}}};function B(){this.yy={}}return M.lexer=R,B.prototype=M,M.Parser=B,new B}();t.parser=i,t.Parser=i.Parser,t.parse=function(){return i.parse.apply(i,arguments)},t.main=()=>{},r.c[r.s]===e&&t.main(n.argv.slice(1))}).call(this,r("./node_modules/webpack/buildin/module.js")(e),r("./node_modules/process/browser.js"))},"./node_modules/eel-wasm/dist/src/astUtils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={ASSIGNMENT_EXPRESSION:[{type:"NODE",key:"right"}],SCRIPT:[{type:"ARRAY",key:"body"}],EXPRESSION_BLOCK:[{type:"ARRAY",key:"body"}],UNARY_EXPRESSION:[{type:"NODE",key:"value"}],NUMBER_LITERAL:[],IDENTIFIER:[],CALL_EXPRESSION:[{type:"ARRAY",key:"arguments"},{type:"NODE",key:"callee"}],BINARY_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}],LOGICAL_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}]};t.mapAst=function e(t,r){const i=n[t.type];let a=t;if(null==i)throw new Error(`Unknown children definition for ${t.type}`);return i.forEach((n=>{if("NODE"===n.type){const i=t[n.key],s=e(i,r);s!==i&&(a=Object.assign(Object.assign({},a),{[n.key]:s}))}else if("ARRAY"===n.type){const i=t[n.key],s=i.map((t=>e(t,r))),o=i.some(((e,t)=>e!==s[t]));o&&(a=Object.assign(Object.assign({},a),{[n.key]:s}))}})),r(a)}},"./node_modules/eel-wasm/dist/src/compiler.js":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const a=r("./node_modules/eel-wasm/dist/src/parser.js"),s=r("./node_modules/eel-wasm/dist/src/emitter.js"),o=r("./node_modules/eel-wasm/dist/src/encoding.js"),l=n(r("./node_modules/eel-wasm/dist/src/shims.js")),c=i(r("./node_modules/eel-wasm/dist/src/utils.js")),u=r("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),h=r("./node_modules/eel-wasm/dist/src/constants.js");t.compileModule=function({pools:e,functions:t,eelVersion:r=2,preParsed:n=!1}){if(Object.keys(e).includes("shims"))throw new Error('You may not name a pool "shims". "shims" is reserved for injected JavaScript functions.');const i=[];Object.entries(e).forEach((([e,t])=>{t.forEach((t=>{i.push([e,t])}))}));const d=new c.ScopedIdMap;i.forEach((([e,t])=>{d.get(e,t)}));const f=Object.entries(l.default).map((([e,t])=>({args:new Array(t.length).fill(null).map((e=>o.VAL_TYPE.f64)),returns:[o.VAL_TYPE.f64],name:e}))),m=[],p=[];Object.entries(t).forEach((([t,{pool:i,code:l}])=>{if(null==e[i]){const r=Object.keys(e);if(0===r.length)throw new Error(`The function "${t}" was declared as using a variable pool named "${i}" but no pools were defined.`);throw new Error(`The function "${t}" was declared as using a variable pool named "${i}" which is not among the variable pools defined. The defined variable pools are: ${c.formatList(r)}.`)}const h=n?l:a.parse(l);if("string"==typeof h)throw new Error("Got passed unparsed code without setting the preParsed flag");if("SCRIPT"!==h.type)throw new Error("Invalid AST");if(0===h.body.length)return;const g=[],A={resolveVar:e=>/^reg\d\d$/.test(e)?d.get(null,e):d.get(i,e),resolveLocal:e=>(g.push(e),g.length-1),resolveFunc:e=>{const t=f.findIndex((t=>t.name===e));if(-1!==t){const n=o.op.call(t);return"rand"===e&&1===r?[...n,o.op.f64_floor]:n}if(null==u.localFuncMap[e])return null;let n=m.indexOf(e);return-1===n&&(m.push(e),n=m.length-1),o.op.call(n+f.length)},rawSource:l},v=s.emit(h,A);p.push({binary:v,exportName:t,args:[],returns:[],localVariables:g})}));const g=m.map((e=>{const t=u.localFuncMap[e];if(null==t)throw new Error(`Undefined local function "${e}"`);return t})),A=e=>[...e.args,"|",...e.returns].join("-"),v=[],b=new Map;function y(e){const t=A(e),r=b.get(t);if(null==r)throw new Error(`Failed to get a type index for key ${t}`);return r}[...f,...g,...p].forEach((e=>{const t=A(e);b.has(t)||(v.push([o.FUNCTION_TYPE,...o.encodeFlatVector(e.args),...o.encodeFlatVector(e.returns)]),b.set(t,v.length-1))}));const w=[...i.map((([e,t])=>[...o.encodeString(e),...o.encodeString(t),o.GLOBAL_TYPE,o.VAL_TYPE.f64,o.MUTABILITY.var])),...f.map(((e,t)=>{const r=y(e);return[...o.encodeString("shims"),...o.encodeString(e.name),o.TYPE_IDX,...o.unsignedLEB128(r)]}))],_=[...g,...p].map((e=>{const t=y(e);return o.unsignedLEB128(t)})),E=[[1,...o.unsignedLEB128(h.WASM_MEMORY_SIZE),...o.unsignedLEB128(h.WASM_MEMORY_SIZE)]],x=d.size()-i.length,S=c.times(x,(()=>[o.VAL_TYPE.f64,o.MUTABILITY.var,...o.op.f64_const(0),o.op.end])),T=[...p].map(((e,t)=>{const r=t+f.length+g.length;return[...o.encodeString(e.exportName),o.EXPORT_TYPE.FUNC,...o.unsignedLEB128(r)]})),k=[...g,...p].map((e=>{var t;const r=(null!==(t=e.localVariables)&&void 0!==t?t:[]).map((e=>[...o.unsignedLEB128(1),e]));return o.encodeFlatVector([...o.encodeNestedVector(r),...e.binary,o.op.end])}));return new Uint8Array([...o.MAGIC,...o.WASM_VERSION,...o.encodeSection(o.SECTION.TYPE,v),...o.encodeSection(o.SECTION.IMPORT,w),...o.encodeSection(o.SECTION.FUNC,_),...o.encodeSection(o.SECTION.MEMORY,E),...o.encodeSection(o.SECTION.GLOBAL,S),...o.encodeSection(o.SECTION.EXPORT,T),...o.encodeSection(o.SECTION.CODE,k)])}},"./node_modules/eel-wasm/dist/src/constants.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_LOOP_COUNT=1048576,t.BUFFER_SIZE=8388608,t.WASM_MEMORY_SIZE=Math.ceil(8*t.BUFFER_SIZE*2/65536)},"./node_modules/eel-wasm/dist/src/emitter.js":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r("./node_modules/eel-wasm/dist/src/encoding.js"),a=n(r("./node_modules/eel-wasm/dist/src/shims.js")),s=r("./node_modules/eel-wasm/dist/src/errorUtils.js"),o=r("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),l=r("./node_modules/eel-wasm/dist/src/utils.js"),c=r("./node_modules/eel-wasm/dist/src/constants.js");function u(e,t){var r,n,f;switch(e.type){case"SCRIPT":{const r=e.body.map(((e,r)=>[...u(e,t),i.op.drop]));return l.flatten(r)}case"EXPRESSION_BLOCK":return h(e.body,t);case"BINARY_EXPRESSION":{const r=u(e.left,t),n=u(e.right,t),a={"+":[i.op.f64_add],"-":[i.op.f64_sub],"*":[i.op.f64_mul],"/":t.resolveFunc("div"),"%":t.resolveFunc("mod"),"|":t.resolveFunc("bitwiseOr"),"&":t.resolveFunc("bitwiseAnd"),"^":t.resolveFunc("pow"),"==":[i.op.f64_sub,...i.IS_ZEROISH,i.op.f64_convert_i32_s],"!=":[i.op.f64_sub,...i.IS_NOT_ZEROISH,i.op.f64_convert_i32_s],"<":[i.op.f64_lt,i.op.f64_convert_i32_s],">":[i.op.f64_gt,i.op.f64_convert_i32_s],"<=":[i.op.f64_le,i.op.f64_convert_i32_s],">=":[i.op.f64_ge,i.op.f64_convert_i32_s]}[e.operator];if(null==a)throw s.createCompilerError(`Unknown binary expression operator ${e.operator}`,e.loc,t.rawSource);return[...r,...n,...a]}case"CALL_EXPRESSION":{const n=e.callee.value,f=e.arguments,m=r=>{if(f.length<r)throw s.createUserError(`Too few arguments passed to \`${n}()\`. Expected ${r} but only got ${f.length}.`,e.loc,t.rawSource);if(f.length>r)throw s.createUserError(`Too many arguments passed to \`${n}()\`. Expected ${r} but got ${f.length}.`,f[r].loc,t.rawSource)};switch(n){case"exec2":return m(2),h(e.arguments,t);case"exec3":return m(3),h(e.arguments,t);case"if":m(3);const[a,o,l]=e.arguments;return function(e,t,r,n){return[...u(e,n),...i.IS_NOT_ZEROISH,...i.op.if(i.BLOCK.f64),...u(t,n),i.op.else,...u(r,n),i.op.end]}(a,o,l,t);case"while":return m(1),function(e,t){const r=u(e,t),n=t.resolveLocal(i.VAL_TYPE.i32);return[...i.op.i32_const(0),...i.op.local_set(n),...i.op.loop(i.BLOCK.void),...i.op.local_get(n),...i.op.i32_const(1),i.op.i32_add,...i.op.local_tee(n),...i.op.i32_const(c.MAX_LOOP_COUNT),i.op.i32_lt_u,...r,...i.IS_NOT_ZEROISH,i.op.i32_and,...i.op.br_if(0),i.op.end,...i.op.f64_const(0)]}(e.arguments[0],t);case"loop":return m(2),function(e,t,r){const n=u(t,r),a=r.resolveLocal(i.VAL_TYPE.i32);return[...i.op.block(i.BLOCK.void),...u(e,r),i.op.i32_trunc_f64_s,...i.op.local_tee(a),...i.op.i32_const(0),i.op.i32_le_s,...i.op.br_if(1),...i.op.loop(i.BLOCK.void),...n,i.op.drop,...i.op.local_get(a),...i.op.i32_const(1),i.op.i32_sub,...i.op.local_tee(a),...i.op.i32_const(0),i.op.i32_ne,...i.op.br_if(0),i.op.end,i.op.end,...i.op.f64_const(0)]}(e.arguments[0],e.arguments[1],t);case"megabuf":case"gmegabuf":m(1);const f=t.resolveLocal(i.VAL_TYPE.i32);return[...u(e.arguments[0],t),...null!==(r=t.resolveFunc("_getBufferIndex"))&&void 0!==r?r:[],...i.op.local_tee(f),...i.op.i32_const(-1),i.op.i32_ne,...i.op.if(i.BLOCK.f64),...i.op.local_get(f),...i.op.f64_load(3,d(n)),i.op.else,...i.op.f64_const(0),i.op.end];case"assign":m(2);const p=e.arguments[0];if("IDENTIFIER"!=p.type)throw s.createUserError("Expected the first argument of `assign()` to be an identifier.",p.loc,t.rawSource);const g=t.resolveVar(p.value);return[...u(e.arguments[1],t),...i.op.global_set(g),...i.op.global_get(g)]}const p=l.flatten(e.arguments.map((e=>u(e,t))));switch(n){case"abs":return m(1),[...p,i.op.f64_abs];case"sqrt":return m(1),[...p,i.op.f64_abs,i.op.f64_sqrt];case"int":case"floor":return m(1),[...p,i.op.f64_floor];case"min":return m(2),[...p,i.op.f64_min];case"max":return m(2),[...p,i.op.f64_max];case"above":return m(2),[...p,i.op.f64_gt,i.op.f64_convert_i32_s];case"below":return m(2),[...p,i.op.f64_lt,i.op.f64_convert_i32_s];case"equal":return m(2),[...p,i.op.f64_sub,...i.IS_ZEROISH,i.op.f64_convert_i32_s];case"bnot":return m(1),[...p,...i.IS_ZEROISH,i.op.f64_convert_i32_s];case"ceil":return m(1),[...p,i.op.f64_ceil]}const g=t.resolveFunc(n);if(null==g||n.startsWith("_"))throw s.createUserError(`"${n}" is not defined.`,e.callee.loc,t.rawSource);if(null!=a.default[n])m(a.default[n].length);else{if(null==o.localFuncMap[n])throw s.createCompilerError(`Missing arity information for the function \`${n}()\``,e.callee.loc,t.rawSource);m(o.localFuncMap[n].args.length)}return[...p,...g]}case"ASSIGNMENT_EXPRESSION":{const{left:r}=e,a=u(e.right,t),o=function(e,t){const r={"+=":[i.op.f64_add],"-=":[i.op.f64_sub],"*=":[i.op.f64_mul],"/=":[i.op.f64_div],"%=":t.resolveFunc("mod"),"=":null}[e.operator];if(void 0===r)throw s.createCompilerError(`Unknown assignment operator "${e.operator}"`,e.loc,t.rawSource);return r}(e,t);if("IDENTIFIER"===r.type){const e=t.resolveVar(r.value),n=i.op.global_get(e),s=i.op.global_set(e);return null===o?[...a,...s,...n]:[...n,...a,...o,...s,...n]}if("CALL_EXPRESSION"!==r.type)throw s.createCompilerError(`Unexpected left hand side type for assignment: ${r.type}`,e.loc,t.rawSource);const l=t.resolveLocal(i.VAL_TYPE.i32);if(1!==r.arguments.length)throw s.createUserError(`Expected 1 argument when assinging to a buffer but got ${r.arguments.length}.`,0===r.arguments.length?r.loc:r.arguments[1].loc,t.rawSource);const c=r.callee.value;if("gmegabuf"!==c&&"megabuf"!==c)throw s.createUserError("The only function calls which may be assigned to are `gmegabuf()` and `megabuf()`.",r.callee.loc,t.rawSource);const h=d(c);if(null===o){const e=t.resolveLocal(i.VAL_TYPE.i32),s=t.resolveLocal(i.VAL_TYPE.f64);return[...a,...i.op.local_set(s),...u(r.arguments[0],t),...null!==(n=t.resolveFunc("_getBufferIndex"))&&void 0!==n?n:[],...i.op.local_tee(e),...i.op.i32_const(0),i.op.i32_lt_s,...i.op.if(i.BLOCK.f64),...i.op.f64_const(0),i.op.else,...i.op.local_get(e),...i.op.local_tee(l),...i.op.local_get(s),...i.op.f64_store(3,h),...i.op.local_get(s),i.op.end]}const m=t.resolveLocal(i.VAL_TYPE.i32),p=t.resolveLocal(i.VAL_TYPE.i32),g=t.resolveLocal(i.VAL_TYPE.f64),A=t.resolveLocal(i.VAL_TYPE.f64);return[...a,...i.op.local_set(g),...u(r.arguments[0],t),...null!==(f=t.resolveFunc("_getBufferIndex"))&&void 0!==f?f:[],...i.op.local_tee(m),...i.op.i32_const(-1),i.op.i32_ne,...i.op.local_tee(p),...i.op.if(i.BLOCK.f64),...i.op.local_get(m),...i.op.f64_load(3,h),i.op.else,...i.op.f64_const(0),i.op.end,...i.op.local_get(g),...o,...i.op.local_tee(A),...i.op.local_get(p),...i.op.if(i.BLOCK.void),...i.op.local_get(m),...i.op.local_get(A),...i.op.f64_store(3,h),i.op.end]}case"LOGICAL_EXPRESSION":{const r=u(e.left,t),n=u(e.right,t),a={"&&":{comparison:i.IS_ZEROISH,shortCircutValue:0},"||":{comparison:i.IS_NOT_ZEROISH,shortCircutValue:1}}[e.operator];if(null==a)throw s.createCompilerError(`Unknown logical expression operator ${e.operator}`,e.loc,t.rawSource);const{comparison:o,shortCircutValue:l}=a;return[...r,...o,...i.op.if(i.BLOCK.f64),...i.op.f64_const(l),i.op.else,...n,...i.IS_NOT_ZEROISH,i.op.f64_convert_i32_s,i.op.end]}case"UNARY_EXPRESSION":{const r=u(e.value,t),n={"-":[i.op.f64_neg],"+":[],"!":[...i.IS_ZEROISH,i.op.f64_convert_i32_s]}[e.operator];if(null==n)throw s.createCompilerError(`Unknown logical unary operator ${e.operator}`,e.loc,t.rawSource);return[...r,...n]}case"IDENTIFIER":const m=e.value;return i.op.global_get(t.resolveVar(m));case"NUMBER_LITERAL":return i.op.f64_const(e.value);default:throw s.createCompilerError(`Unknown AST node type ${e.type}`,e.loc,t.rawSource)}}function h(e,t){const r=e.map(((e,r)=>u(e,t)));return l.flatten(l.arrayJoin(r,[i.op.drop]))}function d(e){switch(e){case"gmegabuf":return 8*c.BUFFER_SIZE;case"megabuf":return 0}}t.emit=u},"./node_modules/eel-wasm/dist/src/encoding.js":function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r("./node_modules/eel-wasm/dist/src/ieee754.js")),a=r("./node_modules/eel-wasm/dist/src/utils.js");function s(e){const t=new Uint8Array(8);return i.write(t,e),t}function o(e){const t=[];do{let r=127&e;0!=(e>>>=7)&&(r|=128),t.push(r)}while(0!==e);return t}function l(e){let t=[],r=0,n=Math.ceil(Math.log2(Math.abs(e))),i=e<0,a=!0;for(;a;)r=127&e,e>>=7,i&&(e|=-(1<<n-7)),0==e&&0==(64&r)||-1==e&&64==(64&r)?a=!1:r|=128,t.push(r);return t}t.MAGIC=[0,97,115,109],t.WASM_VERSION=[1,0,0,0],t.EPSILON=1e-5,t.SECTION={TYPE:1,IMPORT:2,FUNC:3,MEMORY:5,GLOBAL:6,EXPORT:7,CODE:10},t.EXPORT_TYPE={FUNC:0,TABLE:1,MEMORY:2,GLOBAL:3},t.op={block:e=>[2,e],loop:e=>[3,e],if:e=>[4,e],else:5,end:11,br_if:e=>[13,...o(e)],call:e=>[16,...o(e)],drop:26,select:27,local_get:e=>[32,...o(e)],local_set:e=>[33,...o(e)],local_tee:e=>[34,...o(e)],global_get:e=>[35,...o(e)],global_set:e=>[36,...o(e)],f64_load:(e,t)=>[43,...o(e),...o(t)],f64_store:(e,t)=>[57,...o(e),...o(t)],i32_const:e=>[65,...l(e)],f64_const:e=>[68,...s(e)],i32_eqz:69,i32_ne:71,i32_lt_s:72,i32_lt_u:73,i32_gt_s:74,i32_le_s:76,i32_le_u:77,i32_ge_s:78,f64_eq:97,f64_ne:98,f64_lt:99,f64_gt:100,f64_le:101,f64_ge:102,i32_add:106,i32_sub:107,i32_mul:108,i32_rem_s:111,i32_and:113,i32_or:114,i64_rem_s:129,i64_and:131,i64_or:132,f64_abs:153,f64_neg:154,f64_ceil:155,f64_floor:156,f64_sqrt:159,f64_add:160,f64_sub:161,f64_mul:162,f64_div:163,f64_min:164,f64_max:165,i32_trunc_f64_s:170,i32_trunc_f64_u:171,i64_trunc_s_f64:176,f64_convert_i64_s:185,f64_convert_i32_s:183},t.VAL_TYPE={i32:127,i64:126,f32:125,f64:124},t.MUTABILITY={const:0,var:1},t.BLOCK={void:64,i32:127,i64:126,f32:125,f64:124},t.FUNCTION_TYPE=96,t.MEMORY_IDX=2,t.GLOBAL_TYPE=3,t.TYPE_IDX=0,t.IS_ZEROISH=[t.op.f64_abs,...t.op.f64_const(t.EPSILON),t.op.f64_lt],t.IS_NOT_ZEROISH=[t.op.f64_abs,...t.op.f64_const(t.EPSILON),t.op.f64_gt],t.encodef64=s,t.encodeString=e=>[e.length].concat(e.split("").map((e=>e.charCodeAt(0)))),t.unsignedLEB128=o,t.signedLEB128=l,t.encodeFlatVector=e=>o(e.length).concat(e),t.encodeNestedVector=e=>o(e.length).concat(a.flatten(e)),t.encodeSection=function(e,r){if(0===r.length)return[];const n=t.encodeFlatVector(t.encodeNestedVector(r));return n.unshift(e),n}},"./node_modules/eel-wasm/dist/src/envParser.js":function(e,t,r){let n=r("./node_modules/eel-wasm/dist/build/parser.js");e.exports={parse:n.parse}},"./node_modules/eel-wasm/dist/src/errorUtils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("./node_modules/eel-wasm/dist/src/utils.js");function i(e,t,r=1){const i=Math.max(e.first_line-1-r,0),a=e.last_line+r,s=t.split("\n").slice(i,a).map(((t,r)=>{const n=r+i+1;return`${n>=e.first_line&&n<=e.last_line?">":" "} ${n} | ${t}`}));if(e.first_line===e.last_line){const t=n.repeat(e.first_column," "),r=n.repeat(e.last_column-e.first_column,"^"),a=e.first_line-i;s.splice(a,0,`    | ${t}${r}`)}return s.join("\n")}t.printLoc=i;class a extends Error{constructor(e,t,r){super(e),this.sourceContext=i(t,r),this.loc=t}}class s extends a{}t.createUserError=function(e,t,r){return new s(e,t,r)},t.createCompilerError=function(e,t,r){return new a(e,t,r)}},"./node_modules/eel-wasm/dist/src/ieee754.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.write=function(e,t){let r=52;var n,i,a,s=64-r-1,o=(1<<s)-1,l=o>>1,c=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,u=0,h=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(i=isNaN(t)?1:0,n=o):(n=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-n))<1&&(n--,a*=2),(t+=n+l>=1?c/a:c*Math.pow(2,1-l))*a>=2&&(n++,a/=2),n+l>=o?(i=0,n=o):n+l>=1?(i=(t*a-1)*Math.pow(2,r),n+=l):(i=t*Math.pow(2,l-1)*Math.pow(2,r),n=0));r>=8;e[0+u]=255&i,u+=1,i/=256,r-=8);for(n=n<<r|i,s+=r;s>0;e[0+u]=255&n,u+=1,n/=256,s-=8);e[0+u-1]|=128*h}},"./node_modules/eel-wasm/dist/src/index.js":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r("./node_modules/eel-wasm/dist/src/parser.js");t.parse=i.parse;const a=r("./node_modules/eel-wasm/dist/src/compiler.js");t.compileModule=a.compileModule;const s=n(r("./node_modules/eel-wasm/dist/src/shims.js"));t.shims=s.default;const o=r("./node_modules/eel-wasm/dist/src/loader.js");t.loadModule=o.loadModule},"./node_modules/eel-wasm/dist/src/loader.js":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r("./node_modules/eel-wasm/dist/src/shims.js")),a=r("./node_modules/eel-wasm/dist/src/compiler.js");t.loadModule=async function({pools:e,functions:t,eelVersion:r=2}){let n={};Object.entries(e).forEach((([e,t])=>{n[e]=new Set(Object.keys(t))}));const s=a.compileModule({pools:n,functions:t,eelVersion:r}),o=await WebAssembly.compile(s);var l=Object.assign(Object.assign({},e),{shims:i.default});return await WebAssembly.instantiate(o,l)}},"./node_modules/eel-wasm/dist/src/parser.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("./node_modules/eel-wasm/dist/src/preProcessor.js"),i=r("./node_modules/eel-wasm/dist/src/envParser.js"),a=r("./node_modules/eel-wasm/dist/src/astUtils.js"),s=r("./node_modules/eel-wasm/dist/src/errorUtils.js");function o(e,t){const r=n.getLoc(t,e.first_column),i=n.getLoc(t,e.last_column);return{first_column:r.column,last_column:i.column,first_line:r.line,last_line:i.line}}t.parse=function(e){const[t,r]=n.preProcess(e);try{const n=i.parse(t);return a.mapAst(n,(t=>{if(1!==t.loc.first_line||1!=t.loc.last_line)throw s.createCompilerError("Unexpected multiline",t.loc,e);return Object.assign(Object.assign({},t),{loc:o(t.loc,r)})}))}catch(t){if(null==t.hash)throw t;throw s.createUserError(`Parse Error: ${t.message.split("\n")[3]}`,o(t.hash.loc,r),e)}}},"./node_modules/eel-wasm/dist/src/preProcessor.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLoc=function(e,t){let r={destCol:1,srcCol:1,srcLine:1};e.forEach((e=>{e.destCol>t||(r=e)}));const n=t-r.destCol;return{column:r.srcCol+n,line:r.srcLine}},t.preProcess=function(e){const t=[];let r=1,n="",i=0,a=!1,s=!1,o=!1;for(let l=0;l<e.length;l++){const c=e[l];if(o){const e=n.length+1,a=l-i+1;t.push({destCol:e,srcCol:a,srcLine:r}),o=!1}"\n"===c?(a=!1,r++,i=l+1,o=!0):"\r"===c&&"\n"===e[l+1]?(l++,a=!1,r++,i=l+1,o=!0):s&&"*"===c&&"/"===e[l+1]?(s=!1,l++,o=!0):"\\"===c&&"\\"===e[l+1]||"/"===c&&"/"===e[l+1]?(a=!0,l++):"/"===c&&"*"===e[l+1]?(s=!0,l++):a||s||(n+=c)}return[n,t]}},"./node_modules/eel-wasm/dist/src/shims.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,atan2:Math.atan2,rand:e=>Math.random()*e,pow:Math.pow,log:Math.log,log10:Math.log10,exp:Math.exp,sigmoid:function(e,t){const r=1+Math.exp(-e*t);return Math.abs(r)>1e-5?1/r:0}};t.default=n},"./node_modules/eel-wasm/dist/src/utils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayJoin=function(e,t){const r=[];for(let n=0;n<e.length;n++)r.push(e[n]),n===e.length-1||r.push(t);return r},t.flatten=function(e){return[].concat.apply([],e)},t.times=function(e,t){return new Array(e).fill(null).map(((e,r)=>t(r)))},t.repeat=function(e,t){return new Array(e).fill(t).join("")},t.ScopedIdMap=class{constructor(){this._map=new Map}get(e,t){const r=null==e?t:`${e}::${t}`;return this._map.has(r)||this._map.set(r,this._map.size),this._map.get(r)}size(){return this._map.size}},t.formatList=function(e){if(0===e.length)throw new Error("Cannot format an empty list");if(1===e.length)return e[0];const t=e.map((e=>`"${e}"`)),r=t.pop();return t.join(", ")+` and ${r}`}},"./node_modules/eel-wasm/dist/src/wasmFunctions.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("./node_modules/eel-wasm/dist/src/encoding.js"),i=r("./node_modules/eel-wasm/dist/src/constants.js");t.localFuncMap={sqr:{args:[n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),...n.op.local_get(0),n.op.f64_mul]},bor:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),...n.IS_NOT_ZEROISH,...n.op.local_get(1),...n.IS_NOT_ZEROISH,n.op.i32_or,...n.op.i32_const(0),n.op.i32_ne,n.op.f64_convert_i32_s]},band:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),...n.IS_NOT_ZEROISH,...n.op.local_get(1),...n.IS_NOT_ZEROISH,n.op.i32_and,...n.op.i32_const(0),n.op.i32_ne,n.op.f64_convert_i32_s]},sign:{args:[n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.f64_const(0),...n.op.local_get(0),n.op.f64_lt,...n.op.local_get(0),...n.op.f64_const(0),n.op.f64_lt,n.op.i32_sub,n.op.f64_convert_i32_s]},mod:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],localVariables:[n.VAL_TYPE.i32],binary:[...n.op.local_get(1),n.op.i32_trunc_f64_s,...n.op.local_tee(2),...n.op.i32_const(0),n.op.i32_ne,...n.op.if(n.BLOCK.f64),...n.op.local_get(0),n.op.i32_trunc_f64_s,...n.op.local_get(2),n.op.i32_rem_s,n.op.f64_convert_i32_s,n.op.else,...n.op.f64_const(0),n.op.end]},bitwiseOr:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),n.op.i64_trunc_s_f64,...n.op.local_get(1),n.op.i64_trunc_s_f64,n.op.i64_or,n.op.f64_convert_i64_s]},bitwiseAnd:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),n.op.i64_trunc_s_f64,...n.op.local_get(1),n.op.i64_trunc_s_f64,n.op.i64_and,n.op.f64_convert_i64_s]},div:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],localVariables:[n.VAL_TYPE.i32],binary:[...n.op.local_get(1),...n.op.f64_const(0),n.op.f64_ne,...n.op.if(n.BLOCK.f64),...n.op.local_get(0),...n.op.local_get(1),n.op.f64_div,n.op.else,...n.op.f64_const(0),n.op.end]},_getBufferIndex:{args:[n.VAL_TYPE.f64],returns:[n.VAL_TYPE.i32],localVariables:[n.VAL_TYPE.f64,n.VAL_TYPE.i32],binary:[...n.op.f64_const(n.EPSILON),...n.op.local_get(0),n.op.f64_add,...n.op.local_tee(1),n.op.i32_trunc_f64_s,...n.op.local_set(2),...n.op.i32_const(-1),...n.op.local_get(2),...n.op.i32_const(8),n.op.i32_mul,...n.op.local_get(2),...n.op.i32_const(0),n.op.i32_lt_s,...n.op.local_get(2),...n.op.i32_const(i.BUFFER_SIZE-1),n.op.i32_gt_s,n.op.i32_or,n.op.select]}}},"./node_modules/process/browser.js":function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=o(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new m(e,t)),1!==c.length||u||o(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/webpack/buildin/module.js":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./src/assemblyscript/presetFunctions.ts":function(e,t){e.exports=()=>"AGFzbQEAAAABPQpgAABgAXwBfGACfHwBfGACf38AYAR/f39/AGAJf39/f3x8fHx8AGADf399AGABfwF/YAJ/fwF/YAF+AX8CuBWMAQNlbnYFYWJvcnQABAhwaXhlbEVxcwtwZXJQaXhlbEVxcwAADHBpeGVsVmFyUG9vbAR3YXJwA3wBDHBpeGVsVmFyUG9vbAR6b29tA3wBDHBpeGVsVmFyUG9vbAd6b29tZXhwA3wBDHBpeGVsVmFyUG9vbAJjeAN8AQxwaXhlbFZhclBvb2wCY3kDfAEMcGl4ZWxWYXJQb29sAnN4A3wBDHBpeGVsVmFyUG9vbAJzeQN8AQxwaXhlbFZhclBvb2wCZHgDfAEMcGl4ZWxWYXJQb29sAmR5A3wBDHBpeGVsVmFyUG9vbANyb3QDfAEMcGl4ZWxWYXJQb29sA3JhZAN8AQxwaXhlbFZhclBvb2wDYW5nA3wBDHBpeGVsVmFyUG9vbAF4A3wBDHBpeGVsVmFyUG9vbAF5A3wBCHFWYXJQb29sAnExA3wBCHFWYXJQb29sAnEyA3wBCHFWYXJQb29sAnEzA3wBCHFWYXJQb29sAnE0A3wBCHFWYXJQb29sAnE1A3wBCHFWYXJQb29sAnE2A3wBCHFWYXJQb29sAnE3A3wBCHFWYXJQb29sAnE4A3wBCHFWYXJQb29sAnE5A3wBCHFWYXJQb29sA3ExMAN8AQhxVmFyUG9vbANxMTEDfAEIcVZhclBvb2wDcTEyA3wBCHFWYXJQb29sA3ExMwN8AQhxVmFyUG9vbANxMTQDfAEIcVZhclBvb2wDcTE1A3wBCHFWYXJQb29sA3ExNgN8AQhxVmFyUG9vbANxMTcDfAEIcVZhclBvb2wDcTE4A3wBCHFWYXJQb29sA3ExOQN8AQhxVmFyUG9vbANxMjADfAEIcVZhclBvb2wDcTIxA3wBCHFWYXJQb29sA3EyMgN8AQhxVmFyUG9vbANxMjMDfAEIcVZhclBvb2wDcTI0A3wBCHFWYXJQb29sA3EyNQN8AQhxVmFyUG9vbANxMjYDfAEIcVZhclBvb2wDcTI3A3wBCHFWYXJQb29sA3EyOAN8AQhxVmFyUG9vbANxMjkDfAEIcVZhclBvb2wDcTMwA3wBCHFWYXJQb29sA3EzMQN8AQhxVmFyUG9vbANxMzIDfAEIdFZhclBvb2wCdDEDfAEIdFZhclBvb2wCdDIDfAEIdFZhclBvb2wCdDMDfAEIdFZhclBvb2wCdDQDfAEIdFZhclBvb2wCdDUDfAEIdFZhclBvb2wCdDYDfAEIdFZhclBvb2wCdDcDfAEIdFZhclBvb2wCdDgDfAEKc2hhcGVQb29sMAN4XzADfAEKc2hhcGVQb29sMAN5XzADfAEKc2hhcGVQb29sMAVyYWRfMAN8AQpzaGFwZVBvb2wwBWFuZ18wA3wBCnNoYXBlUG9vbDADcl8wA3wBCnNoYXBlUG9vbDADZ18wA3wBCnNoYXBlUG9vbDADYl8wA3wBCnNoYXBlUG9vbDADYV8wA3wBCnNoYXBlUG9vbDAEcjJfMAN8AQpzaGFwZVBvb2wwBGcyXzADfAEKc2hhcGVQb29sMARiMl8wA3wBCnNoYXBlUG9vbDAEYTJfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9yXzADfAEKc2hhcGVQb29sMApib3JkZXJfZ18wA3wBCnNoYXBlUG9vbDAKYm9yZGVyX2JfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9hXzADfAEKc2hhcGVQb29sMA50aGlja291dGxpbmVfMAN8AQpzaGFwZVBvb2wwCnRleHR1cmVkXzADfAEKc2hhcGVQb29sMAp0ZXhfem9vbV8wA3wBCnNoYXBlUG9vbDAJdGV4X2FuZ18wA3wBCnNoYXBlUG9vbDAKYWRkaXRpdmVfMAN8AQpzaGFwZVBvb2wxA3hfMQN8AQpzaGFwZVBvb2wxA3lfMQN8AQpzaGFwZVBvb2wxBXJhZF8xA3wBCnNoYXBlUG9vbDEFYW5nXzEDfAEKc2hhcGVQb29sMQNyXzEDfAEKc2hhcGVQb29sMQNnXzEDfAEKc2hhcGVQb29sMQNiXzEDfAEKc2hhcGVQb29sMQNhXzEDfAEKc2hhcGVQb29sMQRyMl8xA3wBCnNoYXBlUG9vbDEEZzJfMQN8AQpzaGFwZVBvb2wxBGIyXzEDfAEKc2hhcGVQb29sMQRhMl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX3JfMQN8AQpzaGFwZVBvb2wxCmJvcmRlcl9nXzEDfAEKc2hhcGVQb29sMQpib3JkZXJfYl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX2FfMQN8AQpzaGFwZVBvb2wxDnRoaWNrb3V0bGluZV8xA3wBCnNoYXBlUG9vbDEKdGV4dHVyZWRfMQN8AQpzaGFwZVBvb2wxCnRleF96b29tXzEDfAEKc2hhcGVQb29sMQl0ZXhfYW5nXzEDfAEKc2hhcGVQb29sMQphZGRpdGl2ZV8xA3wBCnNoYXBlUG9vbDIDeF8yA3wBCnNoYXBlUG9vbDIDeV8yA3wBCnNoYXBlUG9vbDIFcmFkXzIDfAEKc2hhcGVQb29sMgVhbmdfMgN8AQpzaGFwZVBvb2wyA3JfMgN8AQpzaGFwZVBvb2wyA2dfMgN8AQpzaGFwZVBvb2wyA2JfMgN8AQpzaGFwZVBvb2wyA2FfMgN8AQpzaGFwZVBvb2wyBHIyXzIDfAEKc2hhcGVQb29sMgRnMl8yA3wBCnNoYXBlUG9vbDIEYjJfMgN8AQpzaGFwZVBvb2wyBGEyXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfcl8yA3wBCnNoYXBlUG9vbDIKYm9yZGVyX2dfMgN8AQpzaGFwZVBvb2wyCmJvcmRlcl9iXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfYV8yA3wBCnNoYXBlUG9vbDIOdGhpY2tvdXRsaW5lXzIDfAEKc2hhcGVQb29sMgp0ZXh0dXJlZF8yA3wBCnNoYXBlUG9vbDIKdGV4X3pvb21fMgN8AQpzaGFwZVBvb2wyCXRleF9hbmdfMgN8AQpzaGFwZVBvb2wyCmFkZGl0aXZlXzIDfAEKc2hhcGVQb29sMwN4XzMDfAEKc2hhcGVQb29sMwN5XzMDfAEKc2hhcGVQb29sMwVyYWRfMwN8AQpzaGFwZVBvb2wzBWFuZ18zA3wBCnNoYXBlUG9vbDMDcl8zA3wBCnNoYXBlUG9vbDMDZ18zA3wBCnNoYXBlUG9vbDMDYl8zA3wBCnNoYXBlUG9vbDMDYV8zA3wBCnNoYXBlUG9vbDMEcjJfMwN8AQpzaGFwZVBvb2wzBGcyXzMDfAEKc2hhcGVQb29sMwRiMl8zA3wBCnNoYXBlUG9vbDMEYTJfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9yXzMDfAEKc2hhcGVQb29sMwpib3JkZXJfZ18zA3wBCnNoYXBlUG9vbDMKYm9yZGVyX2JfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9hXzMDfAEKc2hhcGVQb29sMw50aGlja291dGxpbmVfMwN8AQpzaGFwZVBvb2wzCnRleHR1cmVkXzMDfAEKc2hhcGVQb29sMwp0ZXhfem9vbV8zA3wBCnNoYXBlUG9vbDMJdGV4X2FuZ18zA3wBCnNoYXBlUG9vbDMKYWRkaXRpdmVfMwN8AQMZGAgDBwkBAQICAQYFAAAAAAAAAAAAAAAAAAUDAQABBuwMigF8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt/AUEAC3wBRAAAAAAAAAAAC3wBRAAAAAAAAAAAC34BQgALB9kBDwZtZW1vcnkCABJjcmVhdGVGbG9hdDMyQXJyYXkABBFydW5QaXhlbEVxdWF0aW9ucwAMBnNhdmVRcwANCXJlc3RvcmVRcwAOBnNhdmVUcwAPCXJlc3RvcmVUcwAQC3NoYXBlMF9zYXZlABEOc2hhcGUwX3Jlc3RvcmUAEgtzaGFwZTFfc2F2ZQATDnNoYXBlMV9yZXN0b3JlABQLc2hhcGUyX3NhdmUAFQ5zaGFwZTJfcmVzdG9yZQAWC3NoYXBlM19zYXZlABcOc2hhcGUzX3Jlc3RvcmUAGAgBGQraQRi0AQEGfyAAQez///8DSwRAAAsgAEEQaiICQfz///8DSwRAAAsjkAIhBiOQAkEEaiIEIAJBE2pBcHFBBGsiB2oiAj8AIgVBEHRBD2pBcHEiA0sEQCAFIAIgA2tB//8DakGAgHxxQRB2IgMgAyAFSBtAAEEASARAIANAAEEASARAAAsLCyACJJACIAYgBzYCACAEQQRrIgJBADYCBCACQQA2AgggAiABNgIMIAIgADYCECAEQRBqC7sCAQF/AkAgAUUNACAAQQA6AAAgACABakEEayICQQA6AAMgAUECTQ0AIABBADoAASAAQQA6AAIgAkEAOgACIAJBADoAASABQQZNDQAgAEEAOgADIAJBADoAACABQQhNDQAgAEEAIABrQQNxIgJqIgBBADYCACAAIAEgAmtBfHEiAmpBHGsiAUEANgIYIAJBCE0NACAAQQA2AgQgAEEANgIIIAFBADYCECABQQA2AhQgAkEYTQ0AIABBADYCDCAAQQA2AhAgAEEANgIUIABBADYCGCABQQA2AgAgAUEANgIEIAFBADYCCCABQQA2AgwgACAAQQRxQRhqIgFqIQAgAiABayEBA0AgAUEgTwRAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCABQSBrIQEgAEEgaiEADAELCwsLdwECfwJ/QQxBAxACIgFFBEBBDEECEAIhAQsgAQtBADYCACABQQA2AgQgAUEANgIIIABB/////wBLBEBBoAhB0AhBEkE5EAAACyAAQQJ0IgBBABACIgIgABADIAEoAgAaIAEgAjYCACABIAI2AgQgASAANgIIIAELuwQDAX8KfgF8IABC////////////AINCNIhClQh9IgVCBoenQQN0QYAJaiIBKQMAIQcgASkDCCEEIAEpAxAhAiAFQj+DIgVCAFIEQAJ+IAcgBYYgBELAACAFfSIDiIQhByAEIAWGIAIgA4iEIQQgAiAFhiABKQMYIAOIhAshAgsgAEL/////////B4NCgICAgICAgAiEIgVC/////w+DIgMgBEIgiCIIfiAEQv////8PgyIGIAN+IglCIIh8IQQgBiAFQiCIIgZ+IARC/////w+DfCEDIAYgCH4gBEIgiHwgA0IgiHwkkwIgBUIghyACQiCIfiIEIAlC/////w+DIANCIIZ8fCECIAIgBFStI5MCIAUgB358fCIIQgKGIAJCPoiEIgdCP4ciBUIBhyAHhSIDeSEEIAMgBIYgBSACQgKGhSIGQsAAIAR9iIQiAkL/////D4MhAyACQiCIIglCtISjiwJ+IANCorW/yAx+IANCtISjiwJ+IgpCIIh8IgtC/////w+DfCEDIAlCorW/yAx+IAtCIIh8IANCIIh8JJMCIApC/////w+DIANCIIZ8IgMgArpEhBtwUcyYOD+iIAYgBIa6RBgtRFT7ITk/oqCxIgJUrSOTAiIGQguIfLokkQIgAiAGQjWGIANCC4iEfLpEAAAAAAAA8DuiJJICI5ECQoCAgICAgIDYPCAEQjSGfSAAIAeFQoCAgICAgICAgH+DhL8iDKIkkQIjkgIgDKIkkgIgCEI+hyAFfacLlQYDAn8BfgR8IAC9IgNCIIinIgFBH3YhAiABQf////8HcSIBQfvDpP8DTQRAIAFBnsGa8gNJBEBEAAAAAAAA8D8PC0QAAAAAAADwPyAAIACiIgVEAAAAAAAA4D+iIgahIgREAAAAAAAA8D8gBKEgBqEgBSAFIAUgBUSQFcsZoAH6PqJEd1HBFmzBVr+gokRMVVVVVVWlP6CiIAUgBaIiBiAGoiAFIAVE1DiIvun6qL2iRMSxtL2e7iE+oKJErVKcgE9+kr6goqCiIABEAAAAAAAAAACioaCgDwsgAUGAgMD/B08EQCAAIAChDwsCfyADQiCIp0H/////B3EiAUH7w+SJBEkEQAJ8IAFBFHYiAiAAIABEg8jJbTBf5D+iniIFRAAAQFT7Ifk/oqEiACAFRDFjYhphtNA9oiIGoSIEvUIgiKdBFHZB/w9xa0EQSwRAAnwgBURzcAMuihmjO6IgACAAIAVEAABgGmG00D2iIgahIgChIAahoSEGIAIgACAGoSIEvUIgiKdBFHZB/w9xa0ExSwR8IAVEwUkgJZqDezmiIAAgACAFRAAAAC6KGaM7oiIGoSIAoSAGoaEhBiAAIAahBSAECwshBAsgBAskkQIgACAEoSAGoSSSAiAFqgwBC0EAIAMQBSIBayABIAIbCyECI5ECIQUjkgIhBiACQQFxBHwgBSAFoiIAIAWiIQQgBSAAIAZEAAAAAAAA4D+iIAQgACAARH3+sVfjHcc+okTVYcEZoAEqv6CiRKb4EBEREYE/oCAAIAAgAKKiIABEfNXPWjrZ5T2iROucK4rm5Vq+oKKgoqGiIAahIARESVVVVVVVxb+ioaEFRAAAAAAAAPA/IAUgBaIiAEQAAAAAAADgP6IiBKEiB0QAAAAAAADwPyAHoSAEoSAAIAAgACAARJAVyxmgAfo+okR3UcEWbMFWv6CiRExVVVVVVaU/oKIgACAAoiIEIASiIAAgAETUOIi+6fqovaJExLG0vZ7uIT6gokStUpyAT36SvqCioKIgBSAGoqGgoAsiAJogACACQQFqQQJxGwu8BAICfwN8IAAhAyAAvUIgiKdB/////wdxIgFBgIDAoARPBEAgACAAYgRAIAAPC0QYLURU+yH5PyADpg8LIAFBgIDw/gNJBEAgAUGAgIDyA0kEQCAADwtBfyECBSAAmSEAIAFBgIDM/wNJBHwgAUGAgJj/A0kEfCAAIACgRAAAAAAAAPA/oSAARAAAAAAAAABAoKMFQQEhAiAARAAAAAAAAPA/oSAARAAAAAAAAPA/oKMLBSABQYCAjoAESQR8QQIhAiAARAAAAAAAAPg/oSAARAAAAAAAAPg/okQAAAAAAADwP6CjBUEDIQJEAAAAAAAA8L8gAKMLCyEACyAAIACiIgUgBaIhBCAAIAUgBCAEIAQgBCAERBHaIuM6rZA/okTrDXYkS3upP6CiRFE90KBmDbE/oKJEbiBMxc1Ftz+gokT/gwCSJEnCP6CiRA1VVVVVVdU/oKIgBCAEIAQgBCAERC9saixEtKK/okSa/d5SLd6tv6CiRG2adK/ysLO/oKJEcRYj/sZxvL+gokTE65iZmZnJv6CioKIhBCACQQBIBEAgACAEoQ8LAkACQAJAAkACQAJAIAIOBAABAgMEC0RPu2EFZ6zdPyAEROJlLyJ/K3o8oSAAoaEhAAwEC0QYLURU+yHpPyAERAdcFDMmpoE8oSAAoaEhAAwDC0Sb9oHSC3PvPyAERL3L8HqIB3A8oSAAoaEhAAwCC0QYLURU+yH5PyAERAdcFDMmppE8oSAAoaEhAAwBCwALIAAgA6YLvgMCBX8BfkEBIAAgAGIgASABYhsEQCABIACgDwsgAL0iB0IgiKchBCAHpyEDIAG9IgenIgYgB0IgiKciBUGAgMD/A2tyRQRAIAAQBw8LIAVBHnZBAnEgBEEfdnIhAiAFQf////8HcSEFIARB/////wdxIgQgA3JFBEACQAJAAkACQCACRQ0AAkAgAkEBaw4DAQIDAAsMAwsgAA8LRBgtRFT7IQlADwtEGC1EVPshCcAPCwsCQCAFIAZyRQ0AIAVBgIDA/wdGBEBE0iEzf3zZAkBEGC1EVPsh6T8gAkECcRtEGC1EVPshCUBEAAAAAAAAAAAgAkECcRsgBEGAgMD/B0YbIgCaIAAgAkEBcRsPC0EBIARBgIDA/wdGIAQgBUGAgIAgaksbDQAgBSAEQYCAgCBqS0EAIAJBAnEbBHxEAAAAAAAAAAAFIAAgAaOZEAcLIQACQAJAAkACQCACIgMEQCADQQFrDgMBAgMECyAADwsgAJoPC0QYLURU+yEJQCAARAdcFDMmpqE8oaEPCyAARAdcFDMmpqE8oUQYLURU+yEJQKEPCwALRBgtRFT7Ifm/RBgtRFT7Ifk/IAJBAXEbC4ESAwl/AX4IfAJAAkACQAJAIAGZRAAAAAAAAABAZQRAIAFEAAAAAAAAAEBhDQEgAUQAAAAAAADgP2EEQCAAn5lEAAAAAAAA8H8gAEQAAAAAAADw/2IbDwsgAUQAAAAAAADwv2ENAiABRAAAAAAAAPA/YQRAIAAPCyABRAAAAAAAAAAAYQRARAAAAAAAAPA/DwsLIAC9IgunIQcgC0IgiKciBkH/////B3EhBCABvSILQiCIpyIDQf////8HcSIFIAunIghyRQRARAAAAAAAAPA/DwtBASAIQQAgBUGAgMD/B0YbQQEgBUGAgMD/B0tBASAHQQAgBEGAgMD/B0YbIARBgIDA/wdKGxsbBEAgACABoA8LIAZBAEgEfyAFQYCAgJoETwR/QQIFIAVBgIDA/wNPBH9BAiAIIAUgBUEUdkH/B2siAkEUSiIJGyIKQTRBFCAJGyACayICdiIJQQFxa0EAIAogCSACdEYbBUEACwsFQQALIQIgCEUEQCAFQYCAwP8HRgRAIAcgBEGAgMD/A2tyBEAgBEGAgMD/A04EQCABRAAAAAAAAAAAIANBAE4bDwVEAAAAAAAAAAAgAZogA0EAThsPCwAFRAAAAAAAAPh/DwsACyAFQYCAwP8DRgRAIANBAE4EQCAADwsMAwsgA0GAgICABEYNASADQYCAgP8DRgRAIAZBAE4EQCAAnw8LCwsgAJkhDCAHRQRAQQEgBEGAgMD/A0YgBEGAgMD/B0ZBASAEGxsEQEQAAAAAAADwPyAMoyAMIANBAEgbIQAgBkEASAR8IAIgBEGAgMD/A2tyBHwgAJogACACQQFGGwUgACAAoSIAIACjCwUgAAsPCwsgBkEASAR8IAJFBEAgACAAoSIAIACjDwtEAAAAAAAA8L9EAAAAAAAA8D8gAkEBRhsFRAAAAAAAAPA/CyEOIAVBgICAjwRLBHwgBUGAgMCfBEsEQCAEQf//v/8DTARARAAAAAAAAPB/RAAAAAAAAAAAIANBAEgbDwsgBEGAgMD/A04EQEQAAAAAAADwf0QAAAAAAAAAACADQQBKGw8LCyAEQf//v/8DSARAIA5EnHUAiDzkN36iRJx1AIg85Dd+oiAORFnz+MIfbqUBokRZ8/jCH26lAaIgA0EASBsPCyAEQYCAwP8DSgRAIA5EnHUAiDzkN36iRJx1AIg85Dd+oiAORFnz+MIfbqUBokRZ8/jCH26lAaIgA0EAShsPCyAMRAAAAAAAAPA/oSIARAAAAGBHFfc/oiIMIABERN9d+AuuVD6iIAAgAKJEAAAAAAAA4D8gAERVVVVVVVXVPyAARAAAAAAAANA/oqGioaJE/oIrZUcV9z+ioSINoL1CgICAgHCDvyEAIA0gACAMoaEFIARBgIDAAEgEfyAMRAAAAAAAAEBDoiIMvUIgiKchBEFLBUEACyAEQRR1Qf8Ha2ohAyAEQf//P3EiAkGAgMD/A3IhBCACQY6xDkwEf0EABSACQfrsLkgEf0EBBSADQQFqIQMgBEGAgEBqIQRBAAsLIQIgDL1C/////w+DIASsQiCGhL8iD0QAAAAAAAD4P0QAAAAAAADwPyACGyIQoSISRAAAAAAAAPA/IA8gEKCjIhOiIg29QoCAgIBwg78iDCAMoiERIAwgEUQAAAAAAAAIQKAgDSANoiIAIACiIAAgACAAIAAgAETvTkVKKH7KP6JEZdvJk0qGzT+gokQBQR2pYHTRP6CiRE0mj1FVVdU/oKJE/6tv27Zt2z+gokQDMzMzMzPjP6CiIBMgEiAMIARBAXVBgICAgAJyQYCAIGogAkESdGqsQiCGvyIAoqEgDCAPIAAgEKGhoqGiIg8gDCANoKKgIgygvUKAgICAcIO/IgCiIhAgDyAAoiAMIABEAAAAAAAACEChIBGhoSANoqAiDKC9QoCAgIBwg78iAEQAAADgCcfuP6IiDSAARPUBWxTgLz6+oiAMIAAgEKGhRP0DOtwJx+4/oqBEBtDPQ+v9TD5EAAAAAAAAAAAgAhugIgygRAAAAEADuOI/RAAAAAAAAAAAIAIbIg+gIAO3IhCgvUKAgICAcIO/IQAgDCAAIBChIA+hIA2hoQshDCABIAG9QoCAgIBwg78iDaEgAKIgASAMoqAiASANIACiIgCgIgy9IgunIQMgC0IgiKciAkGAgMCEBE4EQCADIAJBgIDAhARrciABRP6CK2VHFZc8oCAMIAChZHINAwUgAkH/////B3FBgJjDhARPQQAgAyACQYCYw4R8a3IgASAMIAChZXIbDQQLIAJB/////wdxIgRBFHZB/wdrIQVBACEDIAECfCAEQYCAgP8DSgRAAnwgAkGAgMAAIAVBAWp1aiIEQf////8HcUEUdkH/B2shBUEAIARB//8/cUGAgMAAckEUIAVrdSIDayADIAJBAEgbIQMgACAEQf//PyAFdUF/c3GsQiCGv6ELIQALIAALoL1CgICAgHCDvyIMRAAAAABDLuY/oiINIAEgDCAAoaFE7zn6/kIu5j+iIAxEOWyoDGFcIL6ioCIMoCIAIACiIQEgDkQAAAAAAADwPyAAIAAgASABIAEgASABRNCkvnJpN2Y+okTxa9LFQb27vqCiRCzeJa9qVhE/oKJEk72+FmzBZr+gokQ+VVVVVVXFP6CioSIBoiABRAAAAAAAAABAoaMgDCAAIA2hoSIBIAAgAaKgoSAAoaEiAL1CIIinIANBFHRqIgJBFHVBAEwEfCADIgJB/wdKBHwgAEQAAAAAAADgf6IhACACQf8HayICQf8HSgR8IAJB/wdrIgJB/wcgAkH/B0gbIQIgAEQAAAAAAADgf6IFIAALBSACQYJ4SAR8IABEAAAAAAAAYAOiIQAgAkHJB2oiAkGCeEgEfCACQckHaiICQYJ4IAJBgnhKGyECIABEAAAAAAAAYAOiBSAACwUgAAsLIAKsQv8HfEI0hr+iBSAAvUL/////D4MgAqxCIIaEvwuiDwsgACAAog8LRAAAAAAAAPA/IACjDwsgDkScdQCIPOQ3fqJEnHUAiDzkN36iDwsgDkRZ8/jCH26lAaJEWfP4wh9upQGiC9QFAwJ/AX4EfCAAvSIDQiCIpyIBQR92IQIgAUH/////B3EiAUH7w6T/A00EQCABQYCAwPIDSQRAIAAPCyAAIAAgAKIiBSAAoiAFIAUgBUR9/rFX4x3HPqJE1WHBGaABKr+gokSm+BARERGBP6AgBSAFIAWioiAFRHzVz1o62eU9okTrnCuK5uVavqCioKJESVVVVVVVxb+goqAPCyABQYCAwP8HTwRAIAAgAKEPCwJ/IANCIIinQf////8HcSIBQfvD5IkESQRAAnwgAUEUdiICIAAgAESDyMltMF/kP6KeIgVEAABAVPsh+T+ioSIAIAVEMWNiGmG00D2iIgahIgS9QiCIp0EUdkH/D3FrQRBLBEACfCAFRHNwAy6KGaM7oiAAIAAgBUQAAGAaYbTQPaIiBqEiAKEgBqGhIQYgAiAAIAahIgS9QiCIp0EUdkH/D3FrQTFLBHwgBUTBSSAlmoN7OaIgACAAIAVEAAAALooZozuiIgahIgChIAahoSEGIAAgBqEFIAQLCyEECyAECySRAiAAIAShIAahJJICIAWqDAELQQAgAxAFIgFrIAEgAhsLIQIjkQIhBSOSAiEGIAJBAXEEfEQAAAAAAADwPyAFIAWiIgBEAAAAAAAA4D+iIgShIgdEAAAAAAAA8D8gB6EgBKEgACAAIAAgAESQFcsZoAH6PqJEd1HBFmzBVr+gokRMVVVVVVWlP6CiIAAgAKIiBCAEoiAAIABE1DiIvun6qL2iRMSxtL2e7iE+oKJErVKcgE9+kr6goqCiIAUgBqKhoKAFIAUgBaIiACAFoiEEIAUgACAGRAAAAAAAAOA/oiAEIAAgAER9/rFX4x3HPqJE1WHBGaABKr+gokSm+BARERGBP6AgACAAIACioiAARHzVz1o62eU9okTrnCuK5uVavqCioKKhoiAGoSAERElVVVVVVcW/oqGhCyIAmiAAIAJBAnEbCxIAIAAoAgQgAUECdGogAjgCAAuTCAIFfwl8IAJBAWohDCADQQFqIQ1EAAAAAAAA8D8gBqMhECAEIAWiIgVEz/dT46Wb9j+iRAAAAAAAACRAoBAGRAAAAAAAABBAokRcj8L1KFwnQKAhFCAFRAIrhxbZzvE/okQAAAAAAAAcQKAQBkQAAAAAAAAIQKJECtejcD2KIUCgIRIgBUTufD81XrrzP6JEAAAAAAAACECgEAZEAAAAAAAACECiRBSuR+F6FCVAoCETIAVEQmDl0CLb7T+iRAAAAAAAABRAoBAGRAAAAAAAABBAokR7FK5H4fomQKAhFSMAJIoBIwEkiwEjAiSMASMDJI0BIwQkjgEjBSSPASMGJJABIwckkQEjCCSSASMJJJMBA0AgCiANSARAQQAhCQNAIAkgDEgEQCAJtyACt6MiBCAEoEQAAAAAAADwP6EiBiAGoiAHoiAHoiAKtyADt6MiBCAEoEQAAAAAAADwP6EiDyAPoiAIoiAIoqCfJAogAQRAIAm3IAK3RAAAAAAAAOA/omFBACAKtyADt0QAAAAAAADgP6JhGwRARAAAAAAAAAAAJAsFIA8gCKIgBiAHohAIIgREAAAAAAAAAABjBHwgBEQYLURU+yEZQKAFIAQLJAsLIAZEAAAAAAAA4D+iIAeiRAAAAAAAAOA/oCQMIA9EAAAAAAAA4L+iIAiiRAAAAAAAAOA/oCQNI4oBJAAjiwEkASOMASQCI40BJAMjjgEkBCOPASQFI5ABJAYjkQEkByOSASQII5MBJAkQAQsgBkQAAAAAAADgP6IgB6JEAAAAAAAA8D8jASMCIwoiBCAEoEQAAAAAAADwP6EQCRAJoyIOokQAAAAAAADgP6AjA6EjBaMjA6AhBCAPRAAAAAAAAOC/oiAIoiAOokQAAAAAAADgP6AjBKEjBqMjBKAhDiMARAAAAAAAAAAAYgRAAnwgBCMARHnpJjEIrGw/oiAFRB1aZDvfT9U/oiAQIAYgFKIiESAPIBWiIhahoqAQCqKgIQQgDiMARHnpJjEIrGw/oiAFRAAAAAAAANg/oiAQIAYgE6IgDyASoqCioRAGoqAhDiAEIwBEeekmMQisbD+iIAVEf2q8dJMY6D+iIBAgBiASoiAPIBOioaKhEAaioCEEIA4jAER56SYxCKxsP6IgBURmZmZmZmbqP6IgECARIBagoqAQCqKgCyEOCyAEIwOhIQQgDiMEoSEGIwkQBiEPIAQjCRAKIg6iIAYgD6KgIwSgIwihRAAAAAAAAOA/oSAIo0QAAAAAAADgP6AhESAAIAsgBCAPoiAGIA6ioSMDoCMHoUQAAAAAAADgP6EgB6NEAAAAAAAA4D+gthALIAAgC0EBaiARthALIAtBAmohCyAJQQFqIQkMAQsLIApBAWohCgwBCwsLogEAIw4klAEjDySVASMQJJYBIxEklwEjEiSYASMTJJkBIxQkmgEjFSSbASMWJJwBIxcknQEjGCSeASMZJJ8BIxokoAEjGyShASMcJKIBIx0kowEjHiSkASMfJKUBIyAkpgEjISSnASMiJKgBIyMkqQEjJCSqASMlJKsBIyYkrAEjJyStASMoJK4BIykkrwEjKiSwASMrJLEBIywksgEjLSSzAQuiAQAjlAEkDiOVASQPI5YBJBAjlwEkESOYASQSI5kBJBMjmgEkFCObASQVI5wBJBYjnQEkFyOeASQYI58BJBkjoAEkGiOhASQbI6IBJBwjowEkHSOkASQeI6UBJB8jpgEkICOnASQhI6gBJCIjqQEkIyOqASQkI6sBJCUjrAEkJiOtASQnI64BJCgjrwEkKSOwASQqI7EBJCsjsgEkLCOzASQtCyoAIy4ktAEjLyS1ASMwJLYBIzEktwEjMiS4ASMzJLkBIzQkugEjNSS7AQsqACO0ASQuI7UBJC8jtgEkMCO3ASQxI7gBJDIjuQEkMyO6ASQ0I7sBJDULawAjNiS8ASM3JL0BIzgkvgEjOSS/ASM6JMABIzskwQEjPCTCASM9JMMBIz4kxAEjPyTFASNAJMYBI0EkxwEjQiTIASNDJMkBI0QkygEjRSTLASNGJMwBI0ckzQEjSCTOASNJJM8BI0ok0AELawAjvAEkNiO9ASQ3I74BJDgjvwEkOSPAASQ6I8EBJDsjwgEkPCPDASQ9I8QBJD4jxQEkPyPGASRAI8cBJEEjyAEkQiPJASRDI8oBJEQjywEkRSPMASRGI80BJEcjzgEkSCPPASRJI9ABJEoLawAjSyTRASNMJNIBI00k0wEjTiTUASNPJNUBI1Ak1gEjUSTXASNSJNgBI1Mk2QEjVCTaASNVJNsBI1Yk3AEjVyTdASNYJN4BI1kk3wEjWiTgASNbJOEBI1wk4gEjXSTjASNeJOQBI18k5QELawAj0QEkSyPSASRMI9MBJE0j1AEkTiPVASRPI9YBJFAj1wEkUSPYASRSI9kBJFMj2gEkVCPbASRVI9wBJFYj3QEkVyPeASRYI98BJFkj4AEkWiPhASRbI+IBJFwj4wEkXSPkASReI+UBJF8LawAjYCTmASNhJOcBI2Ik6AEjYyTpASNkJOoBI2Uk6wEjZiTsASNnJO0BI2gk7gEjaSTvASNqJPABI2sk8QEjbCTyASNtJPMBI24k9AEjbyT1ASNwJPYBI3Ek9wEjciT4ASNzJPkBI3Qk+gELawAj5gEkYCPnASRhI+gBJGIj6QEkYyPqASRkI+sBJGUj7AEkZiPtASRnI+4BJGgj7wEkaSPwASRqI/EBJGsj8gEkbCPzASRtI/QBJG4j9QEkbyP2ASRwI/cBJHEj+AEkciP5ASRzI/oBJHQLdQAjdST7ASN2JPwBI3ck/QEjeCT+ASN5JP8BI3okgAIjeySBAiN8JIICI30kgwIjfiSEAiN/JIUCI4ABJIYCI4EBJIcCI4IBJIgCI4MBJIkCI4QBJIoCI4UBJIsCI4YBJIwCI4cBJI0CI4gBJI4CI4kBJI8CC3UAI/sBJHUj/AEkdiP9ASR3I/4BJHgj/wEkeSOAAiR6I4ECJHsjggIkfCODAiR9I4QCJH4jhQIkfyOGAiSAASOHAiSBASOIAiSCASOJAiSDASOKAiSEASOLAiSFASOMAiSGASONAiSHASOOAiSIASOPAiSJAQsIAEHMCiSQAgsLvAIDAEGMCAsvLAAAAAEAAAAAAAAAAQAAABwAAABJAG4AdgBhAGwAaQBkACAAbABlAG4AZwB0AGgAQbwICzk8AAAAAQAAAAAAAAABAAAAJgAAAH4AbABpAGIALwBhAHIAcgBhAHkAYgB1AGYAZgBlAHIALgB0AHMAQYAJC8ABboP5ogAAAADRVyf8KRVETpmVYtvA3TT1q2NR/kGQQzw6biS3YcW73uouSQbg0k1CHOsd/hyS0Qn1NYLoPqcpsSZwnOmERLsuOdaROUF+X7SLX4Sc9DlTg/+X+B87KPm9ixEv7w+YBd7PfjZtH20KWmY/Rk+3Ccsnx7ondS3qX573OQc9e/Hl67Ff+2vqklKKRjADVghdjR8gvM/wq2t7/GGR46kdNvSaX4WZZQgb5l6A2P+NQGigFFcVBgYxJ3NN"},"./src/audio/audioLevels.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e){let t;this.audio=e,t=this.audio.audioContext?this.audio.audioContext.sampleRate:44100;const r=t/this.audio.fftSize,n=Math.clamp(Math.round(20/r)-1,0,this.audio.numSamps-1),i=Math.clamp(Math.round(320/r)-1,0,this.audio.numSamps-1),a=Math.clamp(Math.round(2800/r)-1,0,this.audio.numSamps-1),s=Math.clamp(Math.round(11025/r)-1,0,this.audio.numSamps-1);this.starts=[n,i,a],this.stops=[i,a,s],this.val=new Float32Array(3),this.imm=new Float32Array(3),this.att=new Float32Array(3),this.avg=new Float32Array(3),this.longAvg=new Float32Array(3),this.att.fill(1),this.avg.fill(1),this.longAvg.fill(1)}get bass(){return this.val[0]}get bass_att(){return this.att[0]}get mid(){return this.val[1]}get mid_att(){return this.att[1]}get treb(){return this.val[2]}get treb_att(){return this.att[2]}static isFiniteNumber(e){return Number.isFinite(e)&&!Number.isNaN(e)}static adjustRateToFPS(e,t,r){return e**(t/r)}updateAudioLevels(e,t){if(this.audio.freqArray.length>0){let r=e;!n.isFiniteNumber(r)||r<15?r=15:r>144&&(r=144),this.imm.fill(0);for(let e=0;e<3;e++)for(let t=this.starts[e];t<this.stops[e];t++)this.imm[e]+=this.audio.freqArray[t];for(let e=0;e<3;e++){let i;i=this.imm[e]>this.avg[e]?.2:.5,i=n.adjustRateToFPS(i,30,r),this.avg[e]=this.avg[e]*i+this.imm[e]*(1-i),i=t<50?.9:.992,i=n.adjustRateToFPS(i,30,r),this.longAvg[e]=this.longAvg[e]*i+this.imm[e]*(1-i),this.longAvg[e]<.001?(this.val[e]=1,this.att[e]=1):(this.val[e]=this.imm[e]/this.longAvg[e],this.att[e]=this.avg[e]/this.longAvg[e])}}}}},"./src/audio/audioProcessor.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/audio/fft.js");class i{constructor(e){this.numSamps=512,this.fftSize=2*this.numSamps,this.fft=new n.default(this.fftSize,512,!0),e&&(this.audioContext=e,this.audible=e.createDelay(),this.analyser=e.createAnalyser(),this.analyser.smoothingTimeConstant=0,this.analyser.fftSize=this.fftSize,this.audible.connect(this.analyser),this.analyserL=e.createAnalyser(),this.analyserL.smoothingTimeConstant=0,this.analyserL.fftSize=this.fftSize,this.analyserR=e.createAnalyser(),this.analyserR.smoothingTimeConstant=0,this.analyserR.fftSize=this.fftSize,this.splitter=e.createChannelSplitter(2),this.audible.connect(this.splitter),this.splitter.connect(this.analyserL,0),this.splitter.connect(this.analyserR,1)),this.timeByteArray=new Uint8Array(this.fftSize),this.timeByteArrayL=new Uint8Array(this.fftSize),this.timeByteArrayR=new Uint8Array(this.fftSize),this.timeArray=new Int8Array(this.fftSize),this.timeByteArraySignedL=new Int8Array(this.fftSize),this.timeByteArraySignedR=new Int8Array(this.fftSize),this.tempTimeArrayL=new Int8Array(this.fftSize),this.tempTimeArrayR=new Int8Array(this.fftSize),this.timeArrayL=new Int8Array(this.numSamps),this.timeArrayR=new Int8Array(this.numSamps)}sampleAudio(){this.analyser.getByteTimeDomainData(this.timeByteArray),this.analyserL.getByteTimeDomainData(this.timeByteArrayL),this.analyserR.getByteTimeDomainData(this.timeByteArrayR),this.processAudio()}updateAudio(e,t,r){this.timeByteArray.set(e),this.timeByteArrayL.set(t),this.timeByteArrayR.set(r),this.processAudio()}processAudio(){for(let e=0,t=0,r=0;e<this.fftSize;e++)this.timeArray[e]=this.timeByteArray[e]-128,this.timeByteArraySignedL[e]=this.timeByteArrayL[e]-128,this.timeByteArraySignedR[e]=this.timeByteArrayR[e]-128,this.tempTimeArrayL[e]=.5*(this.timeByteArraySignedL[e]+this.timeByteArraySignedL[r]),this.tempTimeArrayR[e]=.5*(this.timeByteArraySignedR[e]+this.timeByteArraySignedR[r]),e%2==0&&(this.timeArrayL[t]=this.tempTimeArrayL[e],this.timeArrayR[t]=this.tempTimeArrayR[e],t+=1),r=e;this.freqArray=this.fft.timeToFrequencyDomain(this.timeArray),this.freqArrayL=this.fft.timeToFrequencyDomain(this.timeByteArraySignedL),this.freqArrayR=this.fft.timeToFrequencyDomain(this.timeByteArraySignedR)}connectAudio(e){e.connect(this.audible)}disconnectAudio(e){e.disconnect(this.audible)}}},"./src/audio/fft.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e,t,r=!1){this.samplesIn=e,this.samplesOut=t,this.equalize=r,this.NFREQ=2*t,this.equalize&&this.initEqualizeTable(),this.initBitRevTable(),this.initCosSinTable()}initEqualizeTable(){this.equalizeArr=new Float32Array(this.samplesOut);const e=1/this.samplesOut;for(let t=0;t<this.samplesOut;t++)this.equalizeArr[t]=-.02*Math.log((this.samplesOut-t)*e)}initBitRevTable(){this.bitrevtable=new Uint16Array(this.NFREQ);for(let e=0;e<this.NFREQ;e++)this.bitrevtable[e]=e;let e=0;for(let t=0;t<this.NFREQ;t++){if(e>t){const r=this.bitrevtable[t];this.bitrevtable[t]=this.bitrevtable[e],this.bitrevtable[e]=r}let r=this.NFREQ>>1;for(;r>=1&&e>=r;)e-=r,r>>=1;e+=r}}initCosSinTable(){let e=2,t=0;for(;e<=this.NFREQ;)t+=1,e<<=1;this.cossintable=[new Float32Array(t),new Float32Array(t)],e=2;let r=0;for(;e<=this.NFREQ;){const t=-2*Math.PI/e;this.cossintable[0][r]=Math.cos(t),this.cossintable[1][r]=Math.sin(t),r+=1,e<<=1}}timeToFrequencyDomain(e){const t=new Float32Array(this.NFREQ),r=new Float32Array(this.NFREQ);for(let n=0;n<this.NFREQ;n++){const i=this.bitrevtable[n];i<this.samplesIn?t[n]=e[i]:t[n]=0,r[n]=0}let n=2,i=0;for(;n<=this.NFREQ;){const e=this.cossintable[0][i],a=this.cossintable[1][i];let s=1,o=0;const l=n>>1;for(let i=0;i<l;i++){for(let e=i;e<this.NFREQ;e+=n){const n=e+l,i=s*t[n]-o*r[n],a=s*r[n]+o*t[n];t[n]=t[e]-i,r[n]=r[e]-a,t[e]+=i,r[e]+=a}const c=s;s=c*e-o*a,o=o*e+c*a}n<<=1,i+=1}const a=new Float32Array(this.samplesOut);if(this.equalize)for(let e=0;e<this.samplesOut;e++)a[e]=this.equalizeArr[e]*Math.sqrt(t[e]*t[e]+r[e]*r[e]);else for(let e=0;e<this.samplesOut;e++)a[e]=Math.sqrt(t[e]*t[e]+r[e]*r[e]);return a}}},"./src/blankPreset.js":function(e,t,r){var n;void 0===(n=function(){return{baseVals:{gammaadj:1.25,wave_g:.5,mv_x:12,warpscale:1,brighten:0,mv_y:9,wave_scale:1,echo_alpha:0,additivewave:0,sx:1,sy:1,warp:.01,red_blue:0,wave_mode:0,wave_brighten:0,wrap:0,zoomexp:1,fshader:0,wave_r:.5,echo_zoom:1,wave_smoothing:.75,warpanimspeed:1,wave_dots:0,wave_x:.5,wave_y:.5,zoom:1,solarize:0,modwavealphabyvolume:0,dx:0,cx:.5,dy:0,darken_center:0,cy:.5,invert:0,bmotionvectorson:0,rot:0,modwavealphaend:.95,wave_mystery:-.2,decay:.9,wave_a:1,wave_b:.5,rating:5,modwavealphastart:.75,darken:0,echo_orient:0,ib_r:.5,ib_g:.5,ib_b:.5,ib_a:0,ib_size:0,ob_r:.5,ob_g:.5,ob_b:.5,ob_a:0,ob_size:0,mv_dx:0,mv_dy:0,mv_a:0,mv_r:.5,mv_g:.5,mv_b:.5,mv_l:0},init_eqs:function(){return{}},frame_eqs:function(e){return e.rkeys=["warp"],e.zoom=1.01+.02*e.treb_att,e.warp=.15+.25*e.bass_att,e},pixel_eqs:function(e){return e.warp=e.warp+.15*e.rad,e},waves:[{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""}],shapes:[{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}}],warp:"shader_body {\nret = texture2D(sampler_main, uv).rgb;\nret -= 0.004;\n}\n",comp:"shader_body {\nret = texture2D(sampler_main, uv).rgb;\nret *= hue_shader;\n}\n"}}.apply(t,[]))||(e.exports=n)},"./src/equations/presetEquationRunner.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/utils.js");class i{constructor(e,t,r){this.preset=e,this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=n.default.range(1,33).map((e=>`q${e}`)),this.ts=n.default.range(1,9).map((e=>`t${e}`)),this.regs=n.default.range(100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.initializeEquations(t)}initializeEquations(e){this.runVertEQs=""!==this.preset.pixel_eqs,this.mdVSQInit=null,this.mdVSRegs=null,this.mdVSFrame=null,this.mdVSUserKeys=null,this.mdVSFrameMap=null,this.mdVSShapes=null,this.mdVSUserKeysShapes=null,this.mdVSFrameMapShapes=null,this.mdVSWaves=null,this.mdVSUserKeysWaves=null,this.mdVSFrameMapWaves=null,this.mdVSQAfterFrame=null,this.gmegabuf=new Array(1048576).fill(0);const t={frame:e.frame,time:e.time,fps:e.fps,bass:e.bass,bass_att:e.bass_att,mid:e.mid,mid_att:e.mid_att,treb:e.treb,treb_att:e.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY,gmegabuf:this.gmegabuf};this.mdVS=Object.assign({},this.preset.baseVals,t),this.mdVS.megabuf=new Array(1048576).fill(0),this.mdVS.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.mdVS.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]);const r=this.qs.concat(this.regs,Object.keys(this.mdVS)),i=this.preset.init_eqs(n.default.cloneVars(this.mdVS));this.mdVSQInit=n.default.pick(i,this.qs),this.mdVSRegs=n.default.pick(i,this.regs);const a=n.default.pick(i,Object.keys(n.default.omit(i,r)));if(a.megabuf=i.megabuf,a.gmegabuf=i.gmegabuf,this.mdVSFrame=this.preset.frame_eqs(Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSRegs,a)),this.mdVSUserKeys=Object.keys(n.default.omit(this.mdVSFrame,r)),this.mdVSFrameMap=n.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=n.default.pick(this.mdVSFrame,this.qs),this.mdVSRegs=n.default.pick(this.mdVSFrame,this.regs),this.mdVSWaves=[],this.mdVSTWaveInits=[],this.mdVSUserKeysWaves=[],this.mdVSFrameMapWaves=[],this.preset.waves&&this.preset.waves.length>0)for(let e=0;e<this.preset.waves.length;e++){const r=this.preset.waves[e],i=r.baseVals;if(0!==i.enabled){let a=Object.assign({},i,t);const s=this.qs.concat(this.ts,this.regs,Object.keys(a));Object.assign(a,this.mdVSQAfterFrame,this.mdVSRegs),a.megabuf=new Array(1048576).fill(0),r.init_eqs&&(a=r.init_eqs(a),this.mdVSRegs=n.default.pick(a,this.regs),Object.assign(a,i)),this.mdVSWaves.push(a),this.mdVSTWaveInits.push(n.default.pick(a,this.ts)),this.mdVSUserKeysWaves.push(Object.keys(n.default.omit(a,s))),this.mdVSFrameMapWaves.push(n.default.pick(a,this.mdVSUserKeysWaves[e]))}else this.mdVSWaves.push({}),this.mdVSTWaveInits.push({}),this.mdVSUserKeysWaves.push([]),this.mdVSFrameMapWaves.push({})}if(this.mdVSShapes=[],this.mdVSTShapeInits=[],this.mdVSUserKeysShapes=[],this.mdVSFrameMapShapes=[],this.preset.shapes&&this.preset.shapes.length>0)for(let e=0;e<this.preset.shapes.length;e++){const r=this.preset.shapes[e],i=r.baseVals;if(0!==i.enabled){let a=Object.assign({},i,t);const s=this.qs.concat(this.ts,this.regs,Object.keys(a));Object.assign(a,this.mdVSQAfterFrame,this.mdVSRegs),a.megabuf=new Array(1048576).fill(0),r.init_eqs&&(a=r.init_eqs(a),this.mdVSRegs=n.default.pick(a,this.regs),Object.assign(a,i)),this.mdVSShapes.push(a),this.mdVSTShapeInits.push(n.default.pick(a,this.ts)),this.mdVSUserKeysShapes.push(Object.keys(n.default.omit(a,s))),this.mdVSFrameMapShapes.push(n.default.pick(a,this.mdVSUserKeysShapes[e]))}else this.mdVSShapes.push({}),this.mdVSTShapeInits.push({}),this.mdVSUserKeysShapes.push([]),this.mdVSFrameMapShapes.push({})}}updatePreset(e,t){this.preset=e,this.initializeEquations(t)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(e){return this.mdVSFrame=Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSFrameMap,e),this.mdVSFrame=this.preset.frame_eqs(this.mdVSFrame),this.mdVSFrameMap=n.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=n.default.pick(this.mdVSFrame,this.qs),this.mdVSFrame}runPixelEquations(e){return this.preset.pixel_eqs(e)}runShapeFrameEquations(e,t){return this.preset.shapes[e].frame_eqs(t)}runWaveFrameEquations(e,t){return this.preset.waves[e].frame_eqs(t)}runWavePointEquations(e,t){return this.preset.waves[e].point_eqs(t)}}},"./src/equations/presetEquationRunnerWASM.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/utils.js");class i{constructor(e,t,r){this.preset=e,this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=n.default.range(1,33).map((e=>`q${e}`)),this.ts=n.default.range(1,9).map((e=>`t${e}`)),this.regs=n.default.range(100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.globalKeys=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy"],this.frameKeys=["decay","wave_a","wave_r","wave_g","wave_b","wave_x","wave_y","wave_scale","wave_smoothing","wave_mode","old_wave_mode","wave_mystery","ob_size","ob_r","ob_g","ob_b","ob_a","ib_size","ib_r","ib_g","ib_b","ib_a","mv_x","mv_y","mv_dx","mv_dy","mv_l","mv_r","mv_g","mv_b","mv_a","echo_zoom","echo_alpha","echo_orient","wave_dots","wave_thick","additivewave","wave_brighten","modwavealphabyvolume","modwavealphastart","modwavealphaend","darken_center","gammaadj","warp","warpanimspeed","warpscale","zoom","zoomexp","rot","cx","cy","dx","dy","sx","sy","fshader","wrap","invert","brighten","darken","solarize","bmotionvectorson","b1n","b2n","b3n","b1x","b2x","b3x","b1ed"],this.waveFrameKeys=["samples","sep","scaling","spectrum","smoothing","r","g","b","a"],this.waveFrameInputKeys=["samples","r","g","b","a"],this.initializeEquations(t)}getQVars(e){return n.default.pickWasm(this.preset.globalPools[e],this.qs)}getTVars(e){return n.default.pickWasm(this.preset.globalPools[e],this.ts)}initializeEquations(e){this.runVertEQs=!!this.preset.pixel_eqs,this.mdVSQInit=null,this.mdVSQAfterFrame=null;const t={frame:e.frame,time:e.time,fps:e.fps,bass:e.bass,bass_att:e.bass_att,mid:e.mid,mid_att:e.mid_att,treb:e.treb,treb_att:e.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY};if(this.mdVS=Object.assign({},this.preset.baseVals,t),n.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,Object.keys(this.mdVS)),this.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.preset.init_eqs(),this.mdVSQInit=this.getQVars("perFrame"),this.preset.frame_eqs(),this.mdVSQAfterFrame=this.getQVars("perFrame"),this.mdVSTWaveInits=[],this.preset.waves&&this.preset.waves.length>0)for(let e=0;e<this.preset.waves.length;e++){const t=this.preset.waves[e],r=t.baseVals;0!==r.enabled?(n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,Object.keys(r)),t.init_eqs&&(t.init_eqs(),n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,Object.keys(r))),this.mdVSTWaveInits.push(this.getTVars(`wavePerFrame${e}`))):this.mdVSTWaveInits.push({})}if(this.mdVSTShapeInits=[],this.preset.shapes&&this.preset.shapes.length>0)for(let e=0;e<this.preset.shapes.length;e++){const t=this.preset.shapes[e],r=t.baseVals;0!==r.enabled?(n.default.setWasm(this.preset.globalPools[`shapePerFrame${e}`],r,Object.keys(r)),t.init_eqs&&(t.init_eqs(),n.default.setWasm(this.preset.globalPools[`shapePerFrame${e}`],r,Object.keys(r))),this.mdVSTShapeInits.push(this.getTVars(`shapePerFrame${e}`))):this.mdVSTShapeInits.push({})}}updatePreset(e,t){this.preset=e,this.initializeEquations(t)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(e){n.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,this.frameKeys),n.default.setWasm(this.preset.globalPools.perFrame,this.mdVSQInit,this.qs),n.default.setWasm(this.preset.globalPools.perFrame,e,this.globalKeys),this.preset.frame_eqs(),this.preset.save_qs(),this.mdVSQAfterFrame=this.getQVars("perFrame");const t=n.default.pickWasm(this.preset.globalPools.perFrame,[...this.frameKeys,...this.globalKeys]);return t.rand_preset=this.rand_preset,t.rand_start=this.rand_start,t}runWaveFrameEquations(e,t){const r=this.preset.waves[e].baseVals;return n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,this.waveFrameInputKeys),n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],this.mdVSQAfterFrame,this.qs),n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],this.mdVSTWaveInits[e],this.ts),n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],t,this.globalKeys),this.preset.waves[e].frame_eqs(),n.default.pickWasm(this.preset.globalPools[`wavePerFrame${e}`],this.waveFrameKeys)}}},"./src/image/imageTextures.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e){this.gl=e,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.samplers={},this.clouds2Image=new Image,this.clouds2Image.onload=()=>{this.samplers.clouds2=this.gl.createTexture(),this.bindTexture(this.samplers.clouds2,this.clouds2Image,128,128)},this.clouds2Image.src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4RP+RXhpZgAASUkqAAgAAAAJAA8BAgAGAAAAegAAABABAgAVAAAAgAAAABIBAwABAAAAAQAAABoBBQABAAAAoAAAABsBBQABAAAAqAAAACgBAwABAAAAAgAAADIBAgAUAAAAsAAAABMCAwABAAAAAQAAAGmHBAABAAAAxAAAAGYFAABDYW5vbgBDYW5vbiBQb3dlclNob3QgUzExMAAAAAAAAAAAAAAAAEgAAAABAAAASAAAAAEAAAAyMDAyOjAxOjE5IDE3OjMzOjIwABsAmoIFAAEAAABWAwAAnYIFAAEAAABeAwAAAJAHAAQAAAAwMjEwA5ACABQAAAAOAgAABJACABQAAAAiAgAAAZEHAAQAAAABAgMAApEFAAEAAAA+AwAAAZIKAAEAAABGAwAAApIFAAEAAABOAwAABJIKAAEAAABmAwAABZIFAAEAAABuAwAABpIFAAEAAAB2AwAAB5IDAAEAAAAFAAAACZIDAAEAAAAAAAAACpIFAAEAAAB+AwAAfJIHAJoBAACGAwAAhpIHAAgBAAA2AgAAAKAHAAQAAAAwMTAwAaADAAEAAAABAAAAAqAEAAEAAACAAAAAA6AEAAEAAACAAAAABaAEAAEAAAAwBQAADqIFAAEAAAAgBQAAD6IFAAEAAAAoBQAAEKIDAAEAAAACAAAAF6IDAAEAAAACAAAAAKMHAAEAAAADAAAAAAAAADIwMDI6MDE6MTkgMTc6MzM6MjAAMjAwMjowMToxOSAxNzozMzoyMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAACoBAAAgAAAAuAAAACAAAAABAAAAgAIAAEgAAAAKAAAA/////wMAAACK+AIAAAABAL8BAADoAwAArQAAACAAAAAMAAEAAwAmAAAAHAQAAAIAAwAEAAAAaAQAAAMAAwAEAAAAcAQAAAQAAwAaAAAAeAQAAAAAAwAGAAAArAQAAAAAAwAEAAAAuAQAAAYAAgAgAAAAwAQAAAcAAgAYAAAA4AQAAAgABAABAAAAkc4UAAkAAgAgAAAA+AQAABAABAABAAAAAAAJAQ0AAwAEAAAAGAUAAAAAAABMAAIAAAAFAAAAAAAAAAQAAAABAAAAAQAAAAAAAAAAAAAAAwABAAEwAAD/////WgGtACAAYgC4AP//AAAAAAAAAAAAAP//SABABkAGAgCtANMAngAAAAAAAAAAADQAAACPAEYBtQAqAfT/AgABAAEAAAAAAAAAAAAEMAAAAAAAAAAAvwEAALgAJwEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAElNRzpQb3dlclNob3QgUzExMCBKUEVHAAAAAAAAAAAARmlybXdhcmUgVmVyc2lvbiAxLjAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAMgAuQC5AABqGADOAAAAgE8SAJsAAAAEAAEAAgAEAAAAUjk4AAIABwAEAAAAMDEwMAEQAwABAAAAQAYAAAIQAwABAAAAsAQAAAAAAAAGAAMBAwABAAAABgAAABoBBQABAAAAtAUAABsBBQABAAAAvAUAACgBAwABAAAAAgAAAAECBAABAAAA9AUAAAICBAABAAAAuA0AAAAAAAC0AAAAAQAAALQAAAABAAAAaM5qp6ps7vXbS52etpVdo/tuYZ2wtrDFXnrx1HK+braKpineV1+3VFWVteo72Poc/9j/2wCEAAkGBggGBQkIBwgKCQkLDRYPDQwMDRwTFRAWIR0jIiEcIB8kKTQsJCcxJx4fLT0tMTY3Ojo6Iio/RD44QjM3OTYBCQkJDAoMFAwMFA8KCgoPGhoKChoaTxoaGhoaT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT//AABEIAHgAoAMBIQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AOdCcU4R11HMSLHTxFTAXy6PLxQIUJTglIDo9KtbWzjScNvnK/gtao1FkycjaO1ebWvOWvyR307RjZfM5zXoraacTW3DtkyD1PrWathui39q66cmoK+60OacU5O2xA8ZQlT2qBkrdfmYsiZMUwpxVCImXNRMntTERlaaRg0CN5Y8iniOszUlWOniOgQhj5o2UwDZS7KBFmAuoCnIAq69wUjIHPHWuaok5HTBtIqrbzXCMyAEDqCarPvGV6Yqlbb+Xch337kBTOd1RNHxgCrc+xKgNWAPxyD2qCWMAY7g81UJ83yJlGxCy4qJlzWqMyMpTClAjoxCUbDCniP2rK5qOVKkEdMA8ummPmgA2Vd0m1S4vMTIXjUEtjtUzdotrdLQcFeSXQfcQqJ2y/GaZL5fkhE5Y9TXPFt2Zu7K6IUinVWVW+XvjvSNCsceScsa0k1067kRT69NisY8mnC2YoWA4qL2KtcglyjcVVdd78daqnK3zImr/IheFgTkdKiZK6ou6MJKxGyUwrTJOxmjaS2WYqwjLHbnp9KBaeeB5MbZxzXLGVlfotzpcdbdXsQiKniOtSBfLppjoTE0NMdPiYxElSRmiSurAnZiSMTzmmKSDmpUdCpS1NvT0TUoHEjpGQcYC8n3qM6MJdxgYuF46VyyfI2ui6nQlzJPq+hDPo0qcKNz/wB0U54Es7co/wAzkcgdAamU01ZbtjUWnrsjDn+dzxiqpjYHK1aZDHJGQmM9ahe2zk+lbU5WZlOOhWZKjKV1nOddYTPLpptjztbcB2NTBXibaSUOOma4IWt+h2y3/Uj8rmlEdbJmLQpTjpTNlNCYnl00x1RI0x00x4oARd6tmPIPtW1o+uf2fGd+GORlcdffNZVaaqRt1NKc+R36HQxWsWoqbmGQ/MMkg4rL1bSdi5UV5fM4ys9LHfZNXXU599Lkd+FNMbSzGPmHNb85lyFaS32HgUx8pGcqK2g72M5aGY8fPSomSvRRwndafZfYtRCzL8rHFaPiPTTHKlxHGEjKhTj1ryKU/wB4uzR6dSPuPujF2YIzTxHxXamtuxyNPfuIY+KYY6okDHg4pHQIMsQKLhYhV0dtq8mr6aQ8loZRy390DNZVKqgr92aQpczKcd8+nXefLHAwVI6028nt7mTzIY/KJ5IB4qI3UuZO6fxIuSTjy21WzLmjXs9rKFidgM/dzxXTJeRECC5ZN5XPWscVTTlePxM0oS0s9kUriaIEiIKAPzrFup/3uBzmopU3fUqc0isTEQWftVWZ0dPlWuqNNr0RhKafqzOlh6mq7x12RZytHqssMcwSfy0wwyDuxRq2oCew8gxjdx1HT3rx6Uby9GenUdkc/wCSpPzdaV4WVeFJru226nLv8iFVc/eXFKYsCqi7omSIjHzS3EKSRZBJbHNOWwRMp4WjO/O0Z4NWUubuGParnafSsXFS0ZonYRo/Pwzcmk8gL0FbQgkjOUncfFK9sSU4JpkkzO+7Jz9atRV7mbk7WHpczAcOT9aUqzgu3Ud6lxSd1oylJvRkMgDZJJzVSTK9KqKJbIGJqJlzWiViG7nfW1/ZK8XJUDqT0q9q08V2sRiL5HAG35SD3Bryaalzps9KduWyKt1pjWoXzG2uRnkcCs+8ee2YKJUbIzx0Iq/bXemiRPs7IY15Ey7m+TA5BrPuNUDIyCMDnhs81rz3SsZ8tmXbFDe2DTKVzHwyk8n6Vl3944Zo04A7jvT9pp5oOTX1Mp5GVsnmtG21aEQKkikFRj604SFKJOmpWrHAYr9RUjMGXKcg9xW0WmYyTREwNN281qZkqphQRwacCMYPHvUPUpCPGhXORmqU0fNEXqEkV2j9qjKVoQa+GAALE47VPDezRYUOdo7V5CkelY0pb+eayOJt4PG1uSKxpEkQkkmp0T9StX8hnm5GCM1GUBzVXsIj+deFYge1NMTueuapyJURr2jMvTmqclq4PK4ohMJRIhGwNadgLolUjDMvcVtz217GfLc2PsuSQQdw7Uw2pU/MCK6FU6eWhg4afmWLeKFkZJcg9mFRzac8MSyMRhumKnns7PZvQOS6utLblaRMLyR9KhkhVVBDZzV21TFeysVXWoiK1MjttV8O/YWyXVgegFZRsTu4FeHdp2e63PWSvqupZtrbadpHFPnst4xgVDlqUkUX03ax7VEbNd3ByapSbFYDYKw4PPpTv7LdT0wRVq703J0XkBtlU7Sy7qje1yMMtJpoaaZWbTCZOB+FdVo+n/ZrRXaEh/pwacptxEo2ZZfRBLmQNskY8g1lXmm3VsS4IZaaxDvZ9NifZK35mUZbp7odD6jGK3jcotogmgUrWsp3tZ2sTGO+nqZr3Flco6JEEdc7eetLDoElxEH81Vz0FbQrOEby9530MZUlJ+7ppqOOgRxDMrqcdumaqz6Xa55YJnphqaxE5PRadgdGKWr17nd+cl4VFzGHAq0NEspRuRNp9K5vYxm3e6b2ZvzuK027CroNsPvLz6iql7oICFkOQO1RPCuMbp3a3Q41ruzWj2MG604xZJrInQoSVHPrXPB3NZEYlm6bM0gup0+SQttPXmt42W25DuRTW7ht6qXX1qxZSSSttZcqPWrjJPfXuiWrbGgFiADHBxW9p1z5dv8AvW3J2B7VbUeXuQnK/kM+0SyTt5GSg/ic8VUv7xpodrDn26Gs5wj0+LqXGT67dDFWLEhfkGo5nklyrE4qlC9vwJcrFRbJVl3GtO1njhTqQR61u4StYyU1civ7sSLtAJ981kSLnPJrelHlRhVlzM7yLTdTtJuu9Qe3NdBbGUorMFJxz2NcFPnUrWO2XK4lsdKCARg13bmBSurCGU4aMtn0qjJ4Xt3YnP0GK4pYbmk+X3bGyq2WvvFKTw5IpIRAR61Fc+Gttvvfn1GOlYeynHVq1uprzxfzKcCW1mdroXU8YIqQR2KA7AxPUgDGKiz3TKutjPnjic74jtB9TzT4p58Bc7yOm6tItrfoQ0mWEubtZf367l7DtUqq1w24gKg6kDpW0FFrm7Gc207dynKqqzAoOehFVmhLdFJ/CumKtuYN9gGnzuPlibmoXs5VJBXkH1qlVjtdEezlvYimtJEXLow/CqErIDWkZp7WZEotbnrsTkjrmphz1rGDutdToloxaK0EMkU9VGSKRDIQd4A9MVm+ZS0+F7selvPoNDuHw3T2oJWUlWH50r3Vn1HtqjG1LSmVS6DdzxxWQ+nTSTcghjXBKPs3Z/I6IvmV/vK7aWYptsp2jua0LG3tllLQZkK8dO9C95227g9FfcmuFnnUrtyF9BUthHhfLkjO0n14zXToo2WhiruV2JqFtFGNyxoSPUVztzrdzBJhdoVewFZJ8zs3dLY0a5dVu9yCTxLKUPyDd2NZE+tXDyF84J74rSMEiJSbKFxqFxMpDyuQe2azpN3dj+dbRlbYzkr7nvCJkYxsP95eDUqxyA584t7EVnTi+j5fLoaSa66+ZOM45orqMgooAYwqNhis5DQ0yMBio2Zm7ZrNu+5VrDNizPsdFI9CKjNrDCuEiCZ6kcVlKEd7fMtSe34DY2jV8YKknvzTLqUQcs+PwqJuyuVHU5TWtVeaX5coq/dGaxpLxpUw4zjvRFKwSepAF85SUGcdRVeaJh/DiqvZ2JsZ86sDz0qBo2xu/hq0yLHvy9KeK2pkvcdRWogpM0AIaYwqJAhNq1FcPKoHlIHHesZNqPu6vsWtXrou5HuK5YLzjjNZ1/c3YiIUZX+8vauec36LqbRivV9DNivriYlWOdo6HmrxleWIBgDx3HSpaugvZmDqFuWYgwKSPQVlsjxIym3BUgjmoXa+xT7lSOzd3PkAq3YZpby8vVASeNendBzWukt+nUz22Jo7S2v4A3lFGxzg1Rm0l4m+UMVPqKlSa03Q2k9T/9n4qqwQ2C6FUcJKhVwpbQ1vCsihOUlK0km1lS0VoSE2qiF4TrpDJE0aZJK5EgBF7pQGeoyWHrHyLxlrwklpeaZbWWmyFkkIa43/2P/bAEMAAgEBAQEBAgEBAQICAgICBAMCAgICBQQEAwQGBQYGBgUGBgYHCQgGBwkHBgYICwgJCgoKCgoGCAsMCwoMCQoKCv/bAEMBAgICAgICBQMDBQoHBgcKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCv/AABEIAIAAgAMBIgACEQEDEQH/xAAeAAACAwEAAwEBAAAAAAAAAAAGBwQFCAMBAgkACv/EADcQAAEDAwMDAgUDAgYCAwAAAAECAwQFBhEAEiEHMUETUQgiMmFxFIGRFaEjQlKxwdEW8ReCov/EABsBAAICAwEAAAAAAAAAAAAAAAUGAwQBAgcA/8QAMREAAgEDAwMCBQMDBQAAAAAAAQIDAAQRBRIhMUFRE3EiYYGRwaHR4QYU8BUjMnKx/9oADAMBAAIRAxEAPwDNEamJCR8v9tT4dJ3Zwn+2rSHStzaVBvOrSDShnBTpvDYpbIBqsi0QKRn0+QO2uwpJQQCjRFEpR8D+2uj1LIXjb/bWwfmtNvFDqaWE/LsHfXZFNB/y6uVU75uUjj7a6NwMfMEfjWd3Fa0f/DB0mtK7KpIum8KgUxqQ+0pmE2EqMlzOQFA/5MgZ/J1q2L1glUxsPtIbbitNpW80EgbwSO+PGsWWjUqhRZy/0Tqkh1OFgH78aaKLzm0i28SnlLddYwk+wGdJH9QafJd3QLtkdh4802aNeRwWxCjBHU+aA/iosex//ktysdPnN8SpAOymM/M1IUo7/wD6k8jS8uTpxPthCJL3yuJSFKGOwPY50wavS7gnU3+vro7i4QXkyA3naoc86FrhnVGqpQl1SvTI5QVZzycHR6zkmiiSMvkLwSevtQe7WJ5HcLyeRS/q0BHqLc9NIKjyB50Pz6cEkkj+2j2qUlDRWfrJSQEgdjqqRbKKkVMJe2uBO5KSngn20SW9t1OC1DjaTsMhaBKhBCWt23A841QVGnBaiQ3n86O67TGWigR1bsg7hjkHPnVFNiJSgpIyc8DRBDxVRhjigmVAAP041CcaW2rcgYI9tE82n5PCedVkqAUkgJ1uQDUXfFaZplIUMsqb2kHke2rGNSylf0g8+2j2rWvRZtbjvxXY7EV14tuymdxzknCiD9hnge+oU+110+WtoLS4hKylDiBwoe/+2gkVysgB80akhZCQao4lMCk528jXRykKJ3bfxq8jUopABT31KXSRn6NS7sVFjihNVM+Y5T24zr1FPIVt26I3aUoEkA9+2uCqaUuDKdShs1oQM0bVvpPAtizaDUKLKVIVUYaZcxTrQSpl4jBQPOE/7k6rK1QUU213PUmJVLeWG4zTSgoff8Ht/Op1239WbjjNqqMgKDLKW0hCQkAJAHYceNC8aprVNbW+nKErG7nxnnGlyG3vJcvIckHP8f4KNyz20QCxjqP4rlFq98KoZs5ptxmKuQQ4kZBK/PPtjx21U3NbopREMhKlgfOQex9taAhdK3uofT7/AMo6eUh2PBElXqOyn0bFKT9XJOQRuHccg6BKn0RvByUUyqI+pxbZWnCchSQcZyOMZxzqs97E5IwFweR3z86nS0dFByWyOD2x8qULduuOOfIwVcZOBquqaEUV9t1EMBQz3HjTz6c9OpUibLl1aKGIsMelIekfKncoHAB8nj9tK/qfDpiqu9Hp3KWyQCR3++q7XStcel4FSiAiLf5pTVmEhcl1aOQok8e+h2bTVBZJGD99HAYnQZKxCYSXHRt3LQFAZ+x17XBbjT0VpLURKNqcFwJ5Ufvpms9VUuEfvQC609gpZaWMqAcnjzxqslQwBx+2jGr0ZyI6WHmsKx/OqaXTu4KfxjxpgBDDNBDuU1t2HUKReHSW0yqB6D9NEhh+Q0jIWvcFBC/bgkhX3I8al1mQ5ULdj0gUeKw2zIW6hbKDuJICeSSf9I0c/Bn0Pi3xcL1o1iSmP6chKz6qcjaPlPB78Ej99D9etp63K1OtySfUMSU4zuAwCUqIz++Nc70q8huB6SHLJz9yaeNQt3hbe3Rhj7AUJMUc8fJru5S0+n9HI99EcOkFxO5ScY9hr2k0hIbPy+PbTCX3UEA2mg1ym7gfl51Hk0rCdwbOilVLUkkFGvC6SVEkI/IOrAkAqBlNBbkJQQQnODxqK7TFIPKNGTtFZS4d+AAMnOvU2dPqEN6bAhuuMxwPWdbbJSjPbJ8aw9xFEMk4FeSOSQ4UZqNY/V26LLpj1qR5CjT5K8uhP1oJKclJJ4+ka2DZLVgdROlbVDtKII9wohsKeDxG8Mn/AD4BI2naPPdWsxdOennSm511K27kulcCqlgKpUpxQ9FSwPpV7A++ovTq+Lw6IdUGJcSWmQuG56DjbUrc082T9IUONvn/AI0rana2msB1tjtlX4vG79x2/wDaYLO4udM2mcZjbjzinj1f6PXNEtfDtIYjts8+nETj1FEY3qz3JwNZJvGw566u4n0FbiTu419Ird6o2r18oaWnIiYr8mKlT0dXdteSCArGCMAY/wCNKq8ehtl2tMcl1LY8+SpSGkjsOcE/9aRrbULm0maKZfiHamiW1huI1dDxWGHOmU9tkPyIpSM5STqGKHBTIEea2VJB5GtFXzCob812AkIbUjgADHGgWo9OY7Sf1jrjYDhJQpRxxpktbidjlxig08MSjC81nbqPSKe3Wj/Twop9IbwrsFew0HzaeE8lPfTav+22WqissELUSd2DxjQRVKQGx8qPyddMsJA1qgz2pDvEK3LH519dunnRiPZfXiDc8OoxUU1x8IdUy6NqwrIBx3wSM6B/jNsG2aZ1fdlW5LbWJ0Rtx5pAyW1425J7HIAOmjYxrN8yqTb9UoEanKXT0h+ey8lTrxGcKScZRn2PnzpWdXKVKYvqo0559+U7EfLSJMiOW3HAnspSTnx57Ec65F/TyYuid3IGDjx710nV2zAo28Z/X2pVU+2JMJrZIVk9xrg6xDkLWww8lS0n5kA8jRo7NtiAwpF0SVNEK+YIQdwGq9u16ImOzWqO8l1qWne24MHI/wCD9jpvhugGEakEDrzS/Lb7gXYYJ+VCS6c5HUHkJ+dJyCR2OudJpEya86zGirce27m/TTnGOSSPbV7dM2FRkw0uOMqEuQWfkeSVIUMd0jkdxqM4HqK8qR6oZ9MEOlRxgeQdXBcJIp2HmqZt3jcFhxShvufX6ZWQuS84SlZJaSOMZ9tMzpz8RVmUmy5do120UuNPJBSyklG5eACSR3yB2++ll1F6rW69WZKItHTIUUFDD7rpGxefqwO478atrNtyFeVoR6o84gPeotC1NEDJB4PbQie3W/X02PGc9aKRTf2R3gVUXJRH59xuVSgRzGZcXuQ2CcIB8DXWHClMOIdlLKlA5yfHPfRk1bbkOElp9e5aBtzjwO2qmpNMxspTjPuPGjVnZpGB5FCLq7eQkY4o+HXyRYtowaBY4ALMlt5ySpeVhSQNwPH0nAI9hka6TPiakXWt2Rcqn23HUkrDaApJXwMjz7/zpRyWSpzcPOplOghLaHZLSi2VYCgNYk0PT2G5kyx79+awurXoOA3HjtVjWqgqq1FdVUVqbWCGyDhQOPOhK6KnV3VoVJdWG0AhAHkaNJUQrpbcVLSAVnd6iOVHuMaFrnp0tpKv1BJUgYIOpLeKFTtA6cVFNNKRknrzQLV5sV1agWjz/mPfQjVYSFLUWxx4zorqsBwun5cA6qJEEkH7edGIY1iHw0NkdpDzWvLB+KW9rXr0OpN1x55tbXpTQtsbkoOAQkqBwQBweccadHTfrT0wrFz1K5ruuWfOcl00x4s2SylTsde0JCl+OEgpBHP2GsvVG0ajCfUw7CIKDjKRqw6eyKjb9cbdMcPNKc2vMujhSc9jri6Tw+myrhdwwSPFdSaNyyk84OaPut/WO1oTkuzG6PFmul8LYrDBO5SMHIVu5UVcfg9u+l1Gvup0+lLRb0v/AA8ENtvEkNk8naNEd4dNl1J1+tNx0oU4srS0Owz4GfGltMo1VgTDGfWpKEqzwO+orW8WIARtgit5oC+d65BoaqIqqpSprkle71crKlHg50fdVevFq31ZdPt+NbyoU+PT249RloUNstaCT6pAAwo55P2Gh1+lSnt7CmS5nJScarUWstThbciFWOT8vYaIJqWcFjyPzVVrME4A4oErdLE1tamV5JOQfY6pqZeN22Sp1mkVd5lLowtKF8HTjh2HBfaSEIBJByPbQ/cnRhLzS5cTJOSSlQ7a2ttYEUmCaxNp5kTIFD1rfEHekScluoTjKaUseo2/yQnzg+NNinTqPdba36FN9cJA9RJGFJJ5wRpNW/02nTa81SGYpLrrwQkbfJONao6f/C3UunPTxd5Sn1LefdQlUb0+R3IP8aY7bW0jnRC3/LigdxpfqRMwHSl2/RH23Ni2SD7EauaRa1RlUaRLjxS4iMAp7YeQCcZx5AP8Z0aVyg0RgNvSZxafWfodSBzjjj+PxrzRK43aFX/Rwq9CccqLKmlNMvhRJIKcKT7j799GG1ZJIvhI3ePahY0x1k+LO3zS+juvtOBpvCcqHJAONV931CVP+R2GhWVY3oRjb/Gn51R6ET0Uin1i0LUHomIgyW2RvWF4PJH1DPck+4xxxpS3ZR61Zlddi16gNtnaU+m4nKT9xrW3vYL0BoSN3jIzxWJbSazOJQdv1xSlrFLbSokg5OqWRBSXDuIH50dVKmVCrOLMOEpz8J7aoa9Z1w0Vaf6tRZLBcA9NLjJG7PI/9aPRyDAVjzQhkJOQOK+lfxU/DzTVXM2enFkf4D6C4+7FbKxu85OcD8AaTUH4erjaeLrNGcSsKwpBbP8AbWtOiV5zKnVG00SptyUrOFpS8FA/YjPGnW3QrdrITOcpLaXQQTubwQR7++uKLok12zehIBz0I4x8iD+mK6h/qKQKokQnjrnmsCu9MJ8ajpZqNLWktpwoKTpe3TZtDZlrUI+1e3JCm+M6+md1dN7VuuCqPPpTW8NkNrQkAg447ayz1t6Ff0FMh5qlrKjnZhPnGhGqaZe6RIDL8St0I/Pir9nfW98pAGCOx/FZFbpkB2oKQ5BbbU2rAUrhK/tqxj2pa8qQp+tPMw1hISyMEpd57HGcHnPtgak3h0/uKbP/AEkeI6CFH6UEYOqef0lvNcb1XZDoWk7kJUrnOtreSHgsRXnVyOBXpd67Jst8xKdHMtfqAKLY+VQ8lKh3/OuUe2oVxRjPpAzv5LDn1t/Y++ulF6e1y9YZtp9paKgw5hlwpJ9XOePznU/p70tvqgXO8K3EfZEMFBTggLXgkDH7dtEi9hM2w4WqoFzGu5cmudk9B4NWvmImcoRGluBTkoJ4SnI5/OtnMdO2rdZgVKt1mNJgtsJERQQPTkYCRtxyO2SSeTu1nqk3TETV4dKVFTGUtwpkGQsJSnHPCjxp41S9alWbWVY1syI7UVhLf6mXJeAbYHOTvP8AqHAAz286llsrV1TEmfwKhW5uFZspj8mqjq58PfTe6KC7Vo8KNGU2hS1ORlggr5OMDkcax3UulMFfUVuO5MUhppe5DxPbHOONa2u2NVKBSlMUCVNkMuR0plPvpAaWvn6M4OPzpL1C3pcOovOymwXSFbVBOdufI/71pY288UpEDllPT81m5nieMGVQDUTqj1OrNm2221bF3PrdRGLLxaePJ5899DvTLqJROq9VpznVGC++mG2WnGwCQ8rOAT5z7/jXpUbcW+46mpI3kqyk9+NelvvtWe4h2nx0ZQ4CpJT3HnTFp2n3CpvHXnnoaDXt/AW2k8ccdRTerNsdGbepiq7SbPZSQz6qmxFUSkHt4IHP99KK7OtdlxnltsUKS4VEpfadOAMdsfcHVldvVKtVOkriQ3VRy4r/ABdijhQHYY8aUldil1TinkBSl87jotpmj78tdkk/9iaGX+rCMhbYAD2FfTe1PgzqHT+7UXJatwF6M1IC22ivDm0HI5Hn99Puh0+RTssKqLzzeMpTJBKk/bJ1CtaWzMbJizUOBBIWE5BB/BAP76vmySnn++hul6faxH14iefnkfT5e+aLXl1O/wDtv2+VedVdx04TlMtoajFS1FCvXZ3ZSe+PY41aaj1GK7LjlEd703ByheOx0VuohNAVxmqcTbJAaD698P3TisQZDDVDbZfeOQ+ngpP/AFoJY+Du3xUkzKrLalsDOWcFOD+f402Y9MqzVLdaqNS9V8kltxJIIGOBqPGl1OBGcDzO9RPClL57HQKXR9JkZXaDZx24+4HFEEvrxAVWTPv+M1k7qf03c6UXG5Kt+2W3S0slmSpsgd+/PfA/31VT+rw5XV7Tgxqi9HLzsh5IWXMA4wk8Jz/61qfqf0ypfUSkqnMtgzWo69iSTySOBrOVT+Fy8H6k2xVqTIbS4fmf2ZShOlG+0xrOUqyZU9CBnj+KN214J1BBwR1FI+5axbN0SRL9L0pTqgXGkNYQhWPA0QWv0pvrqJRAqgz5amow/wAJv1fkGMnsfHJ0Vv8ASGj9La+5Vbzt+XLisglpLUc7XecABXj8nTHoTFTdsaIbcguUlh0BSWW1J3ZcAyFecD/nWbRTI/pxnbjz+1YuJPTTe4z7UtbWoF2XPOYtepy1L/TIUpwOOhKUJQMq559j/Oqu+qXW4tYcRS6bMQzKQENMrQcqTjgcDkeR9tN+2enl4Wncypj8OO+AMu5SpaCnIzyPOrvrrU6bS7f/AFKKm1FfWgpSoqSTvxnA9iNMM+orZlSoDADH17mg8Nm90DklST+nYVmdfQq/6q4hX9CDKXRu3PvISEjPcjOf7Z1X3T0BlW/SHKtU7jhD0nQhxDIUoJ9yTjxnwNBV/dYep9r3K8+xXpYCuEoWtQBTnjH2Ol31P+IPqddDCI8utO7UIx6bR2p/cDv++rKanqbspVlA9v3qBtPsVBDBif8APFMWtWPSqdTnahIuultpwfSbmv8ApKUARhQye2Of20lbs6o2bDkriqrsJWxW0rbVuSr99ANzXLXZ29dSlur+XlS3CdLyvRW1rWsOg55I76MWupyoT6jbvpihtxp8LD4Bj61/RJHoRq8ZmNWFvJWyrcxIjultxP7juNXdEoJouRFqT7rSvqTJXuOffOvaIT6YBJOBxnU9ogpwBjVbTrSDAkxyMc9/5q7NcSOSvbxXtr9r9r920ZqrXhYBSQdQJjQIJx+dTVup7ajSNqknPtqCcAx1lTg5qllPvxcltwj8agSnqpIQSEuqB7nB51dqYjlRLo75BP2xquu+ZckWnoNqw0StqgH2lOYUUeQPzoHM/pRM7E4HYDJ+1EEw7hRxnueB96rabFcqrkmPJa9UNoBLK+x+bng9+NU9woj0+Utb1vtObAMteiR6ae+5I8du+plWqFah0t5VKbEV1xW4uuIO5IA4Bz986z71mvbqpRbmTUaqX429sNhyO4r03BnIWOfIxn8aA3N9CsigDnyen3olFayFDk0665W4Eq1v69HlyC00raWmlBSkKzwSPtwceQdYw+L3rDWLhqggJQ41FiI2RcnBWc/MtQAABJ8eO2tAWXcl2/p3WX3S4pwpVuWySl3I/wD1pQ9erfrM2c+0i3I8sFBcQtMTkI7c7e3PvoZNcPHcCQjj371aiCPGUB5rLNfviqyKYiTU2VrbQdiXHBnIz21CqNq1WpwUzaPDMhtxsLCmkZwD747aOLwgXNHt522avZjQiLWHEEp+dsDcBt9uSM/jVFRLZ6vWBSZF2dNHZSIzzKm5jbRStSRzwUkHgZznHfVxLkyLxgH9DVdo1j6nIpK31QaoylfqMEEDCgBoHl0OU7HVUm2VpS3wpvGc8d9ak6WVGL1IdnW51Ht6NMmuO+ozMGGHMEYKSBhJAPIOO5OfGqC//h1doNVcnUOnThGUopKS0HAoc9iO/wDHjUqak0bGNxz+lQtbK3xrX//Z",this.emptyImage=new Image,this.emptyImage.onload=()=>{this.samplers.empty=this.gl.createTexture(),this.bindTexture(this.samplers.empty,this.emptyImage,1,1)},this.emptyImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}bindTexture(e,t,r,n){if(this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r,n,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}loadExtraImages(e){Object.keys(e).forEach((t=>{const{data:r,width:n,height:i}=e[t];if(!this.samplers[t]){const e=new Image;e.onload=()=>{this.samplers[t]=this.gl.createTexture(),this.bindTexture(this.samplers[t],e,n,i)},e.src=r}}))}getTexture(e){return this.samplers[e]||this.samplers.clouds2}}},"./src/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i})),r("./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js"),r("./src/presetBase.js");var n=r("./src/visualizer.js");class i{static createVisualizer(e,t,r){return new n.default(e,t,r)}}},"./src/noise/noise.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e){this.gl=e,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.noiseTexLQ=this.gl.createTexture(),this.noiseTexLQLite=this.gl.createTexture(),this.noiseTexMQ=this.gl.createTexture(),this.noiseTexHQ=this.gl.createTexture(),this.noiseTexVolLQ=this.gl.createTexture(),this.noiseTexVolHQ=this.gl.createTexture(),this.nTexArrLQ=n.createNoiseTex(256,1),this.nTexArrLQLite=n.createNoiseTex(32,1),this.nTexArrMQ=n.createNoiseTex(256,4),this.nTexArrHQ=n.createNoiseTex(256,8),this.nTexArrVolLQ=n.createNoiseVolTex(32,1),this.nTexArrVolHQ=n.createNoiseVolTex(32,4),this.bindTexture(this.noiseTexLQ,this.nTexArrLQ,256,256),this.bindTexture(this.noiseTexLQLite,this.nTexArrLQLite,32,32),this.bindTexture(this.noiseTexMQ,this.nTexArrMQ,256,256),this.bindTexture(this.noiseTexHQ,this.nTexArrHQ,256,256),this.bindTexture3D(this.noiseTexVolLQ,this.nTexArrVolLQ,32,32,32),this.bindTexture3D(this.noiseTexVolHQ,this.nTexArrVolHQ,32,32,32),this.noiseTexPointLQ=this.gl.createSampler(),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_WRAP_T,e.REPEAT)}bindTexture(e,t,r,n){if(this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r,n,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}bindTexture3D(e,t,r,n,i){if(this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.gl.RGBA,r,n,i,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_3D),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_3D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}static fCubicInterpolate(e,t,r,n,i){const a=i*i,s=n-r-e+t;return s*(i*a)+(e-t-s)*a+(r-e)*i+t}static dwCubicInterpolate(e,t,r,i,a){const s=[];for(let o=0;o<4;o++){let l=n.fCubicInterpolate(e[o]/255,t[o]/255,r[o]/255,i[o]/255,a);l=Math.clamp(l,0,1),s[o]=255*l}return s}static createNoiseVolTex(e,t){const r=e*e*e,i=new Uint8Array(4*r),a=t>1?216:256,s=.5*a;for(let e=0;e<r;e++)i[4*e+0]=Math.floor(Math.random()*a+s),i[4*e+1]=Math.floor(Math.random()*a+s),i[4*e+2]=Math.floor(Math.random()*a+s),i[4*e+3]=Math.floor(Math.random()*a+s);const o=e*e,l=e;if(t>1){for(let r=0;r<e;r+=t)for(let a=0;a<e;a+=t)for(let s=0;s<e;s++)if(s%t!=0){const c=Math.floor(s/t)*t+e,u=r*o+a*l,h=[],d=[],f=[],m=[];for(let r=0;r<4;r++)h[r]=i[4*u+(c-t)%e*4+r],d[r]=i[4*u+c%e*4+r],f[r]=i[4*u+(c+t)%e*4+r],m[r]=i[4*u+(c+2*t)%e*4+r];const p=s%t/t,g=n.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)i[r*o*4+a*l*4+(4*s+e)]=g[e]}for(let r=0;r<e;r+=t)for(let a=0;a<e;a++)for(let s=0;s<e;s++)if(s%t!=0){const c=Math.floor(s/t)*t+e,u=r*o,h=[],d=[],f=[],m=[];for(let r=0;r<4;r++){const n=4*a+4*u+r;h[r]=i[(c-t)%e*l*4+n],d[r]=i[c%e*l*4+n],f[r]=i[(c+t)%e*l*4+n],m[r]=i[(c+2*t)%e*l*4+n]}const p=s%t/t,g=n.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)i[s*l*4+(4*a+4*u+e)]=g[e]}for(let r=0;r<e;r++)for(let a=0;a<e;a++)for(let s=0;s<e;s++)if(s%t!=0){const c=a*l,u=Math.floor(s/t)*t+e,h=[],d=[],f=[],m=[];for(let n=0;n<4;n++){const a=4*r+4*c+n;h[n]=i[(u-t)%e*o*4+a],d[n]=i[u%e*o*4+a],f[n]=i[(u+t)%e*o*4+a],m[n]=i[(u+2*t)%e*o*4+a]}const p=a%t/t,g=n.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)i[s*o*4+(4*r+4*c+e)]=g[e]}}return i}static createNoiseTex(e,t){const r=e*e,i=new Uint8Array(4*r),a=t>1?216:256,s=.5*a;for(let e=0;e<r;e++)i[4*e+0]=Math.floor(Math.random()*a+s),i[4*e+1]=Math.floor(Math.random()*a+s),i[4*e+2]=Math.floor(Math.random()*a+s),i[4*e+3]=Math.floor(Math.random()*a+s);if(t>1){for(let r=0;r<e;r+=t)for(let a=0;a<e;a++)if(a%t!=0){const s=Math.floor(a/t)*t+e,o=r*e,l=[],c=[],u=[],h=[];for(let r=0;r<4;r++)l[r]=i[4*o+(s-t)%e*4+r],c[r]=i[4*o+s%e*4+r],u[r]=i[4*o+(s+t)%e*4+r],h[r]=i[4*o+(s+2*t)%e*4+r];const d=a%t/t,f=n.dwCubicInterpolate(l,c,u,h,d);for(let t=0;t<4;t++)i[r*e*4+4*a+t]=f[t]}for(let r=0;r<e;r++)for(let a=0;a<e;a++)if(a%t!=0){const s=Math.floor(a/t)*t+e,o=[],l=[],c=[],u=[];for(let n=0;n<4;n++)o[n]=i[(s-t)%e*e*4+4*r+n],l[n]=i[s%e*e*4+4*r+n],c[n]=i[(s+t)%e*e*4+4*r+n],u[n]=i[(s+2*t)%e*e*4+4*r+n];const h=a%t/t,d=n.dwCubicInterpolate(o,l,c,u,h);for(let t=0;t<4;t++)i[a*e*4+4*r+t]=d[t]}}return i}}},"./src/presetBase.js":function(e,t){var r=1e-5;window.sqr=function(e){return e*e},window.sqrt=function(e){return Math.sqrt(Math.abs(e))},window.log10=function(e){return Math.log(e)*Math.LOG10E},window.sign=function(e){return e>0?1:e<0?-1:0},window.rand=function(e){var t=Math.floor(e);return t<1?Math.random():Math.random()*t},window.randint=function(e){return Math.floor(rand(e))},window.bnot=function(e){return Math.abs(e)<r?1:0},window.pow=function(e,t){var r,n=Math.pow(e,t);return r=n,!isFinite(r)||isNaN(r)?0:n},window.div=function(e,t){return 0===t?0:e/t},window.mod=function(e,t){return 0===t?0:Math.floor(e)%Math.floor(t)},window.bitor=function(e,t){return Math.floor(e)|Math.floor(t)},window.bitand=function(e,t){return Math.floor(e)&Math.floor(t)},window.sigmoid=function(e,t){var n=1+Math.exp(-e*t);return Math.abs(n)>r?1/n:0},window.bor=function(e,t){return Math.abs(e)>r||Math.abs(t)>r?1:0},window.band=function(e,t){return Math.abs(e)>r&&Math.abs(t)>r?1:0},window.equal=function(e,t){return Math.abs(e-t)<r?1:0},window.above=function(e,t){return e>t?1:0},window.below=function(e,t){return e<t?1:0},window.ifcond=function(e,t,n){return Math.abs(e)>r?t:n},window.memcpy=function(e,t,r,n){let i=t,a=r,s=n;return a<0&&(s+=a,i-=a,a=0),i<0&&(s+=i,a-=i,i=0),s>0&&e.copyWithin(i,a,s),t}},"./src/rendering/blendPattern.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e){this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.vertInfoA=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.vertInfoC=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.createBlendPattern()}static resizeMatrixValues(e,t,r,n,i){const a=new Float32Array((n+1)*(i+1));let s=0;for(let o=0;o<i+1;o++)for(let l=0;l<n+1;l++){let c=l/i,u=o/n;c*=t+1,u*=r+1,c=Math.clamp(c,0,t-1),u=Math.clamp(u,0,r-1);const h=Math.floor(c),d=Math.floor(u),f=c-h,m=u-d,p=e[d*(t+1)+h],g=e[d*(t+1)+(h+1)],A=e[(d+1)*(t+1)+h],v=e[(d+1)*(t+1)+(h+1)];a[s]=p*(1-f)*(1-m)+g*f*(1-m)+A*(1-f)*m+v*f*m,s+=1}return a}updateGlobals(e){const t=this.mesh_width,r=this.mesh_height;this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.mesh_width===t&&this.mesh_height===r||(this.vertInfoA=n.resizeMatrixValues(this.vertInfoA,t,r,this.mesh_width,this.mesh_height),this.vertInfoC=n.resizeMatrixValues(this.vertInfoC,t,r,this.mesh_width,this.mesh_height))}genPlasma(e,t,r,n,i){const a=Math.floor((e+t)/2),s=Math.floor((r+n)/2);let o=this.vertInfoC[r*(this.mesh_width+1)+e],l=this.vertInfoC[r*(this.mesh_width+1)+t],c=this.vertInfoC[n*(this.mesh_width+1)+e],u=this.vertInfoC[n*(this.mesh_width+1)+t];n-r>=2&&(0===e&&(this.vertInfoC[s*(this.mesh_width+1)+e]=.5*(o+c)+(2*Math.random()-1)*i*this.aspecty),this.vertInfoC[s*(this.mesh_width+1)+t]=.5*(l+u)+(2*Math.random()-1)*i*this.aspecty),t-e>=2&&(0===r&&(this.vertInfoC[r*(this.mesh_width+1)+a]=.5*(o+l)+(2*Math.random()-1)*i*this.aspectx),this.vertInfoC[n*(this.mesh_width+1)+a]=.5*(c+u)+(2*Math.random()-1)*i*this.aspectx),n-r>=2&&t-e>=2&&(o=this.vertInfoC[s*(this.mesh_width+1)+e],l=this.vertInfoC[s*(this.mesh_width+1)+t],c=this.vertInfoC[r*(this.mesh_width+1)+a],u=this.vertInfoC[n*(this.mesh_width+1)+a],this.vertInfoC[s*(this.mesh_width+1)+a]=.25*(c+u+o+l)+(2*Math.random()-1)*i,this.genPlasma(e,a,r,s,.5*i),this.genPlasma(a,t,r,s,.5*i),this.genPlasma(e,a,s,n,.5*i),this.genPlasma(a,t,s,n,.5*i))}createBlendPattern(){const e=1+Math.floor(3*Math.random());if(0===e){let e=0;for(let t=0;t<=this.mesh_height;t++)for(let t=0;t<=this.mesh_width;t++)this.vertInfoA[e]=1,this.vertInfoC[e]=0,e+=1}else if(1===e){const e=6.28*Math.random(),t=Math.cos(e),r=Math.sin(e),n=.1+.2*Math.random(),i=1/n;let a=0;for(let e=0;e<=this.mesh_height;e++){const s=e/this.mesh_height*this.aspecty;for(let e=0;e<=this.mesh_width;e++){let o=(e/this.mesh_width*this.aspectx-.5)*t+(s-.5)*r+.5;o=(o-.5)/Math.sqrt(2)+.5,this.vertInfoA[a]=i*(1+n),this.vertInfoC[a]=i*o-i,a+=1}}}else if(2===e){const e=.12+.13*Math.random(),t=1/e;this.vertInfoC[0]=Math.random(),this.vertInfoC[this.mesh_width]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)+this.mesh_width]=Math.random(),this.genPlasma(0,this.mesh_width,0,this.mesh_height,.25);let r=this.vertInfoC[0],n=this.vertInfoC[0],i=0;for(let e=0;e<=this.mesh_height;e++)for(let e=0;e<=this.mesh_width;e++)r>this.vertInfoC[i]&&(r=this.vertInfoC[i]),n<this.vertInfoC[i]&&(n=this.vertInfoC[i]),i+=1;const a=1/(n-r);i=0;for(let n=0;n<=this.mesh_height;n++)for(let n=0;n<=this.mesh_width;n++){const n=(this.vertInfoC[i]-r)*a;this.vertInfoA[i]=t*(1+e),this.vertInfoC[i]=t*n-t,i+=1}}else if(3===e){const e=.02+.14*Math.random()+.34*Math.random(),t=1/e,r=2*Math.floor(2*Math.random())-1;let n=0;for(let i=0;i<=this.mesh_height;i++){const a=(i/this.mesh_height-.5)*this.aspecty;for(let i=0;i<=this.mesh_width;i++){const s=(i/this.mesh_width-.5)*this.aspectx;let o=1.41421*Math.sqrt(s*s+a*a);-1===r&&(o=1-o),this.vertInfoA[n]=t*(1+e),this.vertInfoC[n]=t*o-t,n+=1}}}}}},"./src/rendering/motionVectors/motionVectors.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.maxX=64,this.maxY=48,this.positions=new Float32Array(this.maxX*this.maxY*2*3),this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.positionVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      void main(void) {\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}getMotionDir(e,t,r){const n=Math.floor(r*this.mesh_height),i=r*this.mesh_height-n,a=Math.floor(t*this.mesh_width),s=t*this.mesh_width-a,o=a+1,l=n+1,c=this.mesh_width+1;let u,h;return u=e[2*(n*c+a)+0]*(1-s)*(1-i),h=e[2*(n*c+a)+1]*(1-s)*(1-i),u+=e[2*(n*c+o)+0]*s*(1-i),h+=e[2*(n*c+o)+1]*s*(1-i),u+=e[2*(l*c+a)+0]*(1-s)*i,h+=e[2*(l*c+a)+1]*(1-s)*i,u+=e[2*(l*c+o)+0]*s*i,h+=e[2*(l*c+o)+1]*s*i,[u,1-h]}generateMotionVectors(e,t){const r=0===e.bmotionvectorson?0:e.mv_a;let n=Math.floor(e.mv_x),i=Math.floor(e.mv_y);if(r>.001&&n>0&&i>0){let a=e.mv_x-n,s=e.mv_y-i;n>this.maxX&&(n=this.maxX,a=0),i>this.maxY&&(i=this.maxY,s=0);const o=e.mv_dx,l=e.mv_dy,c=e.mv_l,u=1/this.texsizeX;this.numVecVerts=0;for(let e=0;e<i;e++){let r=(e+.25)/(i+s+.25-1);if(r-=l,r>1e-4&&r<.9999)for(let e=0;e<n;e++){let i=(e+.25)/(n+a+.25-1);if(i+=o,i>1e-4&&i<.9999){const e=this.getMotionDir(t,i,r);let n=e[0],a=e[1],s=n-i,o=a-r;s*=c,o*=c;let l=Math.sqrt(s*s+o*o);l<u&&l>1e-8?(l=u/l,s*=l,o*=l):(s=u,s=u),n=i+s,a=r+o;const h=2*i-1,d=2*r-1,f=2*n-1,m=2*a-1;this.positions[3*this.numVecVerts+0]=h,this.positions[3*this.numVecVerts+1]=d,this.positions[3*this.numVecVerts+2]=0,this.positions[3*(this.numVecVerts+1)+0]=f,this.positions[3*(this.numVecVerts+1)+1]=m,this.positions[3*(this.numVecVerts+1)+2]=0,this.numVecVerts+=2}}}if(this.numVecVerts>0)return this.color=[e.mv_r,e.mv_g,e.mv_b,r],!0}return!1}drawMotionVectors(e,t){this.generateMotionVectors(e,t)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color),this.gl.lineWidth(1),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.LINES,0,this.numVecVerts))}}},"./src/rendering/renderer.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return x}));var n=r("./src/audio/audioLevels.js"),i=r("./src/blankPreset.js"),a=r.n(i),s=r("./src/equations/presetEquationRunner.js"),o=r("./src/equations/presetEquationRunnerWASM.js"),l=r("./src/rendering/waves/basicWaveform.js"),c=r("./src/rendering/waves/customWaveform.js"),u=r("./src/rendering/shapes/customShape.js"),h=r("./src/rendering/sprites/border.js"),d=r("./src/rendering/sprites/darkenCenter.js"),f=r("./src/rendering/motionVectors/motionVectors.js"),m=r("./src/rendering/shaders/warp.js"),p=r("./src/rendering/shaders/comp.js"),g=r("./src/rendering/shaders/output.js"),A=r("./src/rendering/shaders/resample.js"),v=r("./src/rendering/shaders/blur/blur.js"),b=r("./src/noise/noise.js"),y=r("./src/image/imageTextures.js"),w=r("./src/rendering/text/titleText.js"),_=r("./src/rendering/blendPattern.js"),E=r("./src/utils.js");class x{constructor(e,t,r){this.gl=e,this.audio=t,this.frameNum=0,this.fps=30,this.time=0,this.presetTime=0,this.lastTime=performance.now(),this.timeHist=[0],this.timeHistMax=120,this.blending=!1,this.blendStartTime=0,this.blendProgress=0,this.blendDuration=0,this.width=r.width||1200,this.height=r.height||900,this.mesh_width=r.meshWidth||48,this.mesh_height=r.meshHeight||36,this.pixelRatio=r.pixelRatio||window.devicePixelRatio||1,this.textureRatio=r.textureRatio||1,this.outputFXAA=r.outputFXAA||!1,this.texsizeX=this.width*this.pixelRatio*this.textureRatio,this.texsizeY=this.height*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=E.default.range(1,33).map((e=>`q${e}`)),this.ts=E.default.range(1,9).map((e=>`t${e}`)),this.regs=E.default.range(0,100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.blurRatios=[[.5,.25],[.125,.125],[.0625,.0625]],this.audioLevels=new n.default(this.audio),this.prevFrameBuffer=this.gl.createFramebuffer(),this.targetFrameBuffer=this.gl.createFramebuffer(),this.prevTexture=this.gl.createTexture(),this.targetTexture=this.gl.createTexture(),this.compFrameBuffer=this.gl.createFramebuffer(),this.compTexture=this.gl.createTexture(),this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.targetFrameBuffer,this.targetTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture);const i={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.noise=new b.default(e),this.image=new y.default(e),this.warpShader=new m.default(e,this.noise,this.image,i),this.compShader=new p.default(e,this.noise,this.image,i),this.outputShader=new g.default(e,i),this.prevWarpShader=new m.default(e,this.noise,this.image,i),this.prevCompShader=new p.default(e,this.noise,this.image,i),this.numBlurPasses=0,this.blurShader1=new v.default(0,this.blurRatios,e,i),this.blurShader2=new v.default(1,this.blurRatios,e,i),this.blurShader3=new v.default(2,this.blurRatios,e,i),this.blurTexture1=this.blurShader1.blurVerticalTexture,this.blurTexture2=this.blurShader2.blurVerticalTexture,this.blurTexture3=this.blurShader3.blurVerticalTexture,this.basicWaveform=new l.default(e,i),this.customWaveforms=E.default.range(4).map((t=>new c.default(t,e,i))),this.customShapes=E.default.range(4).map((t=>new u.default(t,e,i))),this.prevCustomWaveforms=E.default.range(4).map((t=>new c.default(t,e,i))),this.prevCustomShapes=E.default.range(4).map((t=>new u.default(t,e,i))),this.darkenCenter=new d.default(e,i),this.innerBorder=new h.default(e,i),this.outerBorder=new h.default(e,i),this.motionVectors=new f.default(e,i),this.titleText=new w.default(e,i),this.blendPattern=new _.default(i),this.resampleShader=new A.default(e),this.supertext={startTime:-1},this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.gl.clearColor(0,0,0,1),this.blankPreset=a.a;const o={frame:0,time:0,fps:45,bass:1,bass_att:1,mid:1,mid_att:1,treb:1,treb_att:1};this.preset=a.a,this.prevPreset=this.preset,this.presetEquationRunner=new s.default(this.preset,o,i),this.prevPresetEquationRunner=new s.default(this.prevPreset,o,i),this.preset.useWASM||(this.regVars=this.presetEquationRunner.mdVSRegs)}static getHighestBlur(e){return/sampler_blur3/.test(e)?3:/sampler_blur2/.test(e)?2:/sampler_blur1/.test(e)?1:0}loadPreset(e,t){this.blendPattern.createBlendPattern(),this.blending=!0,this.blendStartTime=this.time,this.blendDuration=t,this.blendProgress=0,this.prevPresetEquationRunner=this.presetEquationRunner,this.prevPreset=this.preset,this.preset=e,this.presetTime=this.time;const r={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att},n={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};e.useWASM?(this.preset.globalPools.perFrame.old_wave_mode.value=this.prevPreset.baseVals.wave_mode,this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new o.default(this.preset,r,n),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)):(this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new s.default(this.preset,r,n),this.regVars=this.presetEquationRunner.mdVSRegs);const i=this.prevWarpShader;this.prevWarpShader=this.warpShader,this.warpShader=i;const a=this.prevCompShader;this.prevCompShader=this.compShader,this.compShader=a;const l=this.preset.warp.trim(),c=this.preset.comp.trim();this.warpShader.updateShader(l),this.compShader.updateShader(c),0===l.length?this.numBlurPasses=0:this.numBlurPasses=x.getHighestBlur(l),0!==c.length&&(this.numBlurPasses=Math.max(this.numBlurPasses,x.getHighestBlur(c)))}loadExtraImages(e){this.image.loadExtraImages(e)}setRendererSize(e,t,r){const n=this.texsizeX,i=this.texsizeY;if(this.width=e,this.height=t,this.mesh_width=r.meshWidth||this.mesh_width,this.mesh_height=r.meshHeight||this.mesh_height,this.pixelRatio=r.pixelRatio||this.pixelRatio,this.textureRatio=r.textureRatio||this.textureRatio,this.texsizeX=e*this.pixelRatio*this.textureRatio,this.texsizeY=t*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.texsizeX!==n||this.texsizeY!==i){const e=this.gl.createTexture();this.bindFrameBufferTexture(this.targetFrameBuffer,e),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.resampleShader.renderQuadTexture(this.targetTexture),this.targetTexture=e,this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture)}this.updateGlobals(),this.frameNum>0&&this.renderToScreen()}setInternalMeshSize(e,t){this.mesh_width=e,this.mesh_height=t,this.updateGlobals()}setOutputAA(e){this.outputFXAA=e}updateGlobals(){const e={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.presetEquationRunner.updateGlobals(e),this.prevPresetEquationRunner.updateGlobals(e),this.warpShader.updateGlobals(e),this.prevWarpShader.updateGlobals(e),this.compShader.updateGlobals(e),this.prevCompShader.updateGlobals(e),this.outputShader.updateGlobals(e),this.blurShader1.updateGlobals(e),this.blurShader2.updateGlobals(e),this.blurShader3.updateGlobals(e),this.basicWaveform.updateGlobals(e),this.customWaveforms.forEach((t=>t.updateGlobals(e))),this.customShapes.forEach((t=>t.updateGlobals(e))),this.prevCustomWaveforms.forEach((t=>t.updateGlobals(e))),this.prevCustomShapes.forEach((t=>t.updateGlobals(e))),this.darkenCenter.updateGlobals(e),this.innerBorder.updateGlobals(e),this.outerBorder.updateGlobals(e),this.motionVectors.updateGlobals(e),this.titleText.updateGlobals(e),this.blendPattern.updateGlobals(e),this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)}calcTimeAndFPS(e){let t;if(e)t=e;else{const e=performance.now();t=(e-this.lastTime)/1e3,(t>1||t<0||this.frame<2)&&(t=1/30),this.lastTime=e}this.time+=1/this.fps,this.blending&&(this.blendProgress=(this.time-this.blendStartTime)/this.blendDuration,this.blendProgress>1&&(this.blending=!1));const r=this.timeHist[this.timeHist.length-1]+t;this.timeHist.push(r),this.timeHist.length>this.timeHistMax&&this.timeHist.shift();const n=this.timeHist.length/(r-this.timeHist[0]);if(Math.abs(n-this.fps)>3&&this.frame>this.timeHistMax)this.fps=n;else{const e=.93;this.fps=e*this.fps+(1-e)*n}}runPixelEquations(e,t,r,n){const i=this.mesh_width,a=this.mesh_height,s=i+1,o=a+1,l=this.time*t.warpanimspeed,c=1/t.warpscale,u=11.68+4*Math.cos(1.413*l+10),h=8.77+3*Math.cos(1.113*l+7),d=10.54+3*Math.cos(1.233*l+3),f=11.49+4*Math.cos(.933*l+5),m=0/this.texsizeX,p=0/this.texsizeY,g=this.aspectx,A=this.aspecty;let v=0,b=0;if(e.preset.useWASM){const i=e.preset.globalPools.perVertex;if(E.default.setWasm(i,r,e.globalKeys),E.default.setWasm(i,e.mdVSQAfterFrame,e.qs),i.zoom.value=t.zoom,i.zoomexp.value=t.zoomexp,i.rot.value=t.rot,i.warp.value=t.warp,i.cx.value=t.cx,i.cy.value=t.cy,i.dx.value=t.dx,i.dy.value=t.dy,i.sx.value=t.sx,i.sy.value=t.sy,e.preset.pixel_eqs_wasm(e.runVertEQs,this.mesh_width,this.mesh_height,this.time,t.warpanimspeed,t.warpscale,this.aspectx,this.aspecty),n){const t=e.preset.pixel_eqs_get_array();let r=0,n=0;for(let e=0;e<o;e++)for(let e=0;e<s;e++){const e=t[r],i=t[r+1];let a=this.blendPattern.vertInfoA[r/2]*this.blendProgress+this.blendPattern.vertInfoC[r/2];a=Math.clamp(a,0,1),this.warpUVs[r]=this.warpUVs[r]*a+e*(1-a),this.warpUVs[r+1]=this.warpUVs[r+1]*a+i*(1-a),this.warpColor[n+0]=1,this.warpColor[n+1]=1,this.warpColor[n+2]=1,this.warpColor[n+3]=a,r+=2,n+=4}}else this.warpUVs=e.preset.pixel_eqs_get_array(),this.warpColor.fill(1)}else{let r=E.default.cloneVars(t),y=r.warp,w=r.zoom,_=r.zoomexp,x=r.cx,S=r.cy,T=r.sx,k=r.sy,I=r.dx,C=r.dy,P=r.rot;for(let M=0;M<o;M++)for(let o=0;o<s;o++){const s=o/i*2-1,R=M/a*2-1,B=Math.sqrt(s*s*g*g+R*R*A*A);if(e.runVertEQs){let n;n=M===a/2&&o===i/2?0:E.default.atan2(R*A,s*g),r.x=.5*s*g+.5,r.y=-.5*R*A+.5,r.rad=B,r.ang=n,r.zoom=t.zoom,r.zoomexp=t.zoomexp,r.rot=t.rot,r.warp=t.warp,r.cx=t.cx,r.cy=t.cy,r.dx=t.dx,r.dy=t.dy,r.sx=t.sx,r.sy=t.sy,r=e.runPixelEquations(r),y=r.warp,w=r.zoom,_=r.zoomexp,x=r.cx,S=r.cy,T=r.sx,k=r.sy,I=r.dx,C=r.dy,P=r.rot}const L=1/w**(_**(2*B-1));let D=.5*s*g*L+.5,N=.5*-R*A*L+.5;D=(D-x)/T+x,N=(N-S)/k+S,0!==y&&(D+=.0035*y*Math.sin(.333*l+c*(s*u-R*f)),N+=.0035*y*Math.cos(.375*l-c*(s*d+R*h)),D+=.0035*y*Math.cos(.753*l-c*(s*h-R*d)),N+=.0035*y*Math.sin(.825*l+c*(s*u+R*f)));const O=D-x,z=N-S,F=Math.cos(P),U=Math.sin(P);if(D=O*F-z*U+x,N=O*U+z*F+S,D-=I,N-=C,D=(D-.5)/g+.5,N=(N-.5)/A+.5,D+=m,N+=p,n){let e=this.blendPattern.vertInfoA[v/2]*this.blendProgress+this.blendPattern.vertInfoC[v/2];e=Math.clamp(e,0,1),this.warpUVs[v]=this.warpUVs[v]*e+D*(1-e),this.warpUVs[v+1]=this.warpUVs[v+1]*e+N*(1-e),this.warpColor[b+0]=1,this.warpColor[b+1]=1,this.warpColor[b+2]=1,this.warpColor[b+3]=e}else this.warpUVs[v]=D,this.warpUVs[v+1]=N,this.warpColor[b+0]=1,this.warpColor[b+1]=1,this.warpColor[b+2]=1,this.warpColor[b+3]=1;v+=2,b+=4}this.mdVSVertex=r}}static mixFrameEquations(e,t,r){const n=.5-.5*Math.cos(e*Math.PI),i=1-n,a=.5,s=E.default.cloneVars(t);return s.decay=n*t.decay+i*r.decay,s.wave_a=n*t.wave_a+i*r.wave_a,s.wave_r=n*t.wave_r+i*r.wave_r,s.wave_g=n*t.wave_g+i*r.wave_g,s.wave_b=n*t.wave_b+i*r.wave_b,s.wave_x=n*t.wave_x+i*r.wave_x,s.wave_y=n*t.wave_y+i*r.wave_y,s.wave_mystery=n*t.wave_mystery+i*r.wave_mystery,s.ob_size=n*t.ob_size+i*r.ob_size,s.ob_r=n*t.ob_r+i*r.ob_r,s.ob_g=n*t.ob_g+i*r.ob_g,s.ob_b=n*t.ob_b+i*r.ob_b,s.ob_a=n*t.ob_a+i*r.ob_a,s.ib_size=n*t.ib_size+i*r.ib_size,s.ib_r=n*t.ib_r+i*r.ib_r,s.ib_g=n*t.ib_g+i*r.ib_g,s.ib_b=n*t.ib_b+i*r.ib_b,s.ib_a=n*t.ib_a+i*r.ib_a,s.mv_x=n*t.mv_x+i*r.mv_x,s.mv_y=n*t.mv_y+i*r.mv_y,s.mv_dx=n*t.mv_dx+i*r.mv_dx,s.mv_dy=n*t.mv_dy+i*r.mv_dy,s.mv_l=n*t.mv_l+i*r.mv_l,s.mv_r=n*t.mv_r+i*r.mv_r,s.mv_g=n*t.mv_g+i*r.mv_g,s.mv_b=n*t.mv_b+i*r.mv_b,s.mv_a=n*t.mv_a+i*r.mv_a,s.echo_zoom=n*t.echo_zoom+i*r.echo_zoom,s.echo_alpha=n*t.echo_alpha+i*r.echo_alpha,s.echo_orient=n*t.echo_orient+i*r.echo_orient,s.wave_dots=n<a?r.wave_dots:t.wave_dots,s.wave_thick=n<a?r.wave_thick:t.wave_thick,s.additivewave=n<a?r.additivewave:t.additivewave,s.wave_brighten=n<a?r.wave_brighten:t.wave_brighten,s.darken_center=n<a?r.darken_center:t.darken_center,s.gammaadj=n<a?r.gammaadj:t.gammaadj,s.wrap=n<a?r.wrap:t.wrap,s.invert=n<a?r.invert:t.invert,s.brighten=n<a?r.brighten:t.brighten,s.darken=n<a?r.darken:t.darken,s.solarize=n<a?r.brighten:t.solarize,s.b1n=n*t.b1n+i*r.b1n,s.b2n=n*t.b2n+i*r.b2n,s.b3n=n*t.b3n+i*r.b3n,s.b1x=n*t.b1x+i*r.b1x,s.b2x=n*t.b2x+i*r.b2x,s.b3x=n*t.b3x+i*r.b3x,s.b1ed=n*t.b1ed+i*r.b1ed,s}static getBlurValues(e){let t=e.b1n,r=e.b2n,n=e.b3n,i=e.b1x,a=e.b2x,s=e.b3x;if(i-t<.1){const e=.5*(t+i);t=e-.05,i=e-.05}if(a=Math.min(i,a),r=Math.max(t,r),a-r<.1){const e=.5*(r+a);r=e-.05,a=e-.05}if(s=Math.min(a,s),n=Math.max(r,n),s-n<.1){const e=.5*(n+s);n=e-.05,s=e-.05}return{blurMins:[t,r,n],blurMaxs:[i,a,s]}}bindFrambufferAndSetViewport(e,t,r){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,t,r)}bindFrameBufferTexture(e,t){if(this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(this.texsizeX*this.texsizeY*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,t,0)}render({audioLevels:e,elapsedTime:t}={}){this.calcTimeAndFPS(t),this.frameNum+=1,e?this.audio.updateAudio(e.timeByteArray,e.timeByteArrayL,e.timeByteArrayR):this.audio.sampleAudio(),this.audioLevels.updateAudioLevels(this.fps,this.frameNum);const r={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY},n=Object.assign({},r);this.prevPreset.useWASM||(n.gmegabuf=this.prevPresetEquationRunner.gmegabuf),this.preset.useWASM||(r.gmegabuf=this.presetEquationRunner.gmegabuf,Object.assign(r,this.regVars));const i=this.presetEquationRunner.runFrameEquations(r);let a;this.runPixelEquations(this.presetEquationRunner,i,r,!1),this.preset.useWASM||(Object.assign(this.regVars,E.default.pick(this.mdVSVertex,this.regs)),Object.assign(r,this.regVars)),this.blending?(this.prevMDVSFrame=this.prevPresetEquationRunner.runFrameEquations(n),this.runPixelEquations(this.prevPresetEquationRunner,this.prevMDVSFrame,n,!0),a=x.mixFrameEquations(this.blendProgress,i,this.prevMDVSFrame)):a=i;const s=this.targetTexture;this.targetTexture=this.prevTexture,this.prevTexture=s;const o=this.targetFrameBuffer;this.targetFrameBuffer=this.prevFrameBuffer,this.prevFrameBuffer=o,this.gl.bindTexture(this.gl.TEXTURE_2D,this.prevTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:l,blurMaxs:c}=x.getBlurValues(a);this.blending?(this.prevWarpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.warpShader.renderQuadTexture(!0,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,a,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor)):this.warpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,i,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.numBlurPasses>0&&(this.blurShader1.renderBlurTexture(this.targetTexture,i,l,c),this.numBlurPasses>1&&(this.blurShader2.renderBlurTexture(this.blurTexture1,i,l,c),this.numBlurPasses>2&&this.blurShader3.renderBlurTexture(this.blurTexture2,i,l,c)),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY)),this.motionVectors.drawMotionVectors(a,this.warpUVs),this.preset.shapes&&this.preset.shapes.length>0&&this.customShapes.forEach(((e,t)=>{e.drawCustomShape(this.blending?this.blendProgress:1,r,this.presetEquationRunner,this.preset.shapes[t],this.prevTexture)})),this.preset.waves&&this.preset.waves.length>0&&this.customWaveforms.forEach(((e,t)=>{e.drawCustomWaveform(this.blending?this.blendProgress:1,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,r,this.presetEquationRunner,this.preset.waves[t])})),this.blending&&(this.prevPreset.shapes&&this.prevPreset.shapes.length>0&&this.prevCustomShapes.forEach(((e,t)=>{e.drawCustomShape(1-this.blendProgress,n,this.prevPresetEquationRunner,this.prevPreset.shapes[t],this.prevTexture)})),this.prevPreset.waves&&this.prevPreset.waves.length>0&&this.prevCustomWaveforms.forEach(((e,t)=>{e.drawCustomWaveform(1-this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,n,this.prevPresetEquationRunner,this.prevPreset.waves[t])}))),this.basicWaveform.drawBasicWaveform(this.blending,this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,a),this.darkenCenter.drawDarkenCenter(a);const u=[a.ob_r,a.ob_g,a.ob_b,a.ob_a];this.outerBorder.drawBorder(u,a.ob_size,0);const h=[a.ib_r,a.ib_g,a.ib_b,a.ib_a];if(this.innerBorder.drawBorder(h,a.ib_size,a.ob_size),this.supertext.startTime>=0){const e=(this.time-this.supertext.startTime)/this.supertext.duration;e>=1&&this.titleText.renderTitle(e,!0,r)}this.globalVars=r,this.mdVSFrame=i,this.mdVSFrameMixed=a,this.renderToScreen()}renderToScreen(){this.outputFXAA?this.bindFrambufferAndSetViewport(this.compFrameBuffer,this.texsizeX,this.texsizeY):this.bindFrambufferAndSetViewport(null,this.width,this.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:e,blurMaxs:t}=x.getBlurValues(this.mdVSFrameMixed);if(this.blending?(this.prevCompShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpColor),this.compShader.renderQuadTexture(!0,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.mdVSFrameMixed,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor)):this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.supertext.startTime>=0){const e=(this.time-this.supertext.startTime)/this.supertext.duration;this.titleText.renderTitle(e,!1,this.globalVars),e>=1&&(this.supertext.startTime=-1)}this.outputFXAA&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.compTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(null,this.width,this.height),this.outputShader.renderQuadTexture(this.compTexture))}launchSongTitleAnim(e){this.supertext={startTime:this.time,duration:1.7},this.titleText.generateTitleTexture(e)}toDataURL(){const e=new Uint8Array(this.texsizeX*this.texsizeY*4),t=this.gl.createFramebuffer(),r=this.gl.createTexture();this.bindFrameBufferTexture(t,r);const{blurMins:n,blurMaxs:i}=x.getBlurValues(this.mdVSFrameMixed);this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,n,i,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),Array.from({length:this.texsizeY},((t,r)=>e.slice(r*this.texsizeX*4,(r+1)*this.texsizeX*4))).forEach(((t,r)=>e.set(t,(this.texsizeY-r-1)*this.texsizeX*4)));const a=document.createElement("canvas");a.width=this.texsizeX,a.height=this.texsizeY;const s=a.getContext("2d"),o=s.createImageData(this.texsizeX,this.texsizeY);return o.data.set(e),s.putImageData(o,0,0),this.gl.deleteTexture(r),this.gl.deleteFramebuffer(t),a.toDataURL()}warpBufferToDataURL(){const e=new Uint8Array(this.texsizeX*this.texsizeY*4);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.targetFrameBuffer),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);const t=document.createElement("canvas");t.width=this.texsizeX,t.height=this.texsizeY;const r=t.getContext("2d"),n=r.createImageData(this.texsizeX,this.texsizeY);return n.data.set(e),r.putImageData(n,0,0),t.toDataURL()}}},"./src/rendering/shaders/blur/blur.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r("./src/rendering/shaders/blur/blurVertical.js"),i=r("./src/rendering/shaders/blur/blurHorizontal.js");class a{constructor(e,t,r,a={}){this.blurLevel=e,this.blurRatios=t,this.gl=r,this.texsizeX=a.texsizeX,this.texsizeY=a.texsizeY,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.blurHorizontalFrameBuffer=this.gl.createFramebuffer(),this.blurVerticalFrameBuffer=this.gl.createFramebuffer(),this.blurHorizontalTexture=this.gl.createTexture(),this.blurVerticalTexture=this.gl.createTexture(),this.setupFrameBufferTextures(),this.blurHorizontal=new i.default(r,this.blurLevel,a),this.blurVertical=new n.default(r,this.blurLevel,a)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.setupFrameBufferTextures()}getTextureSize(e){let t=Math.max(this.texsizeX*e,16);t=16*Math.floor((t+3)/16);let r=Math.max(this.texsizeY*e,16);return r=4*Math.floor((r+3)/4),[t,r]}setupFrameBufferTextures(){const e=this.blurLevel>0?this.blurRatios[this.blurLevel-1]:[1,1],t=this.blurRatios[this.blurLevel],r=this.getTextureSize(e[1]),n=this.getTextureSize(t[0]);this.bindFrameBufferTexture(this.blurHorizontalFrameBuffer,this.blurHorizontalTexture,n);const i=n,a=this.getTextureSize(t[1]);this.bindFrameBufferTexture(this.blurVerticalFrameBuffer,this.blurVerticalTexture,a),this.horizontalTexsizes=[r,n],this.verticalTexsizes=[i,a]}bindFrambufferAndSetViewport(e,t){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,t[0],t[1])}bindFrameBufferTexture(e,t,r){if(this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r[0],r[1],0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(r[0]*r[1]*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,t,0)}renderBlurTexture(e,t,r,n){this.bindFrambufferAndSetViewport(this.blurHorizontalFrameBuffer,this.horizontalTexsizes[1]),this.blurHorizontal.renderQuadTexture(e,t,r,n,this.horizontalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurHorizontalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.blurVerticalFrameBuffer,this.verticalTexsizes[1]),this.blurVertical.renderQuadTexture(this.blurHorizontalTexture,t,this.verticalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurVerticalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D)}}},"./src/rendering/shaders/blur/blurHorizontal.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.blurLevel=t;const r=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],i=r[0]+r[1],a=r[2]+r[3],s=r[4]+r[5],o=r[6]+r[7],l=0+2*r[1]/i,c=2+2*r[3]/a,u=4+2*r[5]/s,h=6+2*r[7]/o;this.ws=new Float32Array([i,a,s,o]),this.ds=new Float32Array([l,c,u,h]),this.wDiv=.5/(i+a+s+o),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      out vec2 uv;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv = aPos * halfmad + halfmad;\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform vec4 texsize;\n       uniform float scale;\n       uniform float bias;\n       uniform vec4 ws;\n       uniform vec4 ds;\n       uniform float wdiv;\n\n       void main(void) {\n         float w1 = ws[0];\n         float w2 = ws[1];\n         float w3 = ws[2];\n         float w4 = ws[3];\n         float d1 = ds[0];\n         float d2 = ds[1];\n         float d3 = ds[2];\n         float d4 = ds[3];\n\n         vec2 uv2 = uv.xy;\n\n         vec3 blur =\n           ( texture(uTexture, uv2 + vec2( d1 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d1 * texsize.z,0.0) ).xyz) * w1 +\n           ( texture(uTexture, uv2 + vec2( d2 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d2 * texsize.z,0.0) ).xyz) * w2 +\n           ( texture(uTexture, uv2 + vec2( d3 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d3 * texsize.z,0.0) ).xyz) * w3 +\n           ( texture(uTexture, uv2 + vec2( d4 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d4 * texsize.z,0.0) ).xyz) * w4;\n\n         blur.xyz *= wdiv;\n         blur.xyz = blur.xyz * scale + bias;\n\n         fragColor = vec4(blur, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.scaleLoc=this.gl.getUniformLocation(this.shaderProgram,"scale"),this.biasLoc=this.gl.getUniformLocation(this.shaderProgram,"bias"),this.wsLoc=this.gl.getUniformLocation(this.shaderProgram,"ws"),this.dsLocation=this.gl.getUniformLocation(this.shaderProgram,"ds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}getScaleAndBias(e,t){const r=[1,1,1],n=[0,0,0];let i,a;return r[0]=1/(t[0]-e[0]),n[0]=-e[0]*r[0],i=(e[1]-e[0])/(t[0]-e[0]),a=(t[1]-e[0])/(t[0]-e[0]),r[1]=1/(a-i),n[1]=-i*r[1],i=(e[2]-e[1])/(t[1]-e[1]),a=(t[2]-e[1])/(t[1]-e[1]),r[2]=1/(a-i),n[2]=-i*r[2],{scale:r[this.blurLevel],bias:n[this.blurLevel]}}renderQuadTexture(e,t,r,n,i){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0);const{scale:a,bias:s}=this.getScaleAndBias(r,n);this.gl.uniform4fv(this.texsizeLocation,[i[0],i[1],1/i[0],1/i[1]]),this.gl.uniform1f(this.scaleLoc,a),this.gl.uniform1f(this.biasLoc,s),this.gl.uniform4fv(this.wsLoc,this.ws),this.gl.uniform4fv(this.dsLocation,this.ds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/blur/blurVertical.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.blurLevel=t;const r=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],i=r[0]+r[1]+r[2]+r[3],a=r[4]+r[5]+r[6]+r[7],s=0+(r[2]+r[3])/i*2,o=2+(r[6]+r[7])/a*2;this.wds=new Float32Array([i,a,s,o]),this.wDiv=1/(2*(i+a)),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      out vec2 uv;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv = aPos * halfmad + halfmad;\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform vec4 texsize;\n       uniform float ed1;\n       uniform float ed2;\n       uniform float ed3;\n       uniform vec4 wds;\n       uniform float wdiv;\n\n       void main(void) {\n         float w1 = wds[0];\n         float w2 = wds[1];\n         float d1 = wds[2];\n         float d2 = wds[3];\n\n         vec2 uv2 = uv.xy;\n\n         vec3 blur =\n           ( texture(uTexture, uv2 + vec2(0.0, d1 * texsize.w) ).xyz\n           + texture(uTexture, uv2 + vec2(0.0,-d1 * texsize.w) ).xyz) * w1 +\n           ( texture(uTexture, uv2 + vec2(0.0, d2 * texsize.w) ).xyz\n           + texture(uTexture, uv2 + vec2(0.0,-d2 * texsize.w) ).xyz) * w2;\n\n         blur.xyz *= wdiv;\n\n         float t = min(min(uv.x, uv.y), 1.0 - max(uv.x, uv.y));\n         t = sqrt(t);\n         t = ed1 + ed2 * clamp(t * ed3, 0.0, 1.0);\n         blur.xyz *= t;\n\n         fragColor = vec4(blur, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.ed1Loc=this.gl.getUniformLocation(this.shaderProgram,"ed1"),this.ed2Loc=this.gl.getUniformLocation(this.shaderProgram,"ed2"),this.ed3Loc=this.gl.getUniformLocation(this.shaderProgram,"ed3"),this.wdsLocation=this.gl.getUniformLocation(this.shaderProgram,"wds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}renderQuadTexture(e,t,r){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0);const n=0===this.blurLevel?t.b1ed:0;this.gl.uniform4fv(this.texsizeLocation,[r[0],r[1],1/r[0],1/r[1]]),this.gl.uniform1f(this.ed1Loc,1-n),this.gl.uniform1f(this.ed2Loc,n),this.gl.uniform1f(this.ed3Loc,5),this.gl.uniform4fv(this.wdsLocation,this.wds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/comp.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t,r,i={}){this.gl=e,this.noise=t,this.image=r,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.compWidth=32,this.compHeight=24,this.buildPositions(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.compColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),e.samplerParameteri(this.mainSampler,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}buildPositions(){const e=this.compWidth,t=this.compHeight,r=e+1,n=t+1,i=2/e,a=2/t,s=[];for(let e=0;e<n;e++){const t=e*a-1;for(let e=0;e<r;e++){const r=e*i-1;s.push(r,-t,0)}}const o=[];for(let n=0;n<t;n++)for(let t=0;t<e;t++){const e=t+r*n,i=t+r*(n+1),a=t+1+r*(n+1),s=t+1+r*n;o.push(e,i,s),o.push(i,a,s)}this.vertices=new Float32Array(s),this.indices=new Uint16Array(o)}updateGlobals(e){this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(e=""){let t,r;if(0===e.length)t="float orient_horiz = mod(echo_orientation, 2.0);\n                        float orient_x = (orient_horiz != 0.0) ? -1.0 : 1.0;\n                        float orient_y = (echo_orientation >= 2.0) ? -1.0 : 1.0;\n                        vec2 uv_echo = ((uv - 0.5) *\n                                        (1.0 / echo_zoom) *\n                                        vec2(orient_x, orient_y)) + 0.5;\n\n                        ret = mix(texture(sampler_main, uv).rgb,\n                                  texture(sampler_main, uv_echo).rgb,\n                                  echo_alpha);\n\n                        ret *= gammaAdj;\n\n                        if(fShader >= 1.0) {\n                          ret *= hue_shader;\n                        } else if(fShader > 0.001) {\n                          ret *= (1.0 - fShader) + (fShader * hue_shader);\n                        }\n\n                        if(brighten != 0) ret = sqrt(ret);\n                        if(darken != 0) ret = ret*ret;\n                        if(solarize != 0) ret = ret * (1.0 - ret) * 4.0;\n                        if(invert != 0) ret = 1.0 - ret;",r="";else{const i=n.default.getShaderParts(e);r=i[0],t=i[1]}t=t.replace(/texture2D/g,"texture"),t=t.replace(/texture3D/g,"texture"),this.userTextures=n.default.getUserSamplers(r),this.shaderProgram=this.gl.createProgram();const i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      in vec4 aCompColor;\n      out vec2 vUv;\n      out vec4 vColor;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        vUv = aPos * halfmad + halfmad;\n        vColor = aCompColor;\n      }\n      ".trim()),this.gl.compileShader(i);const a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      precision mediump sampler3D;\n\n      vec3 lum(vec3 v){\n          return vec3(dot(v, vec3(0.32,0.49,0.29)));\n      }\n\n      in vec2 vUv;\n      in vec4 vColor;\n      out vec4 fragColor;\n      uniform sampler2D sampler_main;\n      uniform sampler2D sampler_fw_main;\n      uniform sampler2D sampler_fc_main;\n      uniform sampler2D sampler_pw_main;\n      uniform sampler2D sampler_pc_main;\n      uniform sampler2D sampler_blur1;\n      uniform sampler2D sampler_blur2;\n      uniform sampler2D sampler_blur3;\n      uniform sampler2D sampler_noise_lq;\n      uniform sampler2D sampler_noise_lq_lite;\n      uniform sampler2D sampler_noise_mq;\n      uniform sampler2D sampler_noise_hq;\n      uniform sampler2D sampler_pw_noise_lq;\n      uniform sampler3D sampler_noisevol_lq;\n      uniform sampler3D sampler_noisevol_hq;\n\n      uniform float time;\n      uniform float gammaAdj;\n      uniform float echo_zoom;\n      uniform float echo_alpha;\n      uniform float echo_orientation;\n      uniform int invert;\n      uniform int brighten;\n      uniform int darken;\n      uniform int solarize;\n      uniform vec2 resolution;\n      uniform vec4 aspect;\n      uniform vec4 texsize;\n      uniform vec4 texsize_noise_lq;\n      uniform vec4 texsize_noise_mq;\n      uniform vec4 texsize_noise_hq;\n      uniform vec4 texsize_noise_lq_lite;\n      uniform vec4 texsize_noisevol_lq;\n      uniform vec4 texsize_noisevol_hq;\n\n      uniform float bass;\n      uniform float mid;\n      uniform float treb;\n      uniform float vol;\n      uniform float bass_att;\n      uniform float mid_att;\n      uniform float treb_att;\n      uniform float vol_att;\n\n      uniform float frame;\n      uniform float fps;\n\n      uniform vec4 _qa;\n      uniform vec4 _qb;\n      uniform vec4 _qc;\n      uniform vec4 _qd;\n      uniform vec4 _qe;\n      uniform vec4 _qf;\n      uniform vec4 _qg;\n      uniform vec4 _qh;\n\n      #define q1 _qa.x\n      #define q2 _qa.y\n      #define q3 _qa.z\n      #define q4 _qa.w\n      #define q5 _qb.x\n      #define q6 _qb.y\n      #define q7 _qb.z\n      #define q8 _qb.w\n      #define q9 _qc.x\n      #define q10 _qc.y\n      #define q11 _qc.z\n      #define q12 _qc.w\n      #define q13 _qd.x\n      #define q14 _qd.y\n      #define q15 _qd.z\n      #define q16 _qd.w\n      #define q17 _qe.x\n      #define q18 _qe.y\n      #define q19 _qe.z\n      #define q20 _qe.w\n      #define q21 _qf.x\n      #define q22 _qf.y\n      #define q23 _qf.z\n      #define q24 _qf.w\n      #define q25 _qg.x\n      #define q26 _qg.y\n      #define q27 _qg.z\n      #define q28 _qg.w\n      #define q29 _qh.x\n      #define q30 _qh.y\n      #define q31 _qh.z\n      #define q32 _qh.w\n\n      uniform vec4 slow_roam_cos;\n      uniform vec4 roam_cos;\n      uniform vec4 slow_roam_sin;\n      uniform vec4 roam_sin;\n\n      uniform float blur1_min;\n      uniform float blur1_max;\n      uniform float blur2_min;\n      uniform float blur2_max;\n      uniform float blur3_min;\n      uniform float blur3_max;\n\n      uniform float scale1;\n      uniform float scale2;\n      uniform float scale3;\n      uniform float bias1;\n      uniform float bias2;\n      uniform float bias3;\n\n      uniform vec4 rand_frame;\n      uniform vec4 rand_preset;\n\n      uniform float fShader;\n\n      float PI = ${Math.PI};\n\n      ${r}\n\n      void main(void) {\n        vec3 ret;\n        vec2 uv = vUv;\n        vec2 uv_orig = vUv;\n        uv.y = 1.0 - uv.y;\n        uv_orig.y = 1.0 - uv_orig.y;\n        float rad = length(uv - 0.5);\n        float ang = atan(uv.x - 0.5, uv.y - 0.5);\n        vec3 hue_shader = vColor.rgb;\n\n        ${t}\n\n        fragColor = vec4(ret, vColor.a);\n      }\n      `.trim()),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.compColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aCompColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.gammaAdjLoc=this.gl.getUniformLocation(this.shaderProgram,"gammaAdj"),this.echoZoomLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_zoom"),this.echoAlphaLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_alpha"),this.echoOrientationLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_orientation"),this.invertLoc=this.gl.getUniformLocation(this.shaderProgram,"invert"),this.brightenLoc=this.gl.getUniformLocation(this.shaderProgram,"brighten"),this.darkenLoc=this.gl.getUniformLocation(this.shaderProgram,"darken"),this.solarizeLoc=this.gl.getUniformLocation(this.shaderProgram,"solarize"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.fShaderLoc=this.gl.getUniformLocation(this.shaderProgram,"fShader"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];t.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${t.sampler}`)}}updateShader(e){this.createShader(e)}bindBlurVals(e,t){const r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],o=t[2],l=a-r,c=r,u=s-n,h=n,d=o-i,f=i;this.gl.uniform1f(this.blur1MinLoc,r),this.gl.uniform1f(this.blur1MaxLoc,a),this.gl.uniform1f(this.blur2MinLoc,n),this.gl.uniform1f(this.blur2MaxLoc,s),this.gl.uniform1f(this.blur3MinLoc,i),this.gl.uniform1f(this.blur3MaxLoc,o),this.gl.uniform1f(this.scale1Loc,l),this.gl.uniform1f(this.scale2Loc,u),this.gl.uniform1f(this.scale3Loc,d),this.gl.uniform1f(this.bias1Loc,c),this.gl.uniform1f(this.bias2Loc,h),this.gl.uniform1f(this.bias3Loc,f)}static generateHueBase(e){const t=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1]);for(let r=0;r<4;r++){t[3*r+0]=.6+.3*Math.sin(30*e.time*.0143+3+21*r+e.rand_start[3]),t[3*r+1]=.6+.3*Math.sin(30*e.time*.0107+1+13*r+e.rand_start[1]),t[3*r+2]=.6+.3*Math.sin(30*e.time*.0129+6+9*r+e.rand_start[2]);const n=Math.max(t[3*r],t[3*r+1],t[3*r+2]);for(let e=0;e<3;e++)t[3*r+e]=t[3*r+e]/n,t[3*r+e]=.5+.5*t[3*r+e]}return t}generateCompColors(e,t,r){const n=i.generateHueBase(t),a=this.compWidth+1,s=this.compHeight+1,o=new Float32Array(a*s*4);let l=0;for(let t=0;t<s;t++)for(let i=0;i<a;i++){let a=i/this.compWidth,s=t/this.compHeight;const c=[1,1,1];for(let e=0;e<3;e++)c[e]=n[0+e]*a*s+n[3+e]*(1-a)*s+n[6+e]*a*(1-s)+n[9+e]*(1-a)*(1-s);let u=1;if(e){a*=this.mesh_width+1,s*=this.mesh_height+1,a=Math.clamp(a,0,this.mesh_width-1),s=Math.clamp(s,0,this.mesh_height-1);const e=Math.floor(a),t=Math.floor(s),n=a-e,i=s-t;u=r[4*(t*(this.mesh_width+1)+e)+3]*(1-n)*(1-i)+r[4*(t*(this.mesh_width+1)+(e+1))+3]*n*(1-i)+r[4*((t+1)*(this.mesh_width+1)+e)+3]*(1-n)*i+r[4*((t+1)*(this.mesh_width+1)+(e+1))+3]*n*i}o[l+0]=c[0],o[l+1]=c[1],o[l+2]=c[2],o[l+3]=u,l+=4}return o}renderQuadTexture(e,t,r,n,i,a,s,o,l,c){const u=this.generateCompColors(e,o,c);this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.compColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,u,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.compColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.compColorLocation);const h=0!==o.wrap?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,h),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,h),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];this.gl.activeTexture(this.gl.TEXTURE15+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(t.sampler)),this.gl.uniform1i(t.textureLoc,15+e)}this.gl.uniform1f(this.timeLoc,o.time),this.gl.uniform1f(this.gammaAdjLoc,o.gammaadj),this.gl.uniform1f(this.echoZoomLoc,o.echo_zoom),this.gl.uniform1f(this.echoAlphaLoc,o.echo_alpha),this.gl.uniform1f(this.echoOrientationLoc,o.echo_orient),this.gl.uniform1i(this.invertLoc,o.invert),this.gl.uniform1i(this.brightenLoc,o.brighten),this.gl.uniform1i(this.darkenLoc,o.darken),this.gl.uniform1i(this.solarizeLoc,o.solarize),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,o.bass),this.gl.uniform1f(this.midLoc,o.mid),this.gl.uniform1f(this.trebLoc,o.treb),this.gl.uniform1f(this.volLoc,(o.bass+o.mid+o.treb)/3),this.gl.uniform1f(this.bassAttLoc,o.bass_att),this.gl.uniform1f(this.midAttLoc,o.mid_att),this.gl.uniform1f(this.trebAttLoc,o.treb_att),this.gl.uniform1f(this.volAttLoc,(o.bass_att+o.mid_att+o.treb_att)/3),this.gl.uniform1f(this.frameLoc,o.frame),this.gl.uniform1f(this.fpsLoc,o.fps),this.gl.uniform4fv(this.randPresetLoc,o.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform1f(this.fShaderLoc,o.fshader),this.gl.uniform4fv(this.qaLoc,new Float32Array([l.q1||0,l.q2||0,l.q3||0,l.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([l.q5||0,l.q6||0,l.q7||0,l.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([l.q9||0,l.q10||0,l.q11||0,l.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([l.q13||0,l.q14||0,l.q15||0,l.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([l.q17||0,l.q18||0,l.q19||0,l.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([l.q21||0,l.q22||0,l.q23||0,l.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([l.q25||0,l.q26||0,l.q27||0,l.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([l.q29||0,l.q30||0,l.q31||0,l.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(.005*o.time),.5+.5*Math.cos(.008*o.time),.5+.5*Math.cos(.013*o.time),.5+.5*Math.cos(.022*o.time)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(.3*o.time),.5+.5*Math.cos(1.3*o.time),.5+.5*Math.cos(5*o.time),.5+.5*Math.cos(20*o.time)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(.005*o.time),.5+.5*Math.sin(.008*o.time),.5+.5*Math.sin(.013*o.time),.5+.5*Math.sin(.022*o.time)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(.3*o.time),.5+.5*Math.sin(1.3*o.time),.5+.5*Math.sin(5*o.time),.5+.5*Math.sin(20*o.time)]),this.bindBlurVals(a,s),e?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),e||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shaders/output.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.textureRatio=t.textureRatio,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.useFXAA()?this.createFXAAShader():this.createShader()}useFXAA(){return this.textureRatio<=1}updateGlobals(e){this.textureRatio=e.textureRatio,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.gl.deleteProgram(this.shaderProgram),this.useFXAA()?this.createFXAAShader():this.createShader()}createFXAAShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 v_rgbM;\n       out vec2 v_rgbNW;\n       out vec2 v_rgbNE;\n       out vec2 v_rgbSW;\n       out vec2 v_rgbSE;\n       uniform vec4 texsize;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n\n         v_rgbM = aPos * halfmad + halfmad;\n         v_rgbNW = v_rgbM + (vec2(-1.0, -1.0) * texsize.zx);\n         v_rgbNE = v_rgbM + (vec2(1.0, -1.0) * texsize.zx);\n         v_rgbSW = v_rgbM + (vec2(-1.0, 1.0) * texsize.zx);\n         v_rgbSE = v_rgbM + (vec2(1.0, 1.0) * texsize.zx);\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 v_rgbM;\n       in vec2 v_rgbNW;\n       in vec2 v_rgbNE;\n       in vec2 v_rgbSW;\n       in vec2 v_rgbSE;\n       out vec4 fragColor;\n       uniform vec4 texsize;\n       uniform sampler2D uTexture;\n\n       #ifndef FXAA_REDUCE_MIN\n         #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n       #endif\n       #ifndef FXAA_REDUCE_MUL\n         #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n       #endif\n       #ifndef FXAA_SPAN_MAX\n         #define FXAA_SPAN_MAX     8.0\n       #endif\n\n       void main(void) {\n         vec4 color;\n         vec3 rgbNW = textureLod(uTexture, v_rgbNW, 0.0).xyz;\n         vec3 rgbNE = textureLod(uTexture, v_rgbNE, 0.0).xyz;\n         vec3 rgbSW = textureLod(uTexture, v_rgbSW, 0.0).xyz;\n         vec3 rgbSE = textureLod(uTexture, v_rgbSE, 0.0).xyz;\n         vec3 rgbM  = textureLod(uTexture, v_rgbM, 0.0).xyz;\n         vec3 luma = vec3(0.299, 0.587, 0.114);\n         float lumaNW = dot(rgbNW, luma);\n         float lumaNE = dot(rgbNE, luma);\n         float lumaSW = dot(rgbSW, luma);\n         float lumaSE = dot(rgbSE, luma);\n         float lumaM  = dot(rgbM,  luma);\n         float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n         float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n         mediump vec2 dir;\n         dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n         dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n         float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                               (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n         float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n         dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n                   max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                   dir * rcpDirMin)) * texsize.zw;\n\n         vec3 rgbA = 0.5 * (\n             textureLod(uTexture, v_rgbM + dir * (1.0 / 3.0 - 0.5), 0.0).xyz +\n             textureLod(uTexture, v_rgbM + dir * (2.0 / 3.0 - 0.5), 0.0).xyz);\n         vec3 rgbB = rgbA * 0.5 + 0.25 * (\n             textureLod(uTexture, v_rgbM + dir * -0.5, 0.0).xyz +\n             textureLod(uTexture, v_rgbM + dir * 0.5, 0.0).xyz);\n\n         float lumaB = dot(rgbB, luma);\n         if ((lumaB < lumaMin) || (lumaB > lumaMax))\n           color = vec4(rgbA, 1.0);\n         else\n           color = vec4(rgbB, 1.0);\n\n         fragColor = color;\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize")}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv = aPos * halfmad + halfmad;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n\n       void main(void) {\n         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(e){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0),this.useFXAA()&&this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/resample.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e){this.gl=e,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv = aPos * halfmad + halfmad;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n\n       void main(void) {\n         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(e){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.uniform1i(this.textureLoc,0),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/shaderUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));const n=/uniform sampler2D sampler_(?:.+?);/g,i=/uniform sampler2D sampler_(.+?);/;class a{static getShaderParts(e){const t=e.indexOf("shader_body");if(e&&t>-1){const r=e.substring(0,t),n=e.substring(t),i=n.indexOf("{"),a=n.lastIndexOf("}");return[r,n.substring(i+1,a)]}return["",e]}static getFragmentFloatPrecision(e){return e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0?"highp":e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}static getUserSamplers(e){const t=[],r=e.match(n);if(r&&r.length>0)for(let e=0;e<r.length;e++){const n=r[e].match(i);if(n&&n.length>0){const e=n[1];t.push({sampler:e})}}return t}}},"./src/rendering/shaders/warp.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t,r,i={}){this.gl=e,this.noise=t,this.image=r,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.warpUvVertexBuf=this.gl.createBuffer(),this.warpColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),e.samplerParameteri(this.mainSampler,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}buildPositions(){const e=this.mesh_width,t=this.mesh_height,r=e+1,n=t+1,i=2/e,a=2/t,s=[];for(let e=0;e<n;e++){const t=e*a-1;for(let e=0;e<r;e++){const r=e*i-1;s.push(r,-t,0)}}const o=[];for(let n=0;n<t;n++)for(let t=0;t<e;t++){const e=t+r*n,i=t+r*(n+1),a=t+1+r*(n+1),s=t+1+r*n;o.push(e,i,s),o.push(i,a,s)}this.vertices=new Float32Array(s),this.indices=new Uint16Array(o)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(e=""){let t,r;if(0===e.length)t="ret = texture(sampler_main, uv).rgb * decay;",r="";else{const i=n.default.getShaderParts(e);r=i[0],t=i[1]}t=t.replace(/texture2D/g,"texture"),t=t.replace(/texture3D/g,"texture"),this.userTextures=n.default.getUserSamplers(r),this.shaderProgram=this.gl.createProgram();const i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      in vec2 aWarpUv;\n      in vec4 aWarpColor;\n      out vec2 uv;\n      out vec2 uv_orig;\n      out vec4 vColor;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv_orig = aPos * halfmad + halfmad;\n        uv = aWarpUv;\n        vColor = aWarpColor;\n      }\n      `.trim()),this.gl.compileShader(i);const a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      precision mediump sampler3D;\n\n      in vec2 uv;\n      in vec2 uv_orig;\n      in vec4 vColor;\n      out vec4 fragColor;\n      uniform sampler2D sampler_main;\n      uniform sampler2D sampler_fw_main;\n      uniform sampler2D sampler_fc_main;\n      uniform sampler2D sampler_pw_main;\n      uniform sampler2D sampler_pc_main;\n      uniform sampler2D sampler_blur1;\n      uniform sampler2D sampler_blur2;\n      uniform sampler2D sampler_blur3;\n      uniform sampler2D sampler_noise_lq;\n      uniform sampler2D sampler_noise_lq_lite;\n      uniform sampler2D sampler_noise_mq;\n      uniform sampler2D sampler_noise_hq;\n      uniform sampler2D sampler_pw_noise_lq;\n      uniform sampler3D sampler_noisevol_lq;\n      uniform sampler3D sampler_noisevol_hq;\n      uniform float time;\n      uniform float decay;\n      uniform vec2 resolution;\n      uniform vec4 aspect;\n      uniform vec4 texsize;\n      uniform vec4 texsize_noise_lq;\n      uniform vec4 texsize_noise_mq;\n      uniform vec4 texsize_noise_hq;\n      uniform vec4 texsize_noise_lq_lite;\n      uniform vec4 texsize_noisevol_lq;\n      uniform vec4 texsize_noisevol_hq;\n\n      uniform float bass;\n      uniform float mid;\n      uniform float treb;\n      uniform float vol;\n      uniform float bass_att;\n      uniform float mid_att;\n      uniform float treb_att;\n      uniform float vol_att;\n\n      uniform float frame;\n      uniform float fps;\n\n      uniform vec4 _qa;\n      uniform vec4 _qb;\n      uniform vec4 _qc;\n      uniform vec4 _qd;\n      uniform vec4 _qe;\n      uniform vec4 _qf;\n      uniform vec4 _qg;\n      uniform vec4 _qh;\n\n      #define q1 _qa.x\n      #define q2 _qa.y\n      #define q3 _qa.z\n      #define q4 _qa.w\n      #define q5 _qb.x\n      #define q6 _qb.y\n      #define q7 _qb.z\n      #define q8 _qb.w\n      #define q9 _qc.x\n      #define q10 _qc.y\n      #define q11 _qc.z\n      #define q12 _qc.w\n      #define q13 _qd.x\n      #define q14 _qd.y\n      #define q15 _qd.z\n      #define q16 _qd.w\n      #define q17 _qe.x\n      #define q18 _qe.y\n      #define q19 _qe.z\n      #define q20 _qe.w\n      #define q21 _qf.x\n      #define q22 _qf.y\n      #define q23 _qf.z\n      #define q24 _qf.w\n      #define q25 _qg.x\n      #define q26 _qg.y\n      #define q27 _qg.z\n      #define q28 _qg.w\n      #define q29 _qh.x\n      #define q30 _qh.y\n      #define q31 _qh.z\n      #define q32 _qh.w\n\n      uniform vec4 slow_roam_cos;\n      uniform vec4 roam_cos;\n      uniform vec4 slow_roam_sin;\n      uniform vec4 roam_sin;\n\n      uniform float blur1_min;\n      uniform float blur1_max;\n      uniform float blur2_min;\n      uniform float blur2_max;\n      uniform float blur3_min;\n      uniform float blur3_max;\n\n      uniform float scale1;\n      uniform float scale2;\n      uniform float scale3;\n      uniform float bias1;\n      uniform float bias2;\n      uniform float bias3;\n\n      uniform vec4 rand_frame;\n      uniform vec4 rand_preset;\n\n      float PI = ${Math.PI};\n\n      ${r}\n\n      void main(void) {\n        vec3 ret;\n        float rad = length(uv_orig - 0.5);\n        float ang = atan(uv_orig.x - 0.5, uv_orig.y - 0.5);\n\n        ${t}\n\n        fragColor = vec4(ret, 1.0) * vColor;\n      }\n      `.trim()),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.warpUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpUv"),this.warpColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.decayLoc=this.gl.getUniformLocation(this.shaderProgram,"decay"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];t.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${t.sampler}`)}}updateShader(e){this.createShader(e)}bindBlurVals(e,t){const r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],o=t[2],l=a-r,c=r,u=s-n,h=n,d=o-i,f=i;this.gl.uniform1f(this.blur1MinLoc,r),this.gl.uniform1f(this.blur1MaxLoc,a),this.gl.uniform1f(this.blur2MinLoc,n),this.gl.uniform1f(this.blur2MaxLoc,s),this.gl.uniform1f(this.blur3MinLoc,i),this.gl.uniform1f(this.blur3MaxLoc,o),this.gl.uniform1f(this.scale1Loc,l),this.gl.uniform1f(this.scale2Loc,u),this.gl.uniform1f(this.scale3Loc,d),this.gl.uniform1f(this.bias1Loc,c),this.gl.uniform1f(this.bias2Loc,h),this.gl.uniform1f(this.bias3Loc,f)}renderQuadTexture(e,t,r,n,i,a,s,o,l,c,u){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpUvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,c,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,u,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpColorLocation);const h=0!==o.wrap?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,h),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,h),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];this.gl.activeTexture(this.gl.TEXTURE15+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(t.sampler)),this.gl.uniform1i(t.textureLoc,15+e)}this.gl.uniform1f(this.decayLoc,o.decay),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,[this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY]),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,o.bass),this.gl.uniform1f(this.midLoc,o.mid),this.gl.uniform1f(this.trebLoc,o.treb),this.gl.uniform1f(this.volLoc,(o.bass+o.mid+o.treb)/3),this.gl.uniform1f(this.bassAttLoc,o.bass_att),this.gl.uniform1f(this.midAttLoc,o.mid_att),this.gl.uniform1f(this.trebAttLoc,o.treb_att),this.gl.uniform1f(this.volAttLoc,(o.bass_att+o.mid_att+o.treb_att)/3),this.gl.uniform1f(this.timeLoc,o.time),this.gl.uniform1f(this.frameLoc,o.frame),this.gl.uniform1f(this.fpsLoc,o.fps),this.gl.uniform4fv(this.randPresetLoc,o.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform4fv(this.qaLoc,new Float32Array([l.q1||0,l.q2||0,l.q3||0,l.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([l.q5||0,l.q6||0,l.q7||0,l.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([l.q9||0,l.q10||0,l.q11||0,l.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([l.q13||0,l.q14||0,l.q15||0,l.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([l.q17||0,l.q18||0,l.q19||0,l.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([l.q21||0,l.q22||0,l.q23||0,l.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([l.q25||0,l.q26||0,l.q27||0,l.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([l.q29||0,l.q30||0,l.q31||0,l.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(.005*o.time),.5+.5*Math.cos(.008*o.time),.5+.5*Math.cos(.013*o.time),.5+.5*Math.cos(.022*o.time)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(.3*o.time),.5+.5*Math.cos(1.3*o.time),.5+.5*Math.cos(5*o.time),.5+.5*Math.cos(20*o.time)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(.005*o.time),.5+.5*Math.sin(.008*o.time),.5+.5*Math.sin(.013*o.time),.5+.5*Math.sin(.022*o.time)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(.3*o.time),.5+.5*Math.sin(1.3*o.time),.5+.5*Math.sin(5*o.time),.5+.5*Math.sin(20*o.time)]),this.bindBlurVals(a,s),e?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),e||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shapes/customShape.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r("./src/utils.js"),i=r("./src/rendering/shaders/shaderUtils.js");class a{constructor(e,t,r){this.index=e,this.gl=t,this.positions=new Float32Array(309),this.colors=new Float32Array(412),this.uvs=new Float32Array(206),this.borderPositions=new Float32Array(306),this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.uvVertexBuf=this.gl.createBuffer(),this.borderPositionVertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.createBorderShader(),this.mainSampler=this.gl.createSampler(),t.samplerParameteri(this.mainSampler,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_T,t.REPEAT)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      in vec4 aColor;\n      in vec2 aUv;\n      out vec4 vColor;\n      out vec2 vUv;\n      void main(void) {\n        vColor = aColor;\n        vUv = aUv;\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      uniform sampler2D uTexture;\n      uniform float uTextured;\n      in vec4 vColor;\n      in vec2 vUv;\n      out vec4 fragColor;\n      void main(void) {\n        if (uTextured != 0.0) {\n          fragColor = texture(uTexture, vUv) * vColor;\n        } else {\n          fragColor = vColor;\n        }\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.aUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.texturedLoc=this.gl.getUniformLocation(this.shaderProgram,"uTextured"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}createBorderShader(){this.borderShaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aBorderPos;\n      uniform vec2 thickOffset;\n      void main(void) {\n        gl_Position = vec4(aBorderPos +\n                            vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 uBorderColor;\n      void main(void) {\n        fragColor = uBorderColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.borderShaderProgram,e),this.gl.attachShader(this.borderShaderProgram,t),this.gl.linkProgram(this.borderShaderProgram),this.aBorderPosLoc=this.gl.getAttribLocation(this.borderShaderProgram,"aBorderPos"),this.uBorderColorLoc=this.gl.getUniformLocation(this.borderShaderProgram,"uBorderColor"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}drawCustomShape(e,t,r,i,a){if(0!==i.baseVals.enabled)if(r.preset.useWASM){this.setupShapeBuffers(r.preset.globalPools.perFrame.wrap.value);const i=r.preset.shapes[this.index].baseVals,s=r.preset.globalPools[`shapePerFrame${this.index}`];n.default.setWasm(s,t,r.globalKeys),r.preset.shapes[this.index].frame_eqs||r.preset.restore_qs(),n.default.setWasm(s,r.mdVSTShapeInits[this.index],r.ts),r.preset.save_ts(),s.x.value=i.x,s.y.value=i.y,s.rad.value=i.rad,s.ang.value=i.ang,s.r.value=i.r,s.g.value=i.g,s.b.value=i.b,s.a.value=i.a,s.r2.value=i.r2,s.g2.value=i.g2,s.b2.value=i.b2,s.a2.value=i.a2,s.border_r.value=i.border_r,s.border_g.value=i.border_g,s.border_b.value=i.border_b,s.border_a.value=i.border_a,s.thickoutline.value=i.thickoutline,s.textured.value=i.textured,s.tex_zoom.value=i.tex_zoom,s.tex_ang.value=i.tex_ang,s.additive.value=i.additive,r.preset.shapes[this.index].frame_eqs_save();const o=Math.clamp(i.num_inst,1,1024);for(let t=0;t<o;t++){s.instance.value=t,r.preset.shapes[this.index].frame_eqs&&(r.preset.shapes[this.index].frame_eqs_restore(),r.preset.restore_qs(),r.preset.restore_ts(),r.preset.shapes[this.index].frame_eqs());let n=s.sides.value;n=Math.clamp(n,3,100),n=Math.floor(n);const i=s.rad.value,o=s.ang.value,l=2*s.x.value-1,c=-2*s.y.value+1,u=s.r.value,h=s.g.value,d=s.b.value,f=s.a.value,m=s.r2.value,p=s.g2.value,g=s.b2.value,A=s.a2.value,v=s.border_r.value,b=s.border_g.value,y=s.border_b.value,w=s.border_a.value;this.borderColor=[v,b,y,w*e];const _=s.thickoutline.value,E=s.textured.value,x=s.tex_zoom.value,S=s.tex_ang.value,T=s.additive.value,k=this.borderColor[3]>0,I=Math.abs(E)>=1,C=Math.abs(_)>=1,P=Math.abs(T)>=1;this.positions[0]=l,this.positions[1]=c,this.positions[2]=0,this.colors[0]=u,this.colors[1]=h,this.colors[2]=d,this.colors[3]=f*e,I&&(this.uvs[0]=.5,this.uvs[1]=.5);const M=.25*Math.PI;for(let t=1;t<=n+1;t++){const r=(t-1)/n*2*Math.PI,a=r+o+M;if(this.positions[3*t+0]=l+i*Math.cos(a)*this.aspecty,this.positions[3*t+1]=c+i*Math.sin(a),this.positions[3*t+2]=0,this.colors[4*t+0]=m,this.colors[4*t+1]=p,this.colors[4*t+2]=g,this.colors[4*t+3]=A*e,I){const e=r+S+M;this.uvs[2*t+0]=.5+.5*Math.cos(e)/x*this.aspecty,this.uvs[2*t+1]=.5+.5*Math.sin(e)/x}k&&(this.borderPositions[3*(t-1)+0]=this.positions[3*t+0],this.borderPositions[3*(t-1)+1]=this.positions[3*t+1],this.borderPositions[3*(t-1)+2]=this.positions[3*t+2])}this.drawCustomShapeInstance(a,n,I,k,C,P)}}else{this.setupShapeBuffers(r.mdVSFrame.wrap);let i=Object.assign({},r.mdVSShapes[this.index],r.mdVSFrameMapShapes[this.index],t);""===r.preset.shapes[this.index].frame_eqs_str&&(i=Object.assign(i,r.mdVSQAfterFrame,r.mdVSTShapeInits[this.index]));const s=r.preset.shapes[this.index].baseVals,o=Math.clamp(s.num_inst,1,1024);for(let t=0;t<o;t++){let n;i.instance=t,i.x=s.x,i.y=s.y,i.rad=s.rad,i.ang=s.ang,i.r=s.r,i.g=s.g,i.b=s.b,i.a=s.a,i.r2=s.r2,i.g2=s.g2,i.b2=s.b2,i.a2=s.a2,i.border_r=s.border_r,i.border_g=s.border_g,i.border_b=s.border_b,i.border_a=s.border_a,i.thickoutline=s.thickoutline,i.textured=s.textured,i.tex_zoom=s.tex_zoom,i.tex_ang=s.tex_ang,i.additive=s.additive,""!==r.preset.shapes[this.index].frame_eqs_str?(i=Object.assign(i,r.mdVSQAfterFrame,r.mdVSTShapeInits[this.index]),n=r.runShapeFrameEquations(this.index,i)):n=i;let o=n.sides;o=Math.clamp(o,3,100),o=Math.floor(o);const l=n.rad,c=n.ang,u=2*n.x-1,h=-2*n.y+1,d=n.r,f=n.g,m=n.b,p=n.a,g=n.r2,A=n.g2,v=n.b2,b=n.a2,y=n.border_r,w=n.border_g,_=n.border_b,E=n.border_a;this.borderColor=[y,w,_,E*e];const x=n.thickoutline,S=n.textured,T=n.tex_zoom,k=n.tex_ang,I=n.additive,C=this.borderColor[3]>0,P=Math.abs(S)>=1,M=Math.abs(x)>=1,R=Math.abs(I)>=1;this.positions[0]=u,this.positions[1]=h,this.positions[2]=0,this.colors[0]=d,this.colors[1]=f,this.colors[2]=m,this.colors[3]=p*e,P&&(this.uvs[0]=.5,this.uvs[1]=.5);const B=.25*Math.PI;for(let t=1;t<=o+1;t++){const r=(t-1)/o*2*Math.PI,n=r+c+B;if(this.positions[3*t+0]=u+l*Math.cos(n)*this.aspecty,this.positions[3*t+1]=h+l*Math.sin(n),this.positions[3*t+2]=0,this.colors[4*t+0]=g,this.colors[4*t+1]=A,this.colors[4*t+2]=v,this.colors[4*t+3]=b*e,P){const e=r+k+B;this.uvs[2*t+0]=.5+.5*Math.cos(e)/T*this.aspecty,this.uvs[2*t+1]=.5+.5*Math.sin(e)/T}C&&(this.borderPositions[3*(t-1)+0]=this.positions[3*t+0],this.borderPositions[3*(t-1)+1]=this.positions[3*t+1],this.borderPositions[3*(t-1)+2]=this.positions[3*t+2])}this.mdVSShapeFrame=n,this.drawCustomShapeInstance(a,o,P,C,M,R)}const l=r.mdVSUserKeysShapes[this.index],c=n.default.pick(this.mdVSShapeFrame,l);r.mdVSFrameMapShapes[this.index]=c}}setupShapeBuffers(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.uvs,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.borderPositions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc);const t=0!==e?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,t),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,t)}drawCustomShapeInstance(e,t,r,n,i,a){if(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.positions,0,3*(t+2)),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.colors,0,4*(t+2)),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),r&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.uvs,0,2*(t+2)),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation)),this.gl.uniform1f(this.texturedLoc,r?1:0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),a?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,t+2),n){this.gl.useProgram(this.borderShaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.borderPositions,0,3*(t+1)),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc),this.gl.uniform4fv(this.uBorderColorLoc,this.borderColor);const e=i?4:1;for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(this.gl.LINE_STRIP,0,t+1)}}}}},"./src/rendering/sprites/border.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t={}){this.gl=e,this.positions=new Float32Array(72),this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(e){this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      void main(void) {\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}addTriangle(e,t,r,n){this.positions[e+0]=t[0],this.positions[e+1]=t[1],this.positions[e+2]=t[2],this.positions[e+3]=r[0],this.positions[e+4]=r[1],this.positions[e+5]=r[2],this.positions[e+6]=n[0],this.positions[e+7]=n[1],this.positions[e+8]=n[2]}generateBorder(e,t,r){if(t>0&&e[3]>0){const e=2,n=2,i=e/2,a=n/2,s=r/2,o=t/2+s,l=s*e,c=s*n,u=o*e,h=o*n;let d=[-i+l,-a+h,0],f=[-i+l,a-h,0],m=[-i+u,a-h,0],p=[-i+u,-a+h,0];return this.addTriangle(0,p,f,d),this.addTriangle(9,p,m,f),d=[i-l,-a+h,0],f=[i-l,a-h,0],m=[i-u,a-h,0],p=[i-u,-a+h,0],this.addTriangle(18,d,f,p),this.addTriangle(27,f,m,p),d=[-i+l,-a+c,0],f=[-i+l,h-a,0],m=[i-l,h-a,0],p=[i-l,-a+c,0],this.addTriangle(36,p,f,d),this.addTriangle(45,p,m,f),d=[-i+l,a-c,0],f=[-i+l,a-h,0],m=[i-l,a-h,0],p=[i-l,a-c,0],this.addTriangle(54,d,f,p),this.addTriangle(63,f,m,p),!0}return!1}drawBorder(e,t,r){this.generateBorder(e,t,r)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,e),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLES,0,this.positions.length/3))}}},"./src/rendering/sprites/darkenCenter.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions(),this.colors=new Float32Array([0,0,0,3/32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions()}generatePositions(){this.positions=new Float32Array([0,0,0,-.05*this.aspecty,0,0,0,-.05,0,.05*this.aspecty,0,0,0,.05,0,-.05*this.aspecty,0,0])}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      in vec4 aColor;\n      out vec4 vColor;\n      void main(void) {\n        vColor = aColor;\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      in vec4 vColor;\n      out vec4 fragColor;\n      void main(void) {\n        fragColor = vColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor")}drawDarkenCenter(e){0!==e.darken_center&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,this.positions.length/3))}}},"./src/rendering/text/titleText.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t={}){this.gl=e,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.textTexture=this.gl.createTexture(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.vertexBuf=this.gl.createBuffer(),this.canvas=document.createElement("canvas"),this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY,this.context2D=this.canvas.getContext("2d"),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}generateTitleTexture(e){this.context2D.clearRect(0,0,this.texsizeX,this.texsizeY),this.fontSize=Math.floor(this.texsizeX/256*16),this.fontSize=Math.max(this.fontSize,6),this.context2D.font=`italic ${this.fontSize}px Times New Roman`;let t=e,r=this.context2D.measureText(t).width;if(r>this.texsizeX){const e=this.texsizeX/r*.91;t=`${t.substring(0,Math.floor(t.length*e))}...`,r=this.context2D.measureText(t).width}this.context2D.fillStyle="#FFFFFF",this.context2D.fillText(t,(this.texsizeX-r)/2,this.texsizeY/2);const n=new Uint8Array(this.context2D.getImageData(0,0,this.texsizeX,this.texsizeY).data.buffer);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY}buildPositions(){const e=[];for(let t=0;t<8;t++){const r=.2857142857142857*t-1;for(let t=0;t<16;t++){const n=.13333333333333333*t-1;e.push(n,-r,0)}}const t=[];for(let e=0;e<7;e++)for(let r=0;r<15;r++){const n=r+16*e,i=r+16*(e+1),a=r+1+16*(e+1),s=r+1+16*e;t.push(n,i,s),t.push(i,a,s)}this.vertices=new Float32Array(e),this.indices=new Uint16Array(t)}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       in vec2 aUv;\n       out vec2 uv_orig;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv_orig = aPos * halfmad + halfmad;\n         uv = aUv;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv_orig;\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform float textColor;\n\n       void main(void) {\n         fragColor = texture(uTexture, uv) * vec4(textColor);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.uvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.textColorLoc=this.gl.getUniformLocation(this.shaderProgram,"textColor")}generateUvs(e,t,r){const n=[];for(let r=0;r<8;r++)for(let i=0;i<16;i++){const a=i/15*2-1;let s=2*(.75*(r/7-.5)+.5)-1;e>=1&&(s+=1/this.texsizeY),n.push(a,t?s:-s)}const i=Math.max(0,1-1.5*e)**1.8*1.3;for(let e=0;e<8;e++)for(let t=0;t<16;t++){const a=16*e+t;n[a]+=.07*i*Math.sin(.31*r.time+.39*n[a]-1.94*n[a+1]),n[a]+=.044*i*Math.sin(.81*r.time-1.91*n[a]+.27*n[a+1]),n[a]+=.061*i*Math.sin(1.31*r.time+.61*n[a]+.74*n[a+1]),n[a+1]+=.061*i*Math.sin(.37*r.time+1.83*n[a]+.69*n[a+1]),n[a+1]+=.07*i*Math.sin(.67*r.time+.42*n[a]-1.39*n[a+1]),n[a+1]+=.087*i*Math.sin(1.07*r.time+3.55*n[a]+.89*n[a+1])}const a=1.01/(e**.21+.01);for(let e=0;e<n.length/2;e++)n[2*e]*=a,n[2*e+1]*=a*this.invAspecty,n[2*e]=(n[2*e]+1)/2,n[2*e+1]=(n[2*e+1]+1)/2;return new Float32Array(n)}renderTitle(e,t,r){this.gl.useProgram(this.shaderProgram);const n=this.generateUvs(e,t,r);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.uvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.uvLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.uniform1i(this.textureLoc,0),this.gl.uniform1f(this.textColorLoc,e**.3),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0)}}},"./src/rendering/waves/basicWaveform.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r("./src/rendering/shaders/shaderUtils.js"),i=r("./src/rendering/waves/waveUtils.js");class a{constructor(e,t={}){this.gl=e,this.positions=new Float32Array(1536),this.positions2=new Float32Array(1536),this.oldPositions=new Float32Array(1536),this.oldPositions2=new Float32Array(1536),this.smoothedPositions=new Float32Array(3069),this.smoothedPositions2=new Float32Array(3069),this.color=[0,0,0,1],this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      uniform vec2 thickOffset;\n      void main(void) {\n        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}static processWaveform(e,t){const r=[],n=t.wave_scale/128,i=t.wave_smoothing,a=n*(1-i);r.push(e[0]*n);for(let t=1;t<e.length;t++)r.push(e[t]*a+r[t-1]*i);return r}generateWaveform(e,t,r,n,s){let o=s.wave_a;const l=(s.bass+s.mid+s.treb)/3;if(l>-.01&&o>.001&&r.length>0){const c=a.processWaveform(r,s),u=a.processWaveform(n,s),h=Math.floor(s.wave_mode)%8,d=Math.floor(s.old_wave_mode)%8,f=2*s.wave_x-1,m=2*s.wave_y-1;this.numVert=0,this.oldNumVert=0;const p=e&&h!==d?2:1;for(let e=0;e<p;e++){const t=0===e?h:d;let r,n,i,a=s.wave_mystery;if(0!==t&&1!==t&&4!==t||!(a<-1||a>1)||(a=.5*a+.5,a-=Math.floor(a),a=Math.abs(a),a=2*a-1),0===e?(n=this.positions,i=this.positions2):(n=this.oldPositions,i=this.oldPositions2),o=s.wave_a,0===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2)+1;const e=1/(r-1),t=Math.floor((c.length-r)/2);for(let i=0;i<r-1;i++){let o=.5+.4*u[i+t]+a;const l=i*e*2*Math.PI+.2*s.time;if(i<r/10){let e=i/(.1*r);e=.5-.5*Math.cos(e*Math.PI),o=(1-e)*(.5+.4*u[i+r+t]+a)+o*e}n[3*i+0]=o*Math.cos(l)*this.aspecty+f,n[3*i+1]=o*Math.sin(l)*this.aspectx+m,n[3*i+2]=0}n[3*(r-1)+0]=n[0],n[3*(r-1)+1]=n[1],n[3*(r-1)+2]=0}else if(1===t){if(o*=1.25,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2);for(let e=0;e<r;e++){const t=.53+.43*u[e]+a,r=.5*c[e+32]*Math.PI+2.3*s.time;n[3*e+0]=t*Math.cos(r)*this.aspecty+f,n[3*e+1]=t*Math.sin(r)*this.aspectx+m,n[3*e+2]=0}}else if(2===t){if(this.texsizeX<1024?o*=.09:this.texsizeX>=1024&&this.texsizeX<2048?o*=.11:o*=.13,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length;for(let e=0;e<c.length;e++)n[3*e+0]=u[e]*this.aspecty+f,n[3*e+1]=c[(e+32)%c.length]*this.aspectx+m,n[3*e+2]=0}else if(3===t){if(this.texsizeX<1024?o*=.15:this.texsizeX>=1024&&this.texsizeX<2048?o*=.22:o*=.33,o*=1.3,o*=s.treb*s.treb,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length;for(let e=0;e<c.length;e++)n[3*e+0]=u[e]*this.aspecty+f,n[3*e+1]=c[(e+32)%c.length]*this.aspectx+m,n[3*e+2]=0}else if(4===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length,r>this.texsizeX/3&&(r=Math.floor(this.texsizeX/3));const e=1/r,t=Math.floor((c.length-r)/2),i=.45+.5*(.5*a+.5),h=1-i;for(let a=0;a<r;a++){let r=2*a*e+(f-1)+.44*u[(a+25+t)%c.length],s=.47*c[a+t]+m;a>1&&(r=r*h+i*(2*n[3*(a-1)+0]-n[3*(a-2)+0]),s=s*h+i*(2*n[3*(a-1)+1]-n[3*(a-2)+1])),n[3*a+0]=r,n[3*a+1]=s,n[3*a+2]=0}}else if(5===t){if(this.texsizeX<1024?o*=.09:this.texsizeX>=1024&&this.texsizeX<2048?o*=.11:o*=.13,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1);const e=Math.cos(.3*s.time),t=Math.sin(.3*s.time);r=c.length;for(let r=0;r<c.length;r++){const i=(r+32)%c.length,a=u[r]*c[i]+c[r]*u[i],s=u[r]*u[r]-c[i]*c[i];n[3*r+0]=(a*e-s*t)*(this.aspecty+f),n[3*r+1]=(a*t+s*e)*(this.aspectx+m),n[3*r+2]=0}}else if(6===t||7===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2),r>this.texsizeX/3&&(r=Math.floor(this.texsizeX/3));const e=Math.floor((c.length-r)/2),h=.5*Math.PI*a;let d=Math.cos(h),p=Math.sin(h);const g=[f*Math.cos(h+.5*Math.PI)-3*d,f*Math.cos(h+.5*Math.PI)+3*d],A=[f*Math.sin(h+.5*Math.PI)-3*p,f*Math.sin(h+.5*Math.PI)+3*p];for(let e=0;e<2;e++)for(let t=0;t<4;t++){let r,n=!1;switch(t){case 0:g[e]>1.1&&(r=(1.1-g[1-e])/(g[e]-g[1-e]),n=!0);break;case 1:g[e]<-1.1&&(r=(-1.1-g[1-e])/(g[e]-g[1-e]),n=!0);break;case 2:A[e]>1.1&&(r=(1.1-A[1-e])/(A[e]-A[1-e]),n=!0);break;case 3:A[e]<-1.1&&(r=(-1.1-A[1-e])/(A[e]-A[1-e]),n=!0)}if(n){const t=g[e]-g[1-e],n=A[e]-A[1-e];g[e]=g[1-e]+t*r,A[e]=A[1-e]+n*r}}d=(g[1]-g[0])/r,p=(A[1]-A[0])/r;const v=Math.atan2(p,d),b=Math.cos(v+.5*Math.PI),y=Math.sin(v+.5*Math.PI);if(6===t)for(let t=0;t<r;t++){const r=c[t+e];n[3*t+0]=g[0]+d*t+.25*b*r,n[3*t+1]=A[0]+p*t+.25*y*r,n[3*t+2]=0}else if(7===t){const t=(.5*m+.5)**2;for(let i=0;i<r;i++){const r=c[i+e];n[3*i+0]=g[0]+d*i+b*(.25*r+t),n[3*i+1]=A[0]+p*i+y*(.25*r+t),n[3*i+2]=0}for(let n=0;n<r;n++){const r=u[n+e];i[3*n+0]=g[0]+d*n+b*(.25*r-t),i[3*n+1]=A[0]+p*n+y*(.25*r-t),i[3*n+2]=0}}}0===e?(this.positions=n,this.positions2=i,this.numVert=r,this.alpha=o):(this.oldPositions=n,this.oldPositions2=i,this.oldNumVert=r,this.oldAlpha=o)}const g=.5-.5*Math.cos(t*Math.PI),A=1-g;this.oldNumVert>0&&(o=g*this.alpha+A*this.oldAlpha);let v=Math.clamp(s.wave_r,0,1),b=Math.clamp(s.wave_g,0,1),y=Math.clamp(s.wave_b,0,1);if(0!==s.wave_brighten){const e=Math.max(v,b,y);e>.01&&(v/=e,b/=e,y/=e)}if(this.color=[v,b,y,o],this.oldNumVert>0)if(7===h){const e=(this.oldNumVert-1)/(2*this.numVert);for(let t=0;t<this.numVert;t++){const r=t*e,n=Math.floor(r),i=r-n,a=this.oldPositions[3*n+0]*(1-i)+this.oldPositions[3*(n+1)+0]*i,s=this.oldPositions[3*n+1]*(1-i)+this.oldPositions[3*(n+1)+1]*i;this.positions[3*t+0]=this.positions[3*t+0]*g+a*A,this.positions[3*t+1]=this.positions[3*t+1]*g+s*A,this.positions[3*t+2]=0}for(let t=0;t<this.numVert;t++){const r=(t+this.numVert)*e,n=Math.floor(r),i=r-n,a=this.oldPositions[3*n+0]*(1-i)+this.oldPositions[3*(n+1)+0]*i,s=this.oldPositions[3*n+1]*(1-i)+this.oldPositions[3*(n+1)+1]*i;this.positions2[3*t+0]=this.positions2[3*t+0]*g+a*A,this.positions2[3*t+1]=this.positions2[3*t+1]*g+s*A,this.positions2[3*t+2]=0}}else if(7===d){const e=this.numVert/2,t=(this.oldNumVert-1)/e;for(let r=0;r<e;r++){const e=r*t,n=Math.floor(e),i=e-n,a=this.oldPositions[3*n+0]*(1-i)+this.oldPositions[3*(n+1)+0]*i,s=this.oldPositions[3*n+1]*(1-i)+this.oldPositions[3*(n+1)+1]*i;this.positions[3*r+0]=this.positions[3*r+0]*g+a*A,this.positions[3*r+1]=this.positions[3*r+1]*g+s*A,this.positions[3*r+2]=0}for(let r=0;r<e;r++){const n=r*t,i=Math.floor(n),a=n-i,s=this.oldPositions2[3*i+0]*(1-a)+this.oldPositions2[3*(i+1)+0]*a,o=this.oldPositions2[3*i+1]*(1-a)+this.oldPositions2[3*(i+1)+1]*a;this.positions2[3*r+0]=this.positions[3*(r+e)+0]*g+s*A,this.positions2[3*r+1]=this.positions[3*(r+e)+1]*g+o*A,this.positions2[3*r+2]=0}}else{const e=(this.oldNumVert-1)/this.numVert;for(let t=0;t<this.numVert;t++){const r=t*e,n=Math.floor(r),i=r-n,a=this.oldPositions[3*n+0]*(1-i)+this.oldPositions[3*(n+1)+0]*i,s=this.oldPositions[3*n+1]*(1-i)+this.oldPositions[3*(n+1)+1]*i;this.positions[3*t+0]=this.positions[3*t+0]*g+a*A,this.positions[3*t+1]=this.positions[3*t+1]*g+s*A,this.positions[3*t+2]=0}}for(let e=0;e<this.numVert;e++)this.positions[3*e+1]=-this.positions[3*e+1];if(this.smoothedNumVert=2*this.numVert-1,i.default.smoothWave(this.positions,this.smoothedPositions,this.numVert),7===h||7===d){for(let e=0;e<this.numVert;e++)this.positions2[3*e+1]=-this.positions2[3*e+1];i.default.smoothWave(this.positions2,this.smoothedPositions2,this.numVert)}return!0}return!1}drawBasicWaveform(e,t,r,n,i){if(this.generateWaveform(e,t,r,n,i)){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color);let e=1;0===i.wave_thick&&0===i.wave_dots||(e=4),0!==i.additivewave?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const t=0!==i.wave_dots?this.gl.POINTS:this.gl.LINE_STRIP;for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(t,0,this.smoothedNumVert)}if(7==Math.floor(i.wave_mode)%8){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions2,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc);for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(t,0,this.smoothedNumVert)}}}}}},"./src/rendering/waves/customWaveform.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return s}));var n=r("./src/utils.js"),i=r("./src/rendering/shaders/shaderUtils.js"),a=r("./src/rendering/waves/waveUtils.js");class s{constructor(e,t,r){this.index=e,this.gl=t;this.pointsData=[new Float32Array(512),new Float32Array(512)],this.positions=new Float32Array(1536),this.colors=new Float32Array(2048),this.smoothedPositions=new Float32Array(3069),this.smoothedColors=new Float32Array(4092),this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      uniform float uSize;\n      uniform vec2 thickOffset;\n      in vec3 aPos;\n      in vec4 aColor;\n      out vec4 vColor;\n      void main(void) {\n        vColor = aColor;\n        gl_PointSize = uSize;\n        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      in vec4 vColor;\n      out vec4 fragColor;\n      void main(void) {\n        fragColor = vColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.sizeLoc=this.gl.getUniformLocation(this.shaderProgram,"uSize"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}generateWaveform(e,t,r,i,s,o,l,c){if(0!==l.baseVals.enabled&&e.length>0){let u;if(o.preset.useWASM)u=o.runWaveFrameEquations(this.index,s);else{const e=Object.assign({},o.mdVSWaves[this.index],o.mdVSFrameMapWaves[this.index],o.mdVSQAfterFrame,o.mdVSTWaveInits[this.index],s);u=o.runWaveFrameEquations(this.index,e)}const h=512;Object.prototype.hasOwnProperty.call(u,"samples")?this.samples=u.samples:this.samples=h,this.samples>h&&(this.samples=h),this.samples=Math.floor(this.samples);const d=o.preset.waves[this.index].baseVals,f=Math.floor(u.sep),m=u.scaling,p=u.spectrum,g=u.smoothing,A=d.usedots,v=u.r,b=u.g,y=u.b,w=u.a,_=o.preset.baseVals.wave_scale;if(this.samples-=f,this.samples>=2||0!==A&&this.samples>=1){const s=0!==p,E=(s?.15:.004)*m*_,x=s?r:e,S=s?i:t,T=s?0:Math.floor((h-this.samples)/2-f/2),k=s?0:Math.floor((h-this.samples)/2+f/2),I=s?(h-f)/this.samples:1,C=(.98*g)**.5,P=1-C;this.pointsData[0][0]=x[T],this.pointsData[1][0]=S[k];for(let e=1;e<this.samples;e++){const t=x[Math.floor(e*I+T)],r=S[Math.floor(e*I+k)];this.pointsData[0][e]=t*P+this.pointsData[0][e-1]*C,this.pointsData[1][e]=r*P+this.pointsData[1][e-1]*C}for(let e=this.samples-2;e>=0;e--)this.pointsData[0][e]=this.pointsData[0][e]*P+this.pointsData[0][e+1]*C,this.pointsData[1][e]=this.pointsData[1][e]*P+this.pointsData[1][e+1]*C;for(let e=0;e<this.samples;e++)this.pointsData[0][e]*=E,this.pointsData[1][e]*=E;if(o.preset.useWASM){const e=o.preset.globalPools[`wavePerFrame${this.index}`];for(let t=0;t<this.samples;t++){const r=this.pointsData[0][t],n=this.pointsData[1][t];e.sample.value=t/(this.samples-1),e.value1.value=r,e.value2.value=n,e.x.value=.5+r,e.y.value=.5+n,e.r.value=v,e.g.value=b,e.b.value=y,e.a.value=w,l.point_eqs&&o.preset.waves[this.index].point_eqs();const i=(2*e.x.value-1)*this.invAspectx,a=(-2*e.y.value+1)*this.invAspecty,s=e.r.value,u=e.g.value,h=e.b.value,d=e.a.value;this.positions[3*t+0]=i,this.positions[3*t+1]=a,this.positions[3*t+2]=0,this.colors[4*t+0]=s,this.colors[4*t+1]=u,this.colors[4*t+2]=h,this.colors[4*t+3]=d*c}}else for(let e=0;e<this.samples;e++){const t=this.pointsData[0][e],r=this.pointsData[1][e];u.sample=e/(this.samples-1),u.value1=t,u.value2=r,u.x=.5+t,u.y=.5+r,u.r=v,u.g=b,u.b=y,u.a=w,""!==l.point_eqs&&(u=o.runWavePointEquations(this.index,u));const n=(2*u.x-1)*this.invAspectx,i=(-2*u.y+1)*this.invAspecty,a=u.r,s=u.g,h=u.b,d=u.a;this.positions[3*e+0]=n,this.positions[3*e+1]=i,this.positions[3*e+2]=0,this.colors[4*e+0]=a,this.colors[4*e+1]=s,this.colors[4*e+2]=h,this.colors[4*e+3]=d*c}if(o.preset.useWASM)u.usedots=A,u.thick=d.thick,u.additive=d.additive;else{const e=o.mdVSUserKeysWaves[this.index],t=n.default.pick(u,e);o.mdVSFrameMapWaves[this.index]=t}return this.mdVSWaveFrame=u,0===A&&a.default.smoothWaveAndColor(this.positions,this.colors,this.smoothedPositions,this.smoothedColors,this.samples),!0}}return!1}drawCustomWaveform(e,t,r,n,i,a,s,o){if(o&&this.generateWaveform(t,r,n,i,a,s,o,e)){this.gl.useProgram(this.shaderProgram);const e=0!==this.mdVSWaveFrame.usedots,t=0!==this.mdVSWaveFrame.thick,r=0!==this.mdVSWaveFrame.additive;let n,i,a;e?(n=this.positions,i=this.colors,a=this.samples):(n=this.smoothedPositions,i=this.smoothedColors,a=2*this.samples-1),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation);let s=1;e?t?this.gl.uniform1f(this.sizeLoc,2+(this.texsizeX>=1024?1:0)):this.gl.uniform1f(this.sizeLoc,1+(this.texsizeX>=1024?1:0)):(this.gl.uniform1f(this.sizeLoc,1),t&&(s=4)),r?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const o=e?this.gl.POINTS:this.gl.LINE_STRIP;for(let e=0;e<s;e++){const t=2;0===e?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===e?this.gl.uniform2fv(this.thickOffsetLoc,[t/this.texsizeX,0]):2===e?this.gl.uniform2fv(this.thickOffsetLoc,[0,t/this.texsizeY]):3===e&&this.gl.uniform2fv(this.thickOffsetLoc,[t/this.texsizeX,t/this.texsizeY]),this.gl.drawArrays(o,0,a)}}}}},"./src/rendering/waves/waveUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{static smoothWave(e,t,r,n=!1){let i,a=0,s=0,o=1;for(let l=0;l<r-1;l++){i=o,o=Math.min(r-1,l+2);for(let r=0;r<3;r++)t[3*a+r]=e[3*l+r];if(n)for(let r=0;r<3;r++)t[3*(a+1)+r]=.5*(-.15*e[3*s+r]+1.15*e[3*l+r]+1.15*e[3*i+r]+-.15*e[3*o+r]);else{for(let r=0;r<2;r++)t[3*(a+1)+r]=.5*(-.15*e[3*s+r]+1.15*e[3*l+r]+1.15*e[3*i+r]+-.15*e[3*o+r]);t[3*(a+1)+2]=0}s=l,a+=2}for(let n=0;n<3;n++)t[3*a+n]=e[3*(r-1)+n]}static smoothWaveAndColor(e,t,r,n,i,a=!1){let s,o=0,l=0,c=1;for(let u=0;u<i-1;u++){s=c,c=Math.min(i-1,u+2);for(let t=0;t<3;t++)r[3*o+t]=e[3*u+t];if(a)for(let t=0;t<3;t++)r[3*(o+1)+t]=.5*(-.15*e[3*l+t]+1.15*e[3*u+t]+1.15*e[3*s+t]+-.15*e[3*c+t]);else{for(let t=0;t<2;t++)r[3*(o+1)+t]=.5*(-.15*e[3*l+t]+1.15*e[3*u+t]+1.15*e[3*s+t]+-.15*e[3*c+t]);r[3*(o+1)+2]=0}for(let e=0;e<4;e++)n[4*o+e]=t[4*u+e],n[4*(o+1)+e]=t[4*u+e];l=u,o+=2}for(let t=0;t<3;t++)r[3*o+t]=e[3*(i-1)+t];for(let e=0;e<4;e++)n[4*o+e]=t[4*(i-1)+e]}}},"./src/utils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{static atan2(e,t){let r=Math.atan2(e,t);return r<0&&(r+=2*Math.PI),r}static cloneVars(e){return Object.assign({},e)}static range(e,t){return void 0===t?[...Array(e).keys()]:Array.from({length:t-e},((t,r)=>r+e))}static pick(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];r[i]=e[i]||0}return r}static omit(e,t){const r=Object.assign({},e);for(let e=0;e<t.length;e++)delete r[t[e]];return r}static setWasm(e,t,r){for(let n=0;n<r.length;n++){const i=r[n];e[i].value=t[i]}}static pickWasm(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];r[i]=e[i].value}return r}}},"./src/visualizer.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return m}));var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),i=r.n(n),a=r("./node_modules/eel-wasm/dist/src/index.js"),s=r("./node_modules/@assemblyscript/loader/index.js"),o=r("./src/audio/audioProcessor.js"),l=r("./src/rendering/renderer.js"),c=r("./src/utils.js"),u=r("./src/assemblyscript/presetFunctions.ts"),h=r.n(u);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class m{constructor(e,t,r){this.opts=r,this.audio=new o.default(e);const n=r.width||1200,i=r.height||900;this.internalCanvas=document.createElement("canvas"),this.internalCanvas.width=n,this.internalCanvas.height=i,this.gl=this.internalCanvas.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1}),this.outputGl=t.getContext("2d"),this.baseValsDefaults={decay:.98,gammaadj:2,echo_zoom:2,echo_alpha:0,echo_orient:0,red_blue:0,brighten:0,darken:0,wrap:1,darken_center:0,solarize:0,invert:0,bmotionvectorson:1,fshader:0,b1n:0,b2n:0,b3n:0,b1x:1,b2x:1,b3x:1,b1ed:.25,wave_mode:0,additivewave:0,wave_dots:0,wave_thick:0,wave_a:.8,wave_scale:1,wave_smoothing:.75,wave_mystery:0,modwavealphabyvolume:0,modwavealphastart:.75,modwavealphaend:.95,wave_r:1,wave_g:1,wave_b:1,wave_x:.5,wave_y:.5,wave_brighten:1,mv_x:12,mv_y:9,mv_dx:0,mv_dy:0,mv_l:.9,mv_r:1,mv_g:1,mv_b:1,mv_a:1,warpanimspeed:1,warpscale:1,zoomexp:1,zoom:1,rot:0,cx:.5,cy:.5,dx:0,dy:0,warp:1,sx:1,sy:1,ob_size:.01,ob_r:0,ob_g:0,ob_b:0,ob_a:0,ib_size:.01,ib_r:.25,ib_g:.25,ib_b:.25,ib_a:0},this.shapeBaseValsDefaults={enabled:0,sides:4,additive:0,thickoutline:0,textured:0,num_inst:1,tex_zoom:1,tex_ang:0,x:.5,y:.5,rad:.1,ang:0,r:1,g:0,b:0,a:1,r2:0,g2:1,b2:0,a2:0,border_r:1,border_g:1,border_b:1,border_a:.1},this.waveBaseValsDefaults={enabled:0,samples:512,sep:0,scaling:1,smoothing:.5,r:1,g:1,b:1,a:1,spectrum:0,usedots:0,thick:0,additive:0},this.qs=c.default.range(1,33).map((e=>`q${e}`)),this.ts=c.default.range(1,9).map((e=>`t${e}`)),this.globalPerFrameVars=["old_wave_mode","frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset"],this.globalPerPixelVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","rad","ang"],this.globalShapeVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","instance"],this.shapeBaseVars=["x","y","rad","ang","r","g","b","a","r2","g2","b2","a2","border_r","border_g","border_b","border_a","thickoutline","textured","tex_zoom","tex_ang","additive"],this.globalWaveVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","sample","value1","value2"],this.renderer=new l.default(this.gl,this.audio,r)}loseGLContext(){this.gl.getExtension("WEBGL_lose_context").loseContext(),this.outputGl=null}connectAudio(e){this.audioNode=e,this.audio.connectAudio(e)}disconnectAudio(e){this.audio.disconnectAudio(e)}static overrideDefaultVars(e,t){const r={};return Object.keys(e).forEach((n=>{Object.prototype.hasOwnProperty.call(t,n)?r[n]=t[n]:r[n]=e[n]})),r}createQVars(){const e={};return this.qs.forEach((t=>{e[t]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),e}createTVars(){const e={};return this.ts.forEach((t=>{e[t]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),e}createPerFramePool(e){const t={};return Object.keys(this.baseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalPerFrameVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createPerPixelPool(e){const t={};return Object.keys(this.baseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalPerPixelVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createCustomShapePerFramePool(e){const t={};return Object.keys(this.shapeBaseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalShapeVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createCustomWavePerFramePool(e){const t={};return Object.keys(this.waveBaseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalWaveVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}static makeShapeResetPool(e,t,r){return t.reduce(((t,n)=>f(f({},t),{},{[`${n}_${r}`]:e[n]})),{})}static base64ToArrayBuffer(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=t.charCodeAt(i);return n.buffer}async loadPreset(e,t=0){const r=JSON.parse(JSON.stringify(e));r.baseVals=m.overrideDefaultVars(this.baseValsDefaults,r.baseVals);for(let e=0;e<r.shapes.length;e++)r.shapes[e].baseVals=m.overrideDefaultVars(this.shapeBaseValsDefaults,r.shapes[e].baseVals);for(let e=0;e<r.waves.length;e++)r.waves[e].baseVals=m.overrideDefaultVars(this.waveBaseValsDefaults,r.waves[e].baseVals);const n=r.useJS&&!this.opts.onlyUseWASM;Object.prototype.hasOwnProperty.call(r,"init_eqs_eel")&&!n?(r.useWASM=!0,await this.loadWASMPreset(r,t)):this.opts.onlyUseWASM?console.warn("Tried to load a preset that doesn't support WASM with onlyUseWASM on"):Object.prototype.hasOwnProperty.call(r,"init_eqs_str")?this.loadJSPreset(r,t):console.warn("Tried to load a JS preset that doesn't have converted strings")}async loadWASMPreset(e,t){const r=this.createQVars(),n=this.createTVars(),i={perFrame:f(f({},r),this.createPerFramePool(e.baseVals)),perVertex:f(f({},r),this.createPerPixelPool(e.baseVals))},o={presetInit:{pool:"perFrame",code:e.init_eqs_eel},perFrame:{pool:"perFrame",code:e.frame_eqs_eel}};""!==e.pixel_eqs_eel&&(o.perPixel={pool:"perVertex",code:e.pixel_eqs_eel});for(let t=0;t<e.shapes.length;t++)i[`shapePerFrame${t}`]=f(f(f({},r),n),this.createCustomShapePerFramePool(e.shapes[t].baseVals)),0!==e.shapes[t].baseVals.enabled&&(o[`shapes_${t}_init_eqs`]={pool:`shapePerFrame${t}`,code:e.shapes[t].init_eqs_eel},o[`shapes_${t}_frame_eqs`]={pool:`shapePerFrame${t}`,code:e.shapes[t].frame_eqs_eel});for(let t=0;t<e.waves.length;t++)0!==e.waves[t].baseVals.enabled&&(i[`wavePerFrame${t}`]=f(f(f({},r),n),this.createCustomWavePerFramePool(e.waves[t].baseVals)),o[`waves_${t}_init_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].init_eqs_eel},o[`waves_${t}_frame_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].frame_eqs_eel},e.waves[t].point_eqs_eel&&""!==e.waves[t].point_eqs_eel&&(o[`waves_${t}_point_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].point_eqs_eel}));const l=await Object(a.loadModule)({pools:i,functions:o,eelVersion:e.version||2}),c=e=>e||(()=>{}),u=await s.default.instantiate(m.base64ToArrayBuffer(h()()),{pixelEqs:{perPixelEqs:c(l.exports.perPixel)},pixelVarPool:{warp:i.perVertex.warp,zoom:i.perVertex.zoom,zoomexp:i.perVertex.zoomexp,cx:i.perVertex.cx,cy:i.perVertex.cy,sx:i.perVertex.sx,sy:i.perVertex.sy,dx:i.perVertex.dx,dy:i.perVertex.dy,rot:i.perVertex.rot,x:i.perVertex.x,y:i.perVertex.y,ang:i.perVertex.ang,rad:i.perVertex.rad},qVarPool:r,tVarPool:n,shapePool0:m.makeShapeResetPool(i.shapePerFrame0,this.shapeBaseVars,0),shapePool1:m.makeShapeResetPool(i.shapePerFrame1,this.shapeBaseVars,1),shapePool2:m.makeShapeResetPool(i.shapePerFrame2,this.shapeBaseVars,2),shapePool3:m.makeShapeResetPool(i.shapePerFrame3,this.shapeBaseVars,3),console:{logi:e=>{console.log("logi: "+e)},logf:e=>{console.log("logf: "+e)}},env:{abort:()=>{}}});e.globalPools=i,e.init_eqs=c(l.exports.presetInit),e.frame_eqs=c(l.exports.perFrame),e.save_qs=u.exports.saveQs,e.restore_qs=u.exports.restoreQs,e.save_ts=u.exports.saveTs,e.restore_ts=u.exports.restoreTs,l.exports.perPixel&&(e.pixel_eqs=l.exports.perPixel),e.pixel_eqs_initialize_array=(t,r)=>{const n=u.exports.createFloat32Array((t+1)*(r+1)*2);e.pixel_eqs_array=n},e.pixel_eqs_get_array=()=>u.exports.__getFloat32ArrayView(e.pixel_eqs_array),e.pixel_eqs_wasm=(...t)=>u.exports.runPixelEquations(e.pixel_eqs_array,...t);for(let t=0;t<e.shapes.length;t++)0!==e.shapes[t].baseVals.enabled&&(e.shapes[t].init_eqs=c(l.exports[`shapes_${t}_init_eqs`]),e.shapes[t].frame_eqs=l.exports[`shapes_${t}_frame_eqs`],e.shapes[t].frame_eqs_save=()=>u.exports[`shape${t}_save`](),e.shapes[t].frame_eqs_restore=()=>u.exports[`shape${t}_restore`]());for(let t=0;t<e.waves.length;t++)if(0!==e.waves[t].baseVals.enabled){const r={init_eqs:c(l.exports[`waves_${t}_init_eqs`]),frame_eqs:c(l.exports[`waves_${t}_frame_eqs`])};e.waves[t].point_eqs_eel&&""!==e.waves[t].point_eqs_eel?r.point_eqs=l.exports[`waves_${t}_point_eqs`]:r.point_eqs="",e.waves[t]=Object.assign({},e.waves[t],r)}this.renderer.loadPreset(e,t)}loadJSPreset(e,t){if("function"!=typeof e.init_eqs){e.init_eqs=new Function("a",`${e.init_eqs_str} return a;`),e.frame_eqs=new Function("a",`${e.frame_eqs_str} return a;`),e.pixel_eqs_str&&""!==e.pixel_eqs_str?e.pixel_eqs=new Function("a",`${e.pixel_eqs_str} return a;`):e.pixel_eqs="";for(let t=0;t<e.shapes.length;t++)0!==e.shapes[t].baseVals.enabled&&(e.shapes[t]=Object.assign({},e.shapes[t],{init_eqs:new Function("a",`${e.shapes[t].init_eqs_str} return a;`),frame_eqs:new Function("a",`${e.shapes[t].frame_eqs_str} return a;`)}));for(let t=0;t<e.waves.length;t++)if(0!==e.waves[t].baseVals.enabled){const r={init_eqs:new Function("a",`${e.waves[t].init_eqs_str} return a;`),frame_eqs:new Function("a",`${e.waves[t].frame_eqs_str} return a;`)};e.waves[t].point_eqs_str&&""!==e.waves[t].point_eqs_str?r.point_eqs=new Function("a",`${e.waves[t].point_eqs_str} return a;`):r.point_eqs="",e.waves[t]=Object.assign({},e.waves[t],r)}}this.renderer.loadPreset(e,t)}loadExtraImages(e){this.renderer.loadExtraImages(e)}setRendererSize(e,t,r={}){this.internalCanvas.width=e,this.internalCanvas.height=t,this.renderer.setRendererSize(e,t,r)}setInternalMeshSize(e,t){this.renderer.setInternalMeshSize(e,t)}setOutputAA(e){this.renderer.setOutputAA(e)}setCanvas(e){this.outputGl=e.getContext("2d")}render(e){const t=this.renderer.render(e);return this.outputGl&&this.outputGl.drawImage(this.internalCanvas,0,0),t}launchSongTitleAnim(e){this.renderer.launchSongTitleAnim(e)}toDataURL(){return this.renderer.toDataURL()}warpBufferToDataURL(){return this.renderer.warpBufferToDataURL()}}}})},e.exports=t()},487:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=t},7811:(e,t)=>{"use strict";var r=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,n=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,a=/\\([\u000b\u0020-\u00ff])/g,s=/([\\"])/g,o=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function l(e){var t=String(e);if(i.test(t))return t;if(t.length>0&&!n.test(t))throw new TypeError("invalid parameter value");return'"'+t.replace(s,"\\$1")+'"'}function c(e){this.parameters=Object.create(null),this.type=e}t.format=function(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.parameters,r=e.type;if(!r||!o.test(r))throw new TypeError("invalid type");var n=r;if(t&&"object"==typeof t)for(var a,s=Object.keys(t).sort(),c=0;c<s.length;c++){if(a=s[c],!i.test(a))throw new TypeError("invalid parameter name");n+="; "+a+"="+l(t[a])}return n},t.parse=function(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?function(e){var t;if("function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]),"string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var n=t.indexOf(";"),i=-1!==n?t.substr(0,n).trim():t.trim();if(!o.test(i))throw new TypeError("invalid media type");var s=new c(i.toLowerCase());if(-1!==n){var l,u,h;for(r.lastIndex=n;u=r.exec(t);){if(u.index!==n)throw new TypeError("invalid parameter format");n+=u[0].length,l=u[1].toLowerCase(),'"'===(h=u[2])[0]&&(h=h.substr(1,h.length-2).replace(a,"$1")),s.parameters[l]=h}if(n!==t.length)throw new TypeError("invalid parameter format")}return s}},1012:e=>{var t,r;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],n=0;n<e.length;n+=3)for(var i=e[n]<<16|e[n+1]<<8|e[n+2],a=0;a<4;a++)8*n+6*a<=8*e.length?r.push(t.charAt(i>>>6*(3-a)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,i=0;n<e.length;i=++n%4)0!=i&&r.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(n))>>>6-2*i);return r}},e.exports=r},1227:(e,t,r)=>{var n=r(4155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(2447)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2447:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,a,s=null;function o(...e){if(!o.enabled)return;const n=o,i=Number(new Date),a=i-(r||i);n.diff=a,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const a=t.formatters[i];if("function"==typeof a){const t=e[s];r=a.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=n,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,a=t.enabled(e)),a),set:e=>{s=e}}),"function"==typeof t.init&&t.init(o),o}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(7824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},7187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,a),n(r)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}p(e,t,a,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&p(e,"error",t,{once:!0})}(e,i)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,a,s,c;if(o(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]),void 0===s)s=a[t]=r,++e._eventsCount;else if("function"==typeof s?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=u.bind(n);return i.listener=r,n.wrapFn=i,i}function d(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):m(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function p(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(a){n.once&&e.removeEventListener(t,i),r(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var l=a[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else{var c=l.length,u=m(l,c);for(r=0;r<c;++r)n(u[r],this,t)}return!0},a.prototype.addListener=function(e,t){return c(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return c(this,e,t,!0)},a.prototype.once=function(e,t){return o(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,a,s;if(o(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,a=Object.keys(r);for(n=0;n<a.length;++n)"removeListener"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var Buffer=__webpack_require__(8764).Buffer;const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(e){const t=await strtok3.fromStream(e);try{return await fromTokenizer(t)}finally{await t.close()}}async function fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Buffer?e:Buffer.from(e);if(t&&t.length>1)return fromTokenizer(strtok3.fromBuffer(t))}function _check(e,t,r){r={offset:0,...r};for(const[n,i]of t.entries())if(r.mask){if(i!==(r.mask[n]&e[n+r.offset]))return!1}else if(i!==e[n+r.offset])return!1;return!0}async function fromTokenizer(e){try{return _fromTokenizer(e)}catch(e){if(!(e instanceof strtok3.EndOfStreamError))throw e}}async function _fromTokenizer(e){let t=Buffer.alloc(minimumBytes);const r=(e,r)=>_check(t,e,r),n=(e,t)=>r(stringToBytes(e),t);if(e.fileInfo.size||(e.fileInfo.size=Number.MAX_SAFE_INTEGER),await e.peekBuffer(t,{length:12,mayBeLess:!0}),r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(r([37,33]))return await e.peekBuffer(t,{length:24,mayBeLess:!0}),n("PS-Adobe-",{offset:2})&&n(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(n("ID3")){await e.ignore(6);const i=await e.readToken(uint32SyncSafeToken);return e.position+i>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(i),fromTokenizer(e))}if(n("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===t[0]||70===t[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(n("FLIF"))return{ext:"flif",mime:"image/flif"};if(n("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(n("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(n("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(n("FORM"))return{ext:"aif",mime:"audio/aiff"};if(n("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(r([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(t,{length:30});const a={compressedSize:t.readUInt32LE(18),uncompressedSize:t.readUInt32LE(22),filenameLength:t.readUInt16LE(26),extraFieldLength:t.readUInt16LE(28)};if(a.filename=await e.readToken(new Token.StringType(a.filenameLength,"utf-8")),await e.ignore(a.extraFieldLength),"META-INF/mozilla.rsa"===a.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(a.filename.endsWith(".rels")||a.filename.endsWith(".xml"))switch(a.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(a.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(a.filename.startsWith("3D/")&&a.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===a.filename&&a.compressedSize===a.uncompressedSize)switch(await e.readToken(new Token.StringType(a.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}if(0===a.compressedSize){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(t,{mayBeLess:!0}),s=t.indexOf("504B0304",0,"hex"),await e.ignore(s>=0?s:t.length)}else await e.ignore(a.compressedSize)}}catch(o){if(!(o instanceof strtok3.EndOfStreamError))throw o}return{ext:"zip",mime:"application/zip"}}if(n("OggS")){await e.ignore(28);const l=Buffer.alloc(8);return await e.readBuffer(l),_check(l,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(l,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(l,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(l,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(l,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(l,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(r([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(n("ftyp",{offset:4})&&0!=(96&t[8])){const c=t.toString("binary",8,12).replace("\0"," ").trim();switch(c){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return c.startsWith("3g")?c.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(n("MThd"))return{ext:"mid",mime:"audio/midi"};if(n("wOFF")&&(r([0,1,0,0],{offset:4})||n("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(n("wOF2")&&(r([0,1,0,0],{offset:4})||n("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([212,195,178,161])||r([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(n("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(n("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(n("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(n("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(n("%PDF")){await e.ignore(1350);const u=10485760,h=Buffer.alloc(Math.min(u,e.fileInfo.size));return await e.readBuffer(h,{mayBeLess:!0}),h.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([73,73,42,0]))return n("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:r([28,0,254,0],{offset:8})||r([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:r([8,0,0,0],{offset:4})&&(r([45,0,254,0],{offset:8})||r([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(t=Buffer.alloc(24),await e.peekBuffer(t),(r([16,251,134,1],{offset:4})||r([8,0,0,0],{offset:4}))&&r([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(n("MAC "))return{ext:"ape",mime:"audio/ape"};if(r([26,69,223,163])){async function d(){const t=await e.peekNumber(Token.UINT8);let r=128,n=0;for(;0==(t&r)&&0!==r;)++n,r>>=1;const i=Buffer.alloc(n+1);return await e.readBuffer(i),i}async function f(){const e=await d(),t=await d();t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}async function m(t,r){for(;r>0;){const t=await f();if(17026===t.id)return e.readToken(new Token.StringType(t.len,"utf-8"));await e.ignore(t.len),--r}}const p=await f();switch(await m(0,p.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(n("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(n("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(n("MSCF")||n("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(r([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(n("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(n("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(n("IMPM"))return{ext:"it",mime:"audio/x-it"};if(n("-lh0-",{offset:2})||n("-lh1-",{offset:2})||n("-lh2-",{offset:2})||n("-lh3-",{offset:2})||n("-lh4-",{offset:2})||n("-lh5-",{offset:2})||n("-lh6-",{offset:2})||n("-lh7-",{offset:2})||n("-lzs-",{offset:2})||n("-lz4-",{offset:2})||n("-lz5-",{offset:2})||n("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(r([0,0,1,186])){if(r([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(r([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(n("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(n("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(n("solid "))return{ext:"stl",mime:"model/stl"};if(n("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(n("!<arch>"))return await e.ignore(8),"debian-binary"===await e.readToken(new Token.StringType(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(r([137,80,78,71,13,10,26,10])){async function g(){return{length:await e.readToken(Token.INT32_BE),type:await e.readToken(new Token.StringType(4,"binary"))}}await e.ignore(8);do{const A=await g();if(A.length<0)return;switch(A.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(A.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(r([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(r([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(r([102,114,101,101],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(n("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(r([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(r([48,38,178,117,142,102,207,17,166,217])){async function v(){const t=Buffer.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(Token.UINT64_LE))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const b=await v();let y=b.size-24;if(_check(b.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const w=Buffer.alloc(16);if(y-=await e.readBuffer(w),_check(w,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(w,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(y)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(r([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((r([126,16,4])||r([126,24,4]))&&r([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(r([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(r([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(r([255,10])||r([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(t,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),n("BEGIN:")){if(n("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(n("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(n("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(n("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(n("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(r([4,0,0,0])&&t.length>=16){const _=t.readUInt32LE(12);if(_>12&&t.length>=_+16)try{const E=t.slice(16,_+16).toString();if(JSON.parse(E).files)return{ext:"asar",mime:"application/x-asar"}}catch(x){}}if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(n("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(r([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(r([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(t,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(t))return{ext:"tar",mime:"application/x-tar"};if(r([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(n("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(t.length>=2&&r([255,224],{offset:0,mask:[255,224]})){if(r([16],{offset:1,mask:[22]}))return r([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(r([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",(async()=>{const e=new stream.PassThrough;let t;t=stream.pipeline?stream.pipeline(readableStream,e,(()=>{})):readableStream.pipe(e);const r=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const t=await fromBuffer(r);e.fileType=t}catch(e){reject(e)}resolve(t)}))})),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)}),module.exports=fileType},9898:e=>{"use strict";e.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(e,t)=>{"use strict";t.stringToBytes=e=>[...e].map((e=>e.charCodeAt(0))),t.tarHeaderChecksumMatches=(e,t=0)=>{const r=parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(r))return!1;let n=256;for(let r=t;r<t+148;r++)n+=e[r];for(let r=t+156;r<t+512;r++)n+=e[r];return r===n},t.uint32SyncSafeToken={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4}},6234:()=>{!function(e){"use strict";function t(t,r){var n=e.createEvent("Event");n.initEvent(t,!0,!1),r.dispatchEvent(n)}function r(t){return function(r,i){return t!==s.exit||e[n.element]?(e.addEventListener(n.events.change,(function t(){r(),e.removeEventListener(n.events.change,t,!1)}),!1),void e.addEventListener(n.events.error,(function t(){i(new TypeError),e.removeEventListener(n.events.error,t,!1)}),!1)):void setTimeout((function(){i(new TypeError)}),1)}}var n,i,a={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},s=a.w3;for(i in a)if(a[i].enabled in e){n=a[i];break}s.enabled in e||!n||(e.addEventListener(n.events.change,(function(r){r.stopPropagation(),r.stopImmediatePropagation(),e[s.enabled]=e[n.enabled],e[s.element]=e[n.element],t(s.events.change,r.target)}),!1),e.addEventListener(n.events.error,(function(e){t(s.events.error,e.target)}),!1),e[s.enabled]=e[n.enabled],e[s.element]=e[n.element],e[s.exit]=function(){var t=e[n.exit]();return!t&&Promise?new Promise(r(s.exit)):t},Element.prototype[s.request]=function(){var e=this[n.request].apply(this,arguments);return!e&&Promise?new Promise(r(s.request)):e})}(document)},6998:function(e){e.exports=function(e,t){if(null==t&&(t={fuzzy:!0}),/youtu\.?be/.test(e)){var r,n=[/youtu\.be\/([^#\&\?]{11})/,/\?v=([^#\&\?]{11})/,/\&v=([^#\&\?]{11})/,/embed\/([^#\&\?]{11})/,/\/v\/([^#\&\?]{11})/];for(r=0;r<n.length;++r)if(n[r].test(e))return n[r].exec(e)[1];if(t.fuzzy){var i=e.split(/[\/\&\?=#\.\s]/g);for(r=0;r<i.length;++r)if(/^[^#\&\?]{11}$/.test(i[r]))return i[r]}}return null}},645:(e,t)=>{t.read=function(e,t,r,n,i){var a,s,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-u)-1,f>>=-u,u+=o;u>0;a=256*a+e[t+h],h+=d,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=n;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),a-=c}return(f?-1:1)*s*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var s,o,l,c=8*a-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:a-1,m=n?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(o=0,s=u):s+h>=1?(o=(t*l-1)*Math.pow(2,i),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&o,f+=m,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[r+f]=255&s,f+=m,s/=256,c-=8);e[r+f-m]|=128*p}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},8738:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},9090:e=>{function t(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function r(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,n,i){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("script");"function"==typeof n&&(i=n,n={}),n=n||{},i=i||function(){},s.type=n.type||"text/javascript",s.charset=n.charset||"utf8",s.async=!("async"in n)||!!n.async,s.src=e,n.attrs&&function(e,t){for(var r in t)e.setAttribute(r,t[r])}(s,n.attrs),n.text&&(s.text=""+n.text),("onload"in s?t:r)(s,i),s.onload||t(s,i),a.appendChild(s)}},2568:(e,t,r)=>{var n,i,a,s,o;n=r(1012),i=r(487).utf8,a=r(8738),s=r(487).bin,(o=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):i.stringToBytes(e):a(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=n.bytesToWords(e),l=8*e.length,c=1732584193,u=-271733879,h=-1732584194,d=271733878,f=0;f<r.length;f++)r[f]=16711935&(r[f]<<8|r[f]>>>24)|4278255360&(r[f]<<24|r[f]>>>8);r[l>>>5]|=128<<l%32,r[14+(l+64>>>9<<4)]=l;var m=o._ff,p=o._gg,g=o._hh,A=o._ii;for(f=0;f<r.length;f+=16){var v=c,b=u,y=h,w=d;c=m(c,u,h,d,r[f+0],7,-680876936),d=m(d,c,u,h,r[f+1],12,-389564586),h=m(h,d,c,u,r[f+2],17,606105819),u=m(u,h,d,c,r[f+3],22,-1044525330),c=m(c,u,h,d,r[f+4],7,-176418897),d=m(d,c,u,h,r[f+5],12,1200080426),h=m(h,d,c,u,r[f+6],17,-1473231341),u=m(u,h,d,c,r[f+7],22,-45705983),c=m(c,u,h,d,r[f+8],7,1770035416),d=m(d,c,u,h,r[f+9],12,-1958414417),h=m(h,d,c,u,r[f+10],17,-42063),u=m(u,h,d,c,r[f+11],22,-1990404162),c=m(c,u,h,d,r[f+12],7,1804603682),d=m(d,c,u,h,r[f+13],12,-40341101),h=m(h,d,c,u,r[f+14],17,-1502002290),c=p(c,u=m(u,h,d,c,r[f+15],22,1236535329),h,d,r[f+1],5,-165796510),d=p(d,c,u,h,r[f+6],9,-1069501632),h=p(h,d,c,u,r[f+11],14,643717713),u=p(u,h,d,c,r[f+0],20,-373897302),c=p(c,u,h,d,r[f+5],5,-701558691),d=p(d,c,u,h,r[f+10],9,38016083),h=p(h,d,c,u,r[f+15],14,-660478335),u=p(u,h,d,c,r[f+4],20,-405537848),c=p(c,u,h,d,r[f+9],5,568446438),d=p(d,c,u,h,r[f+14],9,-1019803690),h=p(h,d,c,u,r[f+3],14,-187363961),u=p(u,h,d,c,r[f+8],20,1163531501),c=p(c,u,h,d,r[f+13],5,-1444681467),d=p(d,c,u,h,r[f+2],9,-51403784),h=p(h,d,c,u,r[f+7],14,1735328473),c=g(c,u=p(u,h,d,c,r[f+12],20,-1926607734),h,d,r[f+5],4,-378558),d=g(d,c,u,h,r[f+8],11,-2022574463),h=g(h,d,c,u,r[f+11],16,1839030562),u=g(u,h,d,c,r[f+14],23,-35309556),c=g(c,u,h,d,r[f+1],4,-1530992060),d=g(d,c,u,h,r[f+4],11,1272893353),h=g(h,d,c,u,r[f+7],16,-155497632),u=g(u,h,d,c,r[f+10],23,-1094730640),c=g(c,u,h,d,r[f+13],4,681279174),d=g(d,c,u,h,r[f+0],11,-358537222),h=g(h,d,c,u,r[f+3],16,-722521979),u=g(u,h,d,c,r[f+6],23,76029189),c=g(c,u,h,d,r[f+9],4,-640364487),d=g(d,c,u,h,r[f+12],11,-421815835),h=g(h,d,c,u,r[f+15],16,530742520),c=A(c,u=g(u,h,d,c,r[f+2],23,-995338651),h,d,r[f+0],6,-198630844),d=A(d,c,u,h,r[f+7],10,1126891415),h=A(h,d,c,u,r[f+14],15,-1416354905),u=A(u,h,d,c,r[f+5],21,-57434055),c=A(c,u,h,d,r[f+12],6,1700485571),d=A(d,c,u,h,r[f+3],10,-1894986606),h=A(h,d,c,u,r[f+10],15,-1051523),u=A(u,h,d,c,r[f+1],21,-2054922799),c=A(c,u,h,d,r[f+8],6,1873313359),d=A(d,c,u,h,r[f+15],10,-30611744),h=A(h,d,c,u,r[f+6],15,-1560198380),u=A(u,h,d,c,r[f+13],21,1309151649),c=A(c,u,h,d,r[f+4],6,-145523070),d=A(d,c,u,h,r[f+11],10,-1120210379),h=A(h,d,c,u,r[f+2],15,718787259),u=A(u,h,d,c,r[f+9],21,-343485551),c=c+v>>>0,u=u+b>>>0,h=h+y>>>0,d=d+w>>>0}return n.endian([c,u,h,d])})._ff=function(e,t,r,n,i,a,s){var o=e+(t&r|~t&n)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._gg=function(e,t,r,n,i,a,s){var o=e+(t&n|r&~n)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._hh=function(e,t,r,n,i,a,s){var o=e+(t^r^n)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._ii=function(e,t,r,n,i,a,s){var o=e+(r^(t|~n))+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(o(e,t));return t&&t.asBytes?r:t&&t.asString?s.bytesToString(r):n.bytesToHex(r)}},2577:(e,t)=>{"use strict";var r=/^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/,n=/^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/,i=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;function a(e,t,r){this.type=e,this.subtype=t,this.suffix=r}t.format=function(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.subtype,i=e.suffix,a=e.type;if(!a||!n.test(a))throw new TypeError("invalid type");if(!t||!r.test(t))throw new TypeError("invalid subtype");var s=a+"/"+t;if(i){if(!n.test(i))throw new TypeError("invalid suffix");s+="+"+i}return s},t.parse=function(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");var t=i.exec(e.toLowerCase());if(!t)throw new TypeError("invalid media type");var r,n=t[1],s=t[2],o=s.lastIndexOf("+");return-1!==o&&(r=s.substr(o+1),s=s.substr(0,o)),new a(n,s,r)},t.test=function(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");return i.test(e.toLowerCase())}},7824:e=>{var t=1e3,r=60*t,n=60*r,i=24*n;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,s){s=s||{};var o,l,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===c&&isFinite(e))return s.long?(o=e,(l=Math.abs(o))>=i?a(o,l,i,"day"):l>=n?a(o,l,n,"hour"):l>=r?a(o,l,r,"minute"):l>=t?a(o,l,t,"second"):o+" ms"):function(e){var a=Math.abs(e);return a>=i?Math.round(e/i)+"d":a>=n?Math.round(e/n)+"h":a>=r?Math.round(e/r)+"m":a>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2463:(e,t,r)=>{"use strict";t.Aj=t.De=void 0;const n=r(1227),i=r(523),a=r(8090);n("music-metadata-browser:main");r(523);t.De=i.parseStream,t.Aj=async function(e,r){const n={mimeType:e.type,size:e.size};return e instanceof File&&(n.path=e.name),async function(e,r,n){const i=new a.ReadableWebToNodeStream(e),s=await(0,t.De)(i,"string"==typeof r?{mimeType:r}:r,n);return await i.close(),s}(e.stream?e.stream():function(e){const t=new FileReader;return new ReadableStream({start(r){t.onloadend=e=>{let t=e.target.result;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),r.enqueue(t),r.close()},t.onerror=e=>{r.close()},t.onabort=e=>{r.close()},t.readAsArrayBuffer(e)}})}(e),{mimeType:e.type,size:e.size},r)}},3275:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ParserFactory=t.parseHttpContentType=void 0;const i=r(1),a=r(7811),s=r(2577),o=r(1227),l=r(7584),c=r(5410),u=r(6742),h=r(1004),d=r(498),f=r(8841),m=r(60),p=r(9606),g=r(1915),A=r(2682),v=r(5870),b=r(1533),y=r(6789),w=r(78),_=(0,o.default)("music-metadata:parser:factory");function E(e){const t=a.parse(e),r=s.parse(t.type);return{type:r.type,subtype:r.subtype,suffix:r.suffix,parameters:t.parameters}}t.parseHttpContentType=E;class x{static async parseOnContentType(e,t){const{mimeType:r,path:n,url:i}=await e.fileInfo,a=x.getParserIdForMimeType(r)||x.getParserIdForExtension(n)||x.getParserIdForExtension(i);return a||_("No parser found for MIME-type / extension: "+r),this.parse(e,a,t)}static async parse(e,t,r){if(!t){_("Guess parser on content...");const r=n.alloc(4100);if(await e.peekBuffer(r,{mayBeLess:!0}),e.fileInfo.path&&(t=this.getParserIdForExtension(e.fileInfo.path)),!t){const e=await i.fromBuffer(r);if(!e)throw new Error("Failed to determine audio format");if(_(`Guessed file type is mime=${e.mime}, extension=${e.ext}`),!(t=x.getParserIdForMimeType(e.mime)))throw new Error("Guessed MIME-type not supported: "+e.mime)}}return async function(e,t,r={}){const n=await x.loadParser(t),i=new l.MetadataCollector(r);return await n.init(i,e,r).parse(),i.toCommonMetadata()}(e,t,r)}static getParserIdForExtension(e){if(e)switch(this.getExtension(e).toLocaleLowerCase()||e){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}static async loadParser(e){switch(e){case"aiff":return new c.AIFFParser;case"adts":case"mpeg":return new m.MpegParser;case"apev2":return new u.APEv2Parser;case"asf":return new h.AsfParser;case"dsf":return new b.DsfParser;case"dsdiff":return new y.DsdiffParser;case"flac":return new d.FlacParser;case"mp4":return new f.MP4Parser;case"musepack":return new p.default;case"ogg":return new g.OggParser;case"riff":return new A.WaveParser;case"wavpack":return new v.WavPackParser;case"matroska":return new w.MatroskaParser;default:throw new Error(`Unknown parser type: ${e}`)}}static getExtension(e){const t=e.lastIndexOf(".");return-1===t?"":e.slice(t)}static getParserIdForMimeType(e){let t;try{t=E(e)}catch(t){return void _(`Invalid HTTP Content-Type header value: ${e}`)}const r=0===t.subtype.indexOf("x-")?t.subtype.substring(2):t.subtype;switch(t.type){case"audio":switch(r){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(r){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(r){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}}}}t.ParserFactory=x},5410:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AIFFParser=void 0;const n=r(3416),i=r(1227),a=r(5849),s=r(8928),o=r(8049),l=r(7805),c=r(1162),u=r(4633),h=(0,i.default)("music-metadata:parser:aiff"),d={NONE:"not compressed\tPCM\tApple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float\tApple Computer",alaw:"ALaw 2:1\t8-bit ITU-T G.711 A-law",ulaw:"Law 2:1\t8-bit ITU-T G.711 -law\tApple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 -law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32\tIEEE 32-bit float "};class f extends l.BasicParser{async parse(){if("FORM"!==(await this.tokenizer.readToken(u.Header)).chunkID)throw new Error("Invalid Chunk-ID, expected 'FORM'");const e=await this.tokenizer.readToken(o.FourCcToken);switch(e){case"AIFF":this.metadata.setFormat("container",e),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw Error("Unsupported AIFF type: "+e)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=u.Header.len;){h("Reading AIFF chunk at offset="+this.tokenizer.position);const e=await this.tokenizer.readToken(u.Header),t=2*Math.round(e.chunkSize/2),r=await this.readData(e);await this.tokenizer.ignore(t-r)}}catch(e){if(!(e instanceof a.EndOfStreamError))throw e;h("End-of-stream")}}async readData(e){var t;switch(e.chunkID){case"COMM":const r=await this.tokenizer.readToken(new c.Common(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",r.sampleSize),this.metadata.setFormat("sampleRate",r.sampleRate),this.metadata.setFormat("numberOfChannels",r.numChannels),this.metadata.setFormat("numberOfSamples",r.numSampleFrames),this.metadata.setFormat("duration",r.numSampleFrames/r.sampleRate),this.metadata.setFormat("codec",null!==(t=r.compressionName)&&void 0!==t?t:d[r.compressionType]),e.chunkSize;case"ID3 ":const i=await this.tokenizer.readToken(new n.Uint8ArrayType(e.chunkSize)),o=a.fromBuffer(i);return await(new s.ID3v2Parser).parse(this.metadata,o,this.options),e.chunkSize;case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return h(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){return(await this.tokenizer.readToken(new n.StringType(e.chunkSize,"ascii"))).split("\0").map((e=>e.trim())).filter((e=>e&&e.length>0)).forEach((t=>{this.metadata.addTag("AIFF",e.chunkID,t.trim())})),e.chunkSize}}t.AIFFParser=f},8815:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AiffTagMapper=void 0;const n=r(9918),i={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class a extends n.CommonTagMapper{constructor(){super(["AIFF"],i)}}t.AiffTagMapper=a},1162:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Common=void 0;const n=r(3416),i=r(8049);t.Common=class{constructor(e,t){this.isAifc=t;const r=t?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,t){const r=e.readUInt16BE(t+8)-16398,a=e.readUInt16BE(t+8+2),s={numChannels:e.readUInt16BE(t),numSampleFrames:e.readUInt32BE(t+2),sampleSize:e.readUInt16BE(t+6),sampleRate:r<0?a>>Math.abs(r):a<<r};if(this.isAifc){if(s.compressionType=i.FourCcToken.get(e,t+18),this.len>22){const r=e.readInt8(t+22);if(r>0){if(23+r+(r+1)%2!==this.len)throw new Error("Illegal pstring length");s.compressionName=new n.StringType(r,"binary").get(e,t+23)}else s.compressionName=void 0}}else s.compressionName="PCM";return s}}},6742:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.APEv2Parser=void 0;const i=r(1227),a=r(5849),s=r(3416),o=r(3769),l=r(7805),c=r(876),u=(0,i.default)("music-metadata:parser:APEv2"),h="APEv2",d="APETAGEX";class f extends l.BasicParser{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,t,r){const n=new f;return n.init(e,t,r),n.tryParseApeHeader()}static calculateDuration(e){let t=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return t+=e.finalFrameBlocks,t/e.sampleRate}static async findApeFooterOffset(e,t){const r=n.alloc(c.TagFooter.len);await e.randomRead(r,0,c.TagFooter.len,t-c.TagFooter.len);const i=c.TagFooter.get(r,0);if("APETAGEX"===i.ID)return u(`APE footer header at offset=${t}`),{footer:i,offset:t-i.size}}static parseTagFooter(e,t,r){const n=c.TagFooter.get(t,t.length-c.TagFooter.len);if(n.ID!==d)throw new Error("Unexpected APEv2 Footer ID preamble value.");a.fromBuffer(t);const i=new f;return i.init(e,a.fromBuffer(t),r),i.parseTags(n)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<c.TagFooter.len)return void u("No APEv2 header found, end-of-file reached");const e=await this.tokenizer.peekToken(c.TagFooter);if(e.ID===d)return await this.tokenizer.ignore(c.TagFooter.len),this.parseTags(e);if(u(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position,t=n.alloc(e);return await this.tokenizer.readBuffer(t),f.parseTagFooter(this.metadata,t,this.options)}}async parse(){const e=await this.tokenizer.readToken(c.DescriptorParser);if("MAC "!==e.ID)throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const t=e.descriptorBytes-c.DescriptorParser.len,r=await(t>0?this.parseDescriptorExpansion(t):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const t=n.alloc(256);let r=e.size-c.TagFooter.len;u(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let i=0;i<e.fields;i++){if(r<c.TagItemHeader.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-i} items remaining, but no more tag data to read.`);break}const a=await this.tokenizer.readToken(c.TagItemHeader);r-=c.TagItemHeader.len+a.size,await this.tokenizer.peekBuffer(t,{length:Math.min(t.length,r)});let l=o.findZero(t,0,t.length);const d=await this.tokenizer.readToken(new s.StringType(l,"ascii"));switch(await this.tokenizer.ignore(1),r-=d.length+1,a.flags.dataType){case c.DataType.text_utf8:{const e=(await this.tokenizer.readToken(new s.StringType(a.size,"utf8"))).split(/\x00/g);for(const t of e)this.metadata.addTag(h,d,t);break}case c.DataType.binary:if(this.options.skipCovers)await this.tokenizer.ignore(a.size);else{const e=n.alloc(a.size);await this.tokenizer.readBuffer(e),l=o.findZero(e,0,e.length);const t=e.toString("utf8",0,l),r=n.from(e.slice(l+1));this.metadata.addTag(h,d,{description:t,data:r})}break;case c.DataType.external_info:u(`Ignore external info ${d}`),await this.tokenizer.ignore(a.size);break;case c.DataType.reserved:u(`Ignore external info ${d}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${d}"`),await this.tokenizer.ignore(a.size)}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(c.Header);return this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",f.calculateDuration(e)),{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}t.APEv2Parser=f},8414:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APEv2TagMapper=void 0;const n=r(4132),i={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class a extends n.CaseInsensitiveTagMap{constructor(){super(["APEv2"],i)}}t.APEv2TagMapper=a},876:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBitSet=t.parseTagFlags=t.TagField=t.TagItemHeader=t.TagFooter=t.Header=t.DescriptorParser=t.DataType=void 0;const n=r(3416),i=r(8049);var a;function s(e){return{containsHeader:o(e,31),containsFooter:o(e,30),isHeader:o(e,31),readOnly:o(e,0),dataType:(6&e)>>1}}function o(e,t){return 0!=(e&1<<t)}(a=t.DataType||(t.DataType={}))[a.text_utf8=0]="text_utf8",a[a.binary=1]="binary",a[a.external_info=2]="external_info",a[a.reserved=3]="reserved",t.DescriptorParser={len:52,get:(e,t)=>({ID:i.FourCcToken.get(e,t),version:n.UINT32_LE.get(e,t+4)/1e3,descriptorBytes:n.UINT32_LE.get(e,t+8),headerBytes:n.UINT32_LE.get(e,t+12),seekTableBytes:n.UINT32_LE.get(e,t+16),headerDataBytes:n.UINT32_LE.get(e,t+20),apeFrameDataBytes:n.UINT32_LE.get(e,t+24),apeFrameDataBytesHigh:n.UINT32_LE.get(e,t+28),terminatingDataBytes:n.UINT32_LE.get(e,t+32),fileMD5:new n.Uint8ArrayType(16).get(e,t+36)})},t.Header={len:24,get:(e,t)=>({compressionLevel:n.UINT16_LE.get(e,t),formatFlags:n.UINT16_LE.get(e,t+2),blocksPerFrame:n.UINT32_LE.get(e,t+4),finalFrameBlocks:n.UINT32_LE.get(e,t+8),totalFrames:n.UINT32_LE.get(e,t+12),bitsPerSample:n.UINT16_LE.get(e,t+16),channel:n.UINT16_LE.get(e,t+18),sampleRate:n.UINT32_LE.get(e,t+20)})},t.TagFooter={len:32,get:(e,t)=>({ID:new n.StringType(8,"ascii").get(e,t),version:n.UINT32_LE.get(e,t+8),size:n.UINT32_LE.get(e,t+12),fields:n.UINT32_LE.get(e,t+16),flags:s(n.UINT32_LE.get(e,t+20))})},t.TagItemHeader={len:8,get:(e,t)=>({size:n.UINT32_LE.get(e,t),flags:s(n.UINT32_LE.get(e,t+4))})},t.TagField=e=>new n.Uint8ArrayType(e.size-t.TagFooter.len),t.parseTagFlags=s,t.isBitSet=o},5174:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.WmPictureToken=t.MetadataLibraryObjectState=t.MetadataObjectState=t.ExtendedStreamPropertiesObjectState=t.ExtendedContentDescriptionObjectState=t.ContentDescriptionObjectState=t.readCodecEntries=t.HeaderExtensionObject=t.StreamPropertiesObject=t.FilePropertiesObject=t.IgnoreObjectState=t.State=t.HeaderObjectToken=t.TopLevelHeaderObjectToken=t.DataType=void 0;const i=r(3769),a=r(3416),s=r(8054),o=r(2252),l=r(8281);var c;(c=t.DataType||(t.DataType={}))[c.UnicodeString=0]="UnicodeString",c[c.ByteArray=1]="ByteArray",c[c.Bool=2]="Bool",c[c.DWord=3]="DWord",c[c.QWord=4]="QWord",c[c.Word=5]="Word",t.TopLevelHeaderObjectToken={len:30,get:(e,t)=>({objectId:s.default.fromBin(new a.BufferType(16).get(e,t)),objectSize:Number(a.UINT64_LE.get(e,t+16)),numberOfHeaderObjects:a.UINT32_LE.get(e,t+24)})},t.HeaderObjectToken={len:24,get:(e,t)=>({objectId:s.default.fromBin(new a.BufferType(16).get(e,t)),objectSize:Number(a.UINT64_LE.get(e,t+16))})};class u{constructor(e){this.len=Number(e.objectSize)-t.HeaderObjectToken.len}postProcessTag(e,t,r,n){if("WM/Picture"===t)e.push({id:t,value:E.fromBuffer(n)});else{const i=o.AsfUtil.getParserForAttr(r);if(!i)throw new Error("unexpected value headerType: "+r);e.push({id:t,value:i(n)})}}}t.State=u,t.IgnoreObjectState=class extends u{constructor(e){super(e)}get(e,t){return null}};class h extends u{constructor(e){super(e)}get(e,t){return{fileId:s.default.fromBin(e,t),fileSize:a.UINT64_LE.get(e,t+16),creationDate:a.UINT64_LE.get(e,t+24),dataPacketsCount:a.UINT64_LE.get(e,t+32),playDuration:a.UINT64_LE.get(e,t+40),sendDuration:a.UINT64_LE.get(e,t+48),preroll:a.UINT64_LE.get(e,t+56),flags:{broadcast:i.getBit(e,t+64,24),seekable:i.getBit(e,t+64,25)},minimumDataPacketSize:a.UINT32_LE.get(e,t+68),maximumDataPacketSize:a.UINT32_LE.get(e,t+72),maximumBitrate:a.UINT32_LE.get(e,t+76)}}}t.FilePropertiesObject=h,h.guid=s.default.FilePropertiesObject;class d extends u{constructor(e){super(e)}get(e,t){return{streamType:s.default.decodeMediaType(s.default.fromBin(e,t)),errorCorrectionType:s.default.fromBin(e,t+8)}}}t.StreamPropertiesObject=d,d.guid=s.default.StreamPropertiesObject;class f{constructor(){this.len=22}get(e,t){return{reserved1:s.default.fromBin(e,t),reserved2:e.readUInt16LE(t+16),extensionDataSize:e.readUInt32LE(t+18)}}}t.HeaderExtensionObject=f,f.guid=s.default.HeaderExtensionObject;const m={len:20,get:(e,t)=>({entryCount:e.readUInt16LE(t+16)})};async function p(e){const t=await e.readNumber(a.UINT16_LE);return(await e.readToken(new a.StringType(2*t,"utf16le"))).replace("\0","")}async function g(e){const t=await e.readNumber(a.UINT16_LE),r=n.alloc(t);return await e.readBuffer(r),r}async function A(e){const t=await e.readNumber(a.UINT16_LE);return{type:{videoCodec:1==(1&t),audioCodec:2==(2&t)},codecName:await p(e),description:await p(e),information:await g(e)}}t.readCodecEntries=async function(e){const t=await e.readToken(m),r=[];for(let n=0;n<t.entryCount;++n)r.push(await A(e));return r};class v extends u{constructor(e){super(e)}get(e,t){const r=[];let n=t+10;for(let i=0;i<v.contentDescTags.length;++i){const a=e.readUInt16LE(t+2*i);if(a>0){const t=v.contentDescTags[i],s=n+a;r.push({id:t,value:o.AsfUtil.parseUnicodeAttr(e.slice(n,s))}),n=s}}return r}}t.ContentDescriptionObjectState=v,v.guid=s.default.ContentDescriptionObject,v.contentDescTags=["Title","Author","Copyright","Description","Rating"];class b extends u{constructor(e){super(e)}get(e,t){const r=[],n=e.readUInt16LE(t);let i=t+2;for(let t=0;t<n;t+=1){const t=e.readUInt16LE(i);i+=2;const n=o.AsfUtil.parseUnicodeAttr(e.slice(i,i+t));i+=t;const a=e.readUInt16LE(i);i+=2;const s=e.readUInt16LE(i);i+=2;const l=e.slice(i,i+s);i+=s,this.postProcessTag(r,n,a,l)}return r}}t.ExtendedContentDescriptionObjectState=b,b.guid=s.default.ExtendedContentDescriptionObject;class y extends u{constructor(e){super(e)}get(e,t){return{startTime:a.UINT64_LE.get(e,t),endTime:a.UINT64_LE.get(e,t+8),dataBitrate:e.readInt32LE(t+12),bufferSize:e.readInt32LE(t+16),initialBufferFullness:e.readInt32LE(t+20),alternateDataBitrate:e.readInt32LE(t+24),alternateBufferSize:e.readInt32LE(t+28),alternateInitialBufferFullness:e.readInt32LE(t+32),maximumObjectSize:e.readInt32LE(t+36),flags:{reliableFlag:i.getBit(e,t+40,0),seekableFlag:i.getBit(e,t+40,1),resendLiveCleanpointsFlag:i.getBit(e,t+40,2)},streamNumber:e.readInt16LE(t+42),streamLanguageId:e.readInt16LE(t+44),averageTimePerFrame:e.readInt32LE(t+52),streamNameCount:e.readInt32LE(t+54),payloadExtensionSystems:e.readInt32LE(t+56),streamNames:[],streamPropertiesObject:null}}}t.ExtendedStreamPropertiesObjectState=y,y.guid=s.default.ExtendedStreamPropertiesObject;class w extends u{constructor(e){super(e)}get(e,t){const r=[],i=n.from(e),a=i.readUInt16LE(t);let s=t+2;for(let e=0;e<a;e+=1){s+=4;const e=i.readUInt16LE(s);s+=2;const t=i.readUInt16LE(s);s+=2;const n=i.readUInt32LE(s);s+=4;const a=o.AsfUtil.parseUnicodeAttr(i.slice(s,s+e));s+=e;const l=i.slice(s,s+n);s+=n,this.postProcessTag(r,a,t,l)}return r}}t.MetadataObjectState=w,w.guid=s.default.MetadataObject;class _ extends w{constructor(e){super(e)}}t.MetadataLibraryObjectState=_,_.guid=s.default.MetadataLibraryObject;class E{constructor(e){this.len=e}static fromBase64(e){return this.fromBuffer(n.from(e,"base64"))}static fromBuffer(e){return new E(e.length).get(e,0)}get(e,t){const r=e.readUInt8(t++),n=e.readInt32LE(t);let i=5;for(;0!==e.readUInt16BE(i);)i+=2;const a=e.slice(5,i).toString("utf16le");for(;0!==e.readUInt16BE(i);)i+=2;const s=e.slice(5,i).toString("utf16le");return{type:l.AttachedPictureType[r],format:a,description:s,size:n,data:e.slice(i+4)}}}t.WmPictureToken=E},1004:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsfParser=void 0;const n=r(1227),i=r(6032),a=r(8054),s=r(5174),o=r(7805),l=(0,n.default)("music-metadata:parser:ASF");class c extends o.BasicParser{async parse(){const e=await this.tokenizer.readToken(s.TopLevelHeaderObjectToken);if(!e.objectId.equals(a.default.HeaderObject))throw new Error("expected asf header; but was not found; got: "+e.objectId.str);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(e){l("Error while parsing ASF: %s",e)}}async parseObjectHeader(e){let t;do{const e=await this.tokenizer.readToken(s.HeaderObjectToken);switch(l("header GUID=%s",e.objectId.str),e.objectId.str){case s.FilePropertiesObject.guid.str:const r=await this.tokenizer.readToken(new s.FilePropertiesObject(e));this.metadata.setFormat("duration",Number(r.playDuration/BigInt(1e3))/1e4-Number(r.preroll)/1e3),this.metadata.setFormat("bitrate",r.maximumBitrate);break;case s.StreamPropertiesObject.guid.str:const n=await this.tokenizer.readToken(new s.StreamPropertiesObject(e));this.metadata.setFormat("container","ASF/"+n.streamType);break;case s.HeaderExtensionObject.guid.str:const o=await this.tokenizer.readToken(new s.HeaderExtensionObject);await this.parseExtensionObject(o.extensionDataSize);break;case s.ContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new s.ContentDescriptionObjectState(e)),this.addTags(t);break;case s.ExtendedContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new s.ExtendedContentDescriptionObjectState(e)),this.addTags(t);break;case a.default.CodecListObject.str:const c=await s.readCodecEntries(this.tokenizer);c.forEach((e=>{this.metadata.addStreamInfo({type:e.type.videoCodec?i.TrackType.video:i.TrackType.audio,codecName:e.codecName})}));const u=c.filter((e=>e.type.audioCodec)).map((e=>e.codecName)).join("/");this.metadata.setFormat("codec",u);break;case a.default.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(e.objectSize-s.HeaderObjectToken.len);break;case a.default.PaddingObject.str:l("Padding: %s bytes",e.objectSize-s.HeaderObjectToken.len),await this.tokenizer.ignore(e.objectSize-s.HeaderObjectToken.len);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+e.objectId.str),l("Ignore ASF-Object-GUID: %s",e.objectId.str),await this.tokenizer.readToken(new s.IgnoreObjectState(e))}}while(--e)}addTags(e){e.forEach((e=>{this.metadata.addTag("asf",e.id,e.value)}))}async parseExtensionObject(e){do{const t=await this.tokenizer.readToken(s.HeaderObjectToken),r=t.objectSize-s.HeaderObjectToken.len;switch(t.objectId.str){case s.ExtendedStreamPropertiesObjectState.guid.str:await this.tokenizer.readToken(new s.ExtendedStreamPropertiesObjectState(t));break;case s.MetadataObjectState.guid.str:const e=await this.tokenizer.readToken(new s.MetadataObjectState(t));this.addTags(e);break;case s.MetadataLibraryObjectState.guid.str:const n=await this.tokenizer.readToken(new s.MetadataLibraryObjectState(t));this.addTags(n);break;case a.default.PaddingObject.str:await this.tokenizer.ignore(r);break;case a.default.CompatibilityObject.str:this.tokenizer.ignore(r);break;case a.default.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+t.objectId.str),await this.tokenizer.readToken(new s.IgnoreObjectState(t))}e-=t.objectSize}while(e>0)}}t.AsfParser=c},9004:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsfTagMapper=void 0;const n=r(9918),i={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class a extends n.CommonTagMapper{static toRating(e){return{rating:parseFloat(e+1)/5}}constructor(){super(["asf"],i)}postMap(e){if("WM/SharedUserRating"===e.id){const t=e.id.split(":");e.value=a.toRating(e.value),e.id=t[0]}}}t.AsfTagMapper=a},2252:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AsfUtil=void 0;const i=r(3416),a=r(3769);class s{static getParserForAttr(e){return s.attributeParsers[e]}static parseUnicodeAttr(e){return a.stripNulls(a.decodeString(e,"utf16le"))}static parseByteArrayAttr(e){return n.from(e)}static parseBoolAttr(e,t=0){return 1===s.parseWordAttr(e,t)}static parseDWordAttr(e,t=0){return e.readUInt32LE(t)}static parseQWordAttr(e,t=0){return i.UINT64_LE.get(e,t)}static parseWordAttr(e,t=0){return e.readUInt16LE(t)}}t.AsfUtil=s,s.attributeParsers=[s.parseUnicodeAttr,s.parseByteArrayAttr,s.parseBoolAttr,s.parseDWordAttr,s.parseQWordAttr,s.parseWordAttr,s.parseByteArrayAttr]},8054:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.str=e}static fromBin(e,t=0){return new i(this.decode(e,t))}static decode(e,t=0){return(e.readUInt32LE(t).toString(16)+"-"+e.readUInt16LE(t+4).toString(16)+"-"+e.readUInt16LE(t+6).toString(16)+"-"+e.readUInt16BE(t+8).toString(16)+"-"+e.slice(t+10,t+16).toString("hex")).toUpperCase()}static decodeMediaType(e){switch(e.str){case i.AudioMedia.str:return"audio";case i.VideoMedia.str:return"video";case i.CommandMedia.str:return"command";case i.Degradable_JPEG_Media.str:return"degradable-jpeg";case i.FileTransferMedia.str:return"file-transfer";case i.BinaryMedia.str:return"binary"}}static encode(e){const t=n.alloc(16);return t.writeUInt32LE(parseInt(e.slice(0,8),16),0),t.writeUInt16LE(parseInt(e.slice(9,13),16),4),t.writeUInt16LE(parseInt(e.slice(14,18),16),6),n.from(e.slice(19,23),"hex").copy(t,8),n.from(e.slice(24),"hex").copy(t,10),t}equals(e){return this.str===e.str}toBin(){return i.encode(this.str)}}t.default=i,i.HeaderObject=new i("75B22630-668E-11CF-A6D9-00AA0062CE6C"),i.DataObject=new i("75B22636-668E-11CF-A6D9-00AA0062CE6C"),i.SimpleIndexObject=new i("33000890-E5B1-11CF-89F4-00A0C90349CB"),i.IndexObject=new i("D6E229D3-35DA-11D1-9034-00A0C90349BE"),i.MediaObjectIndexObject=new i("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C"),i.TimecodeIndexObject=new i("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C"),i.FilePropertiesObject=new i("8CABDCA1-A947-11CF-8EE4-00C00C205365"),i.StreamPropertiesObject=new i("B7DC0791-A9B7-11CF-8EE6-00C00C205365"),i.HeaderExtensionObject=new i("5FBF03B5-A92E-11CF-8EE3-00C00C205365"),i.CodecListObject=new i("86D15240-311D-11D0-A3A4-00A0C90348F6"),i.ScriptCommandObject=new i("1EFB1A30-0B62-11D0-A39B-00A0C90348F6"),i.MarkerObject=new i("F487CD01-A951-11CF-8EE6-00C00C205365"),i.BitrateMutualExclusionObject=new i("D6E229DC-35DA-11D1-9034-00A0C90349BE"),i.ErrorCorrectionObject=new i("75B22635-668E-11CF-A6D9-00AA0062CE6C"),i.ContentDescriptionObject=new i("75B22633-668E-11CF-A6D9-00AA0062CE6C"),i.ExtendedContentDescriptionObject=new i("D2D0A440-E307-11D2-97F0-00A0C95EA850"),i.ContentBrandingObject=new i("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E"),i.StreamBitratePropertiesObject=new i("7BF875CE-468D-11D1-8D82-006097C9A2B2"),i.ContentEncryptionObject=new i("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E"),i.ExtendedContentEncryptionObject=new i("298AE614-2622-4C17-B935-DAE07EE9289C"),i.DigitalSignatureObject=new i("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E"),i.PaddingObject=new i("1806D474-CADF-4509-A4BA-9AABCB96AAE8"),i.ExtendedStreamPropertiesObject=new i("14E6A5CB-C672-4332-8399-A96952065B5A"),i.AdvancedMutualExclusionObject=new i("A08649CF-4775-4670-8A16-6E35357566CD"),i.GroupMutualExclusionObject=new i("D1465A40-5A79-4338-B71B-E36B8FD6C249"),i.StreamPrioritizationObject=new i("D4FED15B-88D3-454F-81F0-ED5C45999E24"),i.BandwidthSharingObject=new i("A69609E6-517B-11D2-B6AF-00C04FD908E9"),i.LanguageListObject=new i("7C4346A9-EFE0-4BFC-B229-393EDE415C85"),i.MetadataObject=new i("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA"),i.MetadataLibraryObject=new i("44231C94-9498-49D1-A141-1D134E457054"),i.IndexParametersObject=new i("D6E229DF-35DA-11D1-9034-00A0C90349BE"),i.MediaObjectIndexParametersObject=new i("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7"),i.TimecodeIndexParametersObject=new i("F55E496D-9797-4B5D-8C8B-604DFE9BFB24"),i.CompatibilityObject=new i("26F18B5D-4584-47EC-9F5F-0E651F0452C9"),i.AdvancedContentEncryptionObject=new i("43058533-6981-49E6-9B74-AD12CB86D58C"),i.AudioMedia=new i("F8699E40-5B4D-11CF-A8FD-00805F5C442B"),i.VideoMedia=new i("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B"),i.CommandMedia=new i("59DACFC0-59E6-11D0-A3AC-00A0C90348F6"),i.JFIF_Media=new i("B61BE100-5B4E-11CF-A8FD-00805F5C442B"),i.Degradable_JPEG_Media=new i("35907DE0-E415-11CF-A917-00805F5C442B"),i.FileTransferMedia=new i("91BD222C-F21C-497A-8B6D-5AA86BFC0185"),i.BinaryMedia=new i("3AFB65E2-47EF-40F2-AC2C-70A90D71D343"),i.ASF_Index_Placeholder_Object=new i("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2")},7805:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasicParser=void 0,t.BasicParser=class{init(e,t,r){return this.metadata=e,this.tokenizer=t,this.options=r,this}}},4132:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CaseInsensitiveTagMap=void 0;const n=r(9918);class i extends n.CommonTagMapper{constructor(e,t){const r={};for(const e of Object.keys(t))r[e.toUpperCase()]=t[e];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}t.CaseInsensitiveTagMap=i},6592:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedTagMapper=void 0;const n=r(2939),i=r(4005),a=r(9004),s=r(7183),o=r(8414),l=r(7852),c=r(9860),u=r(5756),h=r(5481),d=r(8815);t.CombinedTagMapper=class{constructor(){this.tagMappers={},[new n.ID3v1TagMapper,new s.ID3v22TagMapper,new i.ID3v24TagMapper,new l.MP4TagMapper,new l.MP4TagMapper,new c.VorbisTagMapper,new o.APEv2TagMapper,new a.AsfTagMapper,new u.RiffInfoTagMapper,new h.MatroskaTagMapper,new d.AiffTagMapper].forEach((e=>{this.registerTagMapper(e)}))}mapTag(e,t,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(t,r);throw new Error("No generic tag mapper defined for tag-format: "+e)}registerTagMapper(e){for(const t of e.tagTypes)this.tagMappers[t]=e}}},8049:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.FourCcToken=void 0;const i=r(3769),a=/^[\x21-\x7e][\x20-\x7e\x00()]{3}/;t.FourCcToken={len:4,get:(e,r)=>{const n=e.toString("binary",r,r+t.FourCcToken.len);if(!n.match(a))throw new Error(`FourCC contains invalid characters: ${i.a2hex(n)} "${n}"`);return n},put:(e,t,r)=>{const i=n.from(r,"binary");if(4!==i.length)throw new Error("Invalid length");return i.copy(e,t)}}},9918:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommonTagMapper=void 0;class r{constructor(e,t){this.tagTypes=e,this.tagMap=t}static toIntOrNull(e){const t=parseInt(e,10);return isNaN(t)?null:t}static normalizeTrack(e){const t=e.toString().split("/");return{no:parseInt(t[0],10)||null,of:parseInt(t[1],10)||null}}mapGenericTag(e,t){e={id:e.id,value:e.value},this.postMap(e,t);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,t){}}t.CommonTagMapper=r,r.maxRatingScore=1},103:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUnique=t.isSingleton=t.commonTags=void 0,t.commonTags={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}},t.isSingleton=function(e){return t.commonTags.hasOwnProperty(e)&&!t.commonTags[e].multiple},t.isUnique=function(e){return!t.commonTags[e].multiple||t.commonTags[e].unique}},7584:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.joinArtists=t.MetadataCollector=void 0;const n=r(6032),i=r(1227),a=r(103),s=r(6592),o=r(9918),l=r(3769),c=r(1),u=(0,i.default)("music-metadata:collector"),h=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];function d(e){return e.length>2?e.slice(0,e.length-1).join(", ")+" & "+e[e.length-1]:e.join(" & ")}t.MetadataCollector=class{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new s.CombinedTagMapper;let t=1;for(const e of h)this.originPriority[e]=t++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){u(`streamInfo: type=${n.TrackType[e.type]}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,t){u(`format: ${e} = ${t}`),this.format[e]=t,this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:t}})}addTag(e,t,r){u(`tag ${e}.${t} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:t,value:r}),this.toCommon(e,t,r)}addWarning(e){this.quality.warnings.push({message:e})}postMap(e,t){switch(t.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:t.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:t.value});break;case"artists":if(!(this.common.artist&&this.commonOrigin.artist!==this.originPriority.artificial||this.common.artists&&-1!==this.common.artists.indexOf(t.value))){const e={id:"artist",value:d((this.common.artists||[]).concat([t.value]))};this.setGenericTag("artificial",e)}break;case"picture":return void this.postFixPicture(t.value).then((r=>{null!==r&&(t.value=r,this.setGenericTag(e,t))}));case"totaltracks":return void(this.common.track.of=o.CommonTagMapper.toIntOrNull(t.value));case"totaldiscs":return void(this.common.disk.of=o.CommonTagMapper.toIntOrNull(t.value));case"movementTotal":return void(this.common.movementIndex.of=o.CommonTagMapper.toIntOrNull(t.value));case"track":case"disk":case"movementIndex":const r=this.common[t.id].of;return this.common[t.id]=o.CommonTagMapper.normalizeTrack(t.value),void(this.common[t.id].of=null!=r?r:this.common[t.id].of);case"bpm":case"year":case"originalyear":t.value=parseInt(t.value,10);break;case"date":const n=parseInt(t.value.substr(0,4),10);isNaN(n)||(this.common.year=n);break;case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":t.value="string"==typeof t.value?parseInt(t.value,10):t.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":t.value=(0,l.toRatio)(t.value);break;case"replaygain_track_minmax":t.value=t.value.split(",").map((e=>parseInt(e,10)));break;case"replaygain_undo":const i=t.value.split(",").map((e=>parseInt(e,10)));t.value={leftChannel:i[0],rightChannel:i[1]};break;case"gapless":case"compilation":case"podcast":case"showMovement":t.value="1"===t.value||1===t.value;break;case"isrc":if(this.common[t.id]&&-1!==this.common[t.id].indexOf(t.value))return}null!==t.value&&this.setGenericTag(e,t)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const t=await c.fromBuffer(e.data);if(!t)return null;e.format=t.mime}return e.format=e.format.toLocaleLowerCase(),"image/jpg"===e.format&&(e.format="image/jpeg"),e}return this.addWarning("Empty picture tag found"),null}toCommon(e,t,r){const n={id:t,value:r},i=this.tagMapper.mapTag(e,n,this);i&&this.postMap(e,i)}setGenericTag(e,t){u(`common.${t.id} = ${t.value}`);const r=this.commonOrigin[t.id]||1e3,n=this.originPriority[e];if((0,a.isSingleton)(t.id)){if(!(n<=r))return u(`Ignore native tag (singleton): ${e}.${t.id} = ${t.value}`);this.common[t.id]=t.value,this.commonOrigin[t.id]=n}else if(n===r)(0,a.isUnique)(t.id)&&-1!==this.common[t.id].indexOf(t.value)?u(`Ignore duplicate value: ${e}.${t.id} = ${t.value}`):this.common[t.id].push(t.value);else{if(!(n<r))return u(`Ignore native tag (list): ${e}.${t.id} = ${t.value}`);this.common[t.id]=[t.value],this.commonOrigin[t.id]=n}this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:t.id,value:t.value}})}},t.joinArtists=d},9461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomUint8ArrayReader=void 0,t.RandomUint8ArrayReader=class{constructor(e){this.uint8Array=e,this.fileSize=e.length}async randomRead(e,t,r,n){return e.set(this.uint8Array.subarray(n,n+r),t),r}}},3769:(e,t,r)=>{"use strict";var n=r(8764).Buffer;function i(e,t,r,n){const a=r%8;let s=e[t+~~(r/8)];s&=255>>a;const o=8-a,l=n-o;return l<0?s>>=8-a-n:l>0&&(s<<=l,s|=i(e,t,r+o,l)),s}function a(e){return 10*Math.log10(e)}function s(e){return Math.pow(10,e/10)}Object.defineProperty(t,"__esModule",{value:!0}),t.toRatio=t.dbToRatio=t.ratioToDb=t.a2hex=t.isBitSet=t.getBitAllignedNumber=t.stripNulls=t.decodeString=t.trimRightNull=t.findZero=t.getBit=void 0,t.getBit=function(e,t,r){return 0!=(e[t]&1<<r)},t.findZero=function(e,t,r,n){let i=t;if("utf16le"===n){for(;0!==e[i]||0!==e[i+1];){if(i>=r)return r;i+=2}return i}for(;0!==e[i];){if(i>=r)return r;i++}return i},t.trimRightNull=function(e){const t=e.indexOf("\0");return-1===t?e:e.substr(0,t)},t.decodeString=function e(t,r){if(255===t[0]&&254===t[1])return e(t.subarray(2),r);if("utf16le"===r&&254===t[0]&&255===t[1]){if(0!=(1&t.length))throw new Error("Expected even number of octets for 16-bit unicode string");return e(function(e){const t=e.length;if(0!=(1&t))throw new Error("Buffer length must be even");for(let r=0;r<t;r+=2){const t=e[r];e[r]=e[r+1],e[r+1]=t}return e}(t),r)}return n.from(t).toString(r)},t.stripNulls=function(e){return(e=e.replace(/^\x00+/g,"")).replace(/\x00+$/g,"")},t.getBitAllignedNumber=i,t.isBitSet=function(e,t,r){return 1===i(e,t,r,1)},t.a2hex=function(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=Number(e.charCodeAt(r)).toString(16);t.push(1===n.length?"0"+n:n)}return t.join(" ")},t.ratioToDb=a,t.dbToRatio=s,t.toRatio=function(e){const t=e.split(" ").map((e=>e.trim().toLowerCase()));if(t.length>=1){const e=parseFloat(t[0]);return 2===t.length&&"db"===t[1]?{dB:e,ratio:s(e)}:{dB:a(e),ratio:e}}}},523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanAppendingHeaders=t.selectCover=t.ratingToStars=t.orderTags=t.parseFromTokenizer=t.parseBuffer=t.parseStream=void 0;const n=r(5849),i=r(3275),a=r(9461),s=r(6742),o=r(2282),l=r(9941);function c(e,t){return i.ParserFactory.parseOnContentType(e,t)}async function u(e,t={}){let r=e.fileSize;await(0,o.hasID3v1Header)(e)&&(r-=128,r-=await(0,l.getLyricsHeaderLength)(e)),t.apeHeader=await s.APEv2Parser.findApeFooterOffset(e,r)}t.parseStream=function(e,t,r={}){return c(n.fromStream(e,"string"==typeof t?{mimeType:t}:t),r)},t.parseBuffer=async function(e,t,r={}){const i=new a.RandomUint8ArrayReader(e);return await u(i,r),c(n.fromBuffer(e,"string"==typeof t?{mimeType:t}:t),r)},t.parseFromTokenizer=c,t.orderTags=function(e){const t={};for(const r of e)(t[r.id]=t[r.id]||[]).push(r.value);return t},t.ratingToStars=function(e){return void 0===e?0:1+Math.round(4*e)},t.selectCover=function(e){return e?e.reduce(((e,t)=>t.name&&t.name.toLowerCase()in["front","cover","cover (front)"]?t:e)):null},t.scanAppendingHeaders=u},6789:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DsdiffParser=void 0;const n=r(3416),i=r(1227),a=r(5849),s=r(8049),o=r(7805),l=r(8928),c=r(9187),u=(0,i.default)("music-metadata:parser:aiff");class h extends o.BasicParser{async parse(){const e=await this.tokenizer.readToken(c.ChunkHeader64);if("FRM8"!==e.chunkID)throw new Error("Unexpected chunk-ID");const t=(await this.tokenizer.readToken(s.FourCcToken)).trim();if("DSD"===t)return this.metadata.setFormat("container",`DSDIFF/${t}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(s.FourCcToken.len));throw Error(`Unsupported DSDIFF type: ${t}`)}async readFmt8Chunks(e){for(;e>=c.ChunkHeader64.len;){const t=await this.tokenizer.readToken(c.ChunkHeader64);u(`Chunk id=${t.chunkID}`),await this.readData(t),e-=BigInt(c.ChunkHeader64.len)+t.chunkSize}}async readData(e){u(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const t=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":const t=await this.tokenizer.readToken(n.UINT32_LE);u(`DSDIFF version=${t}`);break;case"PROP":if("SND "!==await this.tokenizer.readToken(s.FourCcToken))throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(s.FourCcToken.len));break;case"ID3":const r=await this.tokenizer.readToken(new n.Uint8ArrayType(Number(e.chunkSize))),i=a.fromBuffer(r);await(new l.ID3v2Parser).parse(this.metadata,i,this.options);break;default:u(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break;case"DSD":this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate)}const r=e.chunkSize-BigInt(this.tokenizer.position-t);r>0&&(u(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(u(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const t=await this.tokenizer.readToken(c.ChunkHeader64);u(`Sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`);const r=this.tokenizer.position;switch(t.chunkID.trim()){case"FS":const e=await this.tokenizer.readToken(n.UINT32_BE);this.metadata.setFormat("sampleRate",e);break;case"CHNL":const r=await this.tokenizer.readToken(n.UINT16_BE);this.metadata.setFormat("numberOfChannels",r),await this.handleChannelChunks(t.chunkSize-BigInt(n.UINT16_BE.len));break;case"CMPR":const i=(await this.tokenizer.readToken(s.FourCcToken)).trim(),a=await this.tokenizer.readToken(n.UINT8),o=await this.tokenizer.readToken(new n.StringType(a,"ascii"));"DSD"===i&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${o})`);break;case"ABSS":const l=await this.tokenizer.readToken(n.UINT16_BE),c=await this.tokenizer.readToken(n.UINT8),h=await this.tokenizer.readToken(n.UINT8),d=await this.tokenizer.readToken(n.UINT32_BE);u(`ABSS ${l}:${c}:${h}.${d}`);break;case"LSCO":const f=await this.tokenizer.readToken(n.UINT16_BE);u(`LSCO lsConfig=${f}`);break;default:u(`Unknown sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`),await this.tokenizer.ignore(Number(t.chunkSize))}const i=t.chunkSize-BigInt(this.tokenizer.position-r);i>0&&(u(`After Parsing sound-property-chunk ${t.chunkSize}, remaining ${i} bytes`),await this.tokenizer.ignore(Number(i))),e-=BigInt(c.ChunkHeader64.len)+t.chunkSize,u(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const e=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",e)}}async handleChannelChunks(e){u(`Parsing channel-chunks, remainingSize=${e}`);const t=[];for(;e>=s.FourCcToken.len;){const r=await this.tokenizer.readToken(s.FourCcToken);u(`Channel[ID=${r}]`),t.push(r),e-=BigInt(s.FourCcToken.len)}return u(`Channels: ${t.join(", ")}`),t}}t.DsdiffParser=h},9187:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChunkHeader64=void 0;const n=r(3416),i=r(8049);t.ChunkHeader64={len:12,get:(e,t)=>({chunkID:i.FourCcToken.get(e,t),chunkSize:n.INT64_BE.get(e,t+4)})}},4101:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormatChunk=t.ChannelType=t.DsdChunk=t.ChunkHeader=void 0;const n=r(3416),i=r(8049);var a;t.ChunkHeader={len:12,get:(e,t)=>({id:i.FourCcToken.get(e,t),size:n.UINT64_LE.get(e,t+4)})},t.DsdChunk={len:16,get:(e,t)=>({fileSize:n.INT64_LE.get(e,t),metadataPointer:n.INT64_LE.get(e,t+8)})},(a=t.ChannelType||(t.ChannelType={}))[a.mono=1]="mono",a[a.stereo=2]="stereo",a[a.channels=3]="channels",a[a.quad=4]="quad",a[a["4 channels"]=5]="4 channels",a[a["5 channels"]=6]="5 channels",a[a["5.1 channels"]=7]="5.1 channels",t.FormatChunk={len:40,get:(e,t)=>({formatVersion:n.INT32_LE.get(e,t),formatID:n.INT32_LE.get(e,t+4),channelType:n.INT32_LE.get(e,t+8),channelNum:n.INT32_LE.get(e,t+12),samplingFrequency:n.INT32_LE.get(e,t+16),bitsPerSample:n.INT32_LE.get(e,t+20),sampleCount:n.INT64_LE.get(e,t+24),blockSizePerChannel:n.INT32_LE.get(e,t+32)})}},1533:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DsfParser=void 0;const n=r(1227),i=r(5159),a=r(4101),s=r(8928),o=(0,n.default)("music-metadata:parser:DSF");class l extends i.AbstractID3Parser{async postId3v2Parse(){const e=this.tokenizer.position,t=await this.tokenizer.readToken(a.ChunkHeader);if("DSD "!==t.id)throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(a.DsdChunk);if(r.metadataPointer!==BigInt(0))return o(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-t.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),(new s.ID3v2Parser).parse(this.metadata,this.tokenizer,this.options);o("No ID3v2 tag present")}async parseChunks(e){for(;e>=a.ChunkHeader.len;){const t=await this.tokenizer.readToken(a.ChunkHeader);if(o(`Parsing chunk name=${t.id} size=${t.size}`),"fmt "===t.id){const e=await this.tokenizer.readToken(a.FormatChunk);this.metadata.setFormat("numberOfChannels",e.channelNum),this.metadata.setFormat("sampleRate",e.samplingFrequency),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("numberOfSamples",e.sampleCount),this.metadata.setFormat("duration",Number(e.sampleCount)/e.samplingFrequency);const t=e.bitsPerSample*e.samplingFrequency*e.channelNum;return void this.metadata.setFormat("bitrate",t)}this.tokenizer.ignore(Number(t.size)-a.ChunkHeader.len),e-=t.size}}}t.DsfParser=l},498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlacParser=void 0;const n=r(3416),i=r(1227),a=r(3769),s=r(2127),o=r(5159),l=r(8049),c=r(4210),u=r(441),h=(0,i.default)("music-metadata:parser:FLAC");var d;!function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.PADDING=1]="PADDING",e[e.APPLICATION=2]="APPLICATION",e[e.SEEKTABLE=3]="SEEKTABLE",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.CUESHEET=5]="CUESHEET",e[e.PICTURE=6]="PICTURE"}(d||(d={}));class f extends o.AbstractID3Parser{constructor(){super(...arguments),this.padding=0}init(e,t,r){return super.init(e,t,r),this.vorbisParser=new c.VorbisParser(e,r),this}async postId3v2Parse(){if("fLaC"!==(await this.tokenizer.readToken(l.FourCcToken)).toString())throw new Error("Invalid FLAC preamble");let e;do{e=await this.tokenizer.readToken(m.BlockHeader),await this.parseDataBlock(e)}while(!e.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}parseDataBlock(e){switch(h(`blockHeader type=${e.type}, length=${e.length}`),e.type){case d.STREAMINFO:return this.parseBlockStreamInfo(e.length);case d.PADDING:this.padding+=e.length;break;case d.APPLICATION:case d.SEEKTABLE:break;case d.VORBIS_COMMENT:return this.parseComment(e.length);case d.CUESHEET:break;case d.PICTURE:return this.parsePicture(e.length).then();default:this.metadata.addWarning("Unknown block type: "+e.type)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==m.BlockStreamInfo.len)throw new Error("Unexpected block-stream-info length");const t=await this.tokenizer.readToken(m.BlockStreamInfo);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",t.channels),this.metadata.setFormat("bitsPerSample",t.bitsPerSample),this.metadata.setFormat("sampleRate",t.sampleRate),t.totalSamples>0&&this.metadata.setFormat("duration",t.totalSamples/t.sampleRate)}async parseComment(e){const t=await this.tokenizer.readToken(new n.Uint8ArrayType(e)),r=new u.VorbisDecoder(t,0);r.readStringUtf8();const i=r.readInt32();for(let e=0;e<i;e++){const e=r.parseUserComment();this.vorbisParser.addTag(e.key,e.value)}}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);{const t=await this.tokenizer.readToken(new s.VorbisPictureToken(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",t)}}}t.FlacParser=f;class m{}m.BlockHeader={len:4,get:(e,t)=>({lastBlock:a.getBit(e,t,7),type:a.getBitAllignedNumber(e,t,1,7),length:n.UINT24_BE.get(e,t+1)})},m.BlockStreamInfo={len:34,get:(e,t)=>({minimumBlockSize:n.UINT16_BE.get(e,t),maximumBlockSize:n.UINT16_BE.get(e,t+2)/1e3,minimumFrameSize:n.UINT24_BE.get(e,t+4),maximumFrameSize:n.UINT24_BE.get(e,t+7),sampleRate:n.UINT24_BE.get(e,t+10)>>4,channels:a.getBitAllignedNumber(e,t+12,4,3)+1,bitsPerSample:a.getBitAllignedNumber(e,t+12,7,5)+1,totalSamples:a.getBitAllignedNumber(e,t+13,4,36),fileMD5:new n.Uint8ArrayType(16).get(e,t+18)})}},2282:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.hasID3v1Header=t.ID3v1Parser=t.Genres=void 0;const i=r(1227),a=r(3416),s=r(3769),o=r(7805),l=r(6742),c=(0,i.default)("music-metadata:parser:ID3v1");t.Genres=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"];const u={len:128,get:(e,t)=>{const r=new h(3).get(e,t);return"TAG"===r?{header:r,title:new h(30).get(e,t+3),artist:new h(30).get(e,t+33),album:new h(30).get(e,t+63),year:new h(4).get(e,t+93),comment:new h(28).get(e,t+97),zeroByte:a.UINT8.get(e,t+127),track:a.UINT8.get(e,t+126),genre:a.UINT8.get(e,t+127)}:null}};class h extends a.StringType{constructor(e){super(e,"binary")}get(e,t){let r=super.get(e,t);return r=s.trimRightNull(r),r=r.trim(),r.length>0?r:void 0}}class d extends o.BasicParser{static getGenre(e){if(e<t.Genres.length)return t.Genres[e]}async parse(){if(!this.tokenizer.fileInfo.size)return void c("Skip checking for ID3v1 because the file-size is unknown");if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const e=new l.APEv2Parser;e.init(this.metadata,this.tokenizer,this.options),await e.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-u.len;if(this.tokenizer.position>e)return void c("Already consumed the last 128 bytes");const t=await this.tokenizer.readToken(u,e);if(t){c("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-u.len);for(const e of["title","artist","album","comment","track","year"])t[e]&&""!==t[e]&&this.addTag(e,t[e]);const e=d.getGenre(t.genre);e&&this.addTag("genre",e)}else c("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-u.len)}addTag(e,t){this.metadata.addTag("ID3v1",e,t)}}t.ID3v1Parser=d,t.hasID3v1Header=async function(e){if(e.fileSize>=128){const t=n.alloc(3);return await e.randomRead(t,0,t.length,e.fileSize-128),"TAG"===t.toString("binary")}return!1}},2939:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v1TagMapper=void 0;const n=r(9918),i={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class a extends n.CommonTagMapper{constructor(){super(["ID3v1"],i)}}t.ID3v1TagMapper=a},5159:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractID3Parser=void 0;const n=r(5849),i=r(1227),a=r(8281),s=r(8928),o=r(2282),l=r(7805),c=(0,i.default)("music-metadata:parser:ID3");class u extends l.BasicParser{constructor(){super(...arguments),this.id3parser=new s.ID3v2Parser}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(a.ID3v2Header)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof n.EndOfStreamError))throw e;c("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),c("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new o.ID3v1Parser;await e.init(this.metadata,this.tokenizer,this.options).parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(a.ID3v2Header)).fileIdentifier)return c("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}t.AbstractID3Parser=u},907:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.FrameParser=t.parseGenre=void 0;const i=r(1227),a=r(3416),s=r(3769),o=r(8281),l=r(2282),c=(0,i.default)("music-metadata:id3v2:frame-parser"),u="latin1";function h(e){const t=[];let r,n="";for(const i of e)if("string"==typeof r)if("("===i&&""===r)n+="(",r=void 0;else if(")"===i){""!==n&&(t.push(n),n="");const e=d(r);e&&t.push(e),r=void 0}else r+=i;else"("===i?r="":n+=i;return n&&(0===t.length&&n.match(/^\d*$/)&&(n=l.Genres[n]),t.push(n)),t}function d(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?l.Genres[e]:void 0}t.parseGenre=h;class f{constructor(e,t){this.major=e,this.warningCollector=t}readData(e,t,r){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${t}`);const{encoding:i,bom:l}=o.TextEncodingToken.get(e,0),d=e.length;let m=0,p=[];const g=f.getNullTerminatorLength(i);let A;const v={};switch(c(`Parsing tag type=${t}, encoding=${i}, bom=${l}`),"TXXX"!==t&&"T"===t[0]?"T*":t){case"T*":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":let l;try{l=s.decodeString(e.slice(1),i).replace(/\x00+$/,"")}catch(e){this.warningCollector.addWarning(`id3v2.${this.major} type=${t} header has invalid string value: ${e.message}`)}switch(t){case"TMCL":case"TIPL":case"IPLS":p=this.splitValue(t,l),p=f.functionList(p);break;case"TRK":case"TRCK":case"TPOS":p=l;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":p=this.splitValue(t,l);break;case"TCO":case"TCON":p=this.splitValue(t,l).map((e=>h(e))).reduce(((e,t)=>e.concat(t)),[]);break;case"PCS":case"PCST":p=this.major>=4?this.splitValue(t,l):[l],p=Array.isArray(p)&&""===p[0]?1:0;break;default:p=this.major>=4?this.splitValue(t,l):[l]}break;case"TXXX":p=f.readIdentifierAndData(e,m+1,d,i),p={description:p.id,text:this.splitValue(t,s.decodeString(p.data,i).replace(/\x00+$/,""))};break;case"PIC":case"APIC":if(r){const t={};switch(m+=1,this.major){case 2:t.format=s.decodeString(e.slice(m,m+3),"latin1"),m+=3;break;case 3:case 4:A=s.findZero(e,m,d,u),t.format=s.decodeString(e.slice(m,A),u),m=A+1;break;default:throw new Error("Warning: unexpected major versionIndex: "+this.major)}t.format=f.fixPictureMimeType(t.format),t.type=o.AttachedPictureType[e[m]],m+=1,A=s.findZero(e,m,d,i),t.description=s.decodeString(e.slice(m,A),i),m=A+g,t.data=n.from(e.slice(m,d)),p=t}break;case"CNT":case"PCNT":p=a.UINT32_BE.get(e,0);break;case"SYLT":for(m+=7,p=[];m<d;){const t=e.slice(m,m=s.findZero(e,m,d,i));m+=5,p.push(s.decodeString(t,i))}break;case"ULT":case"USLT":case"COM":case"COMM":m+=1,v.language=s.decodeString(e.slice(m,m+3),u),m+=3,A=s.findZero(e,m,d,i),v.description=s.decodeString(e.slice(m,A),i),m=A+g,v.text=s.decodeString(e.slice(m,d),i).replace(/\x00+$/,""),p=[v];break;case"UFID":p=f.readIdentifierAndData(e,m,d,u),p={owner_identifier:p.id,identifier:p.data};break;case"PRIV":p=f.readIdentifierAndData(e,m,d,u),p={owner_identifier:p.id,data:p.data};break;case"POPM":A=s.findZero(e,m,d,u);const b=s.decodeString(e.slice(m,A),u);m=A+1;const y=d-m;p={email:b,rating:a.UINT8.get(e,m),counter:y>=5?a.UINT32_BE.get(e,m+1):void 0};break;case"GEOB":{A=s.findZero(e,m+1,d,i);const t=s.decodeString(e.slice(m+1,A),u);m=A+1,A=s.findZero(e,m,d-m,i);const r=s.decodeString(e.slice(m,A),u);m=A+1,A=s.findZero(e,m,d-m,i),p={type:t,filename:r,description:s.decodeString(e.slice(m,A),u),data:e.slice(m+1,d)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":p=s.decodeString(e.slice(m,A),u);break;case"WXXX":{A=s.findZero(e,m+1,d,i);const t=s.decodeString(e.slice(m+1,A),i);m=A+("utf16le"===i?2:1),p={description:t,url:s.decodeString(e.slice(m,d),u)};break}case"WFD":case"WFED":p=s.decodeString(e.slice(m+1,s.findZero(e,m+1,d,i)),i);break;case"MCDI":p=e.slice(0,d);break;default:c("Warning: unsupported id3v2-tag-type: "+t)}return p}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const t={};for(let r=0;r+1<e.length;r+=2){const n=e[r+1].split(",");t[e[r]]=t.hasOwnProperty(e[r])?t[e[r]].concat(n):n}return t}splitValue(e,t){let r;return this.major<4?(r=t.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=t.split(/\//g)):r=t.split(/\x00/g),f.trimArray(r)}static trimArray(e){return e.map((e=>e.replace(/\x00+$/,"").trim()))}static readIdentifierAndData(e,t,r,n){const i=s.findZero(e,t,r,n),a=s.decodeString(e.slice(t,i),n);return t=i+f.getNullTerminatorLength(n),{id:a,data:e.slice(t,r)}}static getNullTerminatorLength(e){return"utf16le"===e?2:1}}t.FrameParser=f},7183:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v22TagMapper=t.id3v22TagMap=void 0;const n=r(4132);t.id3v22TagMap={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website","COM:iTunPGAP":"gapless",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class i extends n.CaseInsensitiveTagMap{constructor(){super(["ID3v2.2"],t.id3v22TagMap)}}t.ID3v22TagMapper=i},4005:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v24TagMapper=void 0;const n=r(9918),i=r(4132),a=r(3769),s={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer","USLT:description":"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"date",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl"};class o extends i.CaseInsensitiveTagMap{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*n.CommonTagMapper.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],s)}postMap(e,t){switch(e.id){case"UFID":"http://musicbrainz.org"===e.value.owner_identifier&&(e.id+=":"+e.value.owner_identifier,e.value=a.decodeString(e.value.identifier,"latin1"));break;case"PRIV":switch(e.value.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=":"+e.value.owner_identifier,e.value=4===e.value.data.length?e.value.data.readUInt32LE(0):null,null===e.value&&t.addWarning("Failed to parse PRIV:PeakValue");break;default:t.addWarning(`Unknown PRIV owner-identifier: ${e.value.owner_identifier}`)}break;case"COMM":e.value=e.value?e.value.text:null;break;case"POPM":e.value=o.toRating(e.value)}}}t.ID3v24TagMapper=o},8928:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v2Parser=void 0;const i=r(3416),a=r(3769),s=r(907),o=r(8281);class l{static removeUnsyncBytes(e){let t=0,r=0;for(;t<e.length-1;)t!==r&&(e[r]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,r++;return t<e.length&&(e[r++]=e[t]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:a.getBit(e,0,6),file_alter_preservation:a.getBit(e,0,5),read_only:a.getBit(e,0,4)},format:{grouping_identity:a.getBit(e,1,7),compression:a.getBit(e,1,3),encryption:a.getBit(e,1,2),unsynchronisation:a.getBit(e,1,1),data_length_indicator:a.getBit(e,1,0)}}}static readFrameData(e,t,r,n,i){const a=new s.FrameParser(r,i);switch(r){case 2:return a.readData(e,t.id,n);case 3:case 4:return t.flags.format.unsynchronisation&&(e=l.removeUnsyncBytes(e)),t.flags.format.data_length_indicator&&(e=e.slice(4,e.length)),a.readData(e,t.id,n);default:throw new Error("Unexpected majorVer: "+r)}}static makeDescriptionTagName(e,t){return e+(t?":"+t:"")}async parse(e,t,r){this.tokenizer=t,this.metadata=e,this.options=r;const n=await this.tokenizer.readToken(o.ID3v2Header);if("ID3"!==n.fileIdentifier)throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=n,this.headerType="ID3v2."+n.version.major,n.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(n.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(o.ExtendedHeader),t=e.size-o.ExtendedHeader.len;return t>0?this.parseExtendedHeaderData(t,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,t){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-t)}async parseId3Data(e){const t=await this.tokenizer.readToken(new i.Uint8ArrayType(e));for(const e of this.parseMetadata(t))if("TXXX"===e.id){if(e.value)for(const t of e.value.text)this.addTag(l.makeDescriptionTagName(e.id,e.value.description),t)}else if("COM"===e.id)for(const t of e.value)this.addTag(l.makeDescriptionTagName(e.id,t.description),t.text);else if("COMM"===e.id)for(const t of e.value)this.addTag(l.makeDescriptionTagName(e.id,t.description),t);else if(Array.isArray(e.value))for(const t of e.value)this.addTag(e.id,t);else this.addTag(e.id,e.value)}addTag(e,t){this.metadata.addTag(this.headerType,e,t)}parseMetadata(e){let t=0;const r=[];for(;t!==e.length;){const n=l.getFrameHeaderLength(this.id3Header.version.major);if(t+n>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(t,t+=n),a=this.readFrameHeader(i,this.id3Header.version.major),s=e.slice(t,t+=a.length),o=l.readFrameData(s,a,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&r.push({id:a.id,value:o})}return r}readFrameHeader(e,t){let r;switch(t){case 2:r={id:n.from(e.slice(0,3)).toString("ascii"),length:i.UINT24_BE.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:n.from(e.slice(0,4)).toString("ascii"),length:(4===t?o.UINT32SYNCSAFE:i.UINT32_BE).get(e,4),flags:l.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error("Unexpected majorVer: "+t)}return r}}t.ID3v2Parser=l},8281:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextEncodingToken=t.ExtendedHeader=t.ID3v2Header=t.UINT32SYNCSAFE=t.AttachedPictureType=void 0;const n=r(3416),i=r(3769);var a;(a=t.AttachedPictureType||(t.AttachedPictureType={}))[a.Other=0]="Other",a[a["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",a[a["Other file icon"]=2]="Other file icon",a[a["Cover (front)"]=3]="Cover (front)",a[a["Cover (back)"]=4]="Cover (back)",a[a["Leaflet page"]=5]="Leaflet page",a[a["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",a[a["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",a[a["Artist/performer"]=8]="Artist/performer",a[a.Conductor=9]="Conductor",a[a["Band/Orchestra"]=10]="Band/Orchestra",a[a.Composer=11]="Composer",a[a["Lyricist/text writer"]=12]="Lyricist/text writer",a[a["Recording Location"]=13]="Recording Location",a[a["During recording"]=14]="During recording",a[a["During performance"]=15]="During performance",a[a["Movie/video screen capture"]=16]="Movie/video screen capture",a[a["A bright coloured fish"]=17]="A bright coloured fish",a[a.Illustration=18]="Illustration",a[a["Band/artist logotype"]=19]="Band/artist logotype",a[a["Publisher/Studio logotype"]=20]="Publisher/Studio logotype",t.UINT32SYNCSAFE={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},t.ID3v2Header={len:10,get:(e,r)=>({fileIdentifier:new n.StringType(3,"ascii").get(e,r),version:{major:n.INT8.get(e,r+3),revision:n.INT8.get(e,r+4)},flags:{unsynchronisation:i.getBit(e,r+5,7),isExtendedHeader:i.getBit(e,r+5,6),expIndicator:i.getBit(e,r+5,5),footer:i.getBit(e,r+5,4)},size:t.UINT32SYNCSAFE.get(e,r+6)})},t.ExtendedHeader={len:10,get:(e,t)=>({size:n.UINT32_BE.get(e,t),extendedFlags:n.UINT16_BE.get(e,t+4),sizeOfPadding:n.UINT32_BE.get(e,t+6),crcDataPresent:i.getBit(e,t+4,31)})},t.TextEncodingToken={len:1,get:(e,t)=>{switch(e[t]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf16le",bom:!0};case 2:return{encoding:"utf16le",bom:!1};default:return{encoding:"utf8",bom:!1}}}}},4633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const n=r(3416),i=r(8049);t.Header={len:8,get:(e,t)=>({chunkID:i.FourCcToken.get(e,t),chunkSize:Number(BigInt(n.UINT32_BE.get(e,t+4)))})}},9941:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.getLyricsHeaderLength=t.endTag2=void 0,t.endTag2="LYRICS200",t.getLyricsHeaderLength=async function(e){if(e.fileSize>=143){const r=n.alloc(15);await e.randomRead(r,0,r.length,e.fileSize-143);const i=r.toString("binary");if(i.substr(6)===t.endTag2)return parseInt(i.substr(0,6),10)+15}return 0}},3121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elements=void 0;const n=r(8591);t.elements={440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:n.DataType.uint},17143:{name:"ebmlReadVersion",value:n.DataType.uint},17138:{name:"ebmlMaxIDWidth",value:n.DataType.uint},17139:{name:"ebmlMaxSizeWidth",value:n.DataType.uint},17026:{name:"docType",value:n.DataType.string},17031:{name:"docTypeVersion",value:n.DataType.uint},17029:{name:"docTypeReadVersion",value:n.DataType.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",container:{21419:{name:"seekId",value:n.DataType.binary},21420:{name:"seekPosition",value:n.DataType.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:n.DataType.uid},29572:{name:"filename",value:n.DataType.string},3979555:{name:"prevUID",value:n.DataType.uid},3965867:{name:"prevFilename",value:n.DataType.string},4110627:{name:"nextUID",value:n.DataType.uid},4096955:{name:"nextFilename",value:n.DataType.string},2807729:{name:"timecodeScale",value:n.DataType.uint},17545:{name:"duration",value:n.DataType.float},17505:{name:"dateUTC",value:n.DataType.uint},31657:{name:"title",value:n.DataType.string},19840:{name:"muxingApp",value:n.DataType.string},22337:{name:"writingApp",value:n.DataType.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:n.DataType.uid},163:{name:"unknown",value:n.DataType.binary},167:{name:"position",value:n.DataType.uid},171:{name:"prevSize",value:n.DataType.uid}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:n.DataType.uint},29637:{name:"uid",value:n.DataType.uid},131:{name:"trackType",value:n.DataType.uint},185:{name:"flagEnabled",value:n.DataType.bool},136:{name:"flagDefault",value:n.DataType.bool},21930:{name:"flagForced",value:n.DataType.bool},156:{name:"flagLacing",value:n.DataType.bool},28135:{name:"minCache",value:n.DataType.uint},28136:{name:"maxCache",value:n.DataType.uint},2352003:{name:"defaultDuration",value:n.DataType.uint},2306383:{name:"timecodeScale",value:n.DataType.float},21358:{name:"name",value:n.DataType.string},2274716:{name:"language",value:n.DataType.string},134:{name:"codecID",value:n.DataType.string},25506:{name:"codecPrivate",value:n.DataType.binary},2459272:{name:"codecName",value:n.DataType.string},3839639:{name:"codecSettings",value:n.DataType.string},3883072:{name:"codecInfoUrl",value:n.DataType.string},2536e3:{name:"codecDownloadUrl",value:n.DataType.string},170:{name:"codecDecodeAll",value:n.DataType.bool},28587:{name:"trackOverlay",value:n.DataType.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:n.DataType.bool},21432:{name:"stereoMode",value:n.DataType.uint},176:{name:"pixelWidth",value:n.DataType.uint},186:{name:"pixelHeight",value:n.DataType.uint},21680:{name:"displayWidth",value:n.DataType.uint},21690:{name:"displayHeight",value:n.DataType.uint},21683:{name:"aspectRatioType",value:n.DataType.uint},3061028:{name:"colourSpace",value:n.DataType.uint},3126563:{name:"gammaValue",value:n.DataType.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:n.DataType.float},30901:{name:"outputSamplingFrequency",value:n.DataType.float},159:{name:"channels",value:n.DataType.uint},148:{name:"channels",value:n.DataType.uint},32123:{name:"channelPositions",value:n.DataType.binary},25188:{name:"bitDepth",value:n.DataType.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:n.DataType.uint},20530:{name:"scope",value:n.DataType.bool},20531:{name:"type",value:n.DataType.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:n.DataType.uint},16981:{name:"contentCompSettings",value:n.DataType.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:n.DataType.uint},18402:{name:"contentEncKeyID",value:n.DataType.binary},18403:{name:"contentSignature ",value:n.DataType.binary},18404:{name:"ContentSigKeyID  ",value:n.DataType.binary},18405:{name:"contentSigAlgo ",value:n.DataType.uint},18406:{name:"contentSigHashAlgo ",value:n.DataType.uint}}},25188:{name:"bitDepth",value:n.DataType.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:n.DataType.uid},183:{name:"positions",container:{247:{name:"track",value:n.DataType.uint},241:{name:"clusterPosition",value:n.DataType.uint},21368:{name:"blockNumber",value:n.DataType.uint},234:{name:"codecState",value:n.DataType.uint},219:{name:"reference",container:{150:{name:"time",value:n.DataType.uint},151:{name:"cluster",value:n.DataType.uint},21343:{name:"number",value:n.DataType.uint},235:{name:"codecState",value:n.DataType.uint}}},240:{name:"relativePosition",value:n.DataType.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:n.DataType.string},18030:{name:"name",value:n.DataType.string},18016:{name:"mimeType",value:n.DataType.string},18012:{name:"data",value:n.DataType.binary},18094:{name:"uid",value:n.DataType.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:n.DataType.uid},145:{name:"timeStart",value:n.DataType.uint},146:{name:"timeEnd",value:n.DataType.uid},152:{name:"hidden",value:n.DataType.bool},17816:{name:"enabled",value:n.DataType.uid},143:{name:"track",container:{137:{name:"trackNumber",value:n.DataType.uid},128:{name:"display",container:{133:{name:"string",value:n.DataType.string},17276:{name:"language ",value:n.DataType.string},17278:{name:"country ",value:n.DataType.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:n.DataType.uid},25540:{name:"tagChapterUID",value:n.DataType.uint},25542:{name:"tagAttachmentUID",value:n.DataType.uid},25546:{name:"targetType",value:n.DataType.string},26826:{name:"targetTypeValue",value:n.DataType.uint},25545:{name:"tagEditionUID",value:n.DataType.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:n.DataType.string},17543:{name:"string",value:n.DataType.string},17541:{name:"binary",value:n.DataType.binary},17530:{name:"language",value:n.DataType.string},17531:{name:"languageIETF",value:n.DataType.string},17540:{name:"default",value:n.DataType.bool}}}}}}}}}}},78:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MatroskaParser=void 0;const i=r(3416),a=r(1227),s=r(7805),o=r(8591),l=r(3121),c=(0,a.default)("music-metadata:parser:matroska");class u extends s.BasicParser{constructor(){super(),this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(o.DataType.uint,(e=>this.readUint(e))),this.parserMap.set(o.DataType.string,(e=>this.readString(e))),this.parserMap.set(o.DataType.binary,(e=>this.readBuffer(e))),this.parserMap.set(o.DataType.uid,(async e=>1===await this.readUint(e))),this.parserMap.set(o.DataType.bool,(e=>this.readFlag(e))),this.parserMap.set(o.DataType.float,(e=>this.readFloat(e)))}init(e,t,r){return super.init(e,t,r),this}async parse(){const e=await this.parseContainer(l.elements,this.tokenizer.fileInfo.size,[]);if(this.metadata.setFormat("container",`EBML/${e.ebml.docType}`),e.segment){const t=e.segment.info;if(t){const e=t.timecodeScale?t.timecodeScale:1e6,r=t.duration*e/1e9;this.addTag("segment:title",t.title),this.metadata.setFormat("duration",r)}const r=e.segment.tracks;if(r&&r.entries){r.entries.forEach((e=>{const t={codecName:e.codecID.replace("A_","").replace("V_",""),codecSettings:e.codecSettings,flagDefault:e.flagDefault,flagLacing:e.flagLacing,flagEnabled:e.flagEnabled,language:e.language,name:e.name,type:e.trackType,audio:e.audio,video:e.video};this.metadata.addStreamInfo(t)}));const t=r.entries.filter((e=>e.trackType===o.TrackType.audio.valueOf())).reduce(((e,t)=>e?!e.flagDefault&&t.flagDefault||t.trackNumber&&t.trackNumber<e.trackNumber?t:e:t),null);t&&(this.metadata.setFormat("codec",t.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",t.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",t.audio.channels)),e.segment.tags&&e.segment.tags.tag.forEach((e=>{const t=e.target,r=(null==t?void 0:t.targetTypeValue)?o.TargetType[t.targetTypeValue]:(null==t?void 0:t.targetType)?t.targetType:"track";e.simpleTags.forEach((e=>{const t=e.string?e.string:e.binary;this.addTag(`${r}:${e.name}`,t)}))})),e.segment.attachments&&e.segment.attachments.attachedFiles.filter((e=>e.mimeType.startsWith("image/"))).map((e=>({data:e.data,format:e.mimeType,description:e.description,name:e.name}))).forEach((e=>{this.addTag("picture",e)}))}}}async parseContainer(e,t,r){const n={};for(;this.tokenizer.position<t;){let t;try{t=await this.readElement()}catch(e){if("End-Of-Stream"===e.message)break;throw e}const i=e[t.id];if(i)if(c(`Element: name=${i.name}, container=${!!i.container}`),i.container){const e=await this.parseContainer(i.container,t.len>=0?this.tokenizer.position+t.len:-1,r.concat([i.name]));i.multiple?(n[i.name]||(n[i.name]=[]),n[i.name].push(e)):n[i.name]=e}else n[i.name]=await this.parserMap.get(i.value)(t);else 236===t.id?(this.padding+=t.len,await this.tokenizer.ignore(t.len)):(c(`parseEbml: path=${r.join("/")}, unknown element: id=${t.id.toString(16)}`),this.padding+=t.len,await this.tokenizer.ignore(t.len))}return n}async readVintData(e){const t=await this.tokenizer.peekNumber(i.UINT8);let r=128,a=1;for(;0==(t&r);){if(a>e)throw new Error("VINT value exceeding maximum size");++a,r>>=1}const s=n.alloc(a);return await this.tokenizer.readBuffer(s),s}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),t=await this.readVintData(this.ebmlMaxSizeLength);t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}isMaxValue(e){if(e.length===this.ebmlMaxSizeLength){for(let t=1;t<this.ebmlMaxSizeLength;++t)if(255!==e[t])return!1;return!0}return!1}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(i.Float32_BE);case 8:case 10:return this.tokenizer.readNumber(i.Float64_BE);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return 1===await this.readUint(e)}async readUint(e){const t=await this.readBuffer(e),r=Math.min(6,e.len);return t.readUIntBE(e.len-r,r)}async readString(e){return(await this.tokenizer.readToken(new i.StringType(e.len,"utf-8"))).replace(/\00.*$/g,"")}async readBuffer(e){const t=n.alloc(e.len);return await this.tokenizer.readBuffer(t),t}addTag(e,t){this.metadata.addTag("matroska",e,t)}}t.MatroskaParser=u},5481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatroskaTagMapper=void 0;const n=r(4132),i={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class a extends n.CaseInsensitiveTagMap{constructor(){super(["matroska"],i)}}t.MatroskaTagMapper=a},8591:(e,t)=>{"use strict";var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.TrackType=t.TargetType=t.DataType=void 0,(i=t.DataType||(t.DataType={}))[i.string=0]="string",i[i.uint=1]="uint",i[i.uid=2]="uid",i[i.bool=3]="bool",i[i.binary=4]="binary",i[i.float=5]="float",(n=t.TargetType||(t.TargetType={}))[n.shot=10]="shot",n[n.scene=20]="scene",n[n.track=30]="track",n[n.part=40]="part",n[n.album=50]="album",n[n.edition=60]="edition",n[n.collection=70]="collection",(r=t.TrackType||(t.TrackType={}))[r.video=1]="video",r[r.audio=2]="audio",r[r.complex=3]="complex",r[r.logo=4]="logo",r[r.subtitle=17]="subtitle",r[r.button=18]="button",r[r.control=32]="control"},9134:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Atom=void 0;const n=r(1227),i=r(1060),a=(0,n.default)("music-metadata:parser:MP4:Atom");class s{constructor(e,t,r){this.header=e,this.extended=t,this.parent=r,this.children=[],this.atomPath=(this.parent?this.parent.atomPath+".":"")+this.header.name}static async readAtom(e,t,r,n){const o=e.position,l=await e.readToken(i.Header);l.length===BigInt(1)&&(l.length=await e.readToken(i.ExtendedSize));const c=new s(l,l.length===BigInt(1),r),u=c.getPayloadLength(n);return a(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${o}, len=${c.header.length}`),await c.readData(e,t,u),c}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,t,r){for(;r>0;){const n=await s.readAtom(e,t,this,r);this.children.push(n),r-=n.header.length===BigInt(0)?r:Number(n.header.length)}}async readData(e,t,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,t,this.getPayloadLength(r));case"meta":return await e.ignore(4),this.readAtoms(e,t,this.getPayloadLength(r)-4);default:return t(this,r)}}}t.Atom=s},1060:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ChapterText=t.StcoAtom=t.StszAtom=t.StscAtom=t.SampleToChunkToken=t.SttsAtom=t.TimeToSampleToken=t.SoundSampleDescriptionV0=t.SoundSampleDescriptionVersion=t.StsdAtom=t.TrackHeaderAtom=t.NameAtom=t.DataAtom=t.MvhdAtom=t.MdhdAtom=t.FixedLengthAtom=t.mhdr=t.tkhd=t.ftyp=t.ExtendedSize=t.Header=void 0;const i=r(3416),a=r(1227),s=r(8049),o=(0,a.default)("music-metadata:parser:MP4:atom");t.Header={len:8,get:(e,t)=>{const r=i.UINT32_BE.get(e,t);if(r<0)throw new Error("Invalid atom header length");return{length:BigInt(r),name:new i.StringType(4,"binary").get(e,t+4)}},put:(e,t,r)=>(i.UINT32_BE.put(e,t,Number(r.length)),s.FourCcToken.put(e,t+4,r.name))},t.ExtendedSize=i.UINT64_BE,t.ftyp={len:4,get:(e,t)=>({type:new i.StringType(4,"ascii").get(e,t)})},t.tkhd={len:4,get:(e,t)=>({type:new i.StringType(4,"ascii").get(e,t)})},t.mhdr={len:8,get:(e,t)=>({version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),nextItemID:i.UINT32_BE.get(e,t+4)})};class l{constructor(e,t,r){if(this.len=e,e<t)throw new Error(`Atom ${r} expected to be ${t}, but specifies ${e} bytes long.`);e>t&&o(`Warning: atom ${r} expected to be ${t}, but was actually ${e} bytes long.`)}}t.FixedLengthAtom=l;const c=(e,t)=>{const r=i.UINT32_BE.get(e,t)-2082844800;return new Date(1e3*r)};t.MdhdAtom=class extends l{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,t){return{version:i.UINT8.get(e,t+0),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),timeScale:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+16),language:i.UINT16_BE.get(e,t+20),quality:i.UINT16_BE.get(e,t+22)}}},t.MvhdAtom=class extends l{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),timeScale:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+16),preferredRate:i.UINT32_BE.get(e,t+20),preferredVolume:i.UINT16_BE.get(e,t+24),previewTime:i.UINT32_BE.get(e,t+72),previewDuration:i.UINT32_BE.get(e,t+76),posterTime:i.UINT32_BE.get(e,t+80),selectionTime:i.UINT32_BE.get(e,t+84),selectionDuration:i.UINT32_BE.get(e,t+88),currentTime:i.UINT32_BE.get(e,t+92),nextTrackID:i.UINT32_BE.get(e,t+96)}}},t.DataAtom=class{constructor(e){this.len=e}get(e,t){return{type:{set:i.UINT8.get(e,t+0),type:i.UINT24_BE.get(e,t+1)},locale:i.UINT24_BE.get(e,t+4),value:n.from(new i.Uint8ArrayType(this.len-8).get(e,t+8))}}},t.NameAtom=class{constructor(e){this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),name:new i.StringType(this.len-4,"utf-8").get(e,t+4)}}},t.TrackHeaderAtom=class{constructor(e){this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),trackId:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+20),layer:i.UINT16_BE.get(e,t+24),alternateGroup:i.UINT16_BE.get(e,t+26),volume:i.UINT16_BE.get(e,t+28)}}};class u{constructor(e){this.len=e}get(e,t){return{dataFormat:s.FourCcToken.get(e,t),dataReferenceIndex:i.UINT16_BE.get(e,t+10),description:new i.Uint8ArrayType(this.len-12).get(e,t+12)}}}t.StsdAtom=class{constructor(e){this.len=e}get(e,t){const r=((e,t)=>({version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),numberOfEntries:i.UINT32_BE.get(e,t+4)}))(e,t);t+=8;const n=[];for(let a=0;a<r.numberOfEntries;++a){const r=i.UINT32_BE.get(e,t);t+=i.UINT32_BE.len,n.push(new u(r).get(e,t)),t+=r}return{header:r,table:n}}},t.SoundSampleDescriptionVersion={len:8,get:(e,t)=>({version:i.INT16_BE.get(e,t),revision:i.INT16_BE.get(e,t+2),vendor:i.INT32_BE.get(e,t+4)})},t.SoundSampleDescriptionV0={len:12,get:(e,t)=>({numAudioChannels:i.INT16_BE.get(e,t+0),sampleSize:i.INT16_BE.get(e,t+2),compressionId:i.INT16_BE.get(e,t+4),packetSize:i.INT16_BE.get(e,t+6),sampleRate:i.UINT16_BE.get(e,t+8)+i.UINT16_BE.get(e,t+10)/1e4})};class h{constructor(e,t){this.len=e,this.token=t}get(e,t){const r=i.INT32_BE.get(e,t+4);return{version:i.INT8.get(e,t+0),flags:i.INT24_BE.get(e,t+1),numberOfEntries:r,entries:d(e,this.token,t+8,this.len-8,r)}}}function d(e,t,r,n,i){if(o(`remainingLen=${n}, numberOfEntries=${i} * token-len=${t.len}`),0===n)return[];if(n!==i*t.len)throw new Error("mismatch number-of-entries with remaining atom-length");const a=[];for(let n=0;n<i;++n)a.push(t.get(e,r)),r+=t.len;return a}t.TimeToSampleToken={len:8,get:(e,t)=>({count:i.INT32_BE.get(e,t+0),duration:i.INT32_BE.get(e,t+4)})},t.SttsAtom=class extends h{constructor(e){super(e,t.TimeToSampleToken),this.len=e}},t.SampleToChunkToken={len:12,get:(e,t)=>({firstChunk:i.INT32_BE.get(e,t),samplesPerChunk:i.INT32_BE.get(e,t+4),sampleDescriptionId:i.INT32_BE.get(e,t+8)})},t.StscAtom=class extends h{constructor(e){super(e,t.SampleToChunkToken),this.len=e}},t.StszAtom=class{constructor(e){this.len=e}get(e,t){const r=i.INT32_BE.get(e,t+8);return{version:i.INT8.get(e,t),flags:i.INT24_BE.get(e,t+1),sampleSize:i.INT32_BE.get(e,t+4),numberOfEntries:r,entries:d(e,i.INT32_BE,t+12,this.len-12,r)}}},t.StcoAtom=class extends h{constructor(e){super(e,i.INT32_BE),this.len=e}},t.ChapterText=class{constructor(e){this.len=e}get(e,t){const r=i.INT16_BE.get(e,t+0);return new i.StringType(r,"utf-8").get(e,t+2)}}},8841:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MP4Parser=void 0;const i=r(1227),a=r(3416),s=r(7805),o=r(2282),l=r(6032),c=r(9134),u=r(1060),h=(0,i.default)("music-metadata:parser:MP4"),d={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function f(e,t,r){return r.indexOf(e)===t}class m extends s.BasicParser{constructor(){super(...arguments),this.atomParsers={mvhd:async e=>{const t=await this.tokenizer.readToken(new u.MvhdAtom(e));this.metadata.setFormat("creationTime",t.creationTime),this.metadata.setFormat("modificationTime",t.modificationTime)},mdhd:async e=>{const t=await this.tokenizer.readToken(new u.MdhdAtom(e)),r=this.getTrackDescription();r.creationTime=t.creationTime,r.modificationTime=t.modificationTime,r.timeScale=t.timeScale,r.duration=t.duration},chap:async e=>{const t=this.getTrackDescription(),r=[];for(;e>=a.UINT32_BE.len;)r.push(await this.tokenizer.readNumber(a.UINT32_BE)),e-=a.UINT32_BE.len;t.chapterList=r},tkhd:async e=>{const t=await this.tokenizer.readToken(new u.TrackHeaderAtom(e));this.tracks.push(t)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const t=this.tracks.filter((e=>e.chapterList));if(1===t.length){const r=t[0].chapterList,n=this.tracks.filter((e=>-1!==r.indexOf(e.trackId)));if(1===n.length)return this.parseChapterTrack(n[0],t[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const t=[];for(;e>0;){const r=await this.tokenizer.readToken(u.ftyp);e-=u.ftyp.len;const n=r.type.replace(/\W/g,"");n.length>0&&t.push(n)}h(`ftyp: ${t.join("/")}`);const r=t.filter(f).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const t=await this.tokenizer.readToken(new u.StsdAtom(e));this.getTrackDescription().soundSampleDescription=t.table.map((e=>this.parseSoundSampleDescription(e)))},stsc:async e=>{const t=await this.tokenizer.readToken(new u.StscAtom(e));this.getTrackDescription().sampleToChunkTable=t.entries},stts:async e=>{const t=await this.tokenizer.readToken(new u.SttsAtom(e));this.getTrackDescription().timeToSampleTable=t.entries},stsz:async e=>{const t=await this.tokenizer.readToken(new u.StszAtom(e)),r=this.getTrackDescription();r.sampleSize=t.sampleSize,r.sampleSizeTable=t.entries},stco:async e=>{const t=await this.tokenizer.readToken(new u.StcoAtom(e));this.getTrackDescription().chunkOffsetTable=t.entries},date:async e=>{const t=await this.tokenizer.readToken(new a.StringType(e,"utf-8"));this.addTag("date",t)}}}static read_BE_Integer(e,t){const r=(t?"INT":"UINT")+8*e.length+(e.length>1?"_BE":""),n=a[r];if(!n)throw new Error('Token for integer type not found: "'+r+'"');return Number(n.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size;for(;!this.tokenizer.fileInfo.size||e>0;){try{if("\0\0\0\0"===(await this.tokenizer.peekToken(u.Header)).name){const e=`Error at offset=${this.tokenizer.position}: box.id=0`;h(e),this.addWarning(e);break}}catch(e){const t=`Error at offset=${this.tokenizer.position}: ${e.message}`;h(t),this.addWarning(t);break}const t=await c.Atom.readAtom(this.tokenizer,((e,t)=>this.handleAtom(e,t)),null,e);e-=t.header.length===BigInt(0)?e:Number(t.header.length)}const t=[];this.tracks.forEach((e=>{const r=[];e.soundSampleDescription.forEach((e=>{const t={},n=d[e.dataFormat];if(n?(r.push(n.format),t.codecName=n.format):t.codecName=`<${e.dataFormat}>`,e.description){const{description:r}=e;r.sampleRate>0&&(t.type=l.TrackType.audio,t.audio={samplingFrequency:r.sampleRate,bitDepth:r.sampleSize,channels:r.numAudioChannels})}this.metadata.addStreamInfo(t)})),r.length>=1&&t.push(r.join("/"))})),t.length>0&&this.metadata.setFormat("codec",t.filter(f).join("+"));const r=this.tracks.filter((e=>e.soundSampleDescription.length>=1&&e.soundSampleDescription[0].description&&e.soundSampleDescription[0].description.numAudioChannels>0));if(r.length>=1){const e=r[0],t=e.duration/e.timeScale;this.metadata.setFormat("duration",t);const n=e.soundSampleDescription[0];n.description&&(this.metadata.setFormat("sampleRate",n.description.sampleRate),this.metadata.setFormat("bitsPerSample",n.description.sampleSize),this.metadata.setFormat("numberOfChannels",n.description.numAudioChannels));const i=d[n.dataFormat];i&&this.metadata.setFormat("lossless",!i.lossy),this.calculateBitRate()}}async handleAtom(e,t){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](t);h(`No parser for atom path=${e.atomPath}, payload-len=${t}, ignoring atom`),await this.tokenizer.ignore(t)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}addTag(e,t){this.metadata.addTag("iTunes",e,t)}addWarning(e){h("Warning: "+e),this.metadata.addWarning(e)}parseMetadataItemData(e){let t=e.header.name;return e.readAtoms(this.tokenizer,(async(e,r)=>{const n=e.getPayloadLength(r);switch(e.header.name){case"data":return this.parseValueAtom(t,e);case"name":const r=await this.tokenizer.readToken(new u.NameAtom(n));t+=":"+r.name;break;case"mean":const i=await this.tokenizer.readToken(new u.NameAtom(n));t+=":"+i.name;break;default:const s=await this.tokenizer.readToken(new a.BufferType(n));this.addWarning("Unsupported meta-item: "+t+"["+e.header.name+"] => value="+s.toString("hex")+" ascii="+s.toString("ascii"))}}),e.getPayloadLength(0))}async parseValueAtom(e,t){const r=await this.tokenizer.readToken(new u.DataAtom(Number(t.header.length)-u.Header.len));if(0!==r.type.set)throw new Error("Unsupported type-set != 0: "+r.type.set);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":const t=a.UINT8.get(r.value,3),n=a.UINT8.get(r.value,5);this.addTag(e,t+"/"+n);break;case"gnre":const i=a.UINT8.get(r.value,1),s=o.Genres[i-1];this.addTag(e,s)}break;case 1:case 18:this.addTag(e,r.value.toString("utf-8"));break;case 13:if(this.options.skipCovers)break;this.addTag(e,{format:"image/jpeg",data:n.from(r.value)});break;case 14:if(this.options.skipCovers)break;this.addTag(e,{format:"image/png",data:n.from(r.value)});break;case 21:this.addTag(e,m.read_BE_Integer(r.value,!0));break;case 22:this.addTag(e,m.read_BE_Integer(r.value,!1));break;case 65:this.addTag(e,r.value.readInt8(0));break;case 66:this.addTag(e,r.value.readInt16BE(0));break;case 67:this.addTag(e,r.value.readInt32BE(0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const t={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const n=u.SoundSampleDescriptionVersion.get(e.description,r);return r+=u.SoundSampleDescriptionVersion.len,0===n.version||1===n.version?t.description=u.SoundSampleDescriptionV0.get(e.description,r):h(`Warning: sound-sample-description ${n} not implemented`),t}async parseChapterTrack(e,t,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const n=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const a=e.chunkOffsetTable[i]-this.tokenizer.position,s=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if((r-=a+s)<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(a);const o=await this.tokenizer.readToken(new u.ChapterText(s));h(`Chapter ${i+1}: ${o}`);const l={title:o,sampleOffset:this.findSampleOffset(t,this.tokenizer.position)};h(`Chapter title=${l.title}, offset=${l.sampleOffset}/${this.tracks[0].duration}`),n.push(l)}this.metadata.setFormat("chapters",n),await this.tokenizer.ignore(r)}findSampleOffset(e,t){let r=0;e.timeToSampleTable.forEach((e=>{r+=e.count*e.duration})),h(`Total duration=${r}`);let n=0;for(;n<e.chunkOffsetTable.length&&e.chunkOffsetTable[n]<t;)++n;return this.getChunkDuration(n+1,e)}getChunkDuration(e,t){let r=0,n=t.timeToSampleTable[r].count,i=t.timeToSampleTable[r].duration,a=1,s=this.getSamplesPerChunk(a,t.sampleToChunkTable),o=0;for(;a<e;){const e=Math.min(n,s);o+=e*i,n-=e,s-=e,0===s?(++a,s=this.getSamplesPerChunk(a,t.sampleToChunkTable)):(++r,n=t.timeToSampleTable[r].count,i=t.timeToSampleTable[r].duration)}return o}getSamplesPerChunk(e,t){for(let r=0;r<t.length-1;++r)if(e>=t[r].firstChunk&&e<t[r+1].firstChunk)return t[r].samplesPerChunk;return t[t.length-1].samplesPerChunk}}t.MP4Parser=m},7852:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MP4TagMapper=t.tagType=void 0;const n=r(4132),i={"nam":"title","ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","alb":"album","day":"date","cmt":"comment","com":"comment",trkn:"track",disk:"disk","gen":"genre",covr:"picture","wrt":"composer","lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear",desc:"description",ldes:"longDescription","mvn":"movement","mvi":"movementIndex","mvc":"movementTotal","wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik"};t.tagType="iTunes";class a extends n.CaseInsensitiveTagMap{constructor(){super([t.tagType],i)}}t.MP4TagMapper=a},5261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedLameHeader=void 0;const n=r(3416),i=r(3769),a=r(6118);t.ExtendedLameHeader={len:27,get:(e,t)=>{const r=n.UINT32_BE.get(e,t+2);return{revision:i.getBitAllignedNumber(e,t,0,4),vbr_method:i.getBitAllignedNumber(e,t,4,4),lowpass_filter:100*n.UINT8.get(e,t+1),track_peak:0===r?void 0:r/Math.pow(2,23),track_gain:a.ReplayGain.get(e,6),album_gain:a.ReplayGain.get(e,8),music_length:n.UINT32_BE.get(e,t+20),music_crc:n.UINT8.get(e,t+24),header_crc:n.UINT16_BE.get(e,t+24)}}}},60:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MpegParser=void 0;const i=r(3416),a=r(5849),s=r(1227),o=r(3769),l=r(5159),c=r(3566),u=(0,s.default)("music-metadata:parser:mpeg"),h={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,void 0,void 0,-1]},d=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class f{constructor(e,t){this.versionIndex=o.getBitAllignedNumber(e,t+1,3,2),this.layer=f.LayerDescription[o.getBitAllignedNumber(e,t+1,5,2)],this.versionIndex>1&&0===this.layer?this.parseAdtsHeader(e,t):this.parseMpegHeader(e,t),this.isProtectedByCRC=!o.isBitSet(e,t+1,7)}calcDuration(e){return e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return f.samplesInFrameTable[1===this.version?0:1][this.layer]}calculateSideInfoLength(){if(3!==this.layer)return 2;if(3===this.channelModeIndex){if(1===this.version)return 17;if(2===this.version||2.5===this.version)return 9}else{if(1===this.version)return 32;if(2===this.version||2.5===this.version)return 17}}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,t){this.container="MPEG",this.bitrateIndex=o.getBitAllignedNumber(e,t+2,0,4),this.sampRateFreqIndex=o.getBitAllignedNumber(e,t+2,4,2),this.padding=o.isBitSet(e,t+2,6),this.privateBit=o.isBitSet(e,t+2,7),this.channelModeIndex=o.getBitAllignedNumber(e,t+3,0,2),this.modeExtension=o.getBitAllignedNumber(e,t+3,2,2),this.isCopyrighted=o.isBitSet(e,t+3,4),this.isOriginalMedia=o.isBitSet(e,t+3,5),this.emphasis=o.getBitAllignedNumber(e,t+3,7,2),this.version=f.VersionID[this.versionIndex],this.channelMode=f.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=1e3*r,this.samplingRate=this.calcSamplingRate(),null==this.samplingRate)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,t){u("layer=0 => ADTS"),this.version=2===this.versionIndex?4:2,this.container="ADTS/MPEG-"+this.version;const r=o.getBitAllignedNumber(e,t+2,0,2);this.codec="AAC",this.codecProfile=h.AudioObjectTypes[r],u(`MPEG-4 audio-codec=${this.codec}`);const n=o.getBitAllignedNumber(e,t+2,2,4);this.samplingRate=h.SamplingFrequencies[n],u(`sampling-rate=${this.samplingRate}`);const i=o.getBitAllignedNumber(e,t+2,7,3);this.mp4ChannelConfig=d[i],u(`channel-config=${this.mp4ChannelConfig.join("+")}`),this.frameLength=o.getBitAllignedNumber(e,t+3,6,2)<<11}calcBitrate(){if(0===this.bitrateIndex||15===this.bitrateIndex)return;const e=`${Math.floor(this.version)}${this.layer}`;return f.bitrate_index[this.bitrateIndex][e]}calcSamplingRate(){return 3===this.sampRateFreqIndex?null:f.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}f.SyncByte1=255,f.SyncByte2=224,f.VersionID=[2.5,null,2,1],f.LayerDescription=[0,3,2,1],f.ChannelMode=["stereo","joint_stereo","dual_channel","mono"],f.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}},f.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}},f.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];class m extends l.AbstractID3Parser{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.calculateEofDuration=!1,this.buf_frame_header=n.alloc(4),this.syncPeek={buf:n.alloc(1024),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(!(e instanceof a.EndOfStreamError))throw e;if(u("End-of-stream"),this.calculateEofDuration){const e=this.frameCount*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",e);const t=e/this.metadata.format.sampleRate;u(`Calculate duration at EOF: ${t} sec.`,t),this.metadata.setFormat("duration",t)}}}finalize(){const e=this.metadata.format,t=this.metadata.native.hasOwnProperty("ID3v1");if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0);e.codecProfile&&"V"===e.codecProfile[0]&&this.metadata.setFormat("bitrate",8*r/e.duration)}else if(this.tokenizer.fileInfo.size&&"CBR"===e.codecProfile){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0),n=Math.round(r/this.frame_size)*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",n);const i=n/e.sampleRate;u("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}async sync(){let e=!1;for(;;){let t=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:1024,mayBeLess:!0}),this.syncPeek.len<=163)throw new a.EndOfStreamError;for(;;){if(e&&224==(224&this.syncPeek.buf[t]))return this.buf_frame_header[0]=f.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[t],await this.tokenizer.ignore(t),u(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(u(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),void(this.syncFrameCount=this.frameCount);if(e=!1,t=this.syncPeek.buf.indexOf(f.SyncByte1,t),-1===t){if(this.syncPeek.len<this.syncPeek.buf.length)throw new a.EndOfStreamError;await this.tokenizer.ignore(this.syncPeek.len);break}++t,e=!0}}}async parseCommonMpegHeader(){let e;0===this.frameCount&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});try{t=this.buf_frame_header,e=new f(t,0)}catch(e){return await this.tokenizer.ignore(1),this.metadata.addWarning("Parse error: "+e.message),!1}var t;return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version>=2&&0===e.layer?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels","mono"===e.channelMode?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<2e5&&u("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const t=e.calcSlotSize();if(null===t)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();u(`samples_per_frame=${r}`);const n=r/8*e.bitrate/e.samplingRate+(e.padding?t:0);if(this.frame_size=Math.floor(n),this.audioFrameHeader=e,this.bitrates.push(e.bitrate),1===this.frameCount)return this.offset=4,await this.skipSideInformation(),!1;if(3===this.frameCount){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&4===this.frameCount&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const t=n.alloc(3);await this.tokenizer.readBuffer(t),e.frameLength+=o.getBitAllignedNumber(t,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024;const r=e.samplingRate/this.samplesPerFrame,i=8*(0===this.frameCount?0:this.totalDataLength/this.frameCount)*r+.5;if(this.metadata.setFormat("bitrate",i),u(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`),await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),3===this.frameCount){if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),!this.options.duration)return!0;this.calculateEofDuration=!0}return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(i.INT16_BE),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){const e=this.audioFrameHeader.calculateSideInfoLength();await this.tokenizer.readToken(new i.Uint8ArrayType(e)),this.offset+=e,await this.readXtraInfoHeader()}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(c.InfoTagHeaderTag);switch(this.offset+=c.InfoTagHeaderTag.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":const e=(t=(await this.readXingInfoHeader()).vbrScale,"V"+Math.floor((100-t)/10));return this.metadata.setFormat("codecProfile",e),null;case"Xtra":break;case"LAME":const r=await this.tokenizer.readToken(c.LameEncoderVersion);if(this.frame_size>=this.offset+c.LameEncoderVersion.len)return this.offset+=c.LameEncoderVersion.len,this.metadata.setFormat("tool","LAME "+r),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header")}var t;const r=this.frame_size-this.offset;return r<0?this.metadata.addWarning("Frame "+this.frameCount+"corrupt: negative frameDataLeft"):await this.skipFrameData(r),null}async readXingInfoHeader(){const e=this.tokenizer.position,t=await(0,c.readXingHeader)(this.tokenizer);if(this.offset+=this.tokenizer.position-e,t.lame&&(this.metadata.setFormat("tool","LAME "+o.stripNulls(t.lame.version)),t.lame.extended&&(this.metadata.setFormat("trackPeakLevel",t.lame.extended.track_peak),t.lame.extended.track_gain&&this.metadata.setFormat("trackGain",t.lame.extended.track_gain.adjustment),t.lame.extended.album_gain&&this.metadata.setFormat("albumGain",t.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",t.lame.extended.music_length/1e3))),t.streamSize){const e=this.audioFrameHeader.calcDuration(t.numFrames);return this.metadata.setFormat("duration",e),u("Get duration from Xing header: %s",this.metadata.format.duration),t}const r=this.frame_size-this.offset;return await this.skipFrameData(r),t}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const t=e[0];return e.every((e=>e===t))}}t.MpegParser=m},6118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReplayGain=void 0;const n=r(3769);var i,a;!function(e){e[e.not_set=0]="not_set",e[e.radio=1]="radio",e[e.audiophile=2]="audiophile"}(i||(i={})),function(e){e[e.unspecified=0]="unspecified",e[e.engineer=1]="engineer",e[e.user=2]="user",e[e.automatic=3]="automatic",e[e.rms_average=4]="rms_average"}(a||(a={})),t.ReplayGain={len:2,get:(e,t)=>{const r=n.getBitAllignedNumber(e,t,0,3),i=n.getBitAllignedNumber(e,t,6,1),a=n.getBitAllignedNumber(e,t,7,9)/10;if(r>0)return{type:n.getBitAllignedNumber(e,t,0,3),origin:n.getBitAllignedNumber(e,t,3,3),adjustment:i?-a:a}}}},3566:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.readXingHeader=t.XingHeaderFlags=t.LameEncoderVersion=t.InfoTagHeaderTag=void 0;const i=r(3416),a=r(3769),s=r(5261);t.InfoTagHeaderTag=new i.StringType(4,"ascii"),t.LameEncoderVersion=new i.StringType(6,"ascii"),t.XingHeaderFlags={len:4,get:(e,t)=>({frames:a.isBitSet(e,t,31),bytes:a.isBitSet(e,t,30),toc:a.isBitSet(e,t,29),vbrScale:a.isBitSet(e,t,28)})},t.readXingHeader=async function(e){const r=await e.readToken(t.XingHeaderFlags),a={};if(r.frames&&(a.numFrames=await e.readToken(i.UINT32_BE)),r.bytes&&(a.streamSize=await e.readToken(i.UINT32_BE)),r.toc&&(a.toc=n.alloc(100),await e.readBuffer(a.toc)),r.vbrScale&&(a.vbrScale=await e.readToken(i.UINT32_BE)),"LAME"===await e.peekToken(new i.StringType(4,"ascii"))&&(await e.ignore(4),a.lame={version:await e.readToken(new i.StringType(5,"ascii"))},a.lame.version.match(/\d+.\d+/g))){const t=a.lame.version.match(/\d+.\d+/g)[0].split(".").map((e=>parseInt(e,10)));t[0]>=3&&t[1]>=90&&(a.lame.extended=await e.readToken(s.ExtendedLameHeader))}return a}},9606:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1227),i=r(3416),a=r(5159),s=r(5170),o=r(3928),l=(0,n.default)("music-metadata:parser:musepack");class c extends a.AbstractID3Parser{async postId3v2Parse(){let e;switch(await this.tokenizer.peekToken(new i.StringType(3,"binary"))){case"MP+":l("Musepack stream-version 7"),e=new o.MpcSv7Parser;break;case"MPC":l("Musepack stream-version 8"),e=new s.MpcSv8Parser;break;default:throw new Error("Invalid Musepack signature prefix")}return e.init(this.metadata,this.tokenizer,this.options),e.parse()}}t.default=c},2812:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BitReader=void 0;const n=r(3416);t.BitReader=class{constructor(e){this.tokenizer=e,this.pos=0,this.dword=void 0}async read(e){for(;void 0===this.dword;)this.dword=await this.tokenizer.readToken(n.UINT32_LE);let t=this.dword;return this.pos+=e,this.pos<32?(t>>>=32-this.pos,t&(1<<e)-1):(this.pos-=32,0===this.pos?(this.dword=void 0,t&(1<<e)-1):(this.dword=await this.tokenizer.readToken(n.UINT32_LE),this.pos&&(t<<=this.pos,t|=this.dword>>>32-this.pos),t&(1<<e)-1))}async ignore(e){if(this.pos>0){const t=32-this.pos;this.dword=void 0,e-=t,this.pos=0}const t=e%32,r=(e-t)/32;return await this.tokenizer.ignore(4*r),this.read(t)}}},3928:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MpcSv7Parser=void 0;const n=r(1227),i=r(7805),a=r(6742),s=r(2812),o=r(8153),l=(0,n.default)("music-metadata:parser:musepack");class c extends i.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){const e=await this.tokenizer.readToken(o.Header);if("MP+"!==e.signature)throw new Error("Unexpected magic number");l(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const t=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",t),this.duration=t/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new s.BitReader(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),l(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const e=await this.bitreader.read(20);this.audioLength+=20+e,await this.bitreader.ignore(e)}const t=await this.bitreader.read(11);this.audioLength+=t,this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}t.MpcSv7Parser=c},8153:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const i=r(3416),a=r(3769);t.Header={len:24,get:(e,t)=>{const r={signature:n.from(e).toString("latin1",t,t+3),streamMinorVersion:a.getBitAllignedNumber(e,t+3,0,4),streamMajorVersion:a.getBitAllignedNumber(e,t+3,4,4),frameCount:i.UINT32_LE.get(e,t+4),maxLevel:i.UINT16_LE.get(e,t+8),sampleFrequency:[44100,48e3,37800,32e3][a.getBitAllignedNumber(e,t+10,0,2)],link:a.getBitAllignedNumber(e,t+10,2,2),profile:a.getBitAllignedNumber(e,t+10,4,4),maxBand:a.getBitAllignedNumber(e,t+11,0,6),intensityStereo:a.isBitSet(e,t+11,6),midSideStereo:a.isBitSet(e,t+11,7),titlePeak:i.UINT16_LE.get(e,t+12),titleGain:i.UINT16_LE.get(e,t+14),albumPeak:i.UINT16_LE.get(e,t+16),albumGain:i.UINT16_LE.get(e,t+18),lastFrameLength:i.UINT32_LE.get(e,t+20)>>>20&2047,trueGapless:a.isBitSet(e,t+23,0)};return r.lastFrameLength=r.trueGapless?i.UINT32_LE.get(e,20)>>>20&2047:0,r}}},5170:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MpcSv8Parser=void 0;const n=r(1227),i=r(7805),a=r(6742),s=r(8049),o=r(8850),l=(0,n.default)("music-metadata:parser:musepack");class c extends i.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){if("MPCK"!==await this.tokenizer.readToken(s.FourCcToken))throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new o.StreamReader(this.tokenizer);for(;;){const t=await e.readPacketHeader();switch(l(`packet-header key=${t.key}, payloadLength=${t.payloadLength}`),t.key){case"SH":const r=await e.readStreamHeader(t.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break;case"AP":this.audioLength+=t.payloadLength,await this.tokenizer.ignore(t.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(t.payloadLength);break;case"SE":return this.metadata.setFormat("bitrate",8*this.audioLength/this.metadata.format.duration),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${t.key}`)}}}}t.MpcSv8Parser=c},8850:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=void 0;const n=r(3416),i=r(1227),a=r(3769),s=(0,i.default)("music-metadata:parser:musepack:sv8"),o=new n.StringType(2,"binary"),l={len:5,get:(e,t)=>({crc:n.UINT32_LE.get(e,t),streamVersion:n.UINT8.get(e,t+4)})},c={len:2,get:(e,t)=>({sampleFrequency:[44100,48e3,37800,32e3][a.getBitAllignedNumber(e,t,0,3)],maxUsedBands:a.getBitAllignedNumber(e,t,3,5),channelCount:a.getBitAllignedNumber(e,t+1,0,4)+1,msUsed:a.isBitSet(e,t+1,4),audioBlockFrames:a.getBitAllignedNumber(e,t+1,5,3)})};t.StreamReader=class{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(o),t=await this.readVariableSizeField();return{key:e,payloadLength:t.value-2-t.len}}async readStreamHeader(e){const t={};s(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(l);e-=l.len,Object.assign(t,r),s(`SH.streamVersion = ${r.streamVersion}`);const n=await this.readVariableSizeField();e-=n.len,t.sampleCount=n.value;const i=await this.readVariableSizeField();e-=i.len,t.beginningOfSilence=i.value;const a=await this.tokenizer.readToken(c);return e-=c.len,Object.assign(t,a),await this.tokenizer.ignore(e),t}async readVariableSizeField(e=1,t=0){let r=await this.tokenizer.readNumber(n.UINT8);return 0==(128&r)?{len:e,value:t+r}:(r&=127,r+=t,this.readVariableSizeField(e+1,r<<7))}}},1915:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.OggParser=t.SegmentTable=void 0;const i=r(3416),a=r(5849),s=r(1227),o=r(3769),l=r(8049),c=r(7805),u=r(4210),h=r(1272),d=r(573),f=r(2630),m=(0,s.default)("music-metadata:parser:ogg");class p{constructor(e){this.len=e.page_segments}static sum(e,t,r){let n=0;for(let i=t;i<t+r;++i)n+=e[i];return n}get(e,t){return{totalPageSize:p.sum(e,t,this.len)}}}t.SegmentTable=p;class g extends c.BasicParser{async parse(){m("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(g.Header),"OggS"!==e.capturePattern)throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,m("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const t=await this.tokenizer.readToken(new p(e));m("totalPageSize=%s",t.totalPageSize);const r=await this.tokenizer.readToken(new i.Uint8ArrayType(t.totalPageSize));if(m("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const e=new i.StringType(7,"ascii").get(n.from(r),0);switch(e){case"vorbis":m("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new u.VorbisParser(this.metadata,this.options);break;case"OpusHea":m("Set page consumer to Ogg/Opus"),this.pageConsumer=new h.OpusParser(this.metadata,this.options,this.tokenizer);break;case"Speex  ":m("Set page consumer to Ogg/Speex"),this.pageConsumer=new d.SpeexParser(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":m("Set page consumer to Ogg/Theora"),this.pageConsumer=new f.TheoraParser(this.metadata,this.options,this.tokenizer);break;default:throw new Error("gg audio-codec not recognized (id="+e+")")}}this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof a.EndOfStreamError)this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),m("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header);else{if(!e.message.startsWith("FourCC"))throw e;this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),this.pageConsumer.flush())}}}}t.OggParser=g,g.Header={len:27,get:(e,t)=>({capturePattern:l.FourCcToken.get(e,t),version:i.UINT8.get(e,t+4),headerType:{continued:o.getBit(e,t+5,0),firstPage:o.getBit(e,t+5,1),lastPage:o.getBit(e,t+5,2)},absoluteGranulePosition:Number(i.UINT64_LE.get(e,t+6)),streamSerialNumber:i.UINT32_LE.get(e,t+14),pageSequenceNo:i.UINT32_LE.get(e,t+18),pageChecksum:i.UINT32_LE.get(e,t+22),page_segments:i.UINT8.get(e,t+26)})}},5044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdHeader=void 0;const n=r(3416);t.IdHeader=class{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,t){return{magicSignature:new n.StringType(8,"ascii").get(e,t+0),version:e.readUInt8(t+8),channelCount:e.readUInt8(t+9),preSkip:e.readInt16LE(t+10),inputSampleRate:e.readInt32LE(t+12),outputGain:e.readInt16LE(t+16),channelMapping:e.readUInt8(t+18)}}}},1272:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpusParser=void 0;const n=r(3416),i=r(4210),a=r(5044);class s extends i.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r,this.lastPos=-1}parseFirstPage(e,t){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new a.IdHeader(t.length).get(t,0),"OpusHead"!==this.idHeader.magicSignature)throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}parseFullPage(e){"OpusTags"===new n.StringType(8,"ascii").get(e,0)&&(this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length)}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const t=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",t),this.metadata.setFormat("duration",t/48e3),-1!==this.lastPos&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}}}t.OpusParser=s},6666:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const n=r(3416),i=r(3769);t.Header={len:80,get:(e,t)=>({speex:new n.StringType(8,"ascii").get(e,t+0),version:i.trimRightNull(new n.StringType(20,"ascii").get(e,t+8)),version_id:e.readInt32LE(t+28),header_size:e.readInt32LE(t+32),rate:e.readInt32LE(t+36),mode:e.readInt32LE(t+40),mode_bitstream_version:e.readInt32LE(t+44),nb_channels:e.readInt32LE(t+48),bitrate:e.readInt32LE(t+52),frame_size:e.readInt32LE(t+56),vbr:e.readInt32LE(t+60),frames_per_packet:e.readInt32LE(t+64),extra_headers:e.readInt32LE(t+68),reserved1:e.readInt32LE(t+72),reserved2:e.readInt32LE(t+76)})}},573:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpeexParser=void 0;const n=r(1227),i=r(4210),a=r(6666),s=(0,n.default)("music-metadata:parser:ogg:speex");class o extends i.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r}parseFirstPage(e,t){s("First Ogg/Speex page");const r=a.Header.get(t,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),-1!==r.bitrate&&this.metadata.setFormat("bitrate",r.bitrate)}}t.SpeexParser=o},5177:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentificationHeader=void 0;const n=r(3416);t.IdentificationHeader={len:42,get:(e,t)=>({id:new n.StringType(7,"ascii").get(e,t),vmaj:e.readUInt8(t+7),vmin:e.readUInt8(t+8),vrev:e.readUInt8(t+9),vmbw:e.readUInt16BE(t+10),vmbh:e.readUInt16BE(t+17),nombr:n.UINT24_BE.get(e,t+37),nqual:e.readUInt8(t+40)})}},2630:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TheoraParser=void 0;const n=r(1227),i=r(5177),a=(0,n.default)("music-metadata:parser:ogg:theora");t.TheoraParser=class{constructor(e,t,r){this.metadata=e,this.tokenizer=r}parsePage(e,t){e.headerType.firstPage&&this.parseFirstPage(e,t)}flush(){a("flush")}calculateDuration(e){a("duration calculation not implemented")}parseFirstPage(e,t){a("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=i.IdentificationHeader.get(t,0);this.metadata.setFormat("bitrate",r.nombr)}}},2127:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.IdentificationHeader=t.CommonHeader=t.VorbisPictureToken=void 0;const i=r(3416),a=r(8281);class s{constructor(e){this.len=e}static fromBase64(e){return this.fromBuffer(n.from(e,"base64"))}static fromBuffer(e){return new s(e.length).get(e,0)}get(e,t){const r=a.AttachedPictureType[i.UINT32_BE.get(e,t)],s=i.UINT32_BE.get(e,t+=4),o=e.toString("utf-8",t+=4,t+s),l=i.UINT32_BE.get(e,t+=s),c=e.toString("utf-8",t+=4,t+l),u=i.UINT32_BE.get(e,t+=l),h=i.UINT32_BE.get(e,t+=4),d=i.UINT32_BE.get(e,t+=4),f=i.UINT32_BE.get(e,t+=4),m=i.UINT32_BE.get(e,t+=4);return{type:r,format:o,description:c,width:u,height:h,colour_depth:d,indexed_color:f,data:n.from(e.slice(t+=4,t+m))}}}t.VorbisPictureToken=s,t.CommonHeader={len:7,get:(e,t)=>({packetType:e.readUInt8(t),vorbis:new i.StringType(6,"ascii").get(e,t+1)})},t.IdentificationHeader={len:23,get:(e,t)=>{const r=new DataView(e.buffer,e.byteOffset);return{version:r.getUint32(t+0,!0),channelMode:r.getUint8(t+4),sampleRate:r.getUint32(t+5,!0),bitrateMax:r.getUint32(t+9,!0),bitrateNominal:r.getUint32(t+13,!0),bitrateMin:r.getUint32(t+17,!0)}}}},441:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisDecoder=void 0;const i=r(3416);t.VorbisDecoder=class{constructor(e,t){this.data=e,this.offset=t}readInt32(){const e=i.UINT32_LE.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),t=n.from(this.data).toString("utf-8",this.offset,this.offset+e);return this.offset+=e,t}parseUserComment(){const e=this.offset,t=this.readStringUtf8(),r=t.indexOf("=");return{key:t.slice(0,r).toUpperCase(),value:t.slice(r+1),len:this.offset-e}}}},4210:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisParser=void 0;const i=r(3416),a=r(1227),s=r(441),o=r(2127),l=(0,a.default)("music-metadata:parser:ogg:vorbis1");t.VorbisParser=class{constructor(e,t){this.metadata=e,this.options=t,this.pageSegments=[]}parsePage(e,t){if(e.headerType.firstPage)this.parseFirstPage(e,t);else{if(e.headerType.continued){if(0===this.pageSegments.length)throw new Error("Cannot continue on previous page");this.pageSegments.push(t)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const e=n.concat(this.pageSegments);this.parseFullPage(e)}this.pageSegments=e.headerType.lastPage?[]:[t]}}e.headerType.lastPage&&this.calculateDuration(e)}flush(){this.parseFullPage(n.concat(this.pageSegments))}parseUserComment(e,t){const r=new s.VorbisDecoder(e,t).parseUserComment();return this.addTag(r.key,r.value),r.len}addTag(e,t){if("METADATA_BLOCK_PICTURE"===e&&"string"==typeof t){if(this.options.skipCovers)return void l("Ignore picture");t=o.VorbisPictureToken.fromBase64(t),l(`Push picture: id=${e}, format=${t.format}`)}else l(`Push tag: id=${e}, value=${t}`);this.metadata.addTag("vorbis",e,t)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate))}parseFirstPage(e,t){this.metadata.setFormat("codec","Vorbis I"),l("Parse first page");const r=o.CommonHeader.get(t,0);if("vorbis"!==r.vorbis)throw new Error("Metadata does not look like Vorbis");if(1!==r.packetType)throw new Error("First Ogg page should be type 1: the identification header");{const e=o.IdentificationHeader.get(t,o.CommonHeader.len);this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("bitrate",e.bitrateNominal),this.metadata.setFormat("numberOfChannels",e.channelMode),l("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",e.sampleRate,e.bitrateNominal,e.channelMode)}}parseFullPage(e){const t=o.CommonHeader.get(e,0);if(l("Parse full page: type=%s, byteLength=%s",t.packetType,e.byteLength),3===t.packetType)return this.parseUserCommentList(e,o.CommonHeader.len)}parseUserCommentList(e,t){const r=i.UINT32_LE.get(e,t);t+=4,t+=r;let n=i.UINT32_LE.get(e,t);for(t+=4;n-- >0;)t+=this.parseUserComment(e,t)}}},9860:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisTagMapper=void 0;const n=r(9918),i={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class a extends n.CommonTagMapper{static toRating(e,t){return{source:e?e.toLowerCase():e,rating:parseFloat(t)*n.CommonTagMapper.maxRatingScore}}constructor(){super(["vorbis"],i)}postMap(e){if(0===e.id.indexOf("RATING:")){const t=e.id.split(":");e.value=a.toRating(t[1],e.value),e.id=t[0]}}}t.VorbisTagMapper=a},3211:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListInfoTagValue=t.Header=void 0;const n=r(3416);t.Header={len:8,get:(e,t)=>({chunkID:e.toString("binary",t,t+4),chunkSize:n.UINT32_LE.get(e,4)})},t.ListInfoTagValue=class{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=1&this.len}get(e,t){return new n.StringType(this.tagHeader.chunkSize,"ascii").get(e,t)}}},5756:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RiffInfoTagMapper=t.riffInfoTagMap=void 0;const n=r(9918);t.riffInfoTagMap={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class i extends n.CommonTagMapper{constructor(){super(["exif"],t.riffInfoTagMap)}}t.RiffInfoTagMapper=i},6032:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackType=void 0;var n=r(8591);Object.defineProperty(t,"TrackType",{enumerable:!0,get:function(){return n.TrackType}})},8053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BroadcastAudioExtensionChunk=void 0;const n=r(3416),i=r(3769);t.BroadcastAudioExtensionChunk={len:420,get:(e,t)=>({description:(0,i.stripNulls)(new n.StringType(256,"ascii").get(e,t)).trim(),originator:(0,i.stripNulls)(new n.StringType(32,"ascii").get(e,t+256)).trim(),originatorReference:(0,i.stripNulls)(new n.StringType(32,"ascii").get(e,t+288)).trim(),originationDate:(0,i.stripNulls)(new n.StringType(10,"ascii").get(e,t+320)).trim(),originationTime:(0,i.stripNulls)(new n.StringType(8,"ascii").get(e,t+330)).trim(),timeReferenceLow:n.UINT32_LE.get(e,t+338),timeReferenceHigh:n.UINT32_LE.get(e,t+342),version:n.UINT16_LE.get(e,t+346),umid:new n.Uint8ArrayType(64).get(e,t+348),loudnessValue:n.UINT16_LE.get(e,t+412),maxTruePeakLevel:n.UINT16_LE.get(e,t+414),maxMomentaryLoudness:n.UINT16_LE.get(e,t+416),maxShortTermLoudness:n.UINT16_LE.get(e,t+418)})}},9975:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.FactChunk=t.Format=t.WaveFormat=void 0,(r=t.WaveFormat||(t.WaveFormat={}))[r.PCM=1]="PCM",r[r.ADPCM=2]="ADPCM",r[r.IEEE_FLOAT=3]="IEEE_FLOAT",r[r.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",r[r.MPEG_LOAS=5634]="MPEG_LOAS",r[r.RAW_AAC1=255]="RAW_AAC1",r[r.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",r[r.DVM=8192]="DVM",r[r.RAW_SPORT=576]="RAW_SPORT",r[r.ESST_AC3=577]="ESST_AC3",r[r.DRM=9]="DRM",r[r.DTS2=8193]="DTS2",r[r.MPEG=80]="MPEG",t.Format=class{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,t){return{wFormatTag:e.readUInt16LE(t),nChannels:e.readUInt16LE(t+2),nSamplesPerSec:e.readUInt32LE(t+4),nAvgBytesPerSec:e.readUInt32LE(t+8),nBlockAlign:e.readUInt16LE(t+12),wBitsPerSample:e.readUInt16LE(t+14)}}},t.FactChunk=class{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,t){return{dwSampleLength:e.readUInt32LE(t)}}}},2682:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WaveParser=void 0;const n=r(5849),i=r(3416),a=r(1227),s=r(3211),o=r(9975),l=r(8928),c=r(3769),u=r(8049),h=r(7805),d=r(8053),f=(0,a.default)("music-metadata:parser:RIFF");class m extends h.BasicParser{async parse(){const e=await this.tokenizer.readToken(s.Header);if(f(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),"RIFF"===e.chunkID)return this.parseRiffChunk(e.chunkSize).catch((e=>{if(!(e instanceof n.EndOfStreamError))throw e}))}async parseRiffChunk(e){const t=await this.tokenizer.readToken(u.FourCcToken);if(this.metadata.setFormat("container",t),"WAVE"===t)return this.readWaveChunk(e-u.FourCcToken.len);throw new Error(`Unsupported RIFF format: RIFF/${t}`)}async readWaveChunk(e){for(;e>=s.Header.len;){const t=await this.tokenizer.readToken(s.Header);switch(e-=s.Header.len+t.chunkSize,t.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=t,f(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${t.chunkID}`),t.chunkID){case"LIST":await this.parseListTag(t);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new o.FactChunk(t));break;case"fmt ":const e=await this.tokenizer.readToken(new o.Format(t));let r=o.WaveFormat[e.wFormatTag];r||(f("WAVE/non-PCM format="+e.wFormatTag),r="non-PCM ("+e.wFormatTag+")"),this.metadata.setFormat("codec",r),this.metadata.setFormat("bitsPerSample",e.wBitsPerSample),this.metadata.setFormat("sampleRate",e.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",e.nChannels),this.metadata.setFormat("bitrate",e.nBlockAlign*e.nSamplesPerSec*8),this.blockAlign=e.nBlockAlign;break;case"id3 ":case"ID3 ":const a=await this.tokenizer.readToken(new i.Uint8ArrayType(t.chunkSize)),s=n.fromBuffer(a);await(new l.ID3v2Parser).parse(this.metadata,s,this.options);break;case"data":!1!==this.metadata.format.lossless&&this.metadata.setFormat("lossless",!0);let c=t.chunkSize;if(this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;e<c&&(this.metadata.addWarning("data chunk length exceeding file length"),c=e)}const u=this.fact?this.fact.dwSampleLength:4294967295===c?void 0:c/this.blockAlign;u&&(this.metadata.setFormat("numberOfSamples",u),this.metadata.setFormat("duration",u/this.metadata.format.sampleRate)),this.metadata.setFormat("bitrate",this.metadata.format.numberOfChannels*this.blockAlign*this.metadata.format.sampleRate),await this.tokenizer.ignore(t.chunkSize);break;case"bext":const h=await this.tokenizer.readToken(d.BroadcastAudioExtensionChunk);Object.keys(h).forEach((e=>{this.metadata.addTag("exif","bext."+e,h[e])}));const m=t.chunkSize-d.BroadcastAudioExtensionChunk.len;await this.tokenizer.ignore(m);break;case"\0\0\0\0":f(`Ignore padding chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize);break;default:f(`Ignore chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize)}this.header.chunkSize%2==1&&(f("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const t=await this.tokenizer.readToken(new i.StringType(4,"binary"));return f("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,t),"INFO"===t?this.parseRiffInfoTags(e.chunkSize-4):(this.metadata.addWarning("Ignore chunk: RIFF/WAVE/LIST/"+t),f("Ignoring chunkID=RIFF/WAVE/LIST/"+t),this.tokenizer.ignore(e.chunkSize-4).then())}async parseRiffInfoTags(e){for(;e>=8;){const t=await this.tokenizer.readToken(s.Header),r=new s.ListInfoTagValue(t),n=await this.tokenizer.readToken(r);this.addTag(t.chunkID,c.stripNulls(n)),e-=8+r.len}if(0!==e)throw Error("Illegal remaining size: "+e)}addTag(e,t){this.metadata.addTag("exif",e,t)}}t.WaveParser=m},5870:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.WavPackParser=void 0;const i=r(3416),a=r(6742),s=r(8049),o=r(7805),l=r(2989),c=(0,r(1227).default)("music-metadata:parser:WavPack");class u extends o.BasicParser{async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if("wvpk"!==await this.tokenizer.peekToken(s.FourCcToken))break;const e=await this.tokenizer.readToken(l.WavPack.BlockHeaderToken);if("wvpk"!==e.BlockID)throw new Error("Invalid WavPack Block-ID");c(`WavPack header blockIndex=${e.blockIndex}, len=${l.WavPack.BlockHeaderToken.len}`),0!==e.blockIndex||this.metadata.format.container||(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!e.flags.isHybrid),this.metadata.setFormat("bitsPerSample",e.flags.bitsPerSample),e.flags.isDSD||(this.metadata.setFormat("sampleRate",e.flags.samplingRate),this.metadata.setFormat("duration",e.totalSamples/e.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",e.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",e.totalSamples),this.metadata.setFormat("codec",e.flags.isDSD?"DSD":"PCM"));const t=e.blockSize-(l.WavPack.BlockHeaderToken.len-8);await(0===e.blockIndex?this.parseMetadataSubBlock(e,t):this.tokenizer.ignore(t)),e.blockSamples>0&&(this.audioDataSize+=e.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=l.WavPack.BlockHeaderToken.len);this.metadata.setFormat("bitrate",8*this.audioDataSize/this.metadata.format.duration)}async parseMetadataSubBlock(e,t){for(;t>l.WavPack.MetadataIdToken.len;){const r=await this.tokenizer.readToken(l.WavPack.MetadataIdToken),a=await this.tokenizer.readNumber(r.largeBlock?i.UINT24_LE:i.UINT8),s=n.alloc(2*a-(r.isOddSize?1:0));switch(await this.tokenizer.readBuffer(s),c(`Metadata Sub-Blocks functionId=0x${r.functionId.toString(16)}, id.largeBlock=${r.largeBlock},data-size=${s.length}`),r.functionId){case 0:break;case 14:c("ID_DSD_BLOCK");const t=1<<s.readUInt8(0),n=e.flags.samplingRate*t*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",n),this.metadata.setFormat("duration",e.totalSamples/n);break;case 36:c("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",s);break;case 47:c(`ID_BLOCK_CHECKSUM: checksum=${s.toString("hex")}`);break;default:c(`Ignore unsupported meta-sub-block-id functionId=0x${r.functionId.toString(16)}`)}t-=l.WavPack.MetadataIdToken.len+(r.largeBlock?i.UINT24_LE.len:i.UINT8.len)+2*a,c(`remainingLength=${t}`),r.isOddSize&&this.tokenizer.ignore(1)}if(0!==t)throw new Error("metadata-sub-block should fit it remaining length")}}t.WavPackParser=u},2989:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WavPack=void 0;const n=r(3416),i=r(8049),a=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1];class s{static isBitSet(e,t){return 1===s.getBitAllignedNumber(e,t,1)}static getBitAllignedNumber(e,t,r){return e>>>t&4294967295>>>32-r}}t.WavPack=s,s.BlockHeaderToken={len:32,get:(e,t)=>{const r=n.UINT32_LE.get(e,t+24),o={BlockID:i.FourCcToken.get(e,t),blockSize:n.UINT32_LE.get(e,t+4),version:n.UINT16_LE.get(e,t+8),totalSamples:n.UINT32_LE.get(e,t+12),blockIndex:n.UINT32_LE.get(e,t+16),blockSamples:n.UINT32_LE.get(e,t+20),flags:{bitsPerSample:8*(1+s.getBitAllignedNumber(r,0,2)),isMono:s.isBitSet(r,2),isHybrid:s.isBitSet(r,3),isJointStereo:s.isBitSet(r,4),crossChannel:s.isBitSet(r,5),hybridNoiseShaping:s.isBitSet(r,6),floatingPoint:s.isBitSet(r,7),samplingRate:a[s.getBitAllignedNumber(r,23,4)],isDSD:s.isBitSet(r,31)},crc:new n.Uint8ArrayType(4).get(e,t+28)};return o.flags.isDSD&&(o.totalSamples*=8),o}},s.MetadataIdToken={len:1,get:(e,t)=>({functionId:s.getBitAllignedNumber(e[t],0,6),isOptional:s.isBitSet(e[t],5),isOddSize:s.isBitSet(e[t],6),largeBlock:s.isBitSet(e[t],7)})}},8985:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0,t.Deferred=class{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}},7279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndOfStreamError=t.defaultMessages=void 0,t.defaultMessages="End-Of-Stream";class r extends Error{constructor(){super(t.defaultMessages)}}t.EndOfStreamError=r},6654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;const n=r(7279),i=r(8985);var a=r(7279);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return a.EndOfStreamError}}),t.StreamReader=class{constructor(e){if(this.s=e,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!e.read||!e.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",(()=>this.reject(new n.EndOfStreamError))),this.s.once("error",(e=>this.reject(e))),this.s.once("close",(()=>this.reject(new Error("Stream closed"))))}async peek(e,t,r){const n=await this.read(e,t,r);return this.peekQueue.push(e.subarray(t,t+n)),n}async read(e,t,r){if(0===r)return 0;if(0===this.peekQueue.length&&this.endOfStream)throw new n.EndOfStreamError;let i=r,a=0;for(;this.peekQueue.length>0&&i>0;){const r=this.peekQueue.pop();if(!r)throw new Error("peekData should be defined");const n=Math.min(r.length,i);e.set(r.subarray(0,n),t+a),a+=n,i-=n,n<r.length&&this.peekQueue.push(r.subarray(n))}for(;i>0&&!this.endOfStream;){const r=Math.min(i,1048576),n=await this.readFromStream(e,t+a,r);if(a+=n,n<r)break;i-=n}return a}async readFromStream(e,t,r){const n=this.s.read(r);if(n)return e.set(n,t),n.length;{const n={buffer:e,offset:t,length:r,deferred:new i.Deferred};return this.deferred=n.deferred,this.s.once("readable",(()=>{this.readDeferred(n)})),n.deferred.promise}}readDeferred(e){const t=this.s.read(e.length);t?(e.buffer.set(t,e.offset),e.deferred.resolve(t.length),this.deferred=null):this.s.once("readable",(()=>{this.readDeferred(e)}))}reject(e){this.endOfStream=!0,this.deferred&&(this.deferred.reject(e),this.deferred=null)}}},5167:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;var n=r(7279);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return n.EndOfStreamError}});var i=r(6654);Object.defineProperty(t,"StreamReader",{enumerable:!0,get:function(){return i.StreamReader}})},4155:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var o,l=[],c=!1,u=-1;function h(){c&&o&&(c=!1,o.length?l=o.concat(l):u=-1,l.length&&d())}function d(){if(!c){var e=s(h);c=!0;for(var t=l.length;t;){for(o=l,l=[];++u<t;)o&&o[u].run();u=-1,t=l.length}o=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new f(e,t)),1!==l.length||c||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},4448:(e,t,r)=>{"use strict";var n=r(7294),i=r(3840);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function p(e,t,r,n,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var A=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,r,n){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null==t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!h.call(m,e)||!h.call(f,e)&&(d.test(e)?m[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(A,v);g[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(A,v);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(A,v);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),k=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var B=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function D(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=L&&e[L]||e["@@iterator"])?e:null}var N,O=Object.assign;function z(e){if(void 0===N)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),a=n.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{F=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?z(e):""}function j(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return U(e.type,!1);case 11:return U(e.type.render,!1);case 1:return U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case E:return"Fragment";case _:return"Portal";case S:return"Profiler";case x:return"StrictMode";case C:return"Suspense";case P:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return V(e(t))}catch(e){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function Q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function X(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=X(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=X(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function H(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var r=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=Q(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){K(e,t);var r=Q(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,Q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&H(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Q(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(a(92));if(te(r)){if(1<r.length)throw Error(a(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:Q(r)}}function ae(e,t){var r=Q(t.value),n=Q(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function pe(e,t,r){return null==t||"boolean"==typeof t||""===t?"":r||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=pe(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(fe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var Ae=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(Ae[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Ee=null,xe=null;function Se(e){if(e=bi(e)){if("function"!=typeof _e)throw Error(a(280));var t=e.stateNode;t&&(t=wi(t),_e(e.stateNode,e.type,t))}}function Te(e){Ee?xe?xe.push(e):xe=[e]:Ee=e}function ke(){if(Ee){var e=Ee,t=xe;if(xe=Ee=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ie(e,t){return e(t)}function Ce(){}var Pe=!1;function Me(e,t,r){if(Pe)return e(t,r);Pe=!0;try{return Ie(e,t,r)}finally{Pe=!1,(null!==Ee||null!==xe)&&(Ce(),ke())}}function Re(e,t){var r=e.stateNode;if(null===r)return null;var n=wi(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(a(231,t,typeof r));return r}var Be=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Be=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){Be=!1}function De(e,t,r,n,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(e){this.onError(e)}}var Ne=!1,Oe=null,ze=!1,Fe=null,Ue={onError:function(e){Ne=!0,Oe=e}};function je(e,t,r,n,i,a,s,o,l){Ne=!1,Oe=null,De.apply(Ue,arguments)}function Ve(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Qe(e){if(Ve(e)!==e)throw Error(a(188))}function Xe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Qe(i),e;if(s===n)return Qe(i),t;s=s.sibling}throw Error(a(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(r.alternate!==n)throw Error(a(190))}if(3!==r.tag)throw Error(a(188));return r.stateNode.current===r?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var $e=i.unstable_scheduleCallback,He=i.unstable_cancelCallback,Ge=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Ke=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,at=null,st=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2,ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=268435455&r;if(0!==s){var o=s&~i;0!==o?n=ht(o):0!=(a&=s)&&(n=ht(a))}else 0!=(s=r&~i)?n=ht(s):0!==a&&(n=ht(a));if(0===n)return 0;if(0!==t&&t!==n&&0==(t&i)&&((i=n&-n)>=(a=t&-t)||16===i&&0!=(4194240&a)))return t;if(0!=(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-st(t)),n|=e[r],t&=~i;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0==(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function At(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=r}function vt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-st(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var bt=0;function yt(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var wt,_t,Et,xt,St,Tt=!1,kt=[],It=null,Ct=null,Pt=null,Mt=new Map,Rt=new Map,Bt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Nt(e,t,r,n,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},null!==t&&null!==(t=bi(t))&&_t(t),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ot(e){var t=vi(e.target);if(null!==t){var r=Ve(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=qe(r)))return e.blockedOn=t,void St(e.priority,(function(){Et(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Gt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=bi(r))&&_t(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);ye=n,r.target.dispatchEvent(n),ye=null,t.shift()}return!0}function Ft(e,t,r){zt(e)&&r.delete(t)}function Ut(){Tt=!1,null!==It&&zt(It)&&(It=null),null!==Ct&&zt(Ct)&&(Ct=null),null!==Pt&&zt(Pt)&&(Pt=null),Mt.forEach(Ft),Rt.forEach(Ft)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return jt(t,e)}if(0<kt.length){jt(kt[0],e);for(var r=1;r<kt.length;r++){var n=kt[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==It&&jt(It,e),null!==Ct&&jt(Ct,e),null!==Pt&&jt(Pt,e),Mt.forEach(t),Rt.forEach(t),r=0;r<Bt.length;r++)(n=Bt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Bt.length&&null===(r=Bt[0]).blockedOn;)Ot(r),null===r.blockedOn&&Bt.shift()}var qt=y.ReactCurrentBatchConfig,Qt=!0;function Xt(e,t,r,n){var i=bt,a=qt.transition;qt.transition=null;try{bt=1,$t(e,t,r,n)}finally{bt=i,qt.transition=a}}function Wt(e,t,r,n){var i=bt,a=qt.transition;qt.transition=null;try{bt=4,$t(e,t,r,n)}finally{bt=i,qt.transition=a}}function $t(e,t,r,n){if(Qt){var i=Gt(e,t,r,n);if(null===i)Qn(e,t,n,Ht,r),Dt(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return It=Nt(It,e,t,r,n,i),!0;case"dragenter":return Ct=Nt(Ct,e,t,r,n,i),!0;case"mouseover":return Pt=Nt(Pt,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return Mt.set(a,Nt(Mt.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,Rt.set(a,Nt(Rt.get(a)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Dt(e,n),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var a=bi(i);if(null!==a&&wt(a),null===(a=Gt(e,t,r,n))&&Qn(e,t,n,Ht,r),a===i)break;i=a}null!==i&&n.stopPropagation()}else Qn(e,t,n,null,r)}}var Ht=null;function Gt(e,t,r,n){if(Ht=null,null!==(e=vi(e=we(n))))if(null===(t=Ve(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ht=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Kt=null,Jt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Jt,n=r.length,i="value"in Kt?Kt.value:Kt.textContent,a=i.length;for(e=0;e<n&&r[e]===i[e];e++);var s=n-e;for(t=1;t<=s&&r[n-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ir(e){function t(t,r,n,i,a){for(var s in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ar,sr,or,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ir(lr),ur=O({},lr,{view:0,detail:0}),hr=ir(ur),dr=O({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(ar=e.screenX-or.screenX,sr=e.screenY-or.screenY):sr=ar=0,or=e),ar)},movementY:function(e){return"movementY"in e?e.movementY:sr}}),fr=ir(dr),mr=ir(O({},dr,{dataTransfer:0})),pr=ir(O({},ur,{relatedTarget:0})),gr=ir(O({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),Ar=O({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vr=ir(Ar),br=ir(O({},lr,{data:0})),yr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_r={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Er(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_r[e])&&!!t[e]}function xr(){return Er}var Sr=O({},ur,{key:function(e){if(e.key){var t=yr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tr=ir(Sr),kr=ir(O({},dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ir=ir(O({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xr})),Cr=ir(O({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pr=O({},dr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mr=ir(Pr),Rr=[9,13,27,32],Br=u&&"CompositionEvent"in window,Lr=null;u&&"documentMode"in document&&(Lr=document.documentMode);var Dr=u&&"TextEvent"in window&&!Lr,Nr=u&&(!Br||Lr&&8<Lr&&11>=Lr),Or=String.fromCharCode(32),zr=!1;function Fr(e,t){switch(e){case"keyup":return-1!==Rr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var jr=!1,Vr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vr[e.type]:"textarea"===t}function Qr(e,t,r,n){Te(n),0<(t=Wn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xr=null,Wr=null;function $r(e){zn(e,0)}function Hr(e){if($(yi(e)))return e}function Gr(e,t){if("change"===e)return t}var Yr=!1;if(u){var Kr;if(u){var Jr="oninput"in document;if(!Jr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Jr="function"==typeof Zr.oninput}Kr=Jr}else Kr=!1;Yr=Kr&&(!document.documentMode||9<document.documentMode)}function en(){Xr&&(Xr.detachEvent("onpropertychange",tn),Wr=Xr=null)}function tn(e){if("value"===e.propertyName&&Hr(Wr)){var t=[];Qr(t,Wr,e,we(e)),Me($r,t)}}function rn(e,t,r){"focusin"===e?(en(),Wr=r,(Xr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Hr(Wr)}function an(e,t){if("click"===e)return Hr(t)}function sn(e,t){if("input"===e||"change"===e)return Hr(t)}var on="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function ln(e,t){if(on(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!h.call(t,i)||!on(e[i],t[i]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=H();t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(e){r=!1}if(!r)break;t=H((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=dn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=void 0===n.end?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=un(r,a);var s=un(r,n);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pn=u&&"documentMode"in document&&11>=document.documentMode,gn=null,An=null,vn=null,bn=!1;function yn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bn||null==gn||gn!==H(n)||(n="selectionStart"in(n=gn)&&fn(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&ln(vn,n)||(vn=n,0<(n=Wn(An,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function wn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var _n={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},En={},xn={};function Sn(e){if(En[e])return En[e];if(!_n[e])return e;var t,r=_n[e];for(t in r)if(r.hasOwnProperty(t)&&t in xn)return En[e]=r[t];return e}u&&(xn=document.createElement("div").style,"AnimationEvent"in window||(delete _n.animationend.animation,delete _n.animationiteration.animation,delete _n.animationstart.animation),"TransitionEvent"in window||delete _n.transitionend.transition);var Tn=Sn("animationend"),kn=Sn("animationiteration"),In=Sn("animationstart"),Cn=Sn("transitionend"),Pn=new Map,Mn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rn(e,t){Pn.set(e,t),l(t,[e])}for(var Bn=0;Bn<Mn.length;Bn++){var Ln=Mn[Bn];Rn(Ln.toLowerCase(),"on"+(Ln[0].toUpperCase()+Ln.slice(1)))}Rn(Tn,"onAnimationEnd"),Rn(kn,"onAnimationIteration"),Rn(In,"onAnimationStart"),Rn("dblclick","onDoubleClick"),Rn("focusin","onFocus"),Rn("focusout","onBlur"),Rn(Cn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dn));function On(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,s,o,l,c){if(je.apply(this,arguments),Ne){if(!Ne)throw Error(a(198));var u=Oe;Ne=!1,Oe=null,ze||(ze=!0,Fe=u)}}(n,t,void 0,e),e.currentTarget=null}function zn(e,t){t=0!=(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;On(i,o,c),a=l}else for(s=0;s<n.length;s++){if(l=(o=n[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;On(i,o,c),a=l}}}if(ze)throw e=Fe,ze=!1,Fe=null,e}function Fn(e,t){var r=t[pi];void 0===r&&(r=t[pi]=new Set);var n=e+"__bubble";r.has(n)||(qn(t,e,2,!1),r.add(n))}function Un(e,t,r){var n=0;t&&(n|=4),qn(r,e,n,t)}var jn="_reactListening"+Math.random().toString(36).slice(2);function Vn(e){if(!e[jn]){e[jn]=!0,s.forEach((function(t){"selectionchange"!==t&&(Nn.has(t)||Un(t,!1,e),Un(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jn]||(t[jn]=!0,Un("selectionchange",!1,t))}}function qn(e,t,r,n){switch(Yt(t)){case 1:var i=Xt;break;case 4:i=Wt;break;default:i=$t}r=i.bind(null,t,r,e),i=void 0,!Be||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Qn(e,t,r,n,i){var a=n;if(0==(1&t)&&0==(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var o=n.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=n.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=vi(o)))return;if(5===(l=s.tag)||6===l){n=a=s;continue e}o=o.parentNode}}n=n.return}Me((function(){var n=a,i=we(r),s=[];e:{var o=Pn.get(e);if(void 0!==o){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Tr;break;case"focusin":c="focus",l=pr;break;case"focusout":c="blur",l=pr;break;case"beforeblur":case"afterblur":l=pr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ir;break;case Tn:case kn:case In:l=gr;break;case Cn:l=Cr;break;case"scroll":l=hr;break;case"wheel":l=Mr;break;case"copy":case"cut":case"paste":l=vr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kr}var u=0!=(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,m=n;null!==m;){var p=(f=m).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==d&&null!=(p=Re(m,d))&&u.push(Xn(m,p,f))),h)break;m=m.return}0<u.length&&(o=new l(o,c,null,r,i),s.push({event:o,listeners:u}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===ye||!(c=r.relatedTarget||r.fromElement)||!vi(c)&&!c[mi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?vi(c):null)&&(c!==(h=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=fr,p="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=kr,p="onPointerLeave",d="onPointerEnter",m="pointer"),h=null==l?o:yi(l),f=null==c?o:yi(c),(o=new u(p,m+"leave",l,r,i)).target=h,o.relatedTarget=f,p=null,vi(i)===n&&((u=new u(d,m+"enter",c,r,i)).target=f,u.relatedTarget=h,p=u),h=p,l&&c)e:{for(d=c,m=0,f=u=l;f;f=$n(f))m++;for(f=0,p=d;p;p=$n(p))f++;for(;0<m-f;)u=$n(u),m--;for(;0<f-m;)d=$n(d),f--;for(;m--;){if(u===d||null!==d&&u===d.alternate)break e;u=$n(u),d=$n(d)}u=null}else u=null;null!==l&&Hn(s,o,l,u,!1),null!==c&&null!==h&&Hn(s,h,c,u,!0)}if("select"===(l=(o=n?yi(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Gr;else if(qr(o))if(Yr)g=sn;else{g=nn;var A=rn}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=an);switch(g&&(g=g(e,n))?Qr(s,g,r,i):(A&&A(e,o,n),"focusout"===e&&(A=o._wrapperState)&&A.controlled&&"number"===o.type&&ee(o,"number",o.value)),A=n?yi(n):window,e){case"focusin":(qr(A)||"true"===A.contentEditable)&&(gn=A,An=n,vn=null);break;case"focusout":vn=An=gn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,yn(s,r,i);break;case"selectionchange":if(pn)break;case"keydown":case"keyup":yn(s,r,i)}var v;if(Br)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else jr?Fr(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Nr&&"ko"!==r.locale&&(jr||"onCompositionStart"!==b?"onCompositionEnd"===b&&jr&&(v=er()):(Jt="value"in(Kt=i)?Kt.value:Kt.textContent,jr=!0)),0<(A=Wn(n,b)).length&&(b=new br(b,e,null,r,i),s.push({event:b,listeners:A}),(v||null!==(v=Ur(r)))&&(b.data=v))),(v=Dr?function(e,t){switch(e){case"compositionend":return Ur(t);case"keypress":return 32!==t.which?null:(zr=!0,Or);case"textInput":return(e=t.data)===Or&&zr?null:e;default:return null}}(e,r):function(e,t){if(jr)return"compositionend"===e||!Br&&Fr(e,t)?(e=er(),Zt=Jt=Kt=null,jr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nr&&"ko"!==t.locale?null:t.data}}(e,r))&&0<(n=Wn(n,"onBeforeInput")).length&&(i=new br("onBeforeInput","beforeinput",null,r,i),s.push({event:i,listeners:n}),i.data=v)}zn(s,t)}))}function Xn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Wn(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Re(e,r))&&n.unshift(Xn(e,a,i)),null!=(a=Re(e,t))&&n.push(Xn(e,a,i))),e=e.return}return n}function $n(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Hn(e,t,r,n,i){for(var a=t._reactName,s=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Re(r,a))&&s.unshift(Xn(r,l,o)):i||null!=(l=Re(r,a))&&s.push(Xn(r,l,o))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}var Gn=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function Kn(e){return("string"==typeof e?e:""+e).replace(Gn,"\n").replace(Yn,"")}function Jn(e,t,r){if(t=Kn(t),Kn(e)!==t&&r)throw Error(a(425))}function Zn(){}var ei=null,ti=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"==typeof setTimeout?setTimeout:void 0,ii="function"==typeof clearTimeout?clearTimeout:void 0,ai="function"==typeof Promise?Promise:void 0,si="function"==typeof queueMicrotask?queueMicrotask:void 0!==ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ni;function oi(e){setTimeout((function(){throw e}))}function li(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void Vt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);Vt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,mi="__reactContainer$"+hi,pi="__reactEvents$"+hi,gi="__reactListeners$"+hi,Ai="__reactHandles$"+hi;function vi(e){var t=e[di];if(t)return t;for(var r=e.parentNode;r;){if(t=r[mi]||r[di]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=ui(e);null!==e;){if(r=e[di])return r;e=ui(e)}return t}r=(e=r).parentNode}return null}function bi(e){return!(e=e[di]||e[mi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function yi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wi(e){return e[fi]||null}var _i=[],Ei=-1;function xi(e){return{current:e}}function Si(e){0>Ei||(e.current=_i[Ei],_i[Ei]=null,Ei--)}function Ti(e,t){Ei++,_i[Ei]=e.current,e.current=t}var ki={},Ii=xi(ki),Ci=xi(!1),Pi=ki;function Mi(e,t){var r=e.type.contextTypes;if(!r)return ki;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in r)a[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ri(e){return null!=e.childContextTypes}function Bi(){Si(Ci),Si(Ii)}function Li(e,t,r){if(Ii.current!==ki)throw Error(a(168));Ti(Ii,t),Ti(Ci,r)}function Di(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(a(108,q(e)||"Unknown",i));return O({},r,n)}function Ni(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,Pi=Ii.current,Ti(Ii,e),Ti(Ci,Ci.current),!0}function Oi(e,t,r){var n=e.stateNode;if(!n)throw Error(a(169));r?(e=Di(e,t,Pi),n.__reactInternalMemoizedMergedChildContext=e,Si(Ci),Si(Ii),Ti(Ii,e)):Si(Ci),Ti(Ci,r)}var zi=null,Fi=!1,Ui=!1;function ji(e){null===zi?zi=[e]:zi.push(e)}function Vi(){if(!Ui&&null!==zi){Ui=!0;var e=0,t=bt;try{var r=zi;for(bt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}zi=null,Fi=!1}catch(t){throw null!==zi&&(zi=zi.slice(e+1)),$e(Ze,Vi),t}finally{bt=t,Ui=!1}}return null}var qi=[],Qi=0,Xi=null,Wi=0,$i=[],Hi=0,Gi=null,Yi=1,Ki="";function Ji(e,t){qi[Qi++]=Wi,qi[Qi++]=Xi,Xi=e,Wi=t}function Zi(e,t,r){$i[Hi++]=Yi,$i[Hi++]=Ki,$i[Hi++]=Gi,Gi=e;var n=Yi;e=Ki;var i=32-st(n)-1;n&=~(1<<i),r+=1;var a=32-st(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Yi=1<<32-st(t)+i|r<<i|n,Ki=a+e}else Yi=1<<a|r<<i|n,Ki=e}function ea(e){null!==e.return&&(Ji(e,1),Zi(e,1,0))}function ta(e){for(;e===Xi;)Xi=qi[--Qi],qi[Qi]=null,Wi=qi[--Qi],qi[Qi]=null;for(;e===Gi;)Gi=$i[--Hi],$i[Hi]=null,Ki=$i[--Hi],$i[Hi]=null,Yi=$i[--Hi],$i[Hi]=null}var ra=null,na=null,ia=!1,aa=null;function sa(e,t){var r=Mc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function oa(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,na=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,na=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Gi?{id:Yi,overflow:Ki}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Mc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ra=e,na=null,!0);default:return!1}}function la(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ca(e){if(ia){var t=na;if(t){var r=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=ci(r.nextSibling);var n=ra;t&&oa(e,t)?sa(n,r):(e.flags=-4097&e.flags|2,ia=!1,ra=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,ra=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function ha(e){if(e!==ra)return!1;if(!ia)return ua(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=na)){if(la(e))throw da(),Error(a(418));for(;t;)sa(e,t),t=ci(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){na=ci(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}na=null}}else na=ra?ci(e.stateNode.nextSibling):null;return!0}function da(){for(var e=na;e;)e=ci(e.nextSibling)}function fa(){na=ra=null,ia=!1}function ma(e){null===aa?aa=[e]:aa.push(e)}var pa=y.ReactCurrentBatchConfig;function ga(e,t){if(e&&e.defaultProps){for(var r in t=O({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var Aa=xi(null),va=null,ba=null,ya=null;function wa(){ya=ba=va=null}function _a(e){var t=Aa.current;Si(Aa),e._currentValue=t}function Ea(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function xa(e,t){va=e,ya=ba=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(yo=!0),e.firstContext=null)}function Sa(e){var t=e._currentValue;if(ya!==e)if(e={context:e,memoizedValue:t,next:null},null===ba){if(null===va)throw Error(a(308));ba=e,va.dependencies={lanes:0,firstContext:e}}else ba=ba.next=e;return t}var Ta=null;function ka(e){null===Ta?Ta=[e]:Ta.push(e)}function Ia(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,ka(t)):(r.next=i.next,i.next=r),t.interleaved=r,Ca(e,n)}function Ca(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Pa=!1;function Ma(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!=(2&Il)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ca(e,r)}return null===(i=n.interleaved)?(t.next=t,ka(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ca(e,r)}function Da(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}function Na(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?i=a=s:a=a.next=s,r=r.next}while(null!==r);null===a?i=a=t:a=a.next=t}else i=a=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Oa(e,t,r,n){var i=e.updateQueue;Pa=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&(o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l)}if(null!==a){var h=i.baseState;for(s=0,u=c=l=null,o=a;;){var d=o.lane,f=o.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(d=t,f=r,p.tag){case 1:if("function"==typeof(m=p.payload)){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(d="function"==typeof(m=p.payload)?m.call(f,h,d):m))break e;h=O({},h,d);break e;case 2:Pa=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,s|=d;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(d=o).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Nl|=s,e.lanes=s,e.memoizedState=h}}function za(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!=typeof i)throw Error(a(191,i));i.call(n)}}}var Fa=(new n.Component).refs;function Ua(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:O({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var ja={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ec(),i=tc(e),a=Ba(n,i);a.payload=t,null!=r&&(a.callback=r),null!==(t=La(e,a,i))&&(rc(t,e,i,n),Da(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ec(),i=tc(e),a=Ba(n,i);a.tag=1,a.payload=t,null!=r&&(a.callback=r),null!==(t=La(e,a,i))&&(rc(t,e,i,n),Da(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),n=tc(e),i=Ba(r,n);i.tag=2,null!=t&&(i.callback=t),null!==(t=La(e,i,n))&&(rc(t,e,n,r),Da(t,e,n))}};function Va(e,t,r,n,i,a,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,s):!(t.prototype&&t.prototype.isPureReactComponent&&ln(r,n)&&ln(i,a))}function qa(e,t,r){var n=!1,i=ki,a=t.contextType;return"object"==typeof a&&null!==a?a=Sa(a):(i=Ri(t)?Pi:Ii.current,a=(n=null!=(n=t.contextTypes))?Mi(e,i):ki),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ja,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Qa(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ja.enqueueReplaceState(t,t.state,null)}function Xa(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=Fa,Ma(e);var a=t.contextType;"object"==typeof a&&null!==a?i.context=Sa(a):(a=Ri(t)?Pi:Ii.current,i.context=Mi(e,a)),i.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(Ua(e,t,a,r),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ja.enqueueReplaceState(i,i.state,null),Oa(e,r,i,n),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function Wa(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(a(309));var n=r.stateNode}if(!n)throw Error(a(147,e));var i=n,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===Fa&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!=typeof e)throw Error(a(284));if(!r._owner)throw Error(a(290,e))}return e}function $a(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ha(e){return(0,e._init)(e._payload)}function Ga(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Bc(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Oc(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var a=r.type;return a===E?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===R&&Ha(a)===t.type)?((n=i(t,r.props)).ref=Wa(e,t,r),n.return=e,n):((n=Lc(r.type,r.key,r.props,null,e.mode,n)).ref=Wa(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=zc(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,a){return null===t||7!==t.tag?((t=Dc(r,e.mode,n,a)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Oc(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Lc(t.type,t.key,t.props,null,e.mode,r)).ref=Wa(e,null,t),r.return=e,r;case _:return(t=zc(t,e.mode,r)).return=e,t;case R:return d(e,(0,t._init)(t._payload),r)}if(te(t)||D(t))return(t=Dc(t,e.mode,r,null)).return=e,t;$a(e,t)}return null}function f(e,t,r,n){var i=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==i?null:l(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===i?c(e,t,r,n):null;case _:return r.key===i?u(e,t,r,n):null;case R:return f(e,t,(i=r._init)(r._payload),n)}if(te(r)||D(r))return null!==i?null:h(e,t,r,n,null);$a(e,r)}return null}function m(e,t,r,n,i){if("string"==typeof n&&""!==n||"number"==typeof n)return l(t,e=e.get(r)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case _:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i);case R:return m(e,t,r,(0,n._init)(n._payload),i)}if(te(n)||D(n))return h(t,e=e.get(r)||null,n,i,null);$a(t,n)}return null}function p(i,a,o,l){for(var c=null,u=null,h=a,p=a=0,g=null;null!==h&&p<o.length;p++){h.index>p?(g=h,h=null):g=h.sibling;var A=f(i,h,o[p],l);if(null===A){null===h&&(h=g);break}e&&h&&null===A.alternate&&t(i,h),a=s(A,a,p),null===u?c=A:u.sibling=A,u=A,h=g}if(p===o.length)return r(i,h),ia&&Ji(i,p),c;if(null===h){for(;p<o.length;p++)null!==(h=d(i,o[p],l))&&(a=s(h,a,p),null===u?c=h:u.sibling=h,u=h);return ia&&Ji(i,p),c}for(h=n(i,h);p<o.length;p++)null!==(g=m(h,i,p,o[p],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?p:g.key),a=s(g,a,p),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),ia&&Ji(i,p),c}function g(i,o,l,c){var u=D(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var h=u=null,p=o,g=o=0,A=null,v=l.next();null!==p&&!v.done;g++,v=l.next()){p.index>g?(A=p,p=null):A=p.sibling;var b=f(i,p,v.value,c);if(null===b){null===p&&(p=A);break}e&&p&&null===b.alternate&&t(i,p),o=s(b,o,g),null===h?u=b:h.sibling=b,h=b,p=A}if(v.done)return r(i,p),ia&&Ji(i,g),u;if(null===p){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(o=s(v,o,g),null===h?u=v:h.sibling=v,h=v);return ia&&Ji(i,g),u}for(p=n(i,p);!v.done;g++,v=l.next())null!==(v=m(p,i,g,v.value,c))&&(e&&null!==v.alternate&&p.delete(null===v.key?g:v.key),o=s(v,o,g),null===h?u=v:h.sibling=v,h=v);return e&&p.forEach((function(e){return t(i,e)})),ia&&Ji(i,g),u}return function e(n,a,s,l){if("object"==typeof s&&null!==s&&s.type===E&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var c=s.key,u=a;null!==u;){if(u.key===c){if((c=s.type)===E){if(7===u.tag){r(n,u.sibling),(a=i(u,s.props.children)).return=n,n=a;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===R&&Ha(c)===u.type){r(n,u.sibling),(a=i(u,s.props)).ref=Wa(n,u,s),a.return=n,n=a;break e}r(n,u);break}t(n,u),u=u.sibling}s.type===E?((a=Dc(s.props.children,n.mode,l,s.key)).return=n,n=a):((l=Lc(s.type,s.key,s.props,null,n.mode,l)).ref=Wa(n,a,s),l.return=n,n=l)}return o(n);case _:e:{for(u=s.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){r(n,a.sibling),(a=i(a,s.children||[])).return=n,n=a;break e}r(n,a);break}t(n,a),a=a.sibling}(a=zc(s,n.mode,l)).return=n,n=a}return o(n);case R:return e(n,a,(u=s._init)(s._payload),l)}if(te(s))return p(n,a,s,l);if(D(s))return g(n,a,s,l);$a(n,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==a&&6===a.tag?(r(n,a.sibling),(a=i(a,s)).return=n,n=a):(r(n,a),(a=Oc(s,n.mode,l)).return=n,n=a),o(n)):r(n,a)}}var Ya=Ga(!0),Ka=Ga(!1),Ja={},Za=xi(Ja),es=xi(Ja),ts=xi(Ja);function rs(e){if(e===Ja)throw Error(a(174));return e}function ns(e,t){switch(Ti(ts,t),Ti(es,e),Ti(Za,Ja),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Si(Za),Ti(Za,t)}function is(){Si(Za),Si(es),Si(ts)}function as(e){rs(ts.current);var t=rs(Za.current),r=le(t,e.type);t!==r&&(Ti(es,e),Ti(Za,r))}function ss(e){es.current===e&&(Si(Za),Si(es))}var os=xi(0);function ls(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cs=[];function us(){for(var e=0;e<cs.length;e++)cs[e]._workInProgressVersionPrimary=null;cs.length=0}var hs=y.ReactCurrentDispatcher,ds=y.ReactCurrentBatchConfig,fs=0,ms=null,ps=null,gs=null,As=!1,vs=!1,bs=0,ys=0;function ws(){throw Error(a(321))}function _s(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!on(e[r],t[r]))return!1;return!0}function Es(e,t,r,n,i,s){if(fs=s,ms=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?so:oo,e=r(n,i),vs){s=0;do{if(vs=!1,bs=0,25<=s)throw Error(a(301));s+=1,gs=ps=null,t.updateQueue=null,hs.current=lo,e=r(n,i)}while(vs)}if(hs.current=ao,t=null!==ps&&null!==ps.next,fs=0,gs=ps=ms=null,As=!1,t)throw Error(a(300));return e}function xs(){var e=0!==bs;return bs=0,e}function Ss(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===gs?ms.memoizedState=gs=e:gs=gs.next=e,gs}function Ts(){if(null===ps){var e=ms.alternate;e=null!==e?e.memoizedState:null}else e=ps.next;var t=null===gs?ms.memoizedState:gs.next;if(null!==t)gs=t,ps=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ps=e).memoizedState,baseState:ps.baseState,baseQueue:ps.baseQueue,queue:ps.queue,next:null},null===gs?ms.memoizedState=gs=e:gs=gs.next=e}return gs}function ks(e,t){return"function"==typeof t?t(e):t}function Is(e){var t=Ts(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=ps,i=n.baseQueue,s=r.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(null!==i){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((fs&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=n):c=c.next=d,ms.lanes|=h,Nl|=h}u=u.next}while(null!==u&&u!==s);null===c?o=n:c.next=l,on(n,t.memoizedState)||(yo=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{s=i.lane,ms.lanes|=s,Nl|=s,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Cs(e){var t=Ts(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);on(s,t.memoizedState)||(yo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Ps(){}function Ms(e,t){var r=ms,n=Ts(),i=t(),s=!on(n.memoizedState,i);if(s&&(n.memoizedState=i,yo=!0),n=n.queue,qs(Ls.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||null!==gs&&1&gs.memoizedState.tag){if(r.flags|=2048,zs(9,Bs.bind(null,r,n,i,t),void 0,null),null===Cl)throw Error(a(349));0!=(30&fs)||Rs(r,t,i)}return i}function Rs(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Bs(e,t,r,n){t.value=r,t.getSnapshot=n,Ds(t)&&Ns(e)}function Ls(e,t,r){return r((function(){Ds(t)&&Ns(e)}))}function Ds(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!on(e,r)}catch(e){return!0}}function Ns(e){var t=Ca(e,1);null!==t&&rc(t,e,1,-1)}function Os(e){var t=Ss();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ks,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,ms,e),[t.memoizedState,e]}function zs(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Fs(){return Ts().memoizedState}function Us(e,t,r,n){var i=Ss();ms.flags|=e,i.memoizedState=zs(1|t,r,void 0,void 0===n?null:n)}function js(e,t,r,n){var i=Ts();n=void 0===n?null:n;var a=void 0;if(null!==ps){var s=ps.memoizedState;if(a=s.destroy,null!==n&&_s(n,s.deps))return void(i.memoizedState=zs(t,r,a,n))}ms.flags|=e,i.memoizedState=zs(1|t,r,a,n)}function Vs(e,t){return Us(8390656,8,e,t)}function qs(e,t){return js(2048,8,e,t)}function Qs(e,t){return js(4,2,e,t)}function Xs(e,t){return js(4,4,e,t)}function Ws(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function $s(e,t,r){return r=null!=r?r.concat([e]):null,js(4,4,Ws.bind(null,t,e),r)}function Hs(){}function Gs(e,t){var r=Ts();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&_s(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ys(e,t){var r=Ts();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&_s(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ks(e,t,r){return 0==(21&fs)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=r):(on(r,t)||(r=pt(),ms.lanes|=r,Nl|=r,e.baseState=!0),t)}function Js(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var n=ds.transition;ds.transition={};try{e(!1),t()}finally{bt=r,ds.transition=n}}function Zs(){return Ts().memoizedState}function eo(e,t,r){var n=tc(e);r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ro(e)?no(t,r):null!==(r=Ia(e,t,r,n))&&(rc(r,e,n,ec()),io(r,t,n))}function to(e,t,r){var n=tc(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ro(e))no(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,on(o,s)){var l=t.interleaved;return null===l?(i.next=i,ka(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(e){}null!==(r=Ia(e,t,i,n))&&(rc(r,e,n,i=ec()),io(r,t,n))}}function ro(e){var t=e.alternate;return e===ms||null!==t&&t===ms}function no(e,t){vs=As=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function io(e,t,r){if(0!=(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}var ao={readContext:Sa,useCallback:ws,useContext:ws,useEffect:ws,useImperativeHandle:ws,useInsertionEffect:ws,useLayoutEffect:ws,useMemo:ws,useReducer:ws,useRef:ws,useState:ws,useDebugValue:ws,useDeferredValue:ws,useTransition:ws,useMutableSource:ws,useSyncExternalStore:ws,useId:ws,unstable_isNewReconciler:!1},so={readContext:Sa,useCallback:function(e,t){return Ss().memoizedState=[e,void 0===t?null:t],e},useContext:Sa,useEffect:Vs,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,Us(4194308,4,Ws.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Us(4194308,4,e,t)},useInsertionEffect:function(e,t){return Us(4,2,e,t)},useMemo:function(e,t){var r=Ss();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ss();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=eo.bind(null,ms,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Ss().memoizedState=e},useState:Os,useDebugValue:Hs,useDeferredValue:function(e){return Ss().memoizedState=e},useTransition:function(){var e=Os(!1),t=e[0];return e=Js.bind(null,e[1]),Ss().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ms,i=Ss();if(ia){if(void 0===r)throw Error(a(407));r=r()}else{if(r=t(),null===Cl)throw Error(a(349));0!=(30&fs)||Rs(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Vs(Ls.bind(null,n,s,e),[e]),n.flags|=2048,zs(9,Bs.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Ss(),t=Cl.identifierPrefix;if(ia){var r=Ki;t=":"+t+"R"+(r=(Yi&~(1<<32-st(Yi)-1)).toString(32)+r),0<(r=bs++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ys++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Sa,useCallback:Gs,useContext:Sa,useEffect:qs,useImperativeHandle:$s,useInsertionEffect:Qs,useLayoutEffect:Xs,useMemo:Ys,useReducer:Is,useRef:Fs,useState:function(){return Is(ks)},useDebugValue:Hs,useDeferredValue:function(e){return Ks(Ts(),ps.memoizedState,e)},useTransition:function(){return[Is(ks)[0],Ts().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Ms,useId:Zs,unstable_isNewReconciler:!1},lo={readContext:Sa,useCallback:Gs,useContext:Sa,useEffect:qs,useImperativeHandle:$s,useInsertionEffect:Qs,useLayoutEffect:Xs,useMemo:Ys,useReducer:Cs,useRef:Fs,useState:function(){return Cs(ks)},useDebugValue:Hs,useDeferredValue:function(e){var t=Ts();return null===ps?t.memoizedState=e:Ks(t,ps.memoizedState,e)},useTransition:function(){return[Cs(ks)[0],Ts().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Ms,useId:Zs,unstable_isNewReconciler:!1};function co(e,t){try{var r="",n=t;do{r+=j(n),n=n.return}while(n);var i=r}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i,digest:null}}function uo(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var fo="function"==typeof WeakMap?WeakMap:Map;function mo(e,t,r){(r=Ba(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ql||(Ql=!0,Xl=n),ho(0,t)},r}function po(e,t,r){(r=Ba(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(r.callback=function(){ho(0,t),"function"!=typeof n&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function go(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new fo;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Sc.bind(null,e,t,r),t.then(e,e))}function Ao(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,r,n,i){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Ba(-1,1)).tag=2,La(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bo=y.ReactCurrentOwner,yo=!1;function wo(e,t,r,n){t.child=null===e?Ka(t,null,r,n):Ya(t,e.child,r,n)}function _o(e,t,r,n,i){r=r.render;var a=t.ref;return xa(t,i),n=Es(e,t,r,n,a,i),r=xs(),null===e||yo?(ia&&r&&ea(t),t.flags|=1,wo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Qo(e,t,i))}function Eo(e,t,r,n,i){if(null===e){var a=r.type;return"function"!=typeof a||Rc(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Lc(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,xo(e,t,a,n,i))}if(a=e.child,0==(e.lanes&i)){var s=a.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(s,n)&&e.ref===t.ref)return Qo(e,t,i)}return t.flags|=1,(e=Bc(a,n)).ref=t.ref,e.return=t,t.child=e}function xo(e,t,r,n,i){if(null!==e){var a=e.memoizedProps;if(ln(a,n)&&e.ref===t.ref){if(yo=!1,t.pendingProps=n=a,0==(e.lanes&i))return t.lanes=e.lanes,Qo(e,t,i);0!=(131072&e.flags)&&(yo=!0)}}return ko(e,t,r,n,i)}function So(e,t,r){var n=t.pendingProps,i=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Bl,Rl),Rl|=r;else{if(0==(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Bl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:r,Ti(Bl,Rl),Rl|=n}else null!==a?(n=a.baseLanes|r,t.memoizedState=null):n=r,Ti(Bl,Rl),Rl|=n;return wo(e,t,i,r),t.child}function To(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ko(e,t,r,n,i){var a=Ri(r)?Pi:Ii.current;return a=Mi(t,a),xa(t,i),r=Es(e,t,r,n,a,i),n=xs(),null===e||yo?(ia&&n&&ea(t),t.flags|=1,wo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Qo(e,t,i))}function Io(e,t,r,n,i){if(Ri(r)){var a=!0;Ni(t)}else a=!1;if(xa(t,i),null===t.stateNode)qo(e,t),qa(t,r,n),Xa(t,r,n,i),n=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;c="object"==typeof c&&null!==c?Sa(c):Mi(t,c=Ri(r)?Pi:Ii.current);var u=r.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==n||l!==c)&&Qa(t,s,n,c),Pa=!1;var d=t.memoizedState;s.state=d,Oa(t,n,s,i),l=t.memoizedState,o!==n||d!==l||Ci.current||Pa?("function"==typeof u&&(Ua(t,r,u,n),l=t.memoizedState),(o=Pa||Va(t,r,o,n,d,l,c))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):("function"==typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Ra(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ga(t.type,o),s.props=c,h=t.pendingProps,d=s.context,l="object"==typeof(l=r.contextType)&&null!==l?Sa(l):Mi(t,l=Ri(r)?Pi:Ii.current);var f=r.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==h||d!==l)&&Qa(t,s,n,l),Pa=!1,d=t.memoizedState,s.state=d,Oa(t,n,s,i);var m=t.memoizedState;o!==h||d!==m||Ci.current||Pa?("function"==typeof f&&(Ua(t,r,f,n),m=t.memoizedState),(c=Pa||Va(t,r,c,n,d,m,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(n,m,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,m,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=l,n=c):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Co(e,t,r,n,a,i)}function Co(e,t,r,n,i,a){To(e,t);var s=0!=(128&t.flags);if(!n&&!s)return i&&Oi(t,r,!1),Qo(e,t,a);n=t.stateNode,bo.current=t;var o=s&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Ya(t,e.child,null,a),t.child=Ya(t,null,o,a)):wo(e,t,o,a),t.memoizedState=n.state,i&&Oi(t,r,!0),t.child}function Po(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),ns(e,t.containerInfo)}function Mo(e,t,r,n,i){return fa(),ma(i),t.flags|=256,wo(e,t,r,n),t.child}var Ro,Bo,Lo,Do={dehydrated:null,treeContext:null,retryLane:0};function No(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oo(e,t,r){var n,i=t.pendingProps,s=os.current,o=!1,l=0!=(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!=(2&s)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ti(os,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0==(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Nc(l,i,0,null),e=Dc(e,i,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=No(r),t.memoizedState=Do,e):zo(t,l));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,r,n,i,s,o){if(r)return 256&t.flags?(t.flags&=-257,Fo(e,t,o,n=uo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Nc({mode:"visible",children:n.children},i,0,null),(s=Dc(s,i,o,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!=(1&t.mode)&&Ya(t,e.child,null,o),t.child.memoizedState=No(o),t.memoizedState=Do,s);if(0==(1&t.mode))return Fo(e,t,o,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var l=n.dgst;return n=l,Fo(e,t,o,n=uo(s=Error(a(419)),n,void 0))}if(l=0!=(o&e.childLanes),yo||l){if(null!==(n=Cl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!=(i&(n.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Ca(e,i),rc(n,e,i,-1))}return pc(),Fo(e,t,o,n=uo(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=kc.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,na=ci(i.nextSibling),ra=t,ia=!0,aa=null,null!==e&&($i[Hi++]=Yi,$i[Hi++]=Ki,$i[Hi++]=Gi,Yi=e.id,Ki=e.overflow,Gi=t),(t=zo(t,n.children)).flags|=4096,t)}(e,t,l,i,n,s,r);if(o){o=i.fallback,l=t.mode,n=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 0==(1&l)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Bc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==n?o=Bc(n,o):(o=Dc(o,l,r,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?No(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~r,t.memoizedState=Do,i}return e=(o=e.child).sibling,i=Bc(o,{mode:"visible",children:i.children}),0==(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function zo(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fo(e,t,r,n){return null!==n&&ma(n),Ya(t,e.child,null,r),(e=zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ea(e.return,t,r)}function jo(e,t,r,n,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function Vo(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(wo(e,t,n.children,r),0!=(2&(n=os.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,r,t);else if(19===e.tag)Uo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ti(os,n),0==(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===ls(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),jo(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ls(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}jo(t,!0,r,null,a);break;case"together":jo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qo(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qo(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0==(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(r=Bc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Bc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Xo(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Wo(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function $o(e,t,r){var n=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(t),null;case 1:case 17:return Ri(t.type)&&Bi(),Wo(t),null;case 3:return n=t.stateNode,is(),Si(Ci),Si(Ii),us(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==aa&&(sc(aa),aa=null))),Wo(t),null;case 5:ss(t);var i=rs(ts.current);if(r=t.type,null!==e&&null!=t.stateNode)Bo(e,t,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Wo(t),null}if(e=rs(Za.current),ha(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[di]=t,n[fi]=s,e=0!=(1&t.mode),r){case"dialog":Fn("cancel",n),Fn("close",n);break;case"iframe":case"object":case"embed":Fn("load",n);break;case"video":case"audio":for(i=0;i<Dn.length;i++)Fn(Dn[i],n);break;case"source":Fn("error",n);break;case"img":case"image":case"link":Fn("error",n),Fn("load",n);break;case"details":Fn("toggle",n);break;case"input":Y(n,s),Fn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Fn("invalid",n);break;case"textarea":ie(n,s),Fn("invalid",n)}for(var l in ve(r,s),i=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"==typeof c?n.textContent!==c&&(!0!==s.suppressHydrationWarning&&Jn(n.textContent,c,e),i=["children",c]):"number"==typeof c&&n.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Jn(n.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fn("scroll",n)}switch(r){case"input":W(n),Z(n,s,!0);break;case"textarea":W(n),se(n);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(n.onclick=Zn)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[di]=t,e[fi]=n,Ro(e,t),t.stateNode=e;e:{switch(l=be(r,n),r){case"dialog":Fn("cancel",e),Fn("close",e),i=n;break;case"iframe":case"object":case"embed":Fn("load",e),i=n;break;case"video":case"audio":for(i=0;i<Dn.length;i++)Fn(Dn[i],e);i=n;break;case"source":Fn("error",e),i=n;break;case"img":case"image":case"link":Fn("error",e),Fn("load",e),i=n;break;case"details":Fn("toggle",e),i=n;break;case"input":Y(e,n),i=G(e,n),Fn("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=O({},n,{value:void 0}),Fn("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),Fn("invalid",e)}for(s in ve(r,i),c=i)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"==typeof u?("textarea"!==r||""!==u)&&de(e,u):"number"==typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Fn("scroll",e):null!=u&&b(e,s,u,l))}switch(r){case"input":W(e),Z(e,n,!1);break;case"textarea":W(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Q(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?re(e,!!n.multiple,s,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wo(t),null;case 6:if(e&&null!=t.stateNode)Lo(0,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(a(166));if(r=rs(ts.current),rs(Za.current),ha(t)){if(n=t.stateNode,r=t.memoizedProps,n[di]=t,(s=n.nodeValue!==r)&&null!==(e=ra))switch(e.tag){case 3:Jn(n.nodeValue,r,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jn(n.nodeValue,r,0!=(1&e.mode))}s&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[di]=t,t.stateNode=n}return Wo(t),null;case 13:if(Si(os),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==na&&0!=(1&t.mode)&&0==(128&t.flags))da(),fa(),t.flags|=98560,s=!1;else if(s=ha(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[di]=t}else fa(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wo(t),s=!1}else null!==aa&&(sc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=r,t):((n=null!==n)!=(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&os.current)?0===Ll&&(Ll=3):pc())),null!==t.updateQueue&&(t.flags|=4),Wo(t),null);case 4:return is(),null===e&&Vn(t.stateNode.containerInfo),Wo(t),null;case 10:return _a(t.type._context),Wo(t),null;case 19:if(Si(os),null===(s=t.memoizedState))return Wo(t),null;if(n=0!=(128&t.flags),null===(l=s.rendering))if(n)Xo(s,!1);else{if(0!==Ll||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ls(e))){for(t.flags|=128,Xo(s,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(s=r).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ti(os,1&os.current|2),t.child}e=e.sibling}null!==s.tail&&Ke()>Vl&&(t.flags|=128,n=!0,Xo(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ls(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Xo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ia)return Wo(t),null}else 2*Ke()-s.renderingStartTime>Vl&&1073741824!==r&&(t.flags|=128,n=!0,Xo(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=s.last)?r.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ke(),t.sibling=null,r=os.current,Ti(os,n?1&r|2:1&r),t):(Wo(t),null);case 22:case 23:return hc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!=(1&t.mode)?0!=(1073741824&Rl)&&(Wo(t),6&t.subtreeFlags&&(t.flags|=8192)):Wo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Ho(e,t){switch(ta(t),t.tag){case 1:return Ri(t.type)&&Bi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return is(),Si(Ci),Si(Ii),us(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ss(t),null;case 13:if(Si(os),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Si(os),null;case 4:return is(),null;case 10:return _a(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ro=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Bo=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,rs(Za.current);var a,s=null;switch(r){case"input":i=G(e,i),n=G(e,n),s=[];break;case"select":i=O({},i,{value:void 0}),n=O({},n,{value:void 0}),s=[];break;case"textarea":i=ne(e,i),n=ne(e,n),s=[];break;default:"function"!=typeof i.onClick&&"function"==typeof n.onClick&&(e.onclick=Zn)}for(u in ve(r,n),r=null,i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=i?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(u,r)),r=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Fn("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Lo=function(e,t,r,n){r!==n&&(t.flags|=4)};var Go=!1,Yo=!1,Ko="function"==typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var r=e.ref;if(null!==r)if("function"==typeof r)try{r(null)}catch(r){xc(e,t,r)}else r.current=null}function el(e,t,r){try{r()}catch(r){xc(e,t,r)}}var tl=!1;function rl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&el(t,r,a)}i=i.next}while(i!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function il(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"==typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[pi],delete t[gi],delete t[Ai]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!=(r=r._reactRootContainer)||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var ul=null,hl=!1;function dl(e,t,r){for(r=r.child;null!==r;)fl(e,t,r),r=r.sibling}function fl(e,t,r){if(at&&"function"==typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,r)}catch(e){}switch(r.tag){case 5:Yo||Zo(r,t);case 6:var n=ul,i=hl;ul=null,dl(e,t,r),hl=i,null!==(ul=n)&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):ul.removeChild(r.stateNode));break;case 18:null!==ul&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?li(e.parentNode,r):1===e.nodeType&&li(e,r),Vt(e)):li(ul,r.stateNode));break;case 4:n=ul,i=hl,ul=r.stateNode.containerInfo,hl=!0,dl(e,t,r),ul=n,hl=i;break;case 0:case 11:case 14:case 15:if(!Yo&&null!==(n=r.updateQueue)&&null!==(n=n.lastEffect)){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,void 0!==s&&(0!=(2&a)||0!=(4&a))&&el(r,t,s),i=i.next}while(i!==n)}dl(e,t,r);break;case 1:if(!Yo&&(Zo(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(e){xc(r,t,e)}dl(e,t,r);break;case 21:dl(e,t,r);break;case 22:1&r.mode?(Yo=(n=Yo)||null!==r.memoizedState,dl(e,t,r),Yo=n):dl(e,t,r);break;default:dl(e,t,r)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Ko),t.forEach((function(t){var n=Ic.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function pl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));fl(s,o,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(e){xc(i,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),Al(e),4&n){try{rl(3,e,e.return),nl(3,e)}catch(t){xc(e,e.return,t)}try{rl(5,e,e.return)}catch(t){xc(e,e.return,t)}}break;case 1:pl(t,e),Al(e),512&n&&null!==r&&Zo(r,r.return);break;case 5:if(pl(t,e),Al(e),512&n&&null!==r&&Zo(r,r.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(t){xc(e,e.return,t)}}if(4&n&&null!=(i=e.stateNode)){var s=e.memoizedProps,o=null!==r?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&K(i,s),be(l,o);var u=be(l,s);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):b(i,h,d,u)}switch(l){case"input":J(i,s);break;case"textarea":ae(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?re(i,!!s.multiple,m,!1):f!==!!s.multiple&&(null!=s.defaultValue?re(i,!!s.multiple,s.defaultValue,!0):re(i,!!s.multiple,s.multiple?[]:"",!1))}i[fi]=s}catch(t){xc(e,e.return,t)}}break;case 6:if(pl(t,e),Al(e),4&n){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(t){xc(e,e.return,t)}}break;case 3:if(pl(t,e),Al(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(t){xc(e,e.return,t)}break;case 4:default:pl(t,e),Al(e);break;case 13:pl(t,e),Al(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(jl=Ke())),4&n&&ml(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Yo=(u=Yo)||h,pl(t,e),Yo=u):pl(t,e),Al(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!=(1&e.mode))for(Jo=e,h=e.child;null!==h;){for(d=Jo=h;null!==Jo;){switch(m=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:Zo(f,f.return);var p=f.stateNode;if("function"==typeof p.componentWillUnmount){n=f,r=f.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(e){xc(n,r,e)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){wl(d);continue}}null!==m?(m.return=f,Jo=m):wl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"==typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,o=null!=(c=d.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(t){xc(e,e.return,t)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(t){xc(e,e.return,t)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:pl(t,e),Al(e),4&n&&ml(e);case 21:}}function Al(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(sl(r)){var n=r;break e}r=r.return}throw Error(a(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(de(i,""),n.flags&=-33),cl(e,ol(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;ll(e,ol(e),s);break;default:throw Error(a(161))}}catch(t){xc(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,r){Jo=e,bl(e,t,r)}function bl(e,t,r){for(var n=0!=(1&e.mode);null!==Jo;){var i=Jo,a=i.child;if(22===i.tag&&n){var s=null!==i.memoizedState||Go;if(!s){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Go;var c=Yo;if(Go=s,(Yo=l)&&!c)for(Jo=i;null!==Jo;)l=(s=Jo).child,22===s.tag&&null!==s.memoizedState?_l(i):null!==l?(l.return=s,Jo=l):_l(i);for(;null!==a;)Jo=a,bl(a,t,r),a=a.sibling;Jo=i,Go=o,Yo=c}yl(e)}else 0!=(8772&i.subtreeFlags)&&null!==a?(a.return=i,Jo=a):yl(e)}}function yl(e){for(;null!==Jo;){var t=Jo;if(0!=(8772&t.flags)){var r=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Yo)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ga(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&za(t,s,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}za(t,o,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(a(163))}Yo||512&t.flags&&il(t)}catch(e){xc(t,t.return,e)}}if(t===e){Jo=null;break}if(null!==(r=t.sibling)){r.return=t.return,Jo=r;break}Jo=t.return}}function wl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Jo=r;break}Jo=t.return}}function _l(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nl(4,t)}catch(e){xc(t,r,e)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(e){xc(t,i,e)}}var a=t.return;try{il(t)}catch(e){xc(t,a,e)}break;case 5:var s=t.return;try{il(t)}catch(e){xc(t,s,e)}}}catch(e){xc(t,t.return,e)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var El,xl=Math.ceil,Sl=y.ReactCurrentDispatcher,Tl=y.ReactCurrentOwner,kl=y.ReactCurrentBatchConfig,Il=0,Cl=null,Pl=null,Ml=0,Rl=0,Bl=xi(0),Ll=0,Dl=null,Nl=0,Ol=0,zl=0,Fl=null,Ul=null,jl=0,Vl=1/0,ql=null,Ql=!1,Xl=null,Wl=null,$l=!1,Hl=null,Gl=0,Yl=0,Kl=null,Jl=-1,Zl=0;function ec(){return 0!=(6&Il)?Ke():-1!==Jl?Jl:Jl=Ke()}function tc(e){return 0==(1&e.mode)?1:0!=(2&Il)&&0!==Ml?Ml&-Ml:null!==pa.transition?(0===Zl&&(Zl=pt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,r,n){if(50<Yl)throw Yl=0,Kl=null,Error(a(185));At(e,r,n),0!=(2&Il)&&e===Cl||(e===Cl&&(0==(2&Il)&&(Ol|=r),4===Ll&&oc(e,Ml)),nc(e,n),1===r&&0===Il&&0==(1&t.mode)&&(Vl=Ke()+500,Fi&&Vi()))}function nc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,l=i[s];-1===l?0!=(o&r)&&0==(o&n)||(i[s]=ft(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var n=dt(e,e===Cl?Ml:0);if(0===n)null!==r&&He(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&He(r),1===t)0===e.tag?function(e){Fi=!0,ji(e)}(lc.bind(null,e)):ji(lc.bind(null,e)),si((function(){0==(6&Il)&&Vi()})),r=null;else{switch(yt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Cc(r,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ic(e,t){if(Jl=-1,Zl=0,0!=(6&Il))throw Error(a(327));var r=e.callbackNode;if(_c()&&e.callbackNode!==r)return null;var n=dt(e,e===Cl?Ml:0);if(0===n)return null;if(0!=(30&n)||0!=(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var i=Il;Il|=2;var s=mc();for(Cl===e&&Ml===t||(ql=null,Vl=Ke()+500,dc(e,t));;)try{vc();break}catch(t){fc(e,t)}wa(),Sl.current=s,Il=i,null!==Pl?t=0:(Cl=null,Ml=0,t=Ll)}if(0!==t){if(2===t&&0!==(i=mt(e))&&(n=i,t=ac(e,i)),1===t)throw r=Dl,dc(e,0),oc(e,n),nc(e,Ke()),r;if(6===t)oc(e,n);else{if(i=e.current.alternate,0==(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!on(a(),i))return!1}catch(e){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,n))&&0!==(s=mt(e))&&(n=s,t=ac(e,s)),1===t))throw r=Dl,dc(e,0),oc(e,n),nc(e,Ke()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,Ul,ql);break;case 3:if(oc(e,n),(130023424&n)===n&&10<(t=jl+500-Ke())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(wc.bind(null,e,Ul,ql),t);break}wc(e,Ul,ql);break;case 4:if(oc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-st(n);s=1<<o,(o=t[o])>i&&(i=o),n&=~s}if(n=i,10<(n=(120>(n=Ke()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xl(n/1960))-n)){e.timeoutHandle=ni(wc.bind(null,e,Ul,ql),n);break}wc(e,Ul,ql);break;default:throw Error(a(329))}}}return nc(e,Ke()),e.callbackNode===r?ic.bind(null,e):null}function ac(e,t){var r=Fl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=r,null!==t&&sc(t)),e}function sc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function oc(e,t){for(t&=~zl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-st(t),n=1<<r;e[r]=-1,t&=~n}}function lc(e){if(0!=(6&Il))throw Error(a(327));_c();var t=dt(e,0);if(0==(1&t))return nc(e,Ke()),null;var r=gc(e,t);if(0!==e.tag&&2===r){var n=mt(e);0!==n&&(t=n,r=ac(e,n))}if(1===r)throw r=Dl,dc(e,0),oc(e,t),nc(e,Ke()),r;if(6===r)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,ql),nc(e,Ke()),null}function cc(e,t){var r=Il;Il|=1;try{return e(t)}finally{0===(Il=r)&&(Vl=Ke()+500,Fi&&Vi())}}function uc(e){null!==Hl&&0===Hl.tag&&0==(6&Il)&&_c();var t=Il;Il|=1;var r=kl.transition,n=bt;try{if(kl.transition=null,bt=1,e)return e()}finally{bt=n,kl.transition=r,0==(6&(Il=t))&&Vi()}}function hc(){Rl=Bl.current,Si(Bl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,ii(r)),null!==Pl)for(r=Pl.return;null!==r;){var n=r;switch(ta(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&Bi();break;case 3:is(),Si(Ci),Si(Ii),us();break;case 5:ss(n);break;case 4:is();break;case 13:case 19:Si(os);break;case 10:_a(n.type._context);break;case 22:case 23:hc()}r=r.return}if(Cl=e,Pl=e=Bc(e.current,null),Ml=Rl=t,Ll=0,Dl=null,zl=Ol=Nl=0,Ul=Fl=null,null!==Ta){for(t=0;t<Ta.length;t++)if(null!==(n=(r=Ta[t]).interleaved)){r.interleaved=null;var i=n.next,a=r.pending;if(null!==a){var s=a.next;a.next=i,n.next=s}r.pending=n}Ta=null}return e}function fc(e,t){for(;;){var r=Pl;try{if(wa(),hs.current=ao,As){for(var n=ms.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}As=!1}if(fs=0,gs=ps=ms=null,vs=!1,bs=0,Tl.current=null,null===r||null===r.return){Ll=1,Dl=t,Pl=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=Ml,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(0==(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=Ao(o);if(null!==m){m.flags&=-257,vo(m,o,l,0,t),1&m.mode&&go(s,u,t),c=u;var p=(t=m).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0==(1&t)){go(s,u,t),pc();break e}c=Error(a(426))}else if(ia&&1&l.mode){var A=Ao(o);if(null!==A){0==(65536&A.flags)&&(A.flags|=256),vo(A,o,l,0,t),ma(co(c,l));break e}}s=c=co(c,l),4!==Ll&&(Ll=2),null===Fl?Fl=[s]:Fl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Na(s,mo(0,c,t));break e;case 1:l=c;var v=s.type,b=s.stateNode;if(0==(128&s.flags)&&("function"==typeof v.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===Wl||!Wl.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Na(s,po(s,l,t));break e}}s=s.return}while(null!==s)}yc(r)}catch(e){t=e,Pl===r&&null!==r&&(Pl=r=r.return);continue}break}}function mc(){var e=Sl.current;return Sl.current=ao,null===e?ao:e}function pc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Cl||0==(268435455&Nl)&&0==(268435455&Ol)||oc(Cl,Ml)}function gc(e,t){var r=Il;Il|=2;var n=mc();for(Cl===e&&Ml===t||(ql=null,dc(e,t));;)try{Ac();break}catch(t){fc(e,t)}if(wa(),Il=r,Sl.current=n,null!==Pl)throw Error(a(261));return Cl=null,Ml=0,Ll}function Ac(){for(;null!==Pl;)bc(Pl)}function vc(){for(;null!==Pl&&!Ge();)bc(Pl)}function bc(e){var t=El(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?yc(e):Pl=t,Tl.current=null}function yc(e){var t=e;do{var r=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(r=$o(r,t,Rl)))return void(Pl=r)}else{if(null!==(r=Ho(r,t)))return r.flags&=32767,void(Pl=r);if(null===e)return Ll=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Ll&&(Ll=5)}function wc(e,t,r){var n=bt,i=kl.transition;try{kl.transition=null,bt=1,function(e,t,r,n){do{_c()}while(null!==Hl);if(0!=(6&Il))throw Error(a(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-st(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}(e,s),e===Cl&&(Pl=Cl=null,Ml=0),0==(2064&r.subtreeFlags)&&0==(2064&r.flags)||$l||($l=!0,Cc(tt,(function(){return _c(),null}))),s=0!=(15990&r.flags),0!=(15990&r.subtreeFlags)||s){s=kl.transition,kl.transition=null;var o=bt;bt=1;var l=Il;Il|=4,Tl.current=null,function(e,t){if(ei=Qt,fn(e=dn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(e){r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var m;d!==r||0!==i&&3!==d.nodeType||(l=o+i),d!==s||0!==n&&3!==d.nodeType||(c=o+n),3===d.nodeType&&(o+=d.nodeValue.length),null!==(m=d.firstChild);)f=d,d=m;for(;;){if(d===e)break t;if(f===r&&++u===i&&(l=o),f===s&&++h===n&&(c=o),null!==(m=d.nextSibling))break;f=(d=f).parentNode}d=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ti={focusedElem:e,selectionRange:r},Qt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var p=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,A=p.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ga(t.type,g),A);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(a(163))}}catch(e){xc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}p=tl,tl=!1}(e,r),gl(r,e),mn(ti),Qt=!!ei,ti=ei=null,e.current=r,vl(r,e,i),Ye(),Il=l,bt=o,kl.transition=s}else e.current=r;if($l&&($l=!1,Hl=e,Gl=i),0===(s=e.pendingLanes)&&(Wl=null),function(e){if(at&&"function"==typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128==(128&e.current.flags))}catch(e){}}(r.stateNode),nc(e,Ke()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n((i=t[r]).value,{componentStack:i.stack,digest:i.digest});if(Ql)throw Ql=!1,e=Xl,Xl=null,e;0!=(1&Gl)&&0!==e.tag&&_c(),0!=(1&(s=e.pendingLanes))?e===Kl?Yl++:(Yl=0,Kl=e):Yl=0,Vi()}(e,t,r,n)}finally{kl.transition=i,bt=n}return null}function _c(){if(null!==Hl){var e=yt(Gl),t=kl.transition,r=bt;try{if(kl.transition=null,bt=16>e?16:e,null===Hl)var n=!1;else{if(e=Hl,Hl=null,Gl=0,0!=(6&Il))throw Error(a(331));var i=Il;for(Il|=4,Jo=e.current;null!==Jo;){var s=Jo,o=s.child;if(0!=(16&Jo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Jo=u;null!==Jo;){var h=Jo;switch(h.tag){case 0:case 11:case 15:rl(8,h,s)}var d=h.child;if(null!==d)d.return=h,Jo=d;else for(;null!==Jo;){var f=(h=Jo).sibling,m=h.return;if(al(h),h===u){Jo=null;break}if(null!==f){f.return=m,Jo=f;break}Jo=m}}}var p=s.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var A=g.sibling;g.sibling=null,g=A}while(null!==g)}}Jo=s}}if(0!=(2064&s.subtreeFlags)&&null!==o)o.return=s,Jo=o;else e:for(;null!==Jo;){if(0!=(2048&(s=Jo).flags))switch(s.tag){case 0:case 11:case 15:rl(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Jo=v;break e}Jo=s.return}}var b=e.current;for(Jo=b;null!==Jo;){var y=(o=Jo).child;if(0!=(2064&o.subtreeFlags)&&null!==y)y.return=o,Jo=y;else e:for(o=b;null!==Jo;){if(0!=(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(e){xc(l,l.return,e)}if(l===o){Jo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Jo=w;break e}Jo=l.return}}if(Il=i,Vi(),at&&"function"==typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(e){}n=!0}return n}finally{bt=r,kl.transition=t}}return!1}function Ec(e,t,r){e=La(e,t=mo(0,t=co(r,t),1),1),t=ec(),null!==e&&(At(e,1,t),nc(e,t))}function xc(e,t,r){if(3===e.tag)Ec(e,e,r);else for(;null!==t;){if(3===t.tag){Ec(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Wl||!Wl.has(n))){t=La(t,e=po(t,e=co(r,e),1),1),e=ec(),null!==t&&(At(t,1,e),nc(t,e));break}}t=t.return}}function Sc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Cl===e&&(Ml&r)===r&&(4===Ll||3===Ll&&(130023424&Ml)===Ml&&500>Ke()-jl?dc(e,0):zl|=r),nc(e,t)}function Tc(e,t){0===t&&(0==(1&e.mode)?t=1:(t=ut,0==(130023424&(ut<<=1))&&(ut=4194304)));var r=ec();null!==(e=Ca(e,t))&&(At(e,t,r),nc(e,r))}function kc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Tc(e,r)}function Ic(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),Tc(e,r)}function Cc(e,t){return $e(e,t)}function Pc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,r,n){return new Pc(e,t,r,n)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bc(e,t){var r=e.alternate;return null===r?((r=Mc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Lc(e,t,r,n,i,s){var o=2;if(n=e,"function"==typeof e)Rc(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case E:return Dc(r.children,i,s,t);case x:o=8,i|=8;break;case S:return(e=Mc(12,r,t,2|i)).elementType=S,e.lanes=s,e;case C:return(e=Mc(13,r,t,i)).elementType=C,e.lanes=s,e;case P:return(e=Mc(19,r,t,i)).elementType=P,e.lanes=s,e;case B:return Nc(r,i,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case T:o=10;break e;case k:o=9;break e;case I:o=11;break e;case M:o=14;break e;case R:o=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Mc(o,r,t,i)).elementType=e,t.type=n,t.lanes=s,t}function Dc(e,t,r,n){return(e=Mc(7,e,n,t)).lanes=r,e}function Nc(e,t,r,n){return(e=Mc(22,e,n,t)).elementType=B,e.lanes=r,e.stateNode={isHidden:!1},e}function Oc(e,t,r){return(e=Mc(6,e,null,t)).lanes=r,e}function zc(e,t,r){return(t=Mc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fc(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,r,n,i,a,s,o,l){return e=new Fc(e,t,r,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Mc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ma(a),e}function jc(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}function Vc(e){if(!e)return ki;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var r=e.type;if(Ri(r))return Di(e,r,t)}return t}function qc(e,t,r,n,i,a,s,o,l){return(e=Uc(r,n,!0,e,0,a,0,o,l)).context=Vc(null),r=e.current,(a=Ba(n=ec(),i=tc(r))).callback=null!=t?t:null,La(r,a,i),e.current.lanes=i,At(e,i,n),nc(e,n),e}function Qc(e,t,r,n){var i=t.current,a=ec(),s=tc(i);return r=Vc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Ba(a,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=La(i,t,s))&&(rc(e,i,s,a),Da(e,i,s)),s}function Xc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function $c(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}El=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)yo=!0;else{if(0==(e.lanes&r)&&0==(128&t.flags))return yo=!1,function(e,t,r){switch(t.tag){case 3:Po(t),fa();break;case 5:as(t);break;case 1:Ri(t.type)&&Ni(t);break;case 4:ns(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ti(Aa,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Ti(os,1&os.current),t.flags|=128,null):0!=(r&t.child.childLanes)?Oo(e,t,r):(Ti(os,1&os.current),null!==(e=Qo(e,t,r))?e.sibling:null);Ti(os,1&os.current);break;case 19:if(n=0!=(r&t.childLanes),0!=(128&e.flags)){if(n)return Vo(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(os,os.current),n)break;return null;case 22:case 23:return t.lanes=0,So(e,t,r)}return Qo(e,t,r)}(e,t,r);yo=0!=(131072&e.flags)}else yo=!1,ia&&0!=(1048576&t.flags)&&Zi(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;qo(e,t),e=t.pendingProps;var i=Mi(t,Ii.current);xa(t,r),i=Es(null,t,n,e,i,r);var s=xs();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(n)?(s=!0,Ni(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ma(t),i.updater=ja,t.stateNode=i,i._reactInternals=t,Xa(t,n,e,r),t=Co(null,t,n,!0,s,r)):(t.tag=0,ia&&s&&ea(t),wo(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(qo(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"==typeof e)return Rc(e)?1:0;if(null!=e){if((e=e.$$typeof)===I)return 11;if(e===M)return 14}return 2}(n),e=ga(n,e),i){case 0:t=ko(null,t,n,e,r);break e;case 1:t=Io(null,t,n,e,r);break e;case 11:t=_o(null,t,n,e,r);break e;case 14:t=Eo(null,t,n,ga(n.type,e),r);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,ko(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 1:return n=t.type,i=t.pendingProps,Io(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 3:e:{if(Po(t),null===e)throw Error(a(387));n=t.pendingProps,i=(s=t.memoizedState).element,Ra(e,t),Oa(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Mo(e,t,n,r,i=co(Error(a(423)),t));break e}if(n!==i){t=Mo(e,t,n,r,i=co(Error(a(424)),t));break e}for(na=ci(t.stateNode.containerInfo.firstChild),ra=t,ia=!0,aa=null,r=Ka(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(fa(),n===i){t=Qo(e,t,r);break e}wo(e,t,n,r)}t=t.child}return t;case 5:return as(t),null===e&&ca(t),n=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,ri(n,i)?o=null:null!==s&&ri(n,s)&&(t.flags|=32),To(e,t),wo(e,t,o,r),t.child;case 6:return null===e&&ca(t),null;case 13:return Oo(e,t,r);case 4:return ns(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ya(t,null,n,r):wo(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,_o(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 7:return wo(e,t,t.pendingProps,r),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Ti(Aa,n._currentValue),n._currentValue=o,null!==s)if(on(s.value,o)){if(s.children===i.children&&!Ci.current){t=Qo(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===s.tag){(c=Ba(-1,r&-r)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),Ea(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),Ea(o,r,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,xa(t,r),n=n(i=Sa(i)),t.flags|=1,wo(e,t,n,r),t.child;case 14:return i=ga(n=t.type,t.pendingProps),Eo(e,t,n,i=ga(n.type,i),r);case 15:return xo(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ga(n,i),qo(e,t),t.tag=1,Ri(n)?(e=!0,Ni(t)):e=!1,xa(t,r),qa(t,n,i),Xa(t,n,i,r),Co(null,t,n,!0,e,r);case 19:return Vo(e,t,r);case 22:return So(e,t,r)}throw Error(a(156,t.tag))};var Hc="function"==typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if("function"==typeof i){var o=i;i=function(){var e=Xc(s);o.call(e)}}Qc(t,s,e,i)}else s=function(e,t,r,n,i){if(i){if("function"==typeof n){var a=n;n=function(){var e=Xc(s);a.call(e)}}var s=qc(t,n,e,0,null,!1,0,"",Zc);return e._reactRootContainer=s,e[mi]=s.current,Vn(8===e.nodeType?e.parentNode:e),uc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof n){var o=n;n=function(){var e=Xc(l);o.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[mi]=l.current,Vn(8===e.nodeType?e.parentNode:e),uc((function(){Qc(t,l,r,n)})),l}(r,t,e,i,n);return Xc(s)}Yc.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Qc(e,t,null,null)},Yc.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Qc(null,e,null,null)})),t[mi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=xt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Bt.length&&0!==t&&t<Bt[r].priority;r++);Bt.splice(r,0,e),0===r&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(vt(t,1|r),nc(t,Ke()),0==(6&Il)&&(Vl=Ke()+500,Vi()))}break;case 13:uc((function(){var t=Ca(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}})),$c(e,1)}},_t=function(e){if(13===e.tag){var t=Ca(e,134217728);null!==t&&rc(t,e,134217728,ec()),$c(e,134217728)}},Et=function(e){if(13===e.tag){var t=tc(e),r=Ca(e,t);null!==r&&rc(r,e,t,ec()),$c(e,t)}},xt=function(){return bt},St=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},_e=function(e,t,r){switch(t){case"input":if(J(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=wi(n);if(!i)throw Error(a(90));$(n),J(n,i)}}}break;case"textarea":ae(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ie=cc,Ce=uc;var tu={usingClientEntryPoint:!1,Events:[bi,yi,wi,Te,ke,cc]},ru={findFiberByHostInstance:vi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nu={bundleType:ru.bundleType,version:ru.version,rendererPackageName:ru.rendererPackageName,rendererConfig:ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Xe(e))?null:e.stateNode},findFiberByHostInstance:ru.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(nu),at=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(a(200));return jc(e,t,null,r)},t.createRoot=function(e,t){if(!Kc(e))throw Error(a(299));var r=!1,n="",i=Hc;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,r,0,n,i),e[mi]=t.current,Vn(8===e.nodeType?e.parentNode:e),new Gc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return null===(e=Xe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,r){if(!Jc(t))throw Error(a(200));return eu(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Kc(e))throw Error(a(405));var n=null!=r&&r.hydratedSources||null,i=!1,s="",o=Hc;if(null!=r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=qc(t,null,e,1,null!=r?r:null,i,0,s,o),e[mi]=t.current,Vn(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Yc(t)},t.render=function(e,t,r){if(!Jc(t))throw Error(a(200));return eu(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[mi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Jc(r))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return eu(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},745:(e,t,r)=>{"use strict";var n=r(3935);t.s=n.createRoot,n.hydrateRoot},3935:(e,t,r)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=r(4448)},5800:function(e,t,r){!function(e,t){"use strict";function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var n=r(t);function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}var a={error:null},s=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).state=a,t.resetErrorBoundary=function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];null==t.props.onReset||(e=t.props).onReset.apply(e,n),t.reset()},t}var r,s;s=e,(r=t).prototype=Object.create(s.prototype),r.prototype.constructor=r,i(r,s),t.getDerivedStateFromError=function(e){return{error:e}};var o=t.prototype;return o.reset=function(){this.setState(a)},o.componentDidCatch=function(e,t){var r,n;null==(r=(n=this.props).onError)||r.call(n,e,t)},o.componentDidUpdate=function(e,t){var r,n,i,a,s=this.state.error,o=this.props.resetKeys;null!==s&&null!==t.error&&(void 0===(i=e.resetKeys)&&(i=[]),void 0===(a=o)&&(a=[]),i.length!==a.length||i.some((function(e,t){return!Object.is(e,a[t])})))&&(null==(r=(n=this.props).onResetKeysChange)||r.call(n,e.resetKeys,o),this.reset())},o.render=function(){var e=this.state.error,t=this.props,r=t.fallbackRender,i=t.FallbackComponent,a=t.fallback;if(null!==e){var s={error:e,resetErrorBoundary:this.resetErrorBoundary};if(n.isValidElement(a))return a;if("function"==typeof r)return r(s);if(i)return n.createElement(i,s);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},t}(n.Component);e.ErrorBoundary=s,e.useErrorHandler=function(e){var t=n.useState(null),r=t[0],i=t[1];if(null!=e)throw e;if(null!=r)throw r;return i},e.withErrorBoundary=function(e,t){var r=function(r){return n.createElement(s,t,n.createElement(e,r))},i=e.displayName||e.name||"Unknown";return r.displayName="withErrorBoundary("+i+")",r},Object.defineProperty(e,"__esModule",{value:!0})}(t,r(7294))},2408:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator,m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function A(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}function v(){}function b(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}A.prototype.isReactComponent={},A.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},A.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=A.prototype;var y=b.prototype=new v;y.constructor=b,p(y,A.prototype),y.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,E={current:null},x={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)_.call(t,i)&&!x.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:r,type:e,key:s,ref:o,props:a,_owner:E.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var k=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return s=s(l=e),e=""===a?"."+I(l,0):a,w(s)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),C(s,t,i,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var u=a+I(o=e[c],c);l+=C(o,t,i,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,i,u=a+I(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,r){if(null==e)return e;var n=[],i=0;return C(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},B={transition:null},L={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:B,ReactCurrentOwner:E};t.Children={map:P,forEach:function(e,t,r){P(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=A,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=p({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=E.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!x.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:r,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=B.transition;B.transition={};try{e()}finally{B.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,r){return R.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,r){return R.current.useReducer(e,t,r)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return R.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},7294:(e,t,r)=>{"use strict";e.exports=r(2408)},8090:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableWebToNodeStream=void 0;const n=r(5507);class i extends n.Readable{constructor(e){super(),this.bytesRead=0,this.released=!1,this.reader=e.getReader()}async _read(){if(this.released)return void this.push(null);this.pendingRead=this.reader.read();const e=await this.pendingRead;delete this.pendingRead,e.done||this.released?this.push(null):(this.bytesRead+=e.value.length,this.push(e.value))}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}}t.ReadableWebToNodeStream=i},1281:e=>{"use strict";var t={};function r(e,r,n){n||(n=Error);var i=function(e){var t,n;function i(t,n,i){return e.call(this,function(e,t,n){return"string"==typeof r?r:r(e,t,n)}(t,n,i))||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(n);i.prototype.name=n.name,i.prototype.code=e,t[e]=i}function n(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(e,t,r){var i,a,s,o,l;if("string"==typeof t&&(a="not ",t.substr(0,a.length)===a)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(i," ").concat(n(t,"type"));else{var c=("number"!=typeof l&&(l=0),l+".".length>(o=e).length||-1===o.indexOf(".",l)?"argument":"property");s='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(n(t,"type"))}return s+". Received type ".concat(typeof r)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6201:(e,t,r)=>{"use strict";var n=r(4155),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var a=r(2460),s=r(1103);r(5717)(u,a);for(var o=i(s.prototype),l=0;l<o.length;l++){var c=o[l];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);a.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||n.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},4404:(e,t,r)=>{"use strict";e.exports=i;var n=r(7749);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(5717)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},2460:(e,t,r)=>{"use strict";var n,i=r(4155);e.exports=S,S.ReadableState=x,r(7187).EventEmitter;var a,s=function(e,t){return e.listeners(t).length},o=r(8114),l=r(8764).Buffer,c=r.g.Uint8Array||function(){},u=r(3838);a=u&&u.debuglog?u.debuglog("stream"):function(){};var h,d,f,m=r(597),p=r(358),g=r(5267).getHighWaterMark,A=r(1281).q,v=A.ERR_INVALID_ARG_TYPE,b=A.ERR_STREAM_PUSH_AFTER_EOF,y=A.ERR_METHOD_NOT_IMPLEMENTED,w=A.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(5717)(S,o);var _=p.errorOrDestroy,E=["error","close","destroy","pause","resume"];function x(e,t,i){n=n||r(6201),e=e||{},"boolean"!=typeof i&&(i=t instanceof n),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",i),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(2553).s),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(n=n||r(6201),!(this instanceof S))return new S(e);var t=this instanceof n;this._readableState=new x(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){a("readableAddChunk",t);var s,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(a("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}}(e,o);else if(i||(s=function(e,t){var r,n;return n=t,l.isBuffer(n)||n instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new v("chunk",["string","Buffer","Uint8Array"],t)),r}(o,t)),s)_(e,s);else if(o.objectMode||t&&t.length>0)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),n)o.endEmitted?_(e,new w):k(e,o,t,!0);else if(o.ended)_(e,new b);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?k(e,o,t,!1):R(e,o)):k(e,o,t,!1)}else n||(o.reading=!1,R(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function k(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&P(e)),R(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=p.destroy,S.prototype._undestroy=p.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=l.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(2553).s);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var I=1073741824;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=I?e=I:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;a("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(a("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(M,e))}function M(e){var t=e._readableState;a("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,O(e)}function R(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(B,e,t))}function B(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(a("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){a("readable nexttick read 0"),e.read(0)}function N(e,t){a("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),O(e),t.flowing&&!t.reading&&e.read(0)}function O(e){var t=e._readableState;for(a("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;a("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(U,t,e))}function U(e,t){if(a("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function j(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){a("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return a("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):P(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return a("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&a("length less than watermark",i=!0),t.ended||t.reading?a("reading or ended",i=!1):i&&(a("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){_(this,new y("_read()"))},S.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,a("pipe count=%d opts=%j",n.pipesCount,t);var o=t&&!1===t.end||e===i.stdout||e===i.stderr?p:l;function l(){a("onend"),e.end()}n.endEmitted?i.nextTick(o):r.once("end",o),e.on("unpipe",(function t(i,s){a("onunpipe"),i===r&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,a("cleanup"),e.removeListener("close",f),e.removeListener("finish",m),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",t),r.removeListener("end",l),r.removeListener("end",p),r.removeListener("data",h),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}));var c=function(e){return function(){var t=e._readableState;a("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,O(e))}}(r);e.on("drain",c);var u=!1;function h(t){a("ondata");var i=e.write(t);a("dest.write",i),!1===i&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==j(n.pipes,e))&&!u&&(a("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function d(t){a("onerror",t),p(),e.removeListener("error",d),0===s(e,"error")&&_(e,t)}function f(){e.removeListener("finish",m),p()}function m(){a("onfinish"),e.removeListener("close",f),p()}function p(){a("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events.error?Array.isArray(e._events.error)?e._events.error.unshift(r):e._events.error=[r,e._events.error]:e.on(t,r)}(e,"error",d),e.once("close",f),e.once("finish",m),e.emit("pipe",r),n.flowing||(a("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var s=j(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,a("on readable",n.length,n.reading),n.length?P(this):n.reading||i.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(a("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(N,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(a("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){a("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<E.length;s++)e.on(E[s],this.emit.bind(this,E[s]));return this._read=function(t){a("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=r(6913)),d(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(e,t){return void 0===f&&(f=r(2887)),f(S,e,t)})},7749:(e,t,r)=>{"use strict";e.exports=u;var n=r(1281).q,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,s=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=n.ERR_TRANSFORM_WITH_LENGTH_0,l=r(6201);function c(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,r){d(e,t,r)}))}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new o;if(e._transformState.transforming)throw new s;return e.push(null)}r(5717)(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new i("_transform()"))},u.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},1103:(e,t,r)=>{"use strict";var n,i=r(4155);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(undefined),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=S,S.WritableState=x;var s,o={deprecate:r(4927)},l=r(8114),c=r(8764).Buffer,u=r.g.Uint8Array||function(){},h=r(358),d=r(5267).getHighWaterMark,f=r(1281).q,m=f.ERR_INVALID_ARG_TYPE,p=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,A=f.ERR_STREAM_CANNOT_PIPE,v=f.ERR_STREAM_DESTROYED,b=f.ERR_STREAM_NULL_VALUES,y=f.ERR_STREAM_WRITE_AFTER_END,w=f.ERR_UNKNOWN_ENCODING,_=h.errorOrDestroy;function E(){}function x(e,t,s){n=n||r(6201),e=e||{},"boolean"!=typeof s&&(s=t instanceof n),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,a=r.writecb;if("function"!=typeof a)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,a){--t.pendingcb,r?(i.nextTick(a,n),i.nextTick(M,e,t),e._writableState.errorEmitted=!0,_(e,n)):(a(n),e._writableState.errorEmitted=!0,_(e,n),M(e,t))}(e,r,n,t,a);else{var s=C(r)||e.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||I(e,r),n?i.nextTick(k,e,r,s,a):k(e,r,s,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function S(e){var t=this instanceof(n=n||r(6201));if(!t&&!s.call(S,this))return new S(e);this._writableState=new x(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function T(e,t,r,n,i,a,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function k(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function I(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var o=0,l=!0;r;)i[o]=r,r.isBuf||(l=!1),r=r.next,o+=1;i.allBuffers=l,T(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:c.length,c,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(e,t){e._final((function(r){t.pendingcb--,r&&_(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=C(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(P,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}r(5717)(S,l),x.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(x.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===S&&e&&e._writableState instanceof x}})):s=function(e){return e instanceof this},S.prototype.pipe=function(){_(this,new A)},S.prototype.write=function(e,t,r){var n,a=this._writableState,s=!1,o=!a.objectMode&&(n=e,c.isBuffer(n)||n instanceof u);return o&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof r&&(r=E),a.ending?function(e,t){var r=new y;_(e,r),i.nextTick(t,r)}(this,r):(o||function(e,t,r,n){var a;return null===r?a=new b:"string"==typeof r||t.objectMode||(a=new m("chunk",["string","Buffer"],r)),!a||(_(e,a),i.nextTick(n,a),!1)}(this,a,e,r))&&(a.pendingcb++,s=function(e,t,r,n,i,a){if(!r){var s=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r)),t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var o=t.objectMode?1:n.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,o,n,i,a);return l}(this,a,o,e,t,r)),s},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||I(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new p("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?i.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}},6913:(e,t,r)=>{"use strict";var n,i=r(4155);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=r(2880),o=Symbol("lastResolve"),l=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),h=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function m(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[h]=null,e[o]=null,e[l]=null,t(m(r,!1)))}}function g(e){i.nextTick(p,e)}var A=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((a(n={get stream(){return this[f]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(m(void 0,!0));if(this[f].destroyed)return new Promise((function(t,r){i.nextTick((function(){e[c]?r(e[c]):t(m(void 0,!0))}))}));var r,n=this[h];if(n)r=new Promise(function(e,t){return function(r,n){e.then((function(){t[u]?r(m(void 0,!0)):t[d](r,n)}),n)}}(n,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(m(a,!1));r=new Promise(this[d])}return this[h]=r,r}},Symbol.asyncIterator,(function(){return this})),a(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(m(void 0,!0))}))}))})),n),A);e.exports=function(e){var t,r=Object.create(v,(a(t={},f,{value:e,writable:!0}),a(t,o,{value:null,writable:!0}),a(t,l,{value:null,writable:!0}),a(t,c,{value:null,writable:!0}),a(t,u,{value:e._readableState.endEmitted,writable:!0}),a(t,d,{value:function(e,t){var n=r[f].read();n?(r[h]=null,r[o]=null,r[l]=null,e(m(n,!1))):(r[o]=e,r[l]=t)},writable:!0}),t));return r[h]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[l];return null!==t&&(r[h]=null,r[o]=null,r[l]=null,t(e)),void(r[c]=e)}var n=r[o];null!==n&&(r[h]=null,r[o]=null,r[l]=null,n(m(void 0,!0))),r[u]=!0})),e.on("readable",g.bind(null,r)),r}},597:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=r(8764).Buffer,o=r(9283).inspect,l=o&&o.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r;return t=e,r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,r,n,i=s.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,r=i,n=o,s.prototype.copy.call(t,r,n),o+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0==(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0==(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:l,value:function(e,t){return o(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],r&&a(t.prototype,r),e}()},358:(e,t,r)=>{"use strict";var n=r(4155);function i(e,t){s(e,t),a(e)}function a(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return o||l?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(s,this,e)):n.nextTick(s,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?r._writableState?r._writableState.errorEmitted?n.nextTick(a,r):(r._writableState.errorEmitted=!0,n.nextTick(i,r,e)):n.nextTick(i,r,e):t?(n.nextTick(a,r),t(e)):n.nextTick(a,r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}},2880:(e,t,r)=>{"use strict";var n=r(1281).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"==typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var s=r.readable||!1!==r.readable&&t.readable,o=r.writable||!1!==r.writable&&t.writable,l=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){o=!1,c=!0,s||a.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){s=!1,h=!0,o||a.call(t)},f=function(e){a.call(t,e)},m=function(){var e;return s&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):o&&!c?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},p=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",m),t.req?p():t.on("request",p)):o&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",d),t.on("finish",u),!1!==r.error&&t.on("error",f),t.on("close",m),function(){t.removeListener("complete",u),t.removeListener("abort",m),t.removeListener("request",p),t.req&&t.req.removeListener("finish",u),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",u),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",m)}}},2887:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},677:(e,t,r)=>{"use strict";var n,i=r(1281).q,a=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function l(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var o=!1;e.on("close",(function(){o=!0})),void 0===n&&(n=r(2880)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);o=!0,a()}));var l=!1;return function(t){if(!o&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void a(t||new s("pipe"))}}function c(e){e()}function u(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?o:e.pop():o}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var s=t.map((function(e,r){var a=r<t.length-1;return l(e,a,r>0,(function(e){n||(n=e),e&&s.forEach(c),a||(s.forEach(c),i(n))}))}));return t.reduce(u)}},5267:(e,t,r)=>{"use strict";var n=r(1281).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},8114:(e,t,r)=>{e.exports=r(7187).EventEmitter},5507:(e,t,r)=>{(t=e.exports=r(2460)).Stream=t,t.Readable=t,t.Writable=r(1103),t.Duplex=r(6201),t.Transform=r(7749),t.PassThrough=r(4404),t.finished=r(2880),t.pipeline=r(677)},9509:(e,t,r)=>{var n=r(8764),i=n.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=s),s.prototype=Object.create(i.prototype),a(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},53:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<a(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,s=i>>>1;n<s;){var o=2*(n+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,r))c<i&&0>a(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<i&&0>a(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,m=!1,p=!1,g=!1,A="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function y(e){for(var t=n(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function w(e){if(g=!1,y(e),!p)if(null!==n(c))p=!0,B(_);else{var t=n(u);null!==t&&L(w,t.startTime-e)}}function _(e,r){p=!1,g&&(g=!1,v(T),T=-1),m=!0;var a=f;try{for(y(r),d=n(c);null!==d&&(!(d.expirationTime>r)||e&&!C());){var s=d.callback;if("function"==typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=r);r=t.unstable_now(),"function"==typeof o?d.callback=o:d===n(c)&&i(c),y(r)}else i(c);d=n(c)}if(null!==d)var l=!0;else{var h=n(u);null!==h&&L(w,h.startTime-r),l=!1}return l}finally{d=null,f=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,x=!1,S=null,T=-1,k=5,I=-1;function C(){return!(t.unstable_now()-I<k)}function P(){if(null!==S){var e=t.unstable_now();I=e;var r=!0;try{r=S(!0,e)}finally{r?E():(x=!1,S=null)}}else x=!1}if("function"==typeof b)E=function(){b(P)};else if("undefined"!=typeof MessageChannel){var M=new MessageChannel,R=M.port2;M.port1.onmessage=P,E=function(){R.postMessage(null)}}else E=function(){A(P,0)};function B(e){S=e,x||(x=!0,E())}function L(e,r){T=A((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||m||(p=!0,B(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,r(u,e),null===n(c)&&e===n(u)&&(g?(v(T),T=-1):g=!0,L(w,a-s))):(e.sortIndex=o,r(c,e),p||m||(p=!0,B(_))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},3840:(e,t,r)=>{"use strict";e.exports=r(53)},3988:e=>{"use strict";var t;t=function(){var e={},t={};return e.on=function(e,r){var n={name:e,handler:r};return t[e]=t[e]||[],t[e].unshift(n),n},e.off=function(e){var r=t[e.name].indexOf(e);-1!==r&&t[e.name].splice(r,1)},e.trigger=function(e,r){var n,i=t[e];if(i)for(n=i.length;n--;)i[n].handler(r)},e},e.exports=t},5754:e=>{"use strict";var t,r,n,i,a,s,o,l,c=(t="https://api.spotify.com/v1",r=null,n=null,i=function(e,t){return e.abort=t,e},a=function(){var e=Array.prototype.slice.call(arguments),t=e[0],r=e.slice(1);return t=t||{},r.forEach((function(e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})),t},s=function(e,t){var a=new XMLHttpRequest,s=function(n,i){var s=e.type||"GET";if(a.open(s,function(e,t){var r="";for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];r+=encodeURIComponent(n)+"="+encodeURIComponent(i)+"&"}return r.length>0&&(e=e+"?"+(r=r.substring(0,r.length-1))),e}(e.url,e.params)),r&&a.setRequestHeader("Authorization","Bearer "+r),a.onreadystatechange=function(){if(4===a.readyState){var e=null;try{e=a.responseText?JSON.parse(a.responseText):""}catch(e){console.error(e)}a.status>=200&&a.status<300?function(e){n&&n(e),t&&t(null,e)}(e):(i&&i(a),t&&t(a,null))}},"GET"===s)a.send(null);else{var o=null;e.postData&&("image/jpeg"===e.contentType?(o=e.postData,a.setRequestHeader("Content-Type",e.contentType)):(o=JSON.stringify(e.postData),a.setRequestHeader("Content-Type","application/json"))),a.send(o)}};return t?(s(),null):function(e,t){var r;if(null!==n){var s=n.defer();e((function(e){s.resolve(e)}),(function(e){s.reject(e)})),r=s.promise}else window.Promise&&(r=new window.Promise(e));return r?new i(r,(function(){a.abort()})):null}(s)},o=function(e,t,r,n){var i={},o=null;return"object"==typeof t?(i=t,o=r):"function"==typeof t&&(o=t),"GET"!==(e.type||"GET")&&e.postData&&!n?e.postData=a(e.postData,i):e.params=a(e.params,i),s(e,o)},((l=function(){}).prototype={constructor:c}).getGeneric=function(e,t){return o({url:e},t)},l.prototype.getMe=function(e,r){return o({url:t+"/me"},e,r)},l.prototype.getMySavedTracks=function(e,r){return o({url:t+"/me/tracks"},e,r)},l.prototype.addToMySavedTracks=function(e,r,n){return o({url:t+"/me/tracks",type:"PUT",postData:e},r,n)},l.prototype.removeFromMySavedTracks=function(e,r,n){return o({url:t+"/me/tracks",type:"DELETE",postData:e},r,n)},l.prototype.containsMySavedTracks=function(e,r,n){var i={url:t+"/me/tracks/contains",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getMySavedAlbums=function(e,r){return o({url:t+"/me/albums"},e,r)},l.prototype.addToMySavedAlbums=function(e,r,n){return o({url:t+"/me/albums",type:"PUT",postData:e},r,n)},l.prototype.removeFromMySavedAlbums=function(e,r,n){return o({url:t+"/me/albums",type:"DELETE",postData:e},r,n)},l.prototype.containsMySavedAlbums=function(e,r,n){var i={url:t+"/me/albums/contains",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getMyTopArtists=function(e,r){return o({url:t+"/me/top/artists"},e,r)},l.prototype.getMyTopTracks=function(e,r){return o({url:t+"/me/top/tracks"},e,r)},l.prototype.getMyRecentlyPlayedTracks=function(e,r){return o({url:t+"/me/player/recently-played"},e,r)},l.prototype.followUsers=function(e,r){var n={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"user"}};return o(n,r)},l.prototype.followArtists=function(e,r){var n={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"artist"}};return o(n,r)},l.prototype.followPlaylist=function(e,r,n){return o({url:t+"/playlists/"+e+"/followers",type:"PUT",postData:{}},r,n)},l.prototype.unfollowUsers=function(e,r){var n={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"user"}};return o(n,r)},l.prototype.unfollowArtists=function(e,r){var n={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"artist"}};return o(n,r)},l.prototype.unfollowPlaylist=function(e,r){return o({url:t+"/playlists/"+e+"/followers",type:"DELETE"},r)},l.prototype.isFollowingUsers=function(e,r){var n={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"user"}};return o(n,r)},l.prototype.isFollowingArtists=function(e,r){var n={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"artist"}};return o(n,r)},l.prototype.areFollowingPlaylist=function(e,r,n){var i={url:t+"/playlists/"+e+"/followers/contains",type:"GET",params:{ids:r.join(",")}};return o(i,n)},l.prototype.getFollowedArtists=function(e,r){return o({url:t+"/me/following",type:"GET",params:{type:"artist"}},e,r)},l.prototype.getUser=function(e,r,n){var i={url:t+"/users/"+encodeURIComponent(e)};return o(i,r,n)},l.prototype.getUserPlaylists=function(e,r,n){var i;return"string"==typeof e?i={url:t+"/users/"+encodeURIComponent(e)+"/playlists"}:(i={url:t+"/me/playlists"},n=r,r=e),o(i,r,n)},l.prototype.getPlaylist=function(e,r,n){return o({url:t+"/playlists/"+e},r,n)},l.prototype.getPlaylistTracks=function(e,r,n){return o({url:t+"/playlists/"+e+"/tracks"},r,n)},l.prototype.getPlaylistCoverImage=function(e,r){return o({url:t+"/playlists/"+e+"/images"},r)},l.prototype.createPlaylist=function(e,r,n){var i={url:t+"/users/"+encodeURIComponent(e)+"/playlists",type:"POST",postData:r};return o(i,r,n)},l.prototype.changePlaylistDetails=function(e,r,n){return o({url:t+"/playlists/"+e,type:"PUT",postData:r},r,n)},l.prototype.addTracksToPlaylist=function(e,r,n,i){return o({url:t+"/playlists/"+e+"/tracks",type:"POST",postData:{uris:r}},n,i,!0)},l.prototype.replaceTracksInPlaylist=function(e,r,n){return o({url:t+"/playlists/"+e+"/tracks",type:"PUT",postData:{uris:r}},{},n)},l.prototype.reorderTracksInPlaylist=function(e,r,n,i,a){return o({url:t+"/playlists/"+e+"/tracks",type:"PUT",postData:{range_start:r,insert_before:n}},i,a)},l.prototype.removeTracksFromPlaylist=function(e,r,n){var i=r.map((function(e){return"string"==typeof e?{uri:e}:e}));return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{tracks:i}},{},n)},l.prototype.removeTracksFromPlaylistWithSnapshotId=function(e,r,n,i){var a=r.map((function(e){return"string"==typeof e?{uri:e}:e}));return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{tracks:a,snapshot_id:n}},{},i)},l.prototype.removeTracksFromPlaylistInPositions=function(e,r,n,i){return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{positions:r,snapshot_id:n}},{},i)},l.prototype.uploadCustomPlaylistCoverImage=function(e,r,n){var i={url:t+"/playlists/"+e+"/images",type:"PUT",postData:r.replace(/^data:image\/jpeg;base64,/,""),contentType:"image/jpeg"};return o(i,{},n)},l.prototype.getAlbum=function(e,r,n){return o({url:t+"/albums/"+e},r,n)},l.prototype.getAlbumTracks=function(e,r,n){return o({url:t+"/albums/"+e+"/tracks"},r,n)},l.prototype.getAlbums=function(e,r,n){var i={url:t+"/albums/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getTrack=function(e,r,n){var i={};return i.url=t+"/tracks/"+e,o(i,r,n)},l.prototype.getTracks=function(e,r,n){var i={url:t+"/tracks/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getArtist=function(e,r,n){return o({url:t+"/artists/"+e},r,n)},l.prototype.getArtists=function(e,r,n){var i={url:t+"/artists/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getArtistAlbums=function(e,r,n){return o({url:t+"/artists/"+e+"/albums"},r,n)},l.prototype.getArtistTopTracks=function(e,r,n,i){return o({url:t+"/artists/"+e+"/top-tracks",params:{country:r}},n,i)},l.prototype.getArtistRelatedArtists=function(e,r,n){return o({url:t+"/artists/"+e+"/related-artists"},r,n)},l.prototype.getFeaturedPlaylists=function(e,r){return o({url:t+"/browse/featured-playlists"},e,r)},l.prototype.getNewReleases=function(e,r){return o({url:t+"/browse/new-releases"},e,r)},l.prototype.getCategories=function(e,r){return o({url:t+"/browse/categories"},e,r)},l.prototype.getCategory=function(e,r,n){return o({url:t+"/browse/categories/"+e},r,n)},l.prototype.getCategoryPlaylists=function(e,r,n){return o({url:t+"/browse/categories/"+e+"/playlists"},r,n)},l.prototype.search=function(e,r,n,i){var a={url:t+"/search/",params:{q:e,type:r.join(",")}};return o(a,n,i)},l.prototype.searchAlbums=function(e,t,r){return this.search(e,["album"],t,r)},l.prototype.searchArtists=function(e,t,r){return this.search(e,["artist"],t,r)},l.prototype.searchTracks=function(e,t,r){return this.search(e,["track"],t,r)},l.prototype.searchPlaylists=function(e,t,r){return this.search(e,["playlist"],t,r)},l.prototype.searchShows=function(e,t,r){return this.search(e,["show"],t,r)},l.prototype.searchEpisodes=function(e,t,r){return this.search(e,["episode"],t,r)},l.prototype.getAudioFeaturesForTrack=function(e,r){var n={};return n.url=t+"/audio-features/"+e,o(n,{},r)},l.prototype.getAudioFeaturesForTracks=function(e,r){return o({url:t+"/audio-features",params:{ids:e}},{},r)},l.prototype.getAudioAnalysisForTrack=function(e,r){var n={};return n.url=t+"/audio-analysis/"+e,o(n,{},r)},l.prototype.getRecommendations=function(e,r){return o({url:t+"/recommendations"},e,r)},l.prototype.getAvailableGenreSeeds=function(e){return o({url:t+"/recommendations/available-genre-seeds"},{},e)},l.prototype.getMyDevices=function(e){return o({url:t+"/me/player/devices"},{},e)},l.prototype.getMyCurrentPlaybackState=function(e,r){return o({url:t+"/me/player"},e,r)},l.prototype.getMyCurrentPlayingTrack=function(e,r){return o({url:t+"/me/player/currently-playing"},e,r)},l.prototype.transferMyPlayback=function(e,r,n){var i=r||{};return i.device_ids=e,o({type:"PUT",url:t+"/me/player",postData:i},r,n)},l.prototype.play=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null,i={};return["context_uri","uris","offset","position_ms"].forEach((function(t){t in e&&(i[t]=e[t])})),o({type:"PUT",url:t+"/me/player/play",params:n,postData:i},"function"==typeof e?e:{},r)},l.prototype.queue=function(e,r,n){var i="device_id"in(r=r||{})?{uri:e,device_id:r.device_id}:{uri:e};return o({type:"POST",url:t+"/me/player/queue",params:i},r,n)},l.prototype.pause=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"PUT",url:t+"/me/player/pause",params:n},e,r)},l.prototype.skipToNext=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"POST",url:t+"/me/player/next",params:n},e,r)},l.prototype.skipToPrevious=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"POST",url:t+"/me/player/previous",params:n},e,r)},l.prototype.seek=function(e,r,n){var i={position_ms:e};return"device_id"in(r=r||{})&&(i.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/seek",params:i},r,n)},l.prototype.setRepeat=function(e,r,n){var i={state:e};return"device_id"in(r=r||{})&&(i.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/repeat",params:i},r,n)},l.prototype.setVolume=function(e,r,n){var i={volume_percent:e};return"device_id"in(r=r||{})&&(i.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/volume",params:i},r,n)},l.prototype.setShuffle=function(e,r,n){var i={state:e};return"device_id"in(r=r||{})&&(i.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/shuffle",params:i},r,n)},l.prototype.getShow=function(e,r,n){var i={};return i.url=t+"/shows/"+e,o(i,r,n)},l.prototype.getShows=function(e,r,n){var i={url:t+"/shows/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getMySavedShows=function(e,r){return o({url:t+"/me/shows"},e,r)},l.prototype.addToMySavedShows=function(e,r,n){return o({url:t+"/me/shows",type:"PUT",postData:e},r,n)},l.prototype.removeFromMySavedShows=function(e,r,n){return o({url:t+"/me/shows",type:"DELETE",postData:e},r,n)},l.prototype.containsMySavedShows=function(e,r,n){var i={url:t+"/me/shows/contains",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getShowEpisodes=function(e,r,n){return o({url:t+"/shows/"+e+"/episodes"},r,n)},l.prototype.getEpisode=function(e,r,n){var i={};return i.url=t+"/episodes/"+e,o(i,r,n)},l.prototype.getEpisodes=function(e,r,n){var i={url:t+"/episodes/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getAccessToken=function(){return r},l.prototype.setAccessToken=function(e){r=e},l.prototype.setPromiseImplementation=function(e){var t=!1;try{var r=new e((function(e){e()}));"function"==typeof r.then&&"function"==typeof r.catch&&(t=!0)}catch(e){console.error(e)}if(!t)throw new Error("Unsupported implementation of Promises/A+");n=e},l);"object"==typeof e.exports&&(e.exports=c)},6657:e=>{e.exports=function(e,t,r){"use strict";if(e===t)return 1;if(""===t)return 0;var n=0,i=e.toLowerCase(),a=e.length,s=t.toLowerCase(),o=t.length,l=0,c=1;r=r?1-r:0;for(var u=0;u<o;u+=1){var h=i.indexOf(s[u],l);if(-1===h){if(!r)return 0;c+=r}else{var d=0;l===h?d=.7:(d=.1," "===e[h-1]&&(d+=.8)),e[h]===t[u]&&(d+=.1),n+=d,l=h+1}}var f=.5*(n/a+n/o)/c;return s[0]===i[0]&&f<.85&&(f+=.15),f}},2553:(e,t,r)=>{"use strict";var n=r(9509).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=a,a.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},a.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},842:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractTokenizer=void 0;const i=r(5167);t.AbstractTokenizer=class{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){const r=n.alloc(e.len);if(await this.readBuffer(r,{position:t})<e.len)throw new i.EndOfStreamError;return e.get(r,0)}async peekToken(e,t=this.position){const r=n.alloc(e.len);if(await this.peekBuffer(r,{position:t})<e.len)throw new i.EndOfStreamError;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new i.EndOfStreamError;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new i.EndOfStreamError;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}},778:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferTokenizer=void 0;const n=r(5167),i=r(842);class a extends i.AbstractTokenizer{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t&&t.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const r=await this.peekBuffer(e,t);return this.position+=r,r}async peekBuffer(e,t){const r=this.normalizeOptions(e,t),i=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&i<r.length)throw new n.EndOfStreamError;return e.set(this.uint8Array.subarray(r.position,r.position+i),r.offset),i}async close(){}}t.BufferTokenizer=a},599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadStreamTokenizer=void 0;const n=r(842),i=r(5167);class a extends n.AbstractTokenizer{constructor(e,t){super(t),this.streamReader=new i.StreamReader(e)}async getFileInfo(){return this.fileInfo}async readBuffer(e,t){const r=this.normalizeOptions(e,t),n=r.position-this.position;if(n>0)return await this.ignore(n),this.readBuffer(e,t);if(n<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===r.length)return 0;const a=await this.streamReader.read(e,r.offset,r.length);if(this.position+=a,(!t||!t.mayBeLess)&&a<r.length)throw new i.EndOfStreamError;return a}async peekBuffer(e,t){const r=this.normalizeOptions(e,t);let n=0;if(r.position){const t=r.position-this.position;if(t>0){const i=new Uint8Array(r.length+t);return n=await this.peekBuffer(i,{mayBeLess:r.mayBeLess}),e.set(i.subarray(t),r.offset),n-t}if(t<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{n=await this.streamReader.peek(e,r.offset,r.length)}catch(e){if(t&&t.mayBeLess&&e instanceof i.EndOfStreamError)return 0;throw e}if(!r.mayBeLess&&n<r.length)throw new i.EndOfStreamError}return n}async ignore(e){const t=Math.min(256e3,e),r=new Uint8Array(t);let n=0;for(;n<e;){const i=e-n,a=await this.readBuffer(r,{length:Math.min(t,i)});if(a<0)return a;n+=a}return n}}t.ReadStreamTokenizer=a},5849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromBuffer=t.fromStream=t.EndOfStreamError=void 0;const n=r(599),i=r(778);var a=r(5167);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return a.EndOfStreamError}}),t.fromStream=function(e,t){return t=t||{},new n.ReadStreamTokenizer(e,t)},t.fromBuffer=function(e,t){return new i.BufferTokenizer(e,t)}},3416:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AnsiStringType=t.StringType=t.BufferType=t.Uint8ArrayType=t.IgnoreType=t.Float80_LE=t.Float80_BE=t.Float64_LE=t.Float64_BE=t.Float32_LE=t.Float32_BE=t.Float16_LE=t.Float16_BE=t.INT64_BE=t.UINT64_BE=t.INT64_LE=t.UINT64_LE=t.INT32_LE=t.INT32_BE=t.INT24_BE=t.INT24_LE=t.INT16_LE=t.INT16_BE=t.INT8=t.UINT32_BE=t.UINT32_LE=t.UINT24_BE=t.UINT24_LE=t.UINT16_BE=t.UINT16_LE=t.UINT8=void 0;const i=r(645);function a(e){return new DataView(e.buffer,e.byteOffset)}t.UINT8={len:1,get:(e,t)=>a(e).getUint8(t),put:(e,t,r)=>(a(e).setUint8(t,r),t+1)},t.UINT16_LE={len:2,get:(e,t)=>a(e).getUint16(t,!0),put:(e,t,r)=>(a(e).setUint16(t,r,!0),t+2)},t.UINT16_BE={len:2,get:(e,t)=>a(e).getUint16(t),put:(e,t,r)=>(a(e).setUint16(t,r),t+2)},t.UINT24_LE={len:3,get(e,t){const r=a(e);return r.getUint8(t)+(r.getUint16(t+1,!0)<<8)},put(e,t,r){const n=a(e);return n.setUint8(t,255&r),n.setUint16(t+1,r>>8,!0),t+3}},t.UINT24_BE={len:3,get(e,t){const r=a(e);return(r.getUint16(t)<<8)+r.getUint8(t+2)},put(e,t,r){const n=a(e);return n.setUint16(t,r>>8),n.setUint8(t+2,255&r),t+3}},t.UINT32_LE={len:4,get:(e,t)=>a(e).getUint32(t,!0),put:(e,t,r)=>(a(e).setUint32(t,r,!0),t+4)},t.UINT32_BE={len:4,get:(e,t)=>a(e).getUint32(t),put:(e,t,r)=>(a(e).setUint32(t,r),t+4)},t.INT8={len:1,get:(e,t)=>a(e).getInt8(t),put:(e,t,r)=>(a(e).setInt8(t,r),t+1)},t.INT16_BE={len:2,get:(e,t)=>a(e).getInt16(t),put:(e,t,r)=>(a(e).setInt16(t,r),t+2)},t.INT16_LE={len:2,get:(e,t)=>a(e).getInt16(t,!0),put:(e,t,r)=>(a(e).setInt16(t,r,!0),t+2)},t.INT24_LE={len:3,get(e,r){const n=t.UINT24_LE.get(e,r);return n>8388607?n-16777216:n},put(e,t,r){const n=a(e);return n.setUint8(t,255&r),n.setUint16(t+1,r>>8,!0),t+3}},t.INT24_BE={len:3,get(e,r){const n=t.UINT24_BE.get(e,r);return n>8388607?n-16777216:n},put(e,t,r){const n=a(e);return n.setUint16(t,r>>8),n.setUint8(t+2,255&r),t+3}},t.INT32_BE={len:4,get:(e,t)=>a(e).getInt32(t),put:(e,t,r)=>(a(e).setInt32(t,r),t+4)},t.INT32_LE={len:4,get:(e,t)=>a(e).getInt32(t,!0),put:(e,t,r)=>(a(e).setInt32(t,r,!0),t+4)},t.UINT64_LE={len:8,get:(e,t)=>a(e).getBigUint64(t,!0),put:(e,t,r)=>(a(e).setBigUint64(t,r,!0),t+8)},t.INT64_LE={len:8,get:(e,t)=>a(e).getBigInt64(t,!0),put:(e,t,r)=>(a(e).setBigInt64(t,r,!0),t+8)},t.UINT64_BE={len:8,get:(e,t)=>a(e).getBigUint64(t),put:(e,t,r)=>(a(e).setBigUint64(t,r),t+8)},t.INT64_BE={len:8,get:(e,t)=>a(e).getBigInt64(t),put:(e,t,r)=>(a(e).setBigInt64(t,r),t+8)},t.Float16_BE={len:2,get(e,t){return i.read(e,t,!1,10,this.len)},put(e,t,r){return i.write(e,r,t,!1,10,this.len),t+this.len}},t.Float16_LE={len:2,get(e,t){return i.read(e,t,!0,10,this.len)},put(e,t,r){return i.write(e,r,t,!0,10,this.len),t+this.len}},t.Float32_BE={len:4,get:(e,t)=>a(e).getFloat32(t),put:(e,t,r)=>(a(e).setFloat32(t,r),t+4)},t.Float32_LE={len:4,get:(e,t)=>a(e).getFloat32(t,!0),put:(e,t,r)=>(a(e).setFloat32(t,r,!0),t+4)},t.Float64_BE={len:8,get:(e,t)=>a(e).getFloat64(t),put:(e,t,r)=>(a(e).setFloat64(t,r),t+8)},t.Float64_LE={len:8,get:(e,t)=>a(e).getFloat64(t,!0),put:(e,t,r)=>(a(e).setFloat64(t,r,!0),t+8)},t.Float80_BE={len:10,get(e,t){return i.read(e,t,!1,63,this.len)},put(e,t,r){return i.write(e,r,t,!1,63,this.len),t+this.len}},t.Float80_LE={len:10,get(e,t){return i.read(e,t,!0,63,this.len)},put(e,t,r){return i.write(e,r,t,!0,63,this.len),t+this.len}},t.IgnoreType=class{constructor(e){this.len=e}get(e,t){}},t.Uint8ArrayType=class{constructor(e){this.len=e}get(e,t){return e.subarray(t,t+this.len)}},t.BufferType=class{constructor(e){this.len=e}get(e,t){return n.from(e.subarray(t,t+this.len))}},t.StringType=class{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return n.from(e).toString(this.encoding,t,t+this.len)}};class s{constructor(e){this.len=e}static decode(e,t,r){let n="";for(let i=t;i<r;++i)n+=s.codePointToString(s.singleByteDecoder(e[i]));return n}static inRange(e,t,r){return t<=e&&e<=r}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(s.inRange(e,0,127))return e;const t=s.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return s.decode(e,t,t+this.len)}}t.AnsiStringType=s,s.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},4927:(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return!1}catch(e){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},6006:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=r(2275))&&n.__esModule?n:{default:n};t.default={pauseVideo:{acceptableStates:[i.default.ENDED,i.default.PAUSED],stateChangeRequired:!1},playVideo:{acceptableStates:[i.default.ENDED,i.default.PLAYING],stateChangeRequired:!1},seekTo:{acceptableStates:[i.default.ENDED,i.default.PLAYING,i.default.PAUSED],stateChangeRequired:!0,timeout:3e3}},e.exports=t.default},9125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(9215)),i=o(r(8255)),a=o(r(5279)),s=o(r(6006));function o(e){return e&&e.__esModule?e:{default:e}}var l=(0,n.default)("youtube-player"),c={proxyEvents:function(e){var t={},r=function(r){var n="on"+r.slice(0,1).toUpperCase()+r.slice(1);t[n]=function(t){l('event "%s"',n,t),e.trigger(r,t)}},n=!0,i=!1,s=void 0;try{for(var o,c=a.default[Symbol.iterator]();!(n=(o=c.next()).done);n=!0)r(o.value)}catch(e){i=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(i)throw s}}return t},promisifyPlayer:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={},n=function(n){t&&s.default[n]?r[n]=function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.then((function(e){var t=s.default[n],i=e.getPlayerState(),a=e[n].apply(e,r);return t.stateChangeRequired||Array.isArray(t.acceptableStates)&&-1===t.acceptableStates.indexOf(i)?new Promise((function(r){e.addEventListener("onStateChange",(function n(){var i=e.getPlayerState(),a=void 0;"number"==typeof t.timeout&&(a=setTimeout((function(){e.removeEventListener("onStateChange",n),r()}),t.timeout)),Array.isArray(t.acceptableStates)&&-1!==t.acceptableStates.indexOf(i)&&(e.removeEventListener("onStateChange",n),clearTimeout(a),r())}))})).then((function(){return a})):a}))}:r[n]=function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.then((function(e){return e[n].apply(e,r)}))}},a=!0,o=!1,l=void 0;try{for(var c,u=i.default[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var h=c.value;n(h)}}catch(e){o=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(o)throw l}}return r}};t.default=c,e.exports=t.default},2275:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={BUFFERING:3,ENDED:0,PAUSED:2,PLAYING:1,UNSTARTED:-1,VIDEO_CUED:5},e.exports=t.default},5279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["ready","stateChange","playbackQualityChange","playbackRateChange","error","apiChange","volumeChange"],e.exports=t.default},8255:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["cueVideoById","loadVideoById","cueVideoByUrl","loadVideoByUrl","playVideo","pauseVideo","stopVideo","getVideoLoadedFraction","cuePlaylist","loadPlaylist","nextVideo","previousVideo","playVideoAt","setShuffle","setLoop","getPlaylist","getPlaylistIndex","setOption","mute","unMute","isMuted","setVolume","getVolume","seekTo","getPlayerState","getPlaybackRate","setPlaybackRate","getAvailablePlaybackRates","getPlaybackQuality","setPlaybackQuality","getAvailableQualityLevels","getCurrentTime","getDuration","removeEventListener","getVideoUrl","getVideoEmbedCode","getOptions","getOption","addEventListener","destroy","setSize","getIframe"],e.exports=t.default},1062:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=o(r(3988)),a=o(r(5900)),s=o(r(9125));function o(e){return e&&e.__esModule?e:{default:e}}var l=void 0;t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i.default)();if(l||(l=(0,a.default)(o)),t.events)throw new Error("Event handlers cannot be overwritten.");if("string"==typeof e&&!document.getElementById(e))throw new Error('Element "'+e+'" does not exist.');t.events=s.default.proxyEvents(o);var c=new Promise((function(r){"object"===(void 0===e?"undefined":n(e))&&e.playVideo instanceof Function?r(e):l.then((function(n){var i=new n.Player(e,t);return o.on("ready",(function(){r(i)})),null}))})),u=s.default.promisifyPlayer(c,r);return u.on=o.on,u.off=o.off,u},e.exports=t.default},5900:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=r(9090))&&n.__esModule?n:{default:n};t.default=function(e){return new Promise((function(t){if(window.YT&&window.YT.Player&&window.YT.Player instanceof Function)t(window.YT);else{var r="http:"===window.location.protocol?"http:":"https:";(0,i.default)(r+"//www.youtube.com/iframe_api",(function(t){t&&e.trigger("error",t)}));var n=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){n&&n(),t(window.YT)}}}))},e.exports=t.default},9215:(e,t,r)=>{var n=r(4155);function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=r(5046)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(a=i))})),e.splice(a,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())},5046:(e,t,r)=>{var n;function i(e){function r(){if(r.enabled){var e=r,i=+new Date,a=i-(n||i);e.diff=a,e.prev=n,e.curr=i,n=i;for(var s=new Array(arguments.length),o=0;o<s.length;o++)s[o]=arguments[o];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var l=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;l++;var i=t.formatters[n];if("function"==typeof i){var a=s[l];r=i.call(e,a),s.splice(l,1),l--}return r})),t.formatArgs.call(e,s);var c=r.log||t.log||console.log.bind(console);c.apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length,i=0;i<n;i++)r[i]&&("-"===(e=r[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(4680),t.names=[],t.skips=[],t.formatters={}},4680:e=>{var t=1e3,r=60*t,n=60*r,i=24*n;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,s){s=s||{};var o,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===l&&!1===isNaN(e))return s.long?a(o=e,i,"day")||a(o,n,"hour")||a(o,r,"minute")||a(o,t,"second")||o+" ms":function(e){return e>=i?Math.round(e/i)+"d":e>=n?Math.round(e/n)+"h":e>=r?Math.round(e/r)+"m":e>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},9283:()=>{},3838:()=>{}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(7294),t=__webpack_require__(745);function r(e){return"function"==typeof e}function n(e){return function(t){if(function(e){return r(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function s(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function o(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return s}function c(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function u(e){return this instanceof u?(this.v=e,this):new u(e)}function h(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||o(e,t)}))})}function o(e,t){try{!function(e){e.value instanceof u?Promise.resolve(e.value.v).then(l,c):h(a[0][2],e)}(i[e](t))}catch(e){h(a[0][3],e)}}function l(e){o("next",e)}function c(e){o("throw",e)}function h(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function d(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create;var f=d((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function m(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var p=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,i,a;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var u=o(s),h=u.next();!h.done;h=u.next())h.value.remove(this)}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else s.remove(this);var d=this.initialTeardown;if(r(d))try{d()}catch(e){a=e instanceof f?e.errors:[e]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var p=o(m),g=p.next();!g.done;g=p.next()){var A=g.value;try{v(A)}catch(e){a=null!=a?a:[],e instanceof f?a=c(c([],l(a)),l(e.errors)):a.push(e)}}}catch(e){n={error:e}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}}if(a)throw new f(a)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)v(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&m(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&m(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),g=p.EMPTY;function A(e){return e instanceof p||e&&"closed"in e&&r(e.remove)&&r(e.add)&&r(e.unsubscribe)}function v(e){r(e)?e():e.unsubscribe()}var b=null,y=null,w=void 0,_=!1,E=!1,x={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=x.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,c([e,t],l(r))):setTimeout.apply(void 0,c([e,t],l(r)))},clearTimeout:function(e){var t=x.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function S(e){x.setTimeout((function(){if(!b)throw e;b(e)}))}function T(){}var k=I("C",void 0,void 0);function I(e,t,r){return{kind:e,value:t,error:r}}var C=null;function P(e){if(_){var t=!C;if(t&&(C={errorThrown:!1,error:null}),e(),t){var r=C,n=r.errorThrown,i=r.error;if(C=null,n)throw i}}else e()}var M=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,A(t)&&t.add(r)):r.destination=z,r}return a(t,e),t.create=function(e,t,r){return new D(e,t,r)},t.prototype.next=function(e){this.isStopped?O(function(e){return I("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?O(I("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?O(k,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(p),R=Function.prototype.bind;function B(e,t){return R.call(e,t)}var L=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){N(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){N(e)}else N(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){N(e)}},e}(),D=function(e){function t(t,n,i){var a,s,o=e.call(this)||this;return r(t)||!t?a={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0}:o&&E?((s=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},a={next:t.next&&B(t.next,s),error:t.error&&B(t.error,s),complete:t.complete&&B(t.complete,s)}):a=t,o.destination=new L(a),o}return a(t,e),t}(M);function N(e){var t;_?(t=e,_&&C&&(C.errorThrown=!0,C.error=t)):S(e)}function O(e,t){var r=y;r&&x.setTimeout((function(){return r(e,t)}))}var z={closed:!0,next:T,error:function(e){throw e},complete:T};function F(e,t,r,n,i){return new U(e,t,r,n,i)}var U=function(e){function t(t,r,n,i,a,s){var o=e.call(this,t)||this;return o.onFinalize=a,o.shouldUnsubscribe=s,o._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,o._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return a(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(M),j=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function V(e){return r(null==e?void 0:e.then)}var q="function"==typeof Symbol&&Symbol.observable||"@@observable";function Q(e){return e}function X(e){return 0===e.length?Q:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var W=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,n){var i=this,a=function(e){return e&&e instanceof M||function(e){return e&&r(e.next)&&r(e.error)&&r(e.complete)}(e)&&A(e)}(e)?e:new D(e,t,n);return P((function(){var e=i,t=e.operator,r=e.source;a.add(t?t.call(a,r):r?i._subscribe(a):i._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=$(t))((function(t,n){var i=new D({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[q]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return X(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=$(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function $(e){var t;return null!==(t=null!=e?e:w)&&void 0!==t?t:Promise}function H(e){return r(e[q])}function G(e){return Symbol.asyncIterator&&r(null==e?void 0:e[Symbol.asyncIterator])}function Y(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var K="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function J(e){return r(null==e?void 0:e[K])}function Z(e){return h(this,arguments,(function(){var t,r,n;return s(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,u(t.read())];case 3:return r=i.sent(),n=r.value,r.done?[4,u(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,u(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function ee(e){return r(null==e?void 0:e.getReader)}function te(e){if(e instanceof W)return e;if(null!=e){if(H(e))return a=e,new W((function(e){var t=a[q]();if(r(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(j(e))return t=e,new W((function(e){for(var r=0;r<t.length&&!e.closed;r++)e.next(t[r]);e.complete()}));if(V(e))return i=e,new W((function(e){i.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,S)}));if(G(e))return re(e);if(J(e))return n=e,new W((function(e){var t,r;try{for(var i=o(n),a=i.next();!a.done;a=i.next()){var s=a.value;if(e.next(s),e.closed)return}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()}));if(ee(e))return re(Z(e))}var t,n,i,a;throw Y(e)}function re(e){return new W((function(t){(function(e,t){var r,n,i,a;return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var l,c;return s(this,(function(s){switch(s.label){case 0:s.trys.push([0,5,6,11]),r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=o(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}(e),s.label=1;case 1:return[4,r.next()];case 2:if((n=s.sent()).done)return[3,4];if(l=n.value,t.next(l),t.closed)return[2];s.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=s.sent(),i={error:c},[3,11];case 6:return s.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function ne(e){return n((function(t,r){te(e).subscribe(F(r,(function(){return r.complete()}),T)),!r.closed&&t.subscribe(r)}))}var ie=new W((function(e){return e.complete()}));function ae(e){return e<=0?function(){return ie}:n((function(t,r){var n=0;t.subscribe(F(r,(function(t){++n<=e&&(r.next(t),e<=n&&r.complete())})))}))}var se=__webpack_require__(6657),oe=__webpack_require__.n(se);class le{constructor(e="",t=!1,r=window.console){const n=e?` ${e}:`:"",i=(e,t)=>e&&t?`${e}/${t}`:t||e,a=(...t)=>{e.startsWith(le.only)&&r.log(...t)};this.log=(...e)=>a(`##${n}`,...e),this.warn=(...e)=>a(`###${n}`,...e),this.error=t=>{e.startsWith(le.only)&&(a(`####${n} ERROR`),r.error(t))},t&&(this.next=this.log,this.complete=()=>this.log("***complete***")),this.id=n=>new le(i(e,n),t,r),this.all=t=>new le(i(e,t),!0,r),this.only=()=>(le.only=e,this)}}le.only="";const ce=new Map,ue={get length(){return ce.size},clear(){ce.clear()},key(e){var t;return null!==(t=[...ce.keys()][e])&&void 0!==t?t:null},getItem(e){var t;return null!==(t=ce.get(e))&&void 0!==t?t:null},setItem(e,t){ce.set(e,String(t))},removeItem(e){ce.delete(e)}},he=ue,de=new le("LiteStorage");class fe{constructor(e,t="local"){const r=`${t}-${e}`;if(fe.ids.includes(r))throw Error(`Duplicate storageId: ${r}`);switch(fe.ids.push(r),this.id=`ampcast/${e}`,t){case"local":this.storage=localStorage;break;case"session":this.storage=sessionStorage;break;case"memory":this.storage=he}}getBoolean(e){const t=this.getItem(e);return!!t&&"false"!==t}setBoolean(e,t){this.setItem(e,String(!!t))}getJson(e,t=null){const r=this.getItem(e);try{return r?JSON.parse(r):t}catch(e){return de.error(e),t}}setJson(e,t){try{this.setItem(e,JSON.stringify(t))}catch(e){de.error(e)}}getNumber(e,t=0){var r;const n=Number(null!==(r=this.getItem(e))&&void 0!==r?r:t);return isNaN(n)?t:n}setNumber(e,t){this.setItem(e,String(Number(t)||0))}getString(e,t=""){var r;return String(null!==(r=this.getItem(e))&&void 0!==r?r:t)}setString(e,t){this.setItem(e,t)}getItem(e){return this.storage.getItem(`${this.id}/${e}`)}setItem(e,t){this.storage.setItem(`${this.id}/${e}`,null!=t?t:"")}removeItem(e){this.storage.removeItem(`${this.id}/${e}`)}clear(){const e=`${this.id}/`,t=[];for(let r=0;r<this.storage.length;r++){const n=this.storage.key(r);n.startsWith(e)&&t.push(n)}t.forEach((e=>this.storage.removeItem(e)))}}fe.ids=[];var me=__webpack_require__(4155),pe=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},ge=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},Ae=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},ve=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},be=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ye=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],we=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function _e(e){var t=function(e){return""!==e&&ye.reduce((function(t,r){var n=r[0],i=r[1];if(t)return t;var a=i.exec(e);return!!a&&[n,a]}),!1)}(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new ve;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<3&&(i=pe(pe([],i,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-i.length),!0)):i=[];var a=i.join("."),s=function(e){for(var t=0,r=we.length;t<r;t++){var n=we[t],i=n[0];if(n[1].exec(e))return i}return null}(e),o=be.exec(e);return o&&o[1]?new Ae(r,a,s,o[1]):new ge(r,a,s)}const Ee="undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}:"undefined"!=typeof navigator?_e(navigator.userAgent):void 0!==me&&me.version?new function(e){this.version=e,this.type="node",this.name="node",this.os=me.platform}(me.version.slice(1)):null;const xe=(null==Ee?void 0:Ee.name)||"unknown",Se=/^edge/.test(xe)?"Microsoft Edge":xe.replace(/^\w/,(e=>e.toUpperCase())),Te=(null==Ee?void 0:Ee.version)||"0",ke=(null==Ee?void 0:Ee.os)||"unknown",Ie={name:xe,displayName:Se,version:Te,os:ke,ctrlKey:"Mac OS"===ke?"metaKey":"ctrlKey",ctrlKeyStr:"Mac OS"===ke?"":"Ctrl"};function Ce(e){return null!=e}function Pe(e,t,r=.9){return oe()(e,t)>=r||oe()(t,e)>=r}function Me(e){return new Promise(((t,r)=>{const n=()=>e.disconnect(),i=e.observeItems(),a=e.observeError();i.pipe(ne(a),ae(1)).subscribe({next:t,complete:n}),a.pipe(ne(i),ae(1)).subscribe({next:r,complete:n}),e.fetchAt(0)}))}const Re={};function Be(e){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){if(!Re[e])return new Promise(((t,r)=>{let n=document.querySelector(`script[src="${e}"]`);n||(n=document.createElement("script"),n.async=!0,n.src=e),n.addEventListener("load",(()=>{Re[e]=!0,t()})),n.addEventListener("error",(()=>r(`Failed to load script: '${e}'`))),n.parentElement||document.head.appendChild(n)}))}))}function Le(e,t){const r=[],n=[];for(const i of e)t(i)?r.push(i):n.push(i);return[r,n]}function De(e=Date.now()){return`${(e=new Date(e)).getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function Ne(e){return De(e).slice(0,7)}function Oe(e){e.preventDefault()}function ze(e){e.stopPropagation()}function Fe(e,t){return 1===e.length?e[0]:(void 0!==t&&(e=e.filter((e=>e!==t))),e[Math.floor(Math.random()*e.length)])}const Ue=new fe("layout"),je={get:(e,t=0)=>Ue.getNumber(e,t),set(e,t){Ue.setNumber(e,t)}};function Ve(t,r){const n=(0,e.useRef)(r);(0,e.useEffect)((()=>{n.current=r}),[r]),(0,e.useLayoutEffect)((()=>{const e=t.current;if(e){const t=new ResizeObserver((()=>n.current()));return t.observe(e),()=>t.disconnect()}}),[t])}const qe=document.createElement("div");function Qe(){const t=(0,e.useRef)(qe),[r,n]=(0,e.useState)(0);return(0,e.useEffect)((()=>{qe.parentElement||(document.body.append(qe),n(Xe()))}),[]),Ve(t,(0,e.useCallback)((()=>n(Xe())),[])),r}function Xe(){return parseInt(getComputedStyle(qe).fontSize,10)||16}function We({vertical:t,primary:r,size:n,children:i}){const a={};return r||(t?a.height=`${n}px`:a.width=`${n}px`),e.createElement("div",{className:"layout-pane layout-pane-"+(r?"primary":"secondary"),style:a},i)}function $e({id:t,arrange:r="columns",primaryIndex:n=0,children:i}){const a=(0,e.useRef)(null),[s,o]=(0,e.useState)({width:0,height:0}),[l,c]=(0,e.useState)(0),[u,h]=(0,e.useState)(0),[d,f]=(0,e.useState)(0),[m,p]=(0,e.useState)((()=>t?je.get(t):0)),[g,A]=(0,e.useState)(-1),[v,b]=(0,e.useState)(0),y=-1!==g,w=Qe(),_="rows"===r;(0,e.useEffect)((()=>{t&&je.set(t,m)}),[t,m]),(0,e.useLayoutEffect)((()=>{var e;if(w>0){const t=a.current,r=_?"minHeight":"minWidth",n=t.querySelector(":scope > .layout-pane-primary");if(n){n.style[r]="";const e=parseInt(getComputedStyle(n)[r],10);n.style[r]="unset",c(e||80)}const i=t.querySelector(":scope > .layout-pane-secondary");if(i){i.style[r]="";const n=parseInt(getComputedStyle(i)[r],10);i.style[r]="unset",h(n||80);const a=_?"offsetHeight":"offsetWidth",s=t.querySelector(":scope > .layout-splitter");f(null!==(e=null==s?void 0:s[a])&&void 0!==e?e:4)}}}),[_,w]),(0,e.useLayoutEffect)((()=>{const e=_?s.height:s.width;if(e>0){const t=e-d-m;t<l?p(Math.max(m-(l-t),0)):m<u&&p(Math.min(e-d-l,u))}}),[_,s,l,u,d,m]);const E=(0,e.useCallback)((e=>{if(0===e.button){const t=_?e.screenY:e.screenX;A(t),b(m),e.preventDefault()}}),[_,m]),x=(0,e.useCallback)((e=>{const t=(_?e.screenY:e.screenX)-g;p(0===n?v-t:v+t)}),[_,n,g,v]),S=(0,e.useCallback)((()=>{A(-1),b(0)}),[]);return(0,e.useEffect)((()=>{if(y)return document.documentElement.style.cursor=_?"ns-resize":"ew-resize",document.body.classList.add("dragging"),document.addEventListener("mouseup",S),document.addEventListener("mousemove",x),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",S),document.removeEventListener("mousemove",x)}}),[_,y,x,S]),Ve(a,(0,e.useCallback)((()=>{const e=a.current;o({width:e.clientWidth,height:e.clientHeight})}),[])),e.createElement("div",{className:`splitter splitter-${r}`,id:t,ref:a},e.Children.toArray(i).slice(0,2).map(((t,r)=>{const i=r===n,a=i?0:m,s=[];return 1===r&&s.push(e.createElement("div",{className:"layout-splitter "+(y?"active":""),role:"separator",onMouseDown:E,key:"splitter"})),s.push(e.createElement(We,{vertical:_,primary:i,size:a,key:r},t)),s})))}qe.style.cssText="\n    position: absolute;\n    pointer-events: none;\n    visibility: hidden;\n    font-size: 1rem;\n    width: 1rem;\n    height: 1rem;\n";var He=function(e){function t(t,r){return e.call(this)||this}return a(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(p),Ge={setInterval:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=Ge.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,c([e,t],l(r))):setInterval.apply(void 0,c([e,t],l(r)))},clearInterval:function(e){var t=Ge.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Ye=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return a(t,e),t.prototype.schedule=function(e,t){var r;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),Ge.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&Ge.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,m(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(He),Ke={now:function(){return(Ke.delegate||Date).now()},delegate:void 0},Je=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=Ke.now,e}(),Ze=new(function(e){function t(t,r){void 0===r&&(r=Je.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return a(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(Je))(Ye),et=Ze;function tt(e){return e&&r(e.schedule)}function rt(e,t,r){void 0===e&&(e=0),void 0===r&&(r=et);var n=-1;return null!=t&&(tt(t)?r=t:n=t),new W((function(t){var i=function(e){return e instanceof Date&&!isNaN(e)}(e)?+e-r.now():e;i<0&&(i=0);var a=0;return r.schedule((function(){t.closed||(t.next(a++),0<=n?this.schedule(void 0,n):t.complete())}),i)}))}function nt(e,t){return void 0===e&&(e=0),void 0===t&&(t=Ze),e<0&&(e=0),rt(e,e,t)}function it({children:t}){return e.createElement(e.Fragment,null,t)}function at(e,t){return n((function(r,n){var i=0;r.subscribe(F(n,(function(r){n.next(e.call(t,r,i++))})))}))}function st(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var a=t.schedule((function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()}),n);if(e.add(a),!i)return a}function ot(e,t,i){return void 0===i&&(i=1/0),r(t)?ot((function(r,n){return at((function(e,i){return t(r,e,n,i)}))(te(e(r,n)))}),i):("number"==typeof t&&(i=t),n((function(t,r){return function(e,t,r,n,i,a,s,o){var l=[],c=0,u=0,h=!1,d=function(){!h||l.length||c||t.complete()},f=function(e){return c<n?m(e):l.push(e)},m=function(e){c++;var i=!1;te(r(e,u++)).subscribe(F(t,(function(e){t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{c--;for(;l.length&&c<n;)e=void 0,e=l.shift(),m(e);d()}catch(e){t.error(e)}var e})))};return e.subscribe(F(t,f,(function(){h=!0,d()}))),function(){}}(t,r,e,i)})))}var lt=Array.isArray;function ct(e){return at((function(t){return function(e,t){return lt(t)?e.apply(void 0,c([],l(t))):e(t)}(e,t)}))}var ut=["addListener","removeListener"],ht=["addEventListener","removeEventListener"],dt=["on","off"];function ft(e,t,n,i){if(r(n)&&(i=n,n=void 0),i)return ft(e,t,n).pipe(ct(i));var a=l(function(e){return r(e.addEventListener)&&r(e.removeEventListener)}(e)?ht.map((function(r){return function(i){return e[r](t,i,n)}})):function(e){return r(e.addListener)&&r(e.removeListener)}(e)?ut.map(mt(e,t)):function(e){return r(e.on)&&r(e.off)}(e)?dt.map(mt(e,t)):[],2),s=a[0],o=a[1];if(!s&&j(e))return ot((function(e){return ft(e,t,n)}))(te(e));if(!s)throw new TypeError("Invalid event target");return new W((function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return s(t),function(){return o(t)}}))}function mt(e,t){return function(r){return function(n){return e[r](t,n)}}}function pt(e){return void 0===e&&(e=1/0),ot(Q,e)}function gt(e){return e[e.length-1]}function At(e){return r(gt(e))?e.pop():void 0}function vt(e){return tt(gt(e))?e.pop():void 0}function bt(e,t){return"number"==typeof gt(e)?e.pop():t}function yt(e,t){return void 0===t&&(t=0),n((function(r,n){r.subscribe(F(n,(function(r){return st(n,e,(function(){return n.next(r)}),t)}),(function(){return st(n,e,(function(){return n.complete()}),t)}),(function(r){return st(n,e,(function(){return n.error(r)}),t)})))}))}function wt(e,t){return void 0===t&&(t=0),n((function(r,n){n.add(e.schedule((function(){return r.subscribe(n)}),t))}))}function _t(e,t){if(!e)throw new Error("Iterable cannot be null");return new W((function(r){st(r,t,(function(){var n=e[Symbol.asyncIterator]();st(r,t,(function(){n.next().then((function(e){e.done?r.complete():r.next(e.value)}))}),0,!0)}))}))}function Et(e,t){return t?function(e,t){if(null!=e){if(H(e))return function(e,t){return te(e).pipe(wt(t),yt(t))}(e,t);if(j(e))return function(e,t){return new W((function(r){var n=0;return t.schedule((function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())}))}))}(e,t);if(V(e))return function(e,t){return te(e).pipe(wt(t),yt(t))}(e,t);if(G(e))return _t(e,t);if(J(e))return function(e,t){return new W((function(n){var i;return st(n,t,(function(){i=e[K](),st(n,t,(function(){var e,t,r;try{t=(e=i.next()).value,r=e.done}catch(e){return void n.error(e)}r?n.complete():n.next(t)}),0,!0)})),function(){return r(null==i?void 0:i.return)&&i.return()}}))}(e,t);if(ee(e))return function(e,t){return _t(Z(e),t)}(e,t)}throw Y(e)}(e,t):te(e)}function xt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=vt(e),n=bt(e,1/0),i=e;return i.length?1===i.length?te(i[0]):pt(n)(Et(i,r)):ie}function St(){return pt(1)}function Tt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return St()(Et(e,vt(e)))}function kt(e,t){return n((function(r,n){var i=0;r.subscribe(F(n,(function(r){return e.call(t,r,i++)&&n.next(r)})))}))}function It(e,t){return n((function(r,n){var i=null,a=0,s=!1,o=function(){return s&&!i&&n.complete()};r.subscribe(F(n,(function(r){null==i||i.unsubscribe();var s=0,l=a++;te(e(r,l)).subscribe(i=F(n,(function(e){return n.next(t?t(r,e,l,s++):e)}),(function(){i=null,o()})))}),(function(){s=!0,o()})))}))}function Ct(e,t){switch(t.type){case"resize":{const r=Math.max(t.clientSize,0),n=Math.max(t.scrollSize,r);if(r!==e.clientSize||n!==e.scrollSize){const t=n-r,i=Pt(e.position,t);return Object.assign(Object.assign({},e),{position:i,max:t,clientSize:r,scrollSize:n})}return e}case"scrollBy":{const r=Pt(e.position+t.amount,e.max);return r!==e.position?Object.assign(Object.assign({},e),{position:r}):e}case"scrollTo":{const r=Pt(t.position,e.max);return r!==e.position?Object.assign(Object.assign({},e),{position:r}):e}default:return e}}function Pt(e,t){return Math.min(Math.max(e,0),t)}const Mt={position:0,max:0,clientSize:0,scrollSize:0};const Rt=(0,e.memo)((function(t){var{orientation:r,scrollAmount:i,onChange:a,onResize:s,scrollbarRef:o}=t,l=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["orientation","scrollAmount","onChange","onResize","scrollbarRef"]);const c=(0,e.useRef)(null),u=(0,e.useRef)(null),{position:h,max:d,clientSize:f,scrollSize:m,resize:p,scrollBy:g,scrollTo:A}=function(){const[{position:t,max:r,clientSize:n,scrollSize:i},a]=(0,e.useReducer)(Ct,Mt),s=(0,e.useCallback)(((e,t)=>a({type:"resize",clientSize:e,scrollSize:t})),[]),o=(0,e.useCallback)((e=>a({type:"scrollTo",position:e})),[]);return{position:t,max:r,clientSize:n,scrollSize:i,scrollTo:o,scrollBy:(0,e.useCallback)((e=>a({type:"scrollBy",amount:e})),[]),resize:s}}(),[v,b]=(0,e.useState)(0),[y,w]=(0,e.useState)(0),[_,E]=(0,e.useState)(0),[x,S]=(0,e.useState)(-1),[T,k]=(0,e.useState)(0),I=-1!==x,C="vertical"===r,P=Math.ceil(h/d*(y-_));(0,e.useEffect)((()=>{o.current={scrollBy:g,scrollTo:A}}),[o,g,A]),(0,e.useLayoutEffect)((()=>p(l.clientSize,l.scrollSize)),[l.clientSize,l.scrollSize,p]),(0,e.useLayoutEffect)((()=>null==a?void 0:a(h)),[h,a]),(0,e.useLayoutEffect)((()=>null==s?void 0:s(v)),[v,s]),Ve(c,(0,e.useCallback)((()=>{const e=c.current.getBoundingClientRect();w(C?e.height:e.width),b(C?e.width:e.height)}),[C])),Ve(u,(0,e.useCallback)((()=>{const e=u.current.getBoundingClientRect();E(C?e.height:e.width)}),[C]));const M=(0,e.useCallback)(((e,t)=>{const r=()=>o.current.scrollBy(t),i=t=>t.target===e,a=ft(document,"mouseup"),s=ft(e,"mouseover").pipe(at(i),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=vt(e);return n((function(t,n){(r?Tt(e,t,r):Tt(e,t)).subscribe(n)}))}(!0)),l=xt(s,ft(e,"mouseout").pipe(kt(i),at((()=>!1)))).pipe(It(((e,t)=>e?rt(0===t?400:0,40):ie)),ne(a)).subscribe(r);return r(),()=>l.unsubscribe()}),[o]),R=(0,e.useCallback)((e=>{if(0===e.button)return e.stopPropagation(),M(e.target,-i)}),[i,M]),B=(0,e.useCallback)((e=>{if(0===e.button)return e.stopPropagation(),M(e.target,i)}),[i,M]),L=(0,e.useCallback)((e=>{if(0===e.button){e.preventDefault();const t=C?e.nativeEvent.offsetY:e.nativeEvent.offsetX;return M(e.target,t<P?-f:f)}}),[C,f,P,M]),D=(0,e.useCallback)((e=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),S(C?e.screenY:e.screenX),k(P))}),[C,P]),N=(0,e.useCallback)((e=>{const t=C?e.screenY:e.screenX;A((T+(t-x))*d/(y-_))}),[C,x,T,d,_,y,A]),O=(0,e.useCallback)((()=>{S(-1),k(0)}),[]);return(0,e.useEffect)((()=>{if(I)return document.body.classList.add("dragging"),document.addEventListener("mouseup",O),document.addEventListener("mousemove",N),()=>{document.body.classList.remove("dragging"),document.removeEventListener("mouseup",O),document.removeEventListener("mousemove",N)}}),[I,N,O]),e.createElement("div",{className:`scrollbar scrollbar-${r}`},e.createElement("div",{className:"scrollbar-button scrollbar-button-decrement",onMouseDown:R},e.createElement("svg",{className:"icon",viewBox:"0 0 50 50"},e.createElement("polygon",{points:C?"0,50 25,0 50,50":"50,0 0,25 50,50"}))),e.createElement("div",{className:"scrollbar-track",onMouseDown:L,ref:c},e.createElement("div",{className:"scrollbar-thumb",onMouseDown:D,style:{[C?"height":"width"]:y*(m?f/m:0)+"px",transform:`translate${C?"Y":"X"}(${P}px)`},ref:u})),e.createElement("div",{className:"scrollbar-button scrollbar-button-increment",onMouseDown:B},e.createElement("svg",{className:"icon",viewBox:"0 0 50 50"},e.createElement("polygon",{points:C?"0,0 25,50 50,0":"0,0 50,25 0,50"}))))}));function Bt({children:t,scrollWidth:r=0,scrollHeight:n=0,scrollAmount:i=10,droppable:a,onResize:s,onScroll:o,scrollableRef:l}){const c=(0,e.useRef)(null),u=(0,e.useRef)(null),h=(0,e.useRef)(null),d=(0,e.useRef)(null),f=(0,e.useRef)(null),m=(0,e.useRef)(null),[p,g]=(0,e.useState)(0),[A,v]=(0,e.useState)(0),[b,y]=(0,e.useState)(0),[w,_]=(0,e.useState)(0),[E,x]=(0,e.useState)(0),[S,T]=(0,e.useState)(r),[k,I]=(0,e.useState)(n),[C,P]=(0,e.useState)(0),[M,R]=(0,e.useState)(0),[B,L]=(0,e.useState)(!1),[D,N]=(0,e.useState)(!1),[O,z]=(0,e.useState)(0),F=Math.max(C-(D?A:0),0),U=Math.max(M-(B?p:0),0);(0,e.useEffect)((()=>{l&&(l.current={scrollTo:({left:e,top:t})=>{void 0!==e&&f.current.scrollTo(e),void 0!==t&&m.current.scrollTo(t)}})}),[l]),(0,e.useLayoutEffect)((()=>{S&&F?L(S-F>1):N(!1)}),[S,F]),(0,e.useLayoutEffect)((()=>{N(!(!k||!U)&&k-U>1)}),[k,U]),(0,e.useLayoutEffect)((()=>{c.current.classList.toggle("overflow-x",B)}),[B]),(0,e.useLayoutEffect)((()=>{c.current.classList.toggle("overflow-y",D)}),[D]),(0,e.useLayoutEffect)((()=>{var e;T(0===r?(null===(e=u.current)||void 0===e?void 0:e.scrollWidth)||0:r)}),[r]),(0,e.useLayoutEffect)((()=>{var e;I(0===n?(null===(e=u.current)||void 0===e?void 0:e.scrollHeight)||0:n)}),[n]);const j=(0,e.useCallback)((()=>{const e=c.current;P(e.clientWidth),R(e.clientHeight),y(e.getBoundingClientRect().top)}),[]),V=(0,e.useCallback)((()=>{const e=u.current,t=d.current;0===r&&T(e.scrollWidth),0===n&&I(t.scrollHeight+h.current.clientHeight),null==s||s({width:e.clientWidth,height:e.clientHeight})}),[r,n,s]);Ve(c,j),Ve(u,V),Ve(d,V),(0,e.useLayoutEffect)((()=>{null==o||o({left:w,top:E})}),[w,E,o]);const q=(0,e.useCallback)((e=>{m.current.scrollBy(3*i*Math.sign(e.deltaY))}),[i]),Q=(0,e.useCallback)((e=>{const t=e.nativeEvent.clientY-b;t+i/2>M?z(i):t<i&&z(-i)}),[b,M,i]);(0,e.useEffect)((()=>{if(O){const e=()=>m.current.scrollBy(O),t=nt(100).subscribe(e);return()=>t.unsubscribe()}}),[O]);const X=(0,e.useCallback)((()=>z(0)),[]),[W,$]=Le(e.Children.toArray(t),(e=>(null==e?void 0:e.type)===it));return e.createElement("div",{className:"scrollable",onWheel:q,ref:c},e.createElement("div",{className:"scrollable-content",onDragOver:a?Q:void 0,onDragLeave:a?X:void 0,onDragEnd:a?X:void 0,onDrop:a?X:void 0,style:{right:D?`${A}px`:"0",bottom:B?`${p}px`:"0",transform:`translateX(-${w}px)`},ref:u},e.createElement("div",{className:"scrollable-head",ref:h},W),e.createElement("div",{className:"scrollable-body",style:{width:r?`${r}px`:void 0}},e.createElement("div",{className:"scrollable-body-content",style:{transform:`translateY(-${E}px)`},ref:d},$))),e.createElement(Rt,{orientation:"horizontal",clientSize:F,scrollSize:S,scrollAmount:i,onChange:_,onResize:g,scrollbarRef:f}),e.createElement(Rt,{orientation:"vertical",clientSize:U,scrollSize:k,scrollAmount:i,onChange:x,onResize:v,scrollbarRef:m}))}function Lt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=vt(e);return Et(e,r)}function Dt(t=200){const[r,i]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=(e,t)=>ft(document,e,{capture:!0}).pipe(at((()=>t))),r=xt(e("keydown",!0),e("keyup",!1)).pipe((a=e=>e?Lt(0):rt(t),n((function(e,t){var r=!1,n=null,i=null,s=function(){if(null==i||i.unsubscribe(),i=null,r){r=!1;var e=n;n=null,t.next(e)}};e.subscribe(F(t,(function(e){null==i||i.unsubscribe(),r=!0,n=e,i=F(t,s,T),te(a(e)).subscribe(i)}),(function(){s(),t.complete()}),void 0,(function(){n=i=null})))})))).subscribe(i);var a;return()=>r.unsubscribe()}),[t]),r}function Nt(t){return(0,e.useMemo)((()=>Ot(t)),[t])}function Ot(e){return e.reduce(((e,t)=>(e.push(t.id),t.children?e.concat(Ot(t.children)):e)),[])}function zt(t){return{storeExpandedState:(0,e.useCallback)(((e,r)=>{t&&localStorage.setItem(`${t}/${e}`,String(!!r))}),[t]),retrieveExpandedState:(0,e.useCallback)(((e,r=!1)=>{if(t){const n=localStorage.getItem(`${t}/${e}`);return"string"==typeof n?"true"===n:r}return r}),[t]),storeSelectedNodeId:(0,e.useCallback)((e=>{t&&localStorage.setItem(`${t}/selectedId`,e)}),[t]),retrieveSelectedNodeId:(0,e.useCallback)((e=>t&&localStorage.getItem(`${t}/selectedId`)||e),[t])}}function Ft(t,r){const{storeExpandedState:n,retrieveExpandedState:i}=zt(r),a=Nt(t),[s,o]=(0,e.useState)((()=>Ut(t,i)));(0,e.useEffect)((()=>{const e=s.filter((e=>a.includes(e)));e.length!==s.length&&o(e)}),[a,s]);const l=(0,e.useCallback)(((e,t)=>{const r=s.includes(e);r!==t&&(o(r?s.filter((t=>t!==e)):s.concat(e)),n(e,!r))}),[s,n]);return{expandedIds:s,toggle:l}}function Ut(e,t){return e.reduce(((e,r)=>(t(r.id,r.startExpanded)&&e.push(r.id),r.children?e.concat(Ut(r.children,t)):e)),[])}function jt(t,r){return(0,e.useMemo)((()=>Vt(t,r)),[t,r])}function Vt(e,t){return e.reduce(((e,r)=>(e.push(r.id),r.children&&t.includes(r.id)?e.concat(Vt(r.children,t)):e)),[])}function qt({id:t,label:r,children:n=[],selectedId:i,expandedIds:a,level:s,rowHeight:o,nodeIndex:l,setSize:c,emptyMarker:u,onSelect:h,onToggle:d}){const f=a.includes(t),m=0!==n.length,p=t===i,g=`${m?"expandable":""} ${f?"expanded":""} ${p?"selected":""} ${0===n.length?"empty":""}`,A=(0,e.useCallback)((e=>{e.stopPropagation()}),[]),v=(0,e.useCallback)((e=>{e.stopPropagation(),null==h||h(t)}),[t,h]),b=(0,e.useCallback)((e=>{e.stopPropagation(),null==d||d(t)}),[t,d]),y=(0,e.useCallback)((e=>{e.stopPropagation(),null==d||d(t),f&&Ht(n,i)&&(null==h||h(t))}),[t,i,f,n,h,d]);return e.createElement("li",{className:`tree-view-node ${g}`,id:`tree-view-node-${t}`,role:"treeitem","aria-selected":p?"true":void 0,"aria-expanded":f?"true":void 0,"aria-labelledby":`tree-view-node-label-${t}`,"aria-level":s,"aria-setsize":c,"aria-posinset":l+1,onMouseDown:v},e.createElement("span",{className:"tree-view-row",onDoubleClick:b,style:{height:`${o}px`}},m?e.createElement("svg",{className:"tree-view-node-marker",viewBox:`0 0 ${f?320:256} 512`,onMouseDown:A,onClick:y},f?e.createElement("path",{d:"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"}):e.createElement("path",{d:"M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"})):u&&e.createElement("svg",{className:"tree-view-node-marker",viewBox:"0 0 24 24",onMouseDown:A},e.createElement("circle",{cx:"12",cy:"12",r:"4"})),e.createElement("span",{className:"tree-view-node-label",id:`tree-view-node-label-${t}`},r)),f&&e.createElement("ul",{className:"tree-view-node-children",role:"group"},n.map(((t,r)=>{var{id:l}=t,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["id"]);return e.createElement(qt,Object.assign({},c,{id:l,selectedId:i,expandedIds:a,level:s+1,rowHeight:o,nodeIndex:r,setSize:n.length,onSelect:h,onToggle:d,key:l}))}))))}var Qt,Xt=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};function Wt(t){var{roots:r,className:n=""}=t,i=Xt(t,["roots","className"]);return 0===r.length?e.createElement("div",{className:`tree-view ${n}`,tabIndex:0}):e.createElement($t,Object.assign({},i,{className:n,roots:r}))}function $t({roots:t,className:r,storeId:n,onContextMenu:i,onDelete:a,onEnter:s,onInfo:o,onSelect:l}){const c=(0,e.useRef)(null),u=(0,e.useRef)(null),h=(0,e.useRef)(null),{storeSelectedNodeId:d,retrieveSelectedNodeId:f}=zt(n),[m,p]=(0,e.useState)((()=>{var e;return f(null===(e=t[0])||void 0===e?void 0:e.id)})),{expandedIds:g,toggle:A}=Ft(t,n),v=jt(t,g),b=v.indexOf(m),[y,w]=(0,e.useState)(0),[_,E]=(0,e.useState)(24),[x,S]=(0,e.useState)(0),T=Math.floor(y/_)-1,k=v.length,I=Gt(t,m),C=Dt()&&!(0===b||b===k-1),[P,M]=(0,e.useState)((()=>I));(0,e.useLayoutEffect)((()=>{if(!Ht(t,m)){const e=t.find((e=>m.startsWith(`${e.id}/`)))||t[0];p(null==e?void 0:e.id)}}),[t,m]),(0,e.useLayoutEffect)((()=>{null==l||l(P)}),[P,l]),(0,e.useEffect)((()=>{d(m)}),[m,d]),(0,e.useEffect)((()=>{C||M(I)}),[I,C]);const R=(0,e.useCallback)((e=>{e.preventDefault(),null==i||i(I,e.pageX,e.pageY)}),[I,i]),B=(0,e.useCallback)((e=>{switch(e.key){case"Enter":e.stopPropagation(),e.repeat||null==s||s(I);break;case"Delete":e.stopPropagation(),e.repeat||null==a||a(I);break;case"Info":case"i":e.stopPropagation(),e.repeat||null==o||o(I);break;case"ArrowLeft":e.stopPropagation(),e.repeat||A(m,!1);break;case"ArrowRight":e.stopPropagation(),e.repeat||A(m,!0);break;default:{const t=function(e,t,r){switch(e){case"ArrowUp":return t[t.indexOf(r)-1]||r;case"ArrowDown":return t[t.indexOf(r)+1]||r;case"Home":return t[0]||r;case"End":return t[t.length-1]||r;default:return""}}(e.key,v,m);if(t&&(e.preventDefault(),t!==m)){e.stopPropagation();const r=u.current,n=Math.floor(x/_),i=v.indexOf(t);if(i>=n+T-1){const e=k*_,t=k-T-1,n=Math.min(k-1,i+1)-T,a=n===t?e:n*_;r.scrollTo({top:a})}else if(i<=n){const e=Math.max(0,i-1)*_;r.scrollTo({top:e})}p(t)}}}}),[v,m,I,_,T,k,x,a,s,o,A]),L=(0,e.useCallback)((({height:e})=>w(e)),[]),D=(0,e.useCallback)((({top:e})=>S(e)),[]);return Ve(h,(0,e.useCallback)((()=>{E(h.current.getBoundingClientRect().height)}),[])),e.createElement("div",{className:`tree-view ${r}`,tabIndex:0,onContextMenu:R,onKeyDown:B,ref:c},e.createElement(Bt,{scrollAmount:_,onResize:L,onScroll:D,scrollableRef:u},e.createElement("ul",{role:"tree"},t.map(((r,n)=>{var{id:i}=r,a=Xt(r,["id"]);return e.createElement(qt,Object.assign({},a,{id:i,selectedId:m,expandedIds:g,level:1,rowHeight:_,nodeIndex:n,setSize:t.length,emptyMarker:!0,onSelect:p,onToggle:A,key:i}))}))),e.createElement("div",{className:"tree-view-cursor",style:{transform:`translateY(${b*_}px)`},ref:h})))}function Ht(e,t){for(const r of e){if(r.id===t)return!0;if(r.children&&Ht(r.children,t))return!0}return!1}function Gt(e,t){return e.reduce(((e,r)=>{if(void 0===e)if(r.id===t)e=r.value;else if(r.children)return Gt(r.children,t);return e}),void 0)}!function(e){e[e.Media=0]="Media",e[e.Album=1]="Album",e[e.Artist=2]="Artist",e[e.Playlist=3]="Playlist"}(Qt||(Qt={}));const Yt=Qt;class Kt{constructor(e=[]){this.items=e}get maxSize(){}observeItems(){return Lt(this.items)}observeSize(){return Lt(this.items.length)}observeError(){return ie}fetchAt(){}disconnect(){}}var Jt=d((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Zt=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return a(t,e),t.prototype.lift=function(e){var t=new er(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Jt},t.prototype.next=function(e){var t=this;P((function(){var r,n;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=o(t.currentObservers),a=i.next();!a.done;a=i.next())a.value.next(e)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}}))},t.prototype.error=function(e){var t=this;P((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}}))},t.prototype.complete=function(){var e=this;P((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this,n=r.hasError,i=r.isStopped,a=r.observers;return n||i?g:(this.currentObservers=null,a.push(e),new p((function(){t.currentObservers=null,m(a,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,r=t.hasError,n=t.thrownError,i=t.isStopped;r?e.error(n):i&&e.complete()},t.prototype.asObservable=function(){var e=new W;return e.source=this,e},t.create=function(e,t){return new er(e,t)},t}(W),er=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return a(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:g},t}(Zt),tr=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return a(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){var e=this,t=e.hasError,r=e.thrownError,n=e._value;if(t)throw r;return this._throwIfClosed(),n},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Zt);function rr(e,t){return void 0===t&&(t=Q),e=null!=e?e:nr,n((function(r,n){var i,a=!0;r.subscribe(F(n,(function(r){var s=t(r);!a&&e(i,s)||(a=!1,i=s,n.next(r))})))}))}function nr(e,t){return e===t}const ir="eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ijk3RjI2N1daRDkifQ.eyJpYXQiOjE2NjEzNjAyODMsImV4cCI6MTY3NjkxMjI4MywiaXNzIjoiODM4Nk5ERlhMQiJ9.qkvBCFCPGPBBO1Z26b1kiQBzCoZjbcpcIMrxyi-m1BpTWSJUEP9nT58cwc5WGbkOc1YVmipk9Lj0mtOKi_4Qsg".toString(),ar="41bd731be5b78200d2bbaea2312b917b".toString(),sr="78aa93b641329f00e68cf1542356b8fc".toString(),or="68c1c915728f4b9da193da1028692f0d".toString(),lr="AIzaSyD-cQaU5ntJBcCEBAbmK5pIXD4FQ19fdho".toString(),cr="364143070327-sgopc15lidje8uq4l16k1u8pqo2hpc4o.apps.googleusercontent.com".toString(),ur=new fe("apple"),hr={get useMusicKitBeta(){return ur.getBoolean("useMusicKitBeta")},set useMusicKitBeta(e){ur.setBoolean("useMusicKitBeta",e)},clear(){ur.clear()}};var dr=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};class fr{constructor(e){this.MusicKit=e}get Events(){return this.MusicKit.Events}get PlaybackStates(){return this.MusicKit.PlaybackStates}configure(e){return dr(this,void 0,void 0,(function*(){const t=this.MusicKit.configure(e);return this.instance=t,Object.defineProperties(t,{volume:{get:()=>t.player.volume,set:e=>t.player.volume=e},queue:{get:()=>t.player.queue},isPlaying:{get:()=>t.player.isPlaying},nowPlayingItem:{get:()=>t.player.nowPlayingItem}}),Object.defineProperties(t.api,{music:{get:()=>e=>this.music(e)}}),this.instance}))}getInstance(){const e=this.instance;if(e)return e.api.music||Object.defineProperties(e.api,{music:{get:()=>e=>this.music(e)}}),e;throw Error("Not configured.")}formatArtworkURL(e,t,r){return this.MusicKit.formatArtworkURL(e,t,r)}music(e){return dr(this,void 0,void 0,(function*(){const t=this.getInstance();e=e.replace("{{storefrontId}}",t.storefrontId);const r=yield fetch(`https://api.music.apple.com${e}`,{headers:{authorization:`Bearer ${t.developerToken}`,"music-user-token":t.musicUserToken}});if(!r.ok)throw r;return{data:yield r.json()}}))}}var mr=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::appleAuth");const pr=new le("appleAuth"),gr=new tr("");function Ar(){return gr.pipe(rr()).pipe(at((e=>""!==e)),rr())}function vr(){return mr(this,void 0,void 0,(function*(){return window.MusicKit?MusicKit.getInstance():new Promise(((e,t)=>{Be(`https://js-cdn.music.apple.com/musickit/v${hr.useMusicKitBeta?3:1}/musickit.js`).then(void 0,t),document.addEventListener("musickitloaded",(()=>mr(this,void 0,void 0,(function*(){pr.log("Loaded MusicKit version",MusicKit.version),window.MusicKit.version.startsWith("1")&&(window.MusicKit=new fr(MusicKit));try{const t=yield window.MusicKit.configure({developerToken:ir,app:{name:"ampcast",build:"0.5.4"},sourceType:8,suppressErrorDialog:!0});e(t)}catch(e){t(e)}}))))}))}))}var br;!function(){mr(this,void 0,void 0,(function*(){const e=yield vr();if(e.isAuthorized){const t=yield e.authorize();pr.log("Access token successfully obtained."),gr.next(t)}}))}(),function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video"}(br||(br={}));const yr=br;var wr=Array.isArray,_r=Object.getPrototypeOf,Er=Object.prototype,xr=Object.keys;function Sr(e){if(1===e.length){var t=e[0];if(wr(t))return{args:t,keys:null};if((n=t)&&"object"==typeof n&&_r(n)===Er){var r=xr(t);return{args:r.map((function(e){return t[e]})),keys:r}}}var n;return{args:e,keys:null}}function Tr(e,t){return e.reduce((function(e,r,n){return e[r]=t[n],e}),{})}function kr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=vt(e),n=At(e),i=Sr(e),a=i.args,s=i.keys;if(0===a.length)return Et([],r);var o=new W(Ir(a,r,s?function(e){return Tr(s,e)}:Q));return n?o.pipe(ct(n)):o}function Ir(e,t,r){return void 0===r&&(r=Q),function(n){Cr(t,(function(){for(var i=e.length,a=new Array(i),s=i,o=i,l=function(i){Cr(t,(function(){var l=Et(e[i],t),c=!1;l.subscribe(F(n,(function(e){a[i]=e,c||(c=!0,o--),o||n.next(r(a.slice()))}),(function(){--s||n.complete()})))}),n)},c=0;c<i;c++)l(c)}),n)}}function Cr(e,t,r){e?st(r,e,t):t()}function Pr(e,t,i){var a=r(e)||t||i?{next:e,error:t,complete:i}:e;return a?n((function(e,t){var r;null===(r=a.subscribe)||void 0===r||r.call(a);var n=!0;e.subscribe(F(t,(function(e){var r;null===(r=a.next)||void 0===r||r.call(a,e),t.next(e)}),(function(){var e;n=!1,null===(e=a.complete)||void 0===e||e.call(a),t.complete()}),(function(e){var r;n=!1,null===(r=a.error)||void 0===r||r.call(a,e),t.error(e)}),(function(){var e,t;n&&(null===(e=a.unsubscribe)||void 0===e||e.call(a)),null===(t=a.finalize)||void 0===t||t.call(a)})))})):Q}function Mr(e){return n((function(t,r){var n,i=null,a=!1;i=t.subscribe(F(r,void 0,void 0,(function(s){n=te(e(s,Mr(e)(t))),i?(i.unsubscribe(),i=null,n.subscribe(r)):a=!0}))),a&&(i.unsubscribe(),i=null,n.subscribe(r))}))}var Rr=function(e){function t(t,r,n){void 0===t&&(t=1/0),void 0===r&&(r=1/0),void 0===n&&(n=Ke);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=n,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return a(t,e),t.prototype.next=function(t){var r=this,n=r.isStopped,i=r._buffer,a=r._infiniteTimeWindow,s=r._timestampProvider,o=r._windowTime;n||(i.push(t),!a&&i.push(s.now()+o)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),r=this._infiniteTimeWindow,n=this._buffer.slice(),i=0;i<n.length&&!e.closed;i+=r?1:2)e.next(n[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,r=e._timestampProvider,n=e._buffer,i=e._infiniteTimeWindow,a=(i?1:2)*t;if(t<1/0&&a<n.length&&n.splice(0,n.length-a),!i){for(var s=r.now(),o=0,l=1;l<n.length&&n[l]<=s;l+=2)o=l;o&&n.splice(0,o+1)}},t}(Zt);const Br=[],Lr=new le("AbstractPager");let Dr=0;class Nr{constructor(e={}){this.config=e,this.items$=new tr(Br),this.size$=new Rr(1),this.error$=new Rr(1),this.fetches$=new tr({index:0,length:0}),this.disconnected=!1}get maxSize(){return this.config.maxSize}observeItems(){return this.items$.pipe(kt((e=>e!==Br)))}observeSize(){return this.size$.pipe(rr())}observeError(){return this.error$}disconnect(){this.disconnected||(this.disconnected=!0,this.subscriptions&&(this.subscriptions.unsubscribe(),Lr.log("Pager disconnected. connected pagers="+--Dr)),this.items.forEach((e=>{var t;return null===(t=e.pager)||void 0===t?void 0:t.disconnect()})),this.items$.complete(),this.size$.complete(),this.error$.complete())}fetchAt(e,t=50){if(this.disconnected)Lr.warn("disconnected");else{if(!this.subscriptions&&(this.connect(),this.config.calculatePageSize)){const{minPageSize:e=10,maxPageSize:r=100}=this.config,n=10*Math.ceil(2*t/10);this.config.pageSize=Math.max(Math.min(n,r),e)}this.fetches$.next({index:e,length:t})}}get items(){return this.items$.getValue()}observeComplete(){return kr([this.observeItems(),this.observeSize()]).pipe(kt((([e,t])=>e.reduce((e=>e+1),0)===t)),at((([e])=>e)),ae(1))}connect(){this.subscriptions||(Lr.log("Pager connected. connected pagers="+ ++Dr),this.subscriptions=new p,this.subscriptions.add(this.observeAdditions().pipe(Pr((e=>this.addMissingTrackCounts(e)))).subscribe(Lr)))}observeAdditions(){return this.items$.pipe(n((function(e,t){var r,n=!1;e.subscribe(F(t,(function(e){var i=r;r=e,n&&t.next([i,e]),n=!0})))})),at((([e,t])=>t.filter((t=>!e.find((e=>e.src===t.src)))))))}addMissingTrackCounts(e){e.forEach((e=>{if(e.itemType===Yt.Playlist&&!e.trackCount&&e.pager){const t=e.src;this.subscriptions.add(e.pager.observeSize().pipe(Pr((e=>{const r=this.items.findIndex((e=>e.src===t));if(-1!==r){const t=this.items.slice(),n=t[r];t[r]=Object.assign(Object.assign({},n),{trackCount:e}),this.items$.next(t)}}))).subscribe(Lr))}}))}}const Or=new le("SequentialPager");class zr extends Nr{constructor(e,t){super(t),this.fetchNext=e,this.fetching$=new tr(!1),this.maxEmptyCount=2,this.emptyCount=0}connect(){var e,t;this.subscriptions||(super.connect(),this.subscriptions.add(this.observeShouldFetch().pipe(Pr((()=>this.fetching$.next(!0))),(e=()=>this.fetchNext(this.config.pageSize),r(t)?ot(e,t,1):ot(e,1)),Pr((e=>this.addPage(e))),Mr((e=>(Or.error(e),this.error$.next(e),Lt(void 0)))),Pr((()=>this.fetching$.next(!1))),ne(this.observeComplete()),ae(100)).subscribe(Or)))}observeShouldFetch(){const e=kr([this.fetches$,this.items$]).pipe(at((([{index:e,length:t},r])=>e+2*t>=r.length)),kt((e=>e)),at((()=>{})),ae(1));return this.fetching$.pipe(It((t=>t?ie:e)))}addPage(e){var t;const r=(e.items||[]).filter(Ce),n=function(e,t){return e.filter(((e,t,r)=>t===r.findIndex((t=>e.src===t.src))))}(this.items.concat(r));n.length===this.items.length&&this.emptyCount++,n.length=Math.min(n.length,null!==(t=this.maxSize)&&void 0!==t?t:1/0);const i=e.atEnd||n.length===this.maxSize||this.emptyCount>this.maxEmptyCount?n.length:e.total;void 0!==i&&this.size$.next(i),this.items$.next(n)}}var Fr=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};class Ur{constructor(e,t,r,n){this.nextPageUrl=void 0,this.pager=new zr((n=>Fr(this,void 0,void 0,(function*(){const i=yield this.fetchNext(this.nextPageUrl||e,n?r?Object.assign(Object.assign({},r),{limit:n}):{limit:n}:r),a=t(i.data),s=this.createItems(a.items),o=a.total,l=!a.nextPageUrl;return this.nextPageUrl=a.nextPageUrl,{items:s,total:o,atEnd:l}}))),n)}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetchNext(e,t){return Fr(this,void 0,void 0,(function*(){const r=MusicKit.getInstance();return t&&(e=`${e}${e.includes("?")?"&":"?"}${new URLSearchParams(t)}`),r.api.music(e)}))}createItems(e){return e.map((e=>this.createItem(e)))}createItem(e){switch(e.type){case"playlists":case"library-playlists":return this.createMediaPlaylist(e);case"artists":case"library-artists":return this.createMediaArtist(e);case"albums":case"library-albums":return this.createMediaAlbum(e);case"songs":case"library-songs":case"music-videos":return this.createMediaItem(e)}}createMediaPlaylist(e){var t;const r=this.createFromLibrary(e),{id:n,kind:i}=r.playParams||{id:e.id,kind:"playlist"},a=null===(t=e.href)||void 0===t?void 0:t.startsWith("/v1/me/library/");return{itemType:Yt.Playlist,src:`apple:${i}:${n}`,externalUrl:r.url||(a?`https://music.apple.com/library/playlist/${n}`:""),title:r.name,thumbnails:this.createThumbnails(e),owner:{name:r.curatorName||"",url:""},pager:this.createPager(`${e.href}`,{include:"tracks,catalog","fields[library-playlists]":"playParams,name,artwork,url,tracks"}),unplayable:!r.playParams}}createMediaArtist(e){var t;const r=this.createFromLibrary(e);return{itemType:Yt.Artist,src:`apple:artist:${e.id}`,externalUrl:r.url,title:r.name,thumbnails:this.createThumbnails(e),genre:this.getGenre(r),pager:this.createPager((null===(t=e.relationships)||void 0===t?void 0:t.albums.href)||`/v1/catalog/{{storefrontId}}/artists/${e.id}/albums`)}}createMediaAlbum(e){const t=this.createFromLibrary(e),{id:r,kind:n}=t.playParams||{id:e.id,kind:"album"};return{itemType:Yt.Album,src:`apple:${n}:${r}`,externalUrl:t.url,title:t.name,thumbnails:this.createThumbnails(e),artist:t.artistName,trackCount:t.trackCount,genre:this.getGenre(t),year:new Date(t.releaseDate).getFullYear()||0,pager:this.createPager(e.href,{"include[library-songs]":"catalog","fields[library-songs]":"playParams,name,artistName,albumName,artwork"}),unplayable:!t.playParams}}createMediaItem(e){const t=this.createFromLibrary(e),{id:r,kind:n}=t.playParams||{id:e.id,kind:"music-videos"===e.type?"musicVideo":"song"};return{itemType:Yt.Media,mediaType:"musicVideo"===n?yr.Video:yr.Audio,src:`apple:${n}:${r}`,externalUrl:t.url,title:t.name,thumbnails:this.createThumbnails(e),artist:t.artistName,albumArtist:t.albumName?t.artistName:void 0,album:t.albumName,duration:t.durationInMillis/1e3,genre:this.getGenre(t),disc:t.discNumber,track:t.trackNumber,year:new Date(t.releaseDate).getFullYear()||void 0,isrc:t.isrc,unplayable:!t.playParams,playedAt:0}}createFromLibrary(e){var t,r,n;const i=null===(n=null===(r=null===(t=e.relationships)||void 0===t?void 0:t.catalog)||void 0===r?void 0:r.data)||void 0===n?void 0:n[0];return Object.assign(Object.assign({},null==i?void 0:i.attributes),e.attributes)}createThumbnails(e){var t;const r=null===(t=e.attributes)||void 0===t?void 0:t.artwork;return r?[this.createThumbnail(r,60),this.createThumbnail(r,120),this.createThumbnail(r,240),this.createThumbnail(r,480)]:void 0}createThumbnail(e,t){return{url:MusicKit.formatArtworkURL(e,t,t),width:t,height:t}}createPager(e,t,r){return new Ur(e,(e=>{var t,r,n;const i=(null===(r=null===(t=e.data[0])||void 0===t?void 0:t.relationships)||void 0===r?void 0:r.tracks)||e,a=i.data||[],s=i.next;return{items:a,total:null===(n=i.meta)||void 0===n?void 0:n.total,nextPageUrl:s}}),t,r)}getGenre({genreNames:e=[]}){return e.filter((e=>"Music"!==e)).join(";")||void 0}}console.log("module::apple");const jr={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]};function Vr(e,t="songs",r){return e?new Ur("/v1/catalog/{{storefrontId}}/search",(e=>{var r;const n=e.results[t]||{data:[]},i=n.next,a=null===(r=e.meta)||void 0===r?void 0:r.total;return{items:n.data,total:a,nextPageUrl:i}}),{term:e,types:t},Object.assign({maxSize:250,pageSize:25},r)):new Kt}const qr={id:"apple/video",title:"Music Video",icon:"video",itemType:Yt.Media,searchable:!0,layout:jr,search:({q:e=""}={})=>e?Vr(e,"music-videos",{maxSize:100}):new Kt},Qr={id:"apple/recently-played",title:"Recently Played",icon:"clock",itemType:Yt.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>new Ur("/v1/me/recent/played/tracks",Gr,void 0,{pageSize:30})},Xr={id:"apple/liked-songs",title:"Liked Songs",icon:"heart",itemType:Yt.Media,layout:jr,defaultHidden:!0,search:()=>new Ur("/v1/me/library/songs",Gr,{"include[library-songs]":"catalog","fields[library-songs]":"playParams,name,artistName,albumName,artwork"})},Wr={id:"apple/liked-albums",title:"Liked Albums",icon:"heart",itemType:Yt.Album,search:()=>new Ur("/v1/me/library/albums",Gr,{"include[library-albums]":"catalog","fields[library-albums]":"playParams,name,artistName,artwork"})},$r={id:"apple/playlists",title:"Playlists",icon:"playlists",itemType:Yt.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","Owner","TrackCount"]},search:()=>new Ur("/v1/me/library/playlists",Gr,{"include[library-playlists]":"catalog","fields[library-playlists]":"playParams,name,artwork"})};function Hr(e,t){return Object.assign(Object.assign({},t),{id:`apple/search/${e}`,icon:"",searchable:!0,search:({q:t=""}={})=>Vr(t,e)})}function Gr(e){var t;const r=e.data,n=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:n}}const Yr={id:"apple",title:"Apple Music",icon:"apple",url:"https://music.apple.com/",roots:[Hr("songs",{title:"Songs",itemType:Yt.Media,layout:jr}),Hr("albums",{title:"Albums",itemType:Yt.Album}),Hr("artists",{title:"Artists",itemType:Yt.Artist}),Hr("playlists",{title:"Playlists",itemType:Yt.Playlist})],sources:[qr,Qr,Xr,Wr,$r],observeIsLoggedIn:Ar,login:function(){return mr(this,void 0,void 0,(function*(){if(""===gr.getValue())try{const e=yield vr(),t=yield e.authorize();pr.log("Access token successfully obtained."),gr.next(t)}catch(e){pr.log("Could not obtain access token."),pr.error(e)}}))},logout:function(){return mr(this,void 0,void 0,(function*(){yield MusicKit.getInstance().unauthorize(),gr.next("")}))}};var Kr;!function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"}(Kr||(Kr={}));const Jr=new le("OffsetPager");class Zr extends Nr{constructor(e,t){super(t),this.fetch=e,this.fetchStates={},this.size=0}connect(){this.subscriptions||(super.connect(),this.subscriptions.add(this.fetches$.pipe(kt((({index:e})=>this.isInRange(e))),at((({index:e,length:t})=>this.getPageNumbersFromIndex(e,t))),ot((e=>e)),ot((e=>this.fetchPage(e))),Mr((e=>(Jr.error(e),this.error$.next(e),Lt(void 0)))),ne(this.observeComplete())).subscribe(Jr)))}get pageSize(){return this.config.pageSize||20}fetchPage(e){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){if(this.fetchStates[e]!==Kr.Fulfilled&&this.fetchStates[e]!==Kr.Pending){this.fetchStates[e]=Kr.Pending;try{const t=yield this.fetch(e,this.pageSize);this.fetchStates[e]=Kr.Fulfilled,this.insertPage(e,t)}catch(t){throw this.fetchStates[e]=Kr.Rejected,t}}}))}insertPage(e,t){var r;const n=this.items.slice(),i=Math.min(t.total,null!==(r=this.maxSize)&&void 0!==r?r:1/0),a=Math.ceil(i/this.pageSize),s=(e-1)*this.pageSize,o=e===a;if(n.length=o||t.items.length<this.pageSize?s:i,t.items.forEach(((e,t)=>n[t+s]=e)),n.length=Math.min(n.length,i),t.items.length===i)for(let e=0;e<=a;e++)this.fetchStates[e+1]=Kr.Fulfilled;this.size=i,this.size$.next(i),this.items$.next(n)}getPageNumbersFromIndex(e,t){const r=this.size,n=Math.max(Math.ceil(this.pageSize/2),t),i=Math.max(e-n,0),a=Math.min(e+n+t-1,0===r?1/0:r-1),s=this.getPageNumberFromIndex(i),o=this.getPageNumberFromIndex(a);if(s===o)return[s];{const e=[];for(let t=s;t<=o;t++)e.push(t);return e}}getPageNumberFromIndex(e){return Math.floor(e/this.pageSize)+1}isInRange(e){return 0===this.size?e>=0:e>=0&&e<this.size}}let en=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");const tn=new fe("jellyfin"),rn={get host(){return tn.getString("host")},set host(e){tn.setString("host",e)},get device(){return"PC"},get deviceId(){let e=tn.getString("deviceId");return e||(e=en(),tn.setString("deviceId",e)),e},get token(){return tn.getString("token")},set token(e){tn.setString("token",e)},get userId(){return tn.getString("userId")},set userId(e){tn.setString("userId",e)},clear(){tn.removeItem("userId"),tn.removeItem("token")}};var nn=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function an(e,t){return nn(this,void 0,void 0,(function*(){const{device:r,deviceId:n,token:i}=rn;return t.headers=Object.assign(Object.assign({},t.headers),{"X-Emby-Authorization":`MediaBrowser Client="ampcast", Version="0.5.4", Device="${r}", DeviceId="${n}", Token="${i}"`}),window.fetch(`${rn.host}/${e}`,t)}))}console.log("module::jellyfinApi");const sn={get:function(e,t){return nn(this,void 0,void 0,(function*(){return an(`${e}?${new URLSearchParams(t)}`,{method:"GET"})}))},post:function(e,t){return nn(this,void 0,void 0,(function*(){const r=JSON.stringify(t);return an(e,{method:"POST",headers:{"Content-Type":"application/json"},body:r})}))},getPlayableUrlFromSrc:function(e){const{host:t,userId:r,token:n,deviceId:i}=rn;if(t&&r&&n&&i){const[,,a]=e.split(":");return`${t}/Audio/${a}/universal?${new URLSearchParams({MaxStreamingBitrate:"140000000",MaxSampleRate:"48000",TranscodingProtocol:"hls",TranscodingContainer:"ts",Container:"opus,webm|opus,mp3,aac,m4a|aac,m4b|aac,flac,webma,webm|webma,wav,ogg",AudioCodec:"aac",static:"true",UserId:r,api_key:n,DeviceId:i})}`}throw Error("Not logged in.")}},on=sn;class ln{constructor(e,t={}){this.path=e,this.params=t,this.pageSize=ln.minPageSize,this.pager=new Zr((e=>this.fetch(e)),{pageSize:this.pageSize})}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetch(e){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({IncludeItemTypes:"Audio",Fields:"AudioInfo,Genres",Recursive:"true",ImageTypeLimit:"1",EnableImageTypes:"Primary"},this.params),{Limit:String(this.pageSize),StartIndex:String((e-1)*this.pageSize)}),r=yield on.get(this.path,t);if(!r.ok)throw Error(`${r.status}: ${r.statusText}`);const{Items:n,TotalRecordCount:i}=yield r.json();return{items:n.map((e=>this.createItem(e))),total:i}}))}createItem(e){switch(e.Type){case"MusicArtist":return this.createMediaArtist(e);case"MusicAlbum":return this.createMediaAlbum(e);case"Playlist":return this.createMediaPlaylist(e);default:return this.createMediaItemFromTrack(e)}}createMediaArtist(e){var t;return{itemType:Yt.Artist,src:`jellyfin:album:${e.Id}`,title:e.Name||"",genre:null===(t=e.Genres)||void 0===t?void 0:t.join(";"),thumbnails:this.createThumbnails(e.Id),pager:this.createAlbumsPager(e)}}createMediaAlbum(e){var t,r,n;return{itemType:Yt.Album,src:`jellyfin:album:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,playedAt:(null===(t=e.UserData)||void 0===t?void 0:t.LastPlayedDate)?Math.floor(new Date(e.UserData.LastPlayedDate).getTime()/1e3):void 0,playCount:(null===(r=e.UserData)||void 0===r?void 0:r.PlayCount)||void 0,genre:null===(n=e.Genres)||void 0===n?void 0:n.join(";"),thumbnails:this.createThumbnails(e.Id),trackCount:e.ChildCount||void 0,pager:this.createAlbumPager(e),artist:e.AlbumArtist||void 0,year:e.ProductionYear||void 0}}createMediaPlaylist(e){var t,r,n;return{itemType:Yt.Playlist,src:`jellyfin:playlist:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,playedAt:(null===(t=e.UserData)||void 0===t?void 0:t.LastPlayedDate)?Math.floor(new Date(e.UserData.LastPlayedDate).getTime()/1e3):void 0,playCount:(null===(r=e.UserData)||void 0===r?void 0:r.PlayCount)||void 0,genre:null===(n=e.Genres)||void 0===n?void 0:n.join(";"),thumbnails:this.createThumbnails(e.Id),trackCount:e.ChildCount||void 0,pager:this.createPlaylistPager(e)}}createMediaItemFromTrack(e){var t,r,n,i,a;const s=(null===(t=e.ImageTags)||void 0===t?void 0:t.Primary)?e.Id:e.AlbumId;return{itemType:Yt.Media,mediaType:yr.Audio,src:`jellyfin:audio:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,year:e.ProductionYear||void 0,playedAt:(null===(r=e.UserData)||void 0===r?void 0:r.LastPlayedDate)?Math.floor(new Date(e.UserData.LastPlayedDate).getTime()/1e3):0,playCount:(null===(n=e.UserData)||void 0===n?void 0:n.PlayCount)||void 0,genre:null===(i=e.Genres)||void 0===i?void 0:i.join(";"),thumbnails:this.createThumbnails(s),artist:(null===(a=e.Artists)||void 0===a?void 0:a.join("/"))||e.AlbumArtist||void 0,albumArtist:e.AlbumArtist||void 0,album:e.Album||void 0,track:e.Album&&e.IndexNumber||0}}createThumbnails(e){return e?[this.createThumbnail(e,60),this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t,r=t){return{url:`${rn.host}/Items/${e}/Images/Primary?fillWidth=${t}&fillHeight=${r}`,width:t,height:r}}createAlbumPager(e){return new ln(`Users/${rn.userId}/Items`,{ParentId:e.Id,SortBy:"SortName",SortOrder:"Ascending"})}createAlbumsPager(e){return new ln(`Users/${rn.userId}/Items`,{AlbumArtistIds:e.Id,IncludeItemTypes:"MusicAlbum",SortOrder:"Descending"})}createPlaylistPager(e){return new ln(`Playlists/${e.Id}/Items`,{UserId:rn.userId,MediaType:"Audio",Fields:"ChildCount"})}}ln.minPageSize=100,ln.maxPageSize=1e3;const cn=(0,e.forwardRef)((function(t,r){var{onKeyDown:n}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["onKeyDown"]);const a=(0,e.useCallback)((e=>{" "===e.key&&e.stopPropagation(),null==n||n(e)}),[n]);return e.createElement("button",Object.assign({},i,{onKeyDown:a,ref:r}))}));function un({name:t,className:r=""}){switch(r=`icon icon-${t} ${r}`,t){case"ampcast":return e.createElement("svg",{className:r,viewBox:"0 0 24 24"},e.createElement("circle",{cx:"12",cy:"12",r:"8",strokeWidth:"4",stroke:"orange",fill:"black"}),e.createElement("circle",{cx:"12",cy:"12",r:"2",strokeWidth:"none",fill:"white"}));case"play":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"}));case"pause":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"}));case"stop":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"}));case"volume":return e.createElement("svg",{className:r,viewBox:"0 0 16 16"},e.createElement("path",{className:"high medium",d:"M11.536 14.01A8.473 8.473 0 0 0 14.026 8a8.473 8.473 0 0 0-2.49-6.01l-.708.707A7.476 7.476 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303l.708.707z"}),e.createElement("path",{className:"medium",d:"M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z"}),e.createElement("path",{d:"M8.707 11.182A4.486 4.486 0 0 0 10.025 8a4.486 4.486 0 0 0-1.318-3.182L8 5.525A3.489 3.489 0 0 1 9.025 8 3.49 3.49 0 0 1 8 10.475l.707.707zM6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06z"}));case"muted":return e.createElement("svg",{className:r,viewBox:"0 0 16 16"},e.createElement("path",{d:"M6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06zm7.137 2.096a.5.5 0 0 1 0 .708L12.207 8l1.647 1.646a.5.5 0 0 1-.708.708L11.5 8.707l-1.646 1.647a.5.5 0 0 1-.708-.708L10.793 8 9.146 6.354a.5.5 0 1 1 .708-.708L11.5 7.293l1.646-1.647a.5.5 0 0 1 .708 0z"}));case"prev":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"}));case"next":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"}));case"info":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}));case"settings":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}));case"locked":return e.createElement("svg",{className:r,viewBox:"0 0 448 512",transform:"scale(0.95)"},e.createElement("path",{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"}));case"unlocked":return e.createElement("svg",{className:r,viewBox:"0 0 576 512",transform:"scale(0.95)"},e.createElement("path",{d:"M423.5 0C339.5.3 272 69.5 272 153.5V224H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48h-48v-71.1c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v80c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-80C576 68 507.5-.3 423.5 0z"}));case"left":return e.createElement("svg",{className:r,viewBox:"0 0 320 512"},e.createElement("path",{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}));case"right":return e.createElement("svg",{className:r,viewBox:"0 0 320 512"},e.createElement("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}));case"saved":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}));case"unsaved":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM272 80v80H144V80h128zm122 352H54a6 6 0 0 1-6-6V86a6 6 0 0 1 6-6h42v104c0 13.255 10.745 24 24 24h176c13.255 0 24-10.745 24-24V83.882l78.243 78.243a6 6 0 0 1 1.757 4.243V426a6 6 0 0 1-6 6zM224 232c-48.523 0-88 39.477-88 88s39.477 88 88 88 88-39.477 88-88-39.477-88-88-88zm0 128c-22.056 0-40-17.944-40-40s17.944-40 40-40 40 17.944 40 40-17.944 40-40 40z"}));case"close":return e.createElement("svg",{className:r,viewBox:"0 0 64 64"},e.createElement("path",{d:"M 10.5,-0.5 C 12.1667,-0.5 13.8333,-0.5 15.5,-0.5C 20.7971,5.29805 26.2971,10.9647 32,16.5C 37.0314,10.303 42.5314,4.63636 48.5,-0.5C 49.8333,-0.5 51.1667,-0.5 52.5,-0.5C 55.8333,3.5 59.5,7.16667 63.5,10.5C 63.5,11.8333 63.5,13.1667 63.5,14.5C 57.7019,19.7971 52.0353,25.2971 46.5,31C 52.0353,36.7029 57.7019,42.2029 63.5,47.5C 63.5,49.1667 63.5,50.8333 63.5,52.5C 59.5,55.8333 55.8333,59.5 52.5,63.5C 50.8333,63.5 49.1667,63.5 47.5,63.5C 42.1604,57.8275 36.8271,52.1608 31.5,46.5C 25.479,51.8543 19.8123,57.521 14.5,63.5C 13.1667,63.5 11.8333,63.5 10.5,63.5C 7.16667,59.5 3.5,55.8333 -0.5,52.5C -0.5,50.8333 -0.5,49.1667 -0.5,47.5C 5.17254,42.1604 10.8392,36.8271 16.5,31.5C 10.8392,26.1729 5.17254,20.8396 -0.5,15.5C -0.5,13.8333 -0.5,12.1667 -0.5,10.5C 3.5,7.16667 7.16667,3.5 10.5,-0.5 Z"}));case"audio":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.941 97.941l-83.882-83.882A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zM332.118 128H256V51.882L332.118 128zM48 464V48h160v104c0 13.255 10.745 24 24 24h104v288H48zm144-76.024c0 10.691-12.926 16.045-20.485 8.485L136 360.486h-28c-6.627 0-12-5.373-12-12v-56c0-6.627 5.373-12 12-12h28l35.515-36.947c7.56-7.56 20.485-2.206 20.485 8.485v135.952zm41.201-47.13c9.051-9.297 9.06-24.133.001-33.439-22.149-22.752 12.235-56.246 34.395-33.481 27.198 27.94 27.212 72.444.001 100.401-21.793 22.386-56.947-10.315-34.397-33.481z"}));case"video":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.941 97.941l-83.882-83.882A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zM332.118 128H256V51.882L332.118 128zM48 464V48h160v104c0 13.255 10.745 24 24 24h104v288H48zm228.687-211.303L224 305.374V268c0-11.046-8.954-20-20-20H100c-11.046 0-20 8.954-20 20v104c0 11.046 8.954 20 20 20h104c11.046 0 20-8.954 20-20v-37.374l52.687 52.674C286.704 397.318 304 390.28 304 375.986V264.011c0-14.311-17.309-21.319-27.313-11.314z"}));case"note":return e.createElement("svg",{className:r,viewBox:"0 0 24 24",transform:"scale(1.25)"},e.createElement("path",{stroke:"none",d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"}));case"star":return e.createElement("svg",{className:r,viewBox:"0 0 576 512"},e.createElement("path",{d:"M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z"}));case"heart":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M458.4 64.3C400.6 15.7 311.3 23 256 79.3 200.7 23 111.4 15.6 53.6 64.3-21.6 127.6-10.6 230.8 43 285.5l175.4 178.7c10 10.2 23.4 15.9 37.6 15.9 14.3 0 27.6-5.6 37.6-15.8L469 285.6c53.5-54.7 64.7-157.9-10.6-221.3zm-23.6 187.5L259.4 430.5c-2.4 2.4-4.4 2.4-6.8 0L77.2 251.8c-36.5-37.2-43.9-107.6 7.3-150.7 38.9-32.7 98.9-27.8 136.5 10.5l35 35.7 35-35.7c37.8-38.5 97.8-43.2 136.5-10.6 51.1 43.1 43.5 113.9 7.3 150.8z"}));case"thumbs-up":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M466.27 286.69C475.04 271.84 480 256 480 236.85c0-44.015-37.218-85.58-85.82-85.58H357.7c4.92-12.81 8.85-28.13 8.85-46.54C366.55 31.936 328.86 0 271.28 0c-61.607 0-58.093 94.933-71.76 108.6-22.747 22.747-49.615 66.447-68.76 83.4H32c-17.673 0-32 14.327-32 32v240c0 17.673 14.327 32 32 32h64c14.893 0 27.408-10.174 30.978-23.95 44.509 1.001 75.06 39.94 177.802 39.94 7.22 0 15.22.01 22.22.01 77.117 0 111.986-39.423 112.94-95.33 13.319-18.425 20.299-43.122 17.34-66.99 9.854-18.452 13.664-40.343 8.99-62.99zm-61.75 53.83c12.56 21.13 1.26 49.41-13.94 57.57 7.7 48.78-17.608 65.9-53.12 65.9h-37.82c-71.639 0-118.029-37.82-171.64-37.82V240h10.92c28.36 0 67.98-70.89 94.54-97.46 28.36-28.36 18.91-75.63 37.82-94.54 47.27 0 47.27 32.98 47.27 56.73 0 39.17-28.36 56.72-28.36 94.54h103.99c21.11 0 37.73 18.91 37.82 37.82.09 18.9-12.82 37.81-22.27 37.81 13.489 14.555 16.371 45.236-5.21 65.62zM88 432c0 13.255-10.745 24-24 24s-24-10.745-24-24 10.745-24 24-24 24 10.745 24 24z"}));case"person":return e.createElement("svg",{className:r,viewBox:"0 0 16 16"},e.createElement("path",{stroke:"none",d:"M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"}));case"most-played":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"}),e.createElement("polygon",{points:"130,250 270,325 130,400",stroke:"none"}));case"clock":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"}));case"recently-added":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"}),e.createElement("rect",{x:"177",y:"220",width:"40",height:"210",strokeWidth:"20",strokeLinejoin:"round"}),e.createElement("rect",{x:"87",y:"310",width:"210",height:"40",strokeWidth:"20",strokeLinejoin:"round"}));case"playlists":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M88 48C101.3 48 112 58.75 112 72V120C112 133.3 101.3 144 88 144H40C26.75 144 16 133.3 16 120V72C16 58.75 26.75 48 40 48H88zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 232C16 218.7 26.75 208 40 208H88C101.3 208 112 218.7 112 232V280C112 293.3 101.3 304 88 304H40C26.75 304 16 293.3 16 280V232zM88 368C101.3 368 112 378.7 112 392V440C112 453.3 101.3 464 88 464H40C26.75 464 16 453.3 16 440V392C16 378.7 26.75 368 40 368H88z"}));case"file":case"blob":return e.createElement("svg",{className:r,viewBox:"0 0 448 512",transform:"scale(0.875)"},e.createElement("path",{fill:"#00cccc",d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"}));case"apple":return e.createElement("svg",{className:r,viewBox:"0 0 24 24",transform:"scale(1.1) translate(0,-1)"},e.createElement("path",{fillRule:"nonzero",d:"M11.624 7.222c-.876 0-2.232-.996-3.66-.96-1.884.024-3.612 1.092-4.584 2.784-1.956 3.396-.504 8.412 1.404 11.172.936 1.344 2.04 2.856 3.504 2.808 1.404-.06 1.932-.912 3.636-.912 1.692 0 2.172.912 3.66.876 1.512-.024 2.472-1.368 3.396-2.724 1.068-1.56 1.512-3.072 1.536-3.156-.036-.012-2.94-1.128-2.976-4.488-.024-2.808 2.292-4.152 2.4-4.212-1.32-1.932-3.348-2.148-4.056-2.196-1.848-.144-3.396 1.008-4.26 1.008zm3.12-2.832c.78-.936 1.296-2.244 1.152-3.54-1.116.048-2.46.744-3.264 1.68-.72.828-1.344 2.16-1.176 3.432 1.236.096 2.508-.636 3.288-1.572z"}));case"plex":return e.createElement("svg",{className:r,viewBox:"0 0 122.88 122.88"},e.createElement("path",{className:"icon-plex-outer",d:"M18.43,0h86.02c10.18,0,18.43,8.25,18.43,18.43v86.02c0,10.18-8.25,18.43-18.43,18.43H18.43 C8.25,122.88,0,114.63,0,104.45l0-86.02C0,8.25,8.25,0,18.43,0L18.43,0z"}),e.createElement("polygon",{className:"icon-plex-inner",points:"61.44,16.8 35.52,16.8 61.44,61.44 35.52,106.08 61.44,106.08 87.36,61.44 61.44,16.8"}));case"jellyfin":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("defs",null,e.createElement("linearGradient",{id:"jellyfin-linear-gradient",gradientUnits:"userSpaceOnUse",x1:"110.25",y1:"213.3",x2:"496.14",y2:"436.09"},e.createElement("stop",{offset:"0",style:{stopColor:"#aa5cc3"}}),e.createElement("stop",{offset:"1",style:{stopColor:"#00a4dc"}}))),e.createElement("path",{d:"M256,201.6c-20.4,0-86.2,119.3-76.2,139.4s142.5,19.9,152.4,0S276.5,201.6,256,201.6z"}),e.createElement("path",{d:"M256,23.3c-61.6,0-259.8,359.4-229.6,420.1s429.3,60,459.2,0S317.6,23.3,256,23.3z M406.5,390.8c-19.6,39.3-281.1,39.8-300.9,0s110.1-275.3,150.4-275.3S426.1,351.4,406.5,390.8z"}));case"spotify":return e.createElement("svg",{className:r,viewBox:"0 0 168 168"},e.createElement("path",{stroke:"none",d:"m83.996 0.277c-46.249 0-83.743 37.493-83.743 83.742 0 46.251 37.494 83.741 83.743 83.741 46.254 0 83.744-37.49 83.744-83.741 0-46.246-37.49-83.738-83.745-83.738l0.001-0.004zm38.404 120.78c-1.5 2.46-4.72 3.24-7.18 1.73-19.662-12.01-44.414-14.73-73.564-8.07-2.809 0.64-5.609-1.12-6.249-3.93-0.643-2.81 1.11-5.61 3.926-6.25 31.9-7.291 59.263-4.15 81.337 9.34 2.46 1.51 3.24 4.72 1.73 7.18zm10.25-22.805c-1.89 3.075-5.91 4.045-8.98 2.155-22.51-13.839-56.823-17.846-83.448-9.764-3.453 1.043-7.1-0.903-8.148-4.35-1.04-3.453 0.907-7.093 4.354-8.143 30.413-9.228 68.222-4.758 94.072 11.127 3.07 1.89 4.04 5.91 2.15 8.976v-0.001zm0.88-23.744c-26.99-16.031-71.52-17.505-97.289-9.684-4.138 1.255-8.514-1.081-9.768-5.219-1.254-4.14 1.08-8.513 5.221-9.771 29.581-8.98 78.756-7.245 109.83 11.202 3.73 2.209 4.95 7.016 2.74 10.733-2.2 3.722-7.02 4.949-10.73 2.739z"}));case"lastfm":return e.createElement("svg",{className:r,viewBox:"0 0 455 455"},e.createElement("rect",{className:"icon-lastfm-inner",x:"5",y:"5",width:"445",height:"445"}),e.createElement("path",{className:"icon-lastfm-outer",fillRule:"evenodd",clipRule:"evenodd",d:"M0,0v455h455V0H0z M309.94,315.01c-62.425,0-84.085-28.145-95.625-63.145 L202.77,215.77c-8.65-26.33-18.75-46.915-50.505-46.915c-22.035,0-44.395,15.88-44.395,60.275c0,34.63,17.695,56.29,42.575,56.29 c28.145,0,46.915-20.94,46.915-20.94l11.565,31.385c0,0-19.495,19.125-60.275,19.125c-50.51,0-78.65-29.57-78.65-84.435 c0-56.99,28.14-90.565,81.19-90.565c47.99,0,72.165,17.325,87.305,64.235L250.41,240.3c8.65,26.35,23.805,45.47,60.25,45.47 c24.555,0,37.52-5.41,37.52-18.77c0-10.45-6.13-18.025-24.53-22.365l-24.53-5.76c-29.94-7.225-41.855-22.735-41.855-47.265 c0-39.335,31.755-51.6,64.215-51.6c36.82,0,59.18,13.34,62.07,45.82l-36.07,4.335c-1.445-15.53-10.82-22.015-28.145-22.015 c-15.88,0-25.625,7.21-25.625,19.475c0,10.84,4.685,17.325,20.565,20.94l23.085,5.055c31.035,7.21,47.64,22.365,47.64,51.585 C385,301.295,354.685,315.01,309.94,315.01z"}));case"listenbrainz":case"musicbrainz":return e.createElement("svg",{className:r,viewBox:"0 0 27 30"},e.createElement("polygon",{className:`icon-${t}-left`,stroke:"none",points:"13 1 1 8 1 22 13 29 13 1"}),e.createElement("polygon",{className:`icon-${t}-right`,stroke:"none",points:"14 1 26 8 26 22 14 29 14 1"}));case"youtube":return e.createElement("svg",{className:r,viewBox:"0 0 576 512",transform:"scale(1.125)"},e.createElement("rect",{className:"icon-youtube-inner",x:"144",y:"128",width:"288",height:"256"}),e.createElement("path",{className:"icon-youtube-outer",d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"}))}}var hn=window.CustomEvent;function dn(e,t){var r="on"+t.type.toLowerCase();return"function"==typeof e[r]&&e[r](t),e.dispatchEvent(t)}function fn(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement?e.parentElement:e.parentNode?e.parentNode.host:null}return null}function mn(e){for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;e&&e.blur&&e!==document.body&&e.blur()}function pn(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1}function gn(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function An(e){var t=["button","input","keygen","select","textarea"].map((function(e){return e+":not([disabled])"}));t.push('[tabindex]:not([disabled]):not([tabindex=""])');var r=e.querySelector(t.join(", "));if(!r&&"attachShadow"in Element.prototype)for(var n=e.querySelectorAll("*"),i=0;i<n.length&&!(n[i].tagName&&n[i].shadowRoot&&(r=An(n[i].shadowRoot)));i++);return r}function vn(e){return e.isConnected||document.body.contains(e)}function bn(e){if(e.submitter)return e.submitter;var t=e.target;if(!(t instanceof HTMLFormElement))return null;var r=_n.formSubmitter;if(!r){var n=e.target;r=("getRootNode"in n&&n.getRootNode()||document).activeElement}return r&&r.form===t?r:null}function yn(e){if(!e.defaultPrevented){var t=e.target,r=_n.imagemapUseValue,n=bn(e);null===r&&n&&(r=n.value);var i=fn(t);i&&"dialog"===(n&&n.getAttribute("formmethod")||t.getAttribute("method"))&&(e.preventDefault(),null!=r?i.close(r):i.close())}}function wn(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),e.addEventListener("submit",yn,!1),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window)new MutationObserver(this.maybeHideModal.bind(this)).observe(e,{attributes:!0,attributeFilter:["open"]});else{var t,r=!1,n=function(){r?this.downgradeModal():this.maybeHideModal(),r=!1}.bind(this),i=function(i){if(i.target===e){var a="DOMNodeRemoved";r|=i.type.substr(0,a.length)===a,window.clearTimeout(t),t=window.setTimeout(n,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach((function(t){e.addEventListener(t,i)}))}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}hn&&"object"!=typeof hn||(hn=function(e,t){t=t||{};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail||null),r},hn.prototype=window.Event.prototype),wn.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&vn(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),_n.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var t=document.createElement("div");this.dialog_.insertBefore(t,this.dialog_.firstChild),t.tabIndex=-1,t.focus(),this.dialog_.removeChild(t)}var r=document.createEvent("MouseEvents");r.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(r),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),e||(e=An(this.dialog_)),mn(document.activeElement),e&&e.focus()},updateZIndex:function(e,t){if(e<t)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=t},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!vn(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!_n.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var t=window.getComputedStyle(e),r=function(e,r){return!(void 0===t[e]||t[e]===r)};if(t.opacity<1||r("zIndex","auto")||r("transform","none")||r("mixBlendMode","normal")||r("filter","none")||r("perspective","none")||"isolate"===t.isolation||"fixed"===t.position||"touch"===t.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,_n.needsCentering(this.dialog_)?(_n.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(e){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==e&&(this.dialog_.returnValue=e);var t=new hn("close",{bubbles:!1,cancelable:!1});dn(this.dialog_,t)}};var _n={reposition:function(e){var t=document.body.scrollTop||document.documentElement.scrollTop,r=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,r)+"px"},isInlinePositionSetByStylesheet:function(e){for(var t=0;t<document.styleSheets.length;++t){var r=document.styleSheets[t],n=null;try{n=r.cssRules}catch(e){}if(n)for(var i=0;i<n.length;++i){var a=n[i],s=null;try{s=document.querySelectorAll(a.selectorText)}catch(e){}if(s&&pn(s,e)){var o=a.style.getPropertyValue("top"),l=a.style.getPropertyValue("bottom");if(o&&"auto"!==o||l&&"auto"!==l)return!0}}}return!1},needsCentering:function(e){return!("absolute"!==window.getComputedStyle(e).position||"auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom||_n.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new wn(e)},registerDialog:function(e){e.showModal||_n.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(t){this.forwardTab_=void 0,t.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver((function(t){var r=[];t.forEach((function(e){for(var t,n=0;t=e.removedNodes[n];++n)t instanceof Element&&("dialog"===t.localName&&r.push(t),r=r.concat(t.querySelectorAll("dialog")))})),r.length&&e(r)})))}};if(_n.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},_n.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},_n.DialogManager.prototype.updateStacking=function(){for(var e,t=this.zIndexHigh_,r=0;e=this.pendingDialogStack[r];++r)e.updateZIndex(--t,--t),0===r&&(this.overlay.style.zIndex=--t);var n=this.pendingDialogStack[0];n?(n.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},_n.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=fn(e);){for(var t,r=0;t=this.pendingDialogStack[r];++r)if(t.dialog===e)return 0===r;e=e.parentElement}return!1},_n.DialogManager.prototype.handleFocus_=function(e){var t=e.composedPath?e.composedPath()[0]:e.target;if(!this.containedByTopDialog_(t)&&document.activeElement!==document.documentElement&&(e.preventDefault(),e.stopPropagation(),mn(t),void 0!==this.forwardTab_)){var r=this.pendingDialogStack[0];return r.dialog.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?r.focus_():t!==document.documentElement&&document.documentElement.focus()),!1}},_n.DialogManager.prototype.handleKey_=function(e){if(this.forwardTab_=void 0,27===e.keyCode){e.preventDefault(),e.stopPropagation();var t=new hn("cancel",{bubbles:!1,cancelable:!0}),r=this.pendingDialogStack[0];r&&dn(r.dialog,t)&&r.dialog.close()}else 9===e.keyCode&&(this.forwardTab_=!e.shiftKey)},_n.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach((function(t){-1!==e.indexOf(t.dialog)?t.downgradeModal():t.maybeHideModal()}))},_n.DialogManager.prototype.pushDialog=function(e){var t=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=t||(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),0))},_n.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);-1!==t&&(this.pendingDialogStack.splice(t,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},_n.dm=new _n.DialogManager,_n.formSubmitter=null,_n.imagemapUseValue=null,void 0===window.HTMLDialogElement){var En=document.createElement("form");if(En.setAttribute("method","dialog"),"dialog"!==En.method){var xn=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(xn){var Sn=xn.get;xn.get=function(){return gn(this)?"dialog":Sn.call(this)};var Tn=xn.set;xn.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):Tn.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",xn)}}document.addEventListener("click",(function(e){if(_n.formSubmitter=null,_n.imagemapUseValue=null,!e.defaultPrevented){var t=e.target;if("composedPath"in e&&(t=e.composedPath().shift()||t),t&&gn(t.form)){if(!("submit"===t.type&&["button","input"].indexOf(t.localName)>-1)){if("input"!==t.localName||"image"!==t.type)return;_n.imagemapUseValue=e.offsetX+","+e.offsetY}fn(t)&&(_n.formSubmitter=t)}}}),!1),document.addEventListener("submit",(function(e){var t=e.target;if(!fn(t)){var r=bn(e);"dialog"===(r&&r.getAttribute("formmethod")||t.getAttribute("method"))&&e.preventDefault()}}));var kn=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!gn(this))return kn.call(this);var e=fn(this);e&&e.close()}}const In=_n;const Cn={left:0,top:0},Pn=(0,e.forwardRef)((function(t,r){var{title:n,className:i="",children:a,onClose:s}=t,o=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["title","className","children","onClose"]);const l=(0,e.useRef)(null),[c,u]=(0,e.useState)(Cn),[h,d]=(0,e.useState)(null),[f,m]=(0,e.useState)(Cn);(0,e.useImperativeHandle)(r,(()=>({close:e=>{l.current.open&&l.current.close(e)}}))),(0,e.useEffect)((()=>{const e=l.current;In.registerDialog(e),e.showModal()}),[]);const p=(0,e.useCallback)((()=>{l.current.close()}),[]),g=(0,e.useCallback)((()=>{s(l.current.returnValue)}),[s]),A=(0,e.useCallback)((e=>{let t=e.target;for(;t&&"submit"!==t.type;)t=t.parentElement;"#cancel"===(null==t?void 0:t.value)&&(e.preventDefault(),l.current.close())}),[]),v=(0,e.useCallback)((e=>{e.preventDefault(),0===e.button&&d({left:e.screenX,top:e.screenY})}),[]),b=(0,e.useCallback)((e=>{m({left:e.screenX-h.left,top:e.screenY-h.top})}),[h]),y=(0,e.useCallback)((e=>{u({left:c.left+(e.screenX-h.left),top:c.top+(e.screenY-h.top)}),m(Cn),d(null)}),[c,h]);return(0,e.useEffect)((()=>{if(h)return document.documentElement.style.cursor="default",document.body.classList.add("dragging"),document.addEventListener("mouseup",y),document.addEventListener("mousemove",b),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",y),document.removeEventListener("mousemove",b)}}),[h,b,y]),e.createElement("dialog",Object.assign({},o,{className:`dialog ${i}`,onClose:g,style:{transform:`translate(${c.left+f.left}px, ${c.top+f.top}px)`},ref:l}),e.createElement("header",{className:"dialog-head",onMouseDown:v},e.createElement("h2",null,n),e.createElement(cn,{onClick:p,onMouseDown:ze},e.createElement(un,{name:"close"}))),e.createElement("div",{className:"dialog-body",onClick:A},a))}));const Mn=document.getElementById("popup"),Rn=document.getElementById("system");function Bn(r,n=!1){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){return new Promise(((i,a)=>{const s=document.createElement("div"),o=(0,t.s)(s);try{const t=e=>{o.unmount(),s.remove(),i(e)};(n?Rn:Mn).append(s),o.render(e.createElement(r,{onClose:t}))}catch(e){o.unmount(),s.remove(),a(e)}}))}))}const Ln=(0,e.forwardRef)((function(t,r){var{onKeyDown:n}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["onKeyDown"]);const a=(0,e.useCallback)((e=>{" "===e.key&&e.stopPropagation(),null==n||n(e)}),[n]);return e.createElement("input",Object.assign({},i,{onKeyDown:a,ref:r}))}));var Dn=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function Nn(t){const r=(0,e.useRef)(null),n=(0,e.useRef)(null),i=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useRef)(null),o=(0,e.useCallback)((()=>Dn(this,void 0,void 0,(function*(){try{const e=i.current.value,t=a.current.value;rn.host=n.current.value.replace(/\/+$/,"");const{device:s,deviceId:o}=rn,l=`MediaBrowser Client="ampcast", Version="0.5.4", Device="${s}", DeviceId="${o}"`,c=yield fetch(`${rn.host}/Users/AuthenticateByName`,{method:"POST",headers:{"Content-Type":"application/json","X-Emby-Authorization":l},body:JSON.stringify({Username:e,Pw:t})});if(!c.ok)throw Error(`${c.status}: ${c.statusText}`);const u=yield c.json(),h=u.User.Id,d=u.AccessToken;r.current.close(JSON.stringify({userId:h,token:d}))}catch(e){console.error(e)}}))),[]),l=(0,e.useCallback)((e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.repeat||s.current.click())}),[]),c=(0,e.useCallback)((e=>{e.preventDefault(),o()}),[o]);return e.createElement(Pn,Object.assign({},t,{className:"jellyfin-login-dialog",title:"Login to Jellyfin",ref:r}),e.createElement("form",{method:"dialog",onKeyDown:l,onSubmit:c},e.createElement("div",{className:"table-layout"},e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-host"},"Host:"),e.createElement(Ln,{type:"url",id:"jellyfin-host",defaultValue:rn.host,placeholder:"https://",ref:n,required:!0})),e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-username"},"User:"),e.createElement(Ln,{type:"text",id:"jellyfin-username",autoFocus:!0,ref:i,required:!0})),e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-password"},"Password:"),e.createElement(Ln,{type:"password",id:"jellyfin-password",ref:a,required:!0}))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel"},"Cancel"),e.createElement(cn,{ref:s},"Login"))))}var On=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::jellyfinAuth");const zn=new le("jellyfinAuth"),Fn=new tr("");function Un(){return Fn.pipe(rr()).pipe(at((e=>""!==e)),rr())}function jn(e){rn.token=e,e&&zn.log("Access token successfully obtained."),Fn.next(e)}function Vn(e){return kt((function(t,r){return e<=r}))}function qn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=At(e);return n((function(t,n){for(var i=e.length,a=new Array(i),s=e.map((function(){return!1})),o=!1,u=function(t){te(e[t]).subscribe(F(n,(function(e){a[t]=e,o||s[t]||(s[t]=!0,(o=s.every(Q))&&(s=null))}),T))},h=0;h<i;h++)u(h);t.subscribe(F(n,(function(e){if(o){var t=c([e],l(a));n.next(r?r.apply(void 0,c([],l(t))):t)}})))}))}function Qn(e,t){return void 0===t&&(t=Ze),n((function(r,n){var i=null,a=null,s=null,o=function(){if(i){i.unsubscribe(),i=null;var e=a;a=null,n.next(e)}};function l(){var r=s+e,a=t.now();if(a<r)return i=this.schedule(void 0,r-a),void n.add(i);o()}r.subscribe(F(n,(function(r){a=r,s=t.now(),i||(i=t.schedule(l,e),n.add(i))}),(function(){o(),n.complete()}),void 0,(function(){a=i=null})))}))}jn(rn.token);const Xn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Wn=Object.keys,$n=Array.isArray;function Hn(e,t){return"object"!=typeof t||Wn(t).forEach((function(r){e[r]=t[r]})),e}"undefined"==typeof Promise||Xn.Promise||(Xn.Promise=Promise);const Gn=Object.getPrototypeOf,Yn={}.hasOwnProperty;function Kn(e,t){return Yn.call(e,t)}function Jn(e,t){"function"==typeof t&&(t=t(Gn(e))),("undefined"==typeof Reflect?Wn:Reflect.ownKeys)(t).forEach((r=>{ei(e,r,t[r])}))}const Zn=Object.defineProperty;function ei(e,t,r,n){Zn(e,t,Hn(r&&Kn(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function ti(e){return{from:function(t){return e.prototype=Object.create(t.prototype),ei(e.prototype,"constructor",e),{extend:Jn.bind(null,e.prototype)}}}}const ri=Object.getOwnPropertyDescriptor;function ni(e,t){let r;return ri(e,t)||(r=Gn(e))&&ni(r,t)}const ii=[].slice;function ai(e,t,r){return ii.call(e,t,r)}function si(e,t){return t(e)}function oi(e){if(!e)throw new Error("Assertion Failed")}function li(e){Xn.setImmediate?setImmediate(e):setTimeout(e,0)}function ci(e,t){return e.reduce(((e,r,n)=>{var i=t(r,n);return i&&(e[i[0]]=i[1]),e}),{})}function ui(e,t){if(Kn(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var r=[],n=0,i=t.length;n<i;++n){var a=ui(e,t[n]);r.push(a)}return r}var s=t.indexOf(".");if(-1!==s){var o=e[t.substr(0,s)];return void 0===o?void 0:ui(o,t.substr(s+1))}}function hi(e,t,r){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){oi("string"!=typeof r&&"length"in r);for(var n=0,i=t.length;n<i;++n)hi(e,t[n],r[n])}else{var a=t.indexOf(".");if(-1!==a){var s=t.substr(0,a),o=t.substr(a+1);if(""===o)void 0===r?$n(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=r;else{var l=e[s];l&&Kn(e,s)||(l=e[s]={}),hi(l,o,r)}}else void 0===r?$n(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function di(e){var t={};for(var r in e)Kn(e,r)&&(t[r]=e[r]);return t}const fi=[].concat;function mi(e){return fi.apply([],e)}const pi="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(mi([8,16,32,64].map((e=>["Int","Uint","Float"].map((t=>t+e+"Array")))))).filter((e=>Xn[e])),gi=pi.map((e=>Xn[e]));ci(pi,(e=>[e,!0]));let Ai=null;function vi(e){Ai="undefined"!=typeof WeakMap&&new WeakMap;const t=bi(e);return Ai=null,t}function bi(e){if(!e||"object"!=typeof e)return e;let t=Ai&&Ai.get(e);if(t)return t;if($n(e)){t=[],Ai&&Ai.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(bi(e[r]))}else if(gi.indexOf(e.constructor)>=0)t=e;else{const r=Gn(e);for(var i in t=r===Object.prototype?{}:Object.create(r),Ai&&Ai.set(e,t),e)Kn(e,i)&&(t[i]=bi(e[i]))}return t}const{toString:yi}={};function wi(e){return yi.call(e).slice(8,-1)}const _i="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",Ei="symbol"==typeof _i?function(e){var t;return null!=e&&(t=e[_i])&&t.apply(e)}:function(){return null},xi={};function Si(e){var t,r,n,i;if(1===arguments.length){if($n(e))return e.slice();if(this===xi&&"string"==typeof e)return[e];if(i=Ei(e)){for(r=[];!(n=i.next()).done;)r.push(n.value);return r}if(null==e)return[e];if("number"==typeof(t=e.length)){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const Ti="undefined"!=typeof Symbol?e=>"AsyncFunction"===e[Symbol.toStringTag]:()=>!1;var ki="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ii(e,t){ki=e,Ci=t}var Ci=()=>!0;const Pi=!new Error("").stack;function Mi(){if(Pi)try{throw Mi.arguments,new Error}catch(e){return e}return new Error}function Ri(e,t){var r=e.stack;return r?(t=t||0,0===r.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),r.split("\n").slice(t).filter(Ci).map((e=>"\n"+e)).join("")):""}var Bi=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Li=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Bi),Di={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ni(e,t){this._e=Mi(),this.name=e,this.message=t}function Oi(e,t){return e+". Errors: "+Object.keys(t).map((e=>t[e].toString())).filter(((e,t,r)=>r.indexOf(e)===t)).join("\n")}function zi(e,t,r,n){this._e=Mi(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=Oi(e,t)}function Fi(e,t){this._e=Mi(),this.name="BulkError",this.failures=Object.keys(t).map((e=>t[e])),this.failuresByPos=t,this.message=Oi(e,t)}ti(Ni).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Ri(this._e,2))}},toString:function(){return this.name+": "+this.message}}),ti(zi).from(Ni),ti(Fi).from(Ni);var Ui=Li.reduce(((e,t)=>(e[t]=t+"Error",e)),{});const ji=Ni;var Vi=Li.reduce(((e,t)=>{var r=t+"Error";function n(e,n){this._e=Mi(),this.name=r,e?"string"==typeof e?(this.message=`${e}${n?"\n "+n:""}`,this.inner=n||null):"object"==typeof e&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=Di[t]||r,this.inner=null)}return ti(n).from(ji),e[t]=n,e}),{});Vi.Syntax=SyntaxError,Vi.Type=TypeError,Vi.Range=RangeError;var qi=Bi.reduce(((e,t)=>(e[t+"Error"]=Vi[t],e)),{}),Qi=Li.reduce(((e,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Vi[t]),e)),{});function Xi(){}function Wi(e){return e}function $i(e,t){return null==e||e===Wi?t:function(r){return t(e(r))}}function Hi(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Gi(e,t){return e===Xi?t:function(){var r=e.apply(this,arguments);void 0!==r&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Hi(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Hi(i,this.onerror):i),void 0!==a?a:r}}function Yi(e,t){return e===Xi?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Hi(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Hi(n,this.onerror):n)}}function Ki(e,t){return e===Xi?t:function(r){var n=e.apply(this,arguments);Hn(r,n);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Hi(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Hi(a,this.onerror):a),void 0===n?void 0===s?void 0:s:Hn(n,s)}}function Ji(e,t){return e===Xi?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function Zi(e,t){return e===Xi?t:function(){var r=e.apply(this,arguments);if(r&&"function"==typeof r.then){for(var n=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return r.then((function(){return t.apply(n,a)}))}return t.apply(this,arguments)}}Qi.ModifyError=zi,Qi.DexieError=Ni,Qi.BulkError=Fi;var ea={};const[ta,ra,na]="undefined"==typeof Promise?[]:(()=>{let e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,Gn(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Gn(t),e]})(),ia=ra&&ra.then,aa=ta&&ta.constructor,sa=!!na;var oa=!1,la=na?()=>{na.then(Ma)}:Xn.setImmediate?setImmediate.bind(null,Ma):Xn.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver((()=>{Ma(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Ma,0)},ca=function(e,t){va.push([e,t]),ha&&(la(),ha=!1)},ua=!0,ha=!0,da=[],fa=[],ma=null,pa=Wi,ga={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ts,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((e=>{try{ts(e[0],e[1])}catch(e){}}))}},Aa=ga,va=[],ba=0,ya=[];function wa(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Xi,this._lib=!1;var t=this._PSD=Aa;if(ki&&(this._stackHolder=Mi(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==ea)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Sa(this,this._value))}this._state=null,this._value=null,++t.ref,xa(this,e)}const _a={get:function(){var e=Aa,t=ja;function r(r,n){var i=!e.global&&(e!==Aa||t!==ja);const a=i&&!Xa();var s=new wa(((t,s)=>{ka(this,new Ea(Za(r,e,i,a),Za(n,e,i,a),t,s,e))}));return ki&&Pa(s,this),s}return r.prototype=ea,r},set:function(e){ei(this,"then",e&&e.prototype===ea?_a:{get:function(){return e},set:_a.set})}};function Ea(e,t,r,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=r,this.reject=n,this.psd=i}function xa(e,t){try{t((t=>{if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&Ra();t&&"function"==typeof t.then?xa(e,((e,r)=>{t instanceof wa?t._then(e,r):t.then(e,r)})):(e._state=!0,e._value=t,Ta(e)),r&&Ba()}}),Sa.bind(null,e))}catch(t){Sa(e,t)}}function Sa(e,t){if(fa.push(t),null===e._state){var r=e._lib&&Ra();t=pa(t),e._state=!1,e._value=t,ki&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,r){try{e.apply(null,void 0)}catch(e){}}((()=>{var r=ni(t,"stack");t._promise=e,ei(t,"stack",{get:()=>oa?r&&(r.get?r.get.apply(t):r.value):e.stack})})),function(e){da.some((t=>t._value===e._value))||da.push(e)}(e),Ta(e),r&&Ba()}}function Ta(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)ka(e,t[r]);var i=e._PSD;--i.ref||i.finalize(),0===ba&&(++ba,ca((()=>{0==--ba&&La()}),[]))}function ka(e,t){if(null!==e._state){var r=e._state?t.onFulfilled:t.onRejected;if(null===r)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ba,ca(Ia,[r,e,t])}else e._listeners.push(t)}function Ia(e,t,r){try{ma=t;var n,i=t._value;t._state?n=e(i):(fa.length&&(fa=[]),n=e(i),-1===fa.indexOf(i)&&function(e){for(var t=da.length;t;)if(da[--t]._value===e._value)return void da.splice(t,1)}(t)),r.resolve(n)}catch(e){r.reject(e)}finally{ma=null,0==--ba&&La(),--r.psd.ref||r.psd.finalize()}}function Ca(e,t,r){if(t.length===r)return t;var n="";if(!1===e._state){var i,a,s=e._value;null!=s?(i=s.name||"Error",a=s.message||s,n=Ri(s,0)):(i=s,a=""),t.push(i+(a?": "+a:"")+n)}return ki&&((n=Ri(e._stackHolder,2))&&-1===t.indexOf(n)&&t.push(n),e._prev&&Ca(e._prev,t,r)),t}function Pa(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Ma(){Ra()&&Ba()}function Ra(){var e=ua;return ua=!1,ha=!1,e}function Ba(){var e,t,r;do{for(;va.length>0;)for(e=va,va=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}}while(va.length>0);ua=!0,ha=!0}function La(){var e=da;da=[],e.forEach((e=>{e._PSD.onunhandled.call(null,e._value,e)}));for(var t=ya.slice(0),r=t.length;r;)t[--r]()}function Da(e){return new wa(ea,!1,e)}function Na(e,t){var r=Aa;return function(){var n=Ra(),i=Aa;try{return Ga(r,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{Ga(i,!1),n&&Ba()}}}Jn(wa.prototype,{then:_a,_then:function(e,t){ka(this,new Ea(null,null,e,t,Aa))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],r=arguments[1];return"function"==typeof t?this.then(null,(e=>e instanceof t?r(e):Da(e))):this.then(null,(e=>e&&e.name===t?r(e):Da(e)))},finally:function(e){return this.then((t=>(e(),t)),(t=>(e(),Da(t))))},stack:{get:function(){if(this._stack)return this._stack;try{oa=!0;var e=Ca(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{oa=!1}}},timeout:function(e,t){return e<1/0?new wa(((r,n)=>{var i=setTimeout((()=>n(new Vi.Timeout(t))),e);this.then(r,n).finally(clearTimeout.bind(null,i))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&ei(wa.prototype,Symbol.toStringTag,"Dexie.Promise"),ga.env=Ya(),Jn(wa,{all:function(){var e=Si.apply(null,arguments).map(Wa);return new wa((function(t,r){0===e.length&&t([]);var n=e.length;e.forEach(((i,a)=>wa.resolve(i).then((r=>{e[a]=r,--n||t(e)}),r)))}))},resolve:e=>{if(e instanceof wa)return e;if(e&&"function"==typeof e.then)return new wa(((t,r)=>{e.then(t,r)}));var t=new wa(ea,!0,e);return Pa(t,ma),t},reject:Da,race:function(){var e=Si.apply(null,arguments).map(Wa);return new wa(((t,r)=>{e.map((e=>wa.resolve(e).then(t,r)))}))},PSD:{get:()=>Aa,set:e=>Aa=e},totalEchoes:{get:()=>ja},newPSD:qa,usePSD:Ka,scheduler:{get:()=>ca,set:e=>{ca=e}},rejectionMapper:{get:()=>pa,set:e=>{pa=e}},follow:(e,t)=>new wa(((r,n)=>qa(((t,r)=>{var n=Aa;n.unhandleds=[],n.onunhandled=r,n.finalize=Hi((function(){!function(e){ya.push((function t(){e(),ya.splice(ya.indexOf(t),1)})),++ba,ca((()=>{0==--ba&&La()}),[])}((()=>{0===this.unhandleds.length?t():r(this.unhandleds[0])}))}),n.finalize),e()}),t,r,n)))}),aa&&(aa.allSettled&&ei(wa,"allSettled",(function(){const e=Si.apply(null,arguments).map(Wa);return new wa((t=>{0===e.length&&t([]);let r=e.length;const n=new Array(r);e.forEach(((e,i)=>wa.resolve(e).then((e=>n[i]={status:"fulfilled",value:e}),(e=>n[i]={status:"rejected",reason:e})).then((()=>--r||t(n)))))}))})),aa.any&&"undefined"!=typeof AggregateError&&ei(wa,"any",(function(){const e=Si.apply(null,arguments).map(Wa);return new wa(((t,r)=>{0===e.length&&r(new AggregateError([]));let n=e.length;const i=new Array(n);e.forEach(((e,a)=>wa.resolve(e).then((e=>t(e)),(e=>{i[a]=e,--n||r(new AggregateError(i))}))))}))})));const Oa={awaits:0,echoes:0,id:0};var za=0,Fa=[],Ua=0,ja=0,Va=0;function qa(e,t,r,n){var i=Aa,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++Va;var s=ga.env;a.env=sa?{Promise:wa,PromiseProp:{value:wa,configurable:!0,writable:!0},all:wa.all,race:wa.race,allSettled:wa.allSettled,any:wa.any,resolve:wa.resolve,reject:wa.reject,nthen:es(s.nthen,a),gthen:es(s.gthen,a)}:{},t&&Hn(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Ka(a,e,r,n);return 0===a.ref&&a.finalize(),o}function Qa(){return Oa.id||(Oa.id=++za),++Oa.awaits,Oa.echoes+=100,Oa.id}function Xa(){return!!Oa.awaits&&(0==--Oa.awaits&&(Oa.id=0),Oa.echoes=100*Oa.awaits,!0)}function Wa(e){return Oa.echoes&&e&&e.constructor===aa?(Qa(),e.then((e=>(Xa(),e)),(e=>(Xa(),rs(e))))):e}function $a(e){++ja,Oa.echoes&&0!=--Oa.echoes||(Oa.echoes=Oa.id=0),Fa.push(Aa),Ga(e,!0)}function Ha(){var e=Fa[Fa.length-1];Fa.pop(),Ga(e,!1)}function Ga(e,t){var r=Aa;if((t?!Oa.echoes||Ua++&&e===Aa:!Ua||--Ua&&e===Aa)||Ja(t?$a.bind(null,e):Ha),e!==Aa&&(Aa=e,r===ga&&(ga.env=Ya()),sa)){var n=ga.env.Promise,i=e.env;ra.then=i.nthen,n.prototype.then=i.gthen,(r.global||e.global)&&(Object.defineProperty(Xn,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function Ya(){var e=Xn.Promise;return sa?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Xn,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:ra.then,gthen:e.prototype.then}:{}}function Ka(e,t,r,n,i){var a=Aa;try{return Ga(e,!0),t(r,n,i)}finally{Ga(a,!1)}}function Ja(e){ia.call(ta,e)}function Za(e,t,r,n){return"function"!=typeof e?e:function(){var i=Aa;r&&Qa(),Ga(t,!0);try{return e.apply(this,arguments)}finally{Ga(i,!1),n&&Ja(Xa)}}}function es(e,t){return function(r,n){return e.call(this,Za(r,t),Za(n,t))}}function ts(e,t){var r;try{r=t.onuncatched(e)}catch(e){}if(!1!==r)try{var n,i={promise:t,reason:e};if(Xn.document&&document.createEvent?((n=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),Hn(n,i)):Xn.CustomEvent&&Hn(n=new CustomEvent("unhandledrejection",{detail:i}),i),n&&Xn.dispatchEvent&&(dispatchEvent(n),!Xn.PromiseRejectionEvent&&Xn.onunhandledrejection))try{Xn.onunhandledrejection(n)}catch(e){}ki&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch(e){}}-1===(""+ia).indexOf("[native code]")&&(Qa=Xa=Xi);var rs=wa.reject;function ns(e,t,r,n){if(e.idbdb&&(e._state.openComplete||Aa.letThrough||e._vip)){var i=e._createTransaction(t,r,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===Ui.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>ns(e,t,r,n)))):rs(i)}return i._promise(t,((e,t)=>qa((()=>(Aa.trans=i,n(e,t,i)))))).then((e=>i._completion.then((()=>e))))}if(e._state.openComplete)return rs(new Vi.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return rs(new Vi.DatabaseClosed);e.open().catch(Xi)}return e._state.dbReadyPromise.then((()=>ns(e,t,r,n)))}const is=String.fromCharCode(65535),as="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ss=[],os="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ls=os,cs=os,us=e=>!/(dexie\.js|dexie\.min\.js)/.test(e);function hs(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const ds={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function fs(e){return"string"!=typeof e||/\./.test(e)?e=>e:t=>(void 0===t[e]&&e in t&&delete(t=vi(t))[e],t)}class ms{_trans(e,t,r){const n=this._tx||Aa.trans,i=this.name;function a(e,r,n){if(!n.schema[i])throw new Vi.NotFound("Table "+i+" not part of transaction");return t(n.idbtrans,n)}const s=Ra();try{return n&&n.db===this.db?n===Aa.trans?n._promise(e,a,r):qa((()=>n._promise(e,a,r)),{trans:n,transless:Aa.transless||Aa}):ns(this.db,e,[this.name],a)}finally{s&&Ba()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(t=>this.core.get({trans:t,key:e}).then((e=>this.hook.reading.fire(e))))).then(t)}where(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if($n(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const t=Wn(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter((e=>e.compound&&t.every((t=>e.keyPath.indexOf(t)>=0))&&e.keyPath.every((e=>t.indexOf(e)>=0))))[0];if(r&&this.db._maxKey!==is)return this.where(r.name).equals(r.keyPath.map((t=>e[t])));!r&&ki&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${t.join("+")}]`);const{idxByName:n}=this.schema,i=this.db._deps.indexedDB;function a(e,t){try{return 0===i.cmp(e,t)}catch(e){return!1}}const[s,o]=t.reduce((([t,r],i)=>{const s=n[i],o=e[i];return[t||s,t||!s?hs(r,s&&s.multi?e=>{const t=ui(e,i);return $n(t)&&t.some((e=>a(o,e)))}:e=>a(o,ui(e,i))):r]}),[null,null]);return s?this.where(s.name).equals(e[s.keyPath]).filter(o):r?this.filter(o):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,$n(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const t=t=>{if(!t)return t;const r=Object.create(e.prototype);for(var n in t)if(Kn(t,n))try{r[n]=t[n]}catch(e){}return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e}defineClass(){return this.mapToClass((function(e){Hn(this,e)}))}add(e,t){const{auto:r,keyPath:n}=this.schema.primKey;let i=e;return n&&r&&(i=fs(n)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[i]}))).then((e=>e.numFailures?wa.reject(e.failures[0]):e.lastResult)).then((t=>{if(n)try{hi(e,n,t)}catch(e){}return t}))}update(e,t){if("object"!=typeof e||$n(e))return this.where(":id").equals(e).modify(t);{const r=ui(e,this.schema.primKey.keyPath);if(void 0===r)return rs(new Vi.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?Wn(t).forEach((r=>{hi(e,r,t[r])})):t(e,{value:e,primKey:r})}catch(e){}return this.where(":id").equals(r).modify(t)}}put(e,t){const{auto:r,keyPath:n}=this.schema.primKey;let i=e;return n&&r&&(i=fs(n)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"put",values:[i],keys:null!=t?[t]:null}))).then((e=>e.numFailures?wa.reject(e.failures[0]):e.lastResult)).then((t=>{if(n)try{hi(e,n,t)}catch(e){}return t}))}delete(e){return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:[e]}))).then((e=>e.numFailures?wa.reject(e.failures[0]):void 0))}clear(){return this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"deleteRange",range:ds}))).then((e=>e.numFailures?wa.reject(e.failures[0]):void 0))}bulkGet(e){return this._trans("readonly",(t=>this.core.getMany({keys:e,trans:t}).then((e=>e.map((e=>this.hook.reading.fire(e)))))))}bulkAdd(e,t,r){const n=Array.isArray(t)?t:void 0,i=(r=r||(n?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:r,keyPath:a}=this.schema.primKey;if(a&&n)throw new Vi.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(n&&n.length!==e.length)throw new Vi.InvalidArgument("Arguments objects and keys must have the same length");const s=e.length;let o=a&&r?e.map(fs(a)):e;return this.core.mutate({trans:t,type:"add",keys:n,values:o,wantResults:i}).then((({numFailures:e,results:t,lastResult:r,failures:n})=>{if(0===e)return i?t:r;throw new Fi(`${this.name}.bulkAdd(): ${e} of ${s} operations failed`,n)}))}))}bulkPut(e,t,r){const n=Array.isArray(t)?t:void 0,i=(r=r||(n?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:r,keyPath:a}=this.schema.primKey;if(a&&n)throw new Vi.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(n&&n.length!==e.length)throw new Vi.InvalidArgument("Arguments objects and keys must have the same length");const s=e.length;let o=a&&r?e.map(fs(a)):e;return this.core.mutate({trans:t,type:"put",keys:n,values:o,wantResults:i}).then((({numFailures:e,results:t,lastResult:r,failures:n})=>{if(0===e)return i?t:r;throw new Fi(`${this.name}.bulkPut(): ${e} of ${s} operations failed`,n)}))}))}bulkDelete(e){const t=e.length;return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:e}))).then((({numFailures:e,lastResult:r,failures:n})=>{if(0===e)return r;throw new Fi(`${this.name}.bulkDelete(): ${e} of ${t} operations failed`,n)}))}}function ps(e){var t={},r=function(r,n){if(n){for(var i=arguments.length,a=new Array(i-1);--i;)a[i-1]=arguments[i];return t[r].subscribe.apply(null,a),e}if("string"==typeof r)return t[r]};r.addEventType=a;for(var n=1,i=arguments.length;n<i;++n)a(arguments[n]);return r;function a(e,n,i){if("object"==typeof e)return s(e);n||(n=Ji),i||(i=Xi);var a={subscribers:[],fire:i,subscribe:function(e){-1===a.subscribers.indexOf(e)&&(a.subscribers.push(e),a.fire=n(a.fire,e))},unsubscribe:function(e){a.subscribers=a.subscribers.filter((function(t){return t!==e})),a.fire=a.subscribers.reduce(n,i)}};return t[e]=r[e]=a,a}function s(e){Wn(e).forEach((function(t){var r=e[t];if($n(r))a(t,e[t][0],e[t][1]);else{if("asap"!==r)throw new Vi.InvalidArgument("Invalid event config");var n=a(t,Wi,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach((function(e){li((function(){e.apply(null,t)}))}))}))}}))}}function gs(e,t){return ti(t).from({prototype:e}),t}function As(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function vs(e,t){e.filter=hs(e.filter,t)}function bs(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>hs(n(),t()):t,e.justLimit=r&&!n}function ys(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new Vi.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function ws(e,t,r){const n=ys(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:n,range:e.range}})}function _s(e,t,r,n){const i=e.replayFilter?hs(e.filter,e.replayFilter()):e.filter;if(e.or){const a={},s=(e,r,n)=>{if(!i||i(r,n,(e=>r.stop(e)),(e=>r.fail(e)))){var s=r.primaryKey,o=""+s;"[object ArrayBuffer]"===o&&(o=""+new Uint8Array(s)),Kn(a,o)||(a[o]=!0,t(e,r,n))}};return Promise.all([e.or._iterate(s,r),Es(ws(e,n,r),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return Es(ws(e,n,r),hs(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Es(e,t,r,n){var i=Na(n?(e,t,i)=>r(n(e),t,i):r);return e.then((e=>{if(e)return e.start((()=>{var r=()=>e.continue();t&&!t(e,(e=>r=e),(t=>{e.stop(t),r=Xi}),(t=>{e.fail(t),r=Xi}))||i(e.value,e,(e=>r=e)),r()}))}))}function xs(e,t){try{const r=Ss(e),n=Ss(t);if(r!==n)return"Array"===r?1:"Array"===n?-1:"binary"===r?1:"binary"===n?-1:"string"===r?1:"string"===n?-1:"Date"===r?1:"Date"!==n?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){const r=e.length,n=t.length,i=r<n?r:n;for(let r=0;r<i;++r)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return r===n?0:r<n?-1:1}(Ts(e),Ts(t));case"Array":return function(e,t){const r=e.length,n=t.length,i=r<n?r:n;for(let r=0;r<i;++r){const n=xs(e[r],t[r]);if(0!==n)return n}return r===n?0:r<n?-1:1}(e,t)}}catch(e){}return NaN}function Ss(e){const t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";const r=wi(e);return"ArrayBuffer"===r?"binary":r}function Ts(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class ks{_read(e,t){var r=this._ctx;return r.error?r.table._trans(null,rs.bind(null,r.error)):r.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,rs.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=hs(t.algorithm,e)}_iterate(e,t){return _s(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Hn(r,e),t._ctx=r,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read((r=>_s(t,e,r,t.table.core)))}count(e){return this._read((e=>{const t=this._ctx,r=t.table.core;if(As(t,!0))return r.count({trans:e,query:{index:ys(t,r.schema),range:t.range}}).then((e=>Math.min(e,t.limit)));var n=0;return _s(t,(()=>(++n,!1)),e,r).then((()=>n))})).then(e)}sortBy(e,t){const r=e.split(".").reverse(),n=r[0],i=r.length-1;function a(e,t){return t?a(e[r[t]],t-1):e[n]}var s="next"===this._ctx.dir?1:-1;function o(e,t){var r=a(e,i),n=a(t,i);return r<n?-s:r>n?s:0}return this.toArray((function(e){return e.sort(o)})).then(t)}toArray(e){return this._read((e=>{var t=this._ctx;if("next"===t.dir&&As(t,!0)&&t.limit>0){const{valueMapper:r}=t,n=ys(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:n,range:t.range}}).then((({result:e})=>r?e.map(r):e))}{const r=[];return _s(t,(e=>r.push(e)),e,t.table.core).then((()=>r))}}),e)}offset(e){var t=this._ctx;return e<=0||(t.offset+=e,As(t)?bs(t,(()=>{var t=e;return(e,r)=>0===t||(1===t?(--t,!1):(r((()=>{e.advance(t),t=0})),!1))})):bs(t,(()=>{var t=e;return()=>--t<0}))),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),bs(this._ctx,(()=>{var t=e;return function(e,r,n){return--t<=0&&r(n),t>=0}}),!0),this}until(e,t){return vs(this._ctx,(function(r,n,i){return!e(r.value)||(n(i),t)})),this}first(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)}last(e){return this.reverse().first(e)}filter(e){var t,r;return vs(this._ctx,(function(t){return e(t.value)})),t=this._ctx,r=e,t.isMatch=hs(t.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,r){e(r.key,r)}))}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,r){e(r.primaryKey,r)}))}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each((function(e,t){r.push(t.key)})).then((function(){return r})).then(e)}primaryKeys(e){var t=this._ctx;if("next"===t.dir&&As(t,!0)&&t.limit>0)return this._read((e=>{var r=ys(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:r,range:t.range}})})).then((({result:e})=>e)).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each((function(e,t){r.push(t.primaryKey)})).then((function(){return r})).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys((function(e){return e[0]})).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var r={};return vs(this._ctx,(function(e){var t=e.primaryKey.toString(),n=Kn(r,t);return r[t]=!0,!n})),this}modify(e){var t=this._ctx;return this._write((r=>{var n;if("function"==typeof e)n=e;else{var i=Wn(e),a=i.length;n=function(t){for(var r=!1,n=0;n<a;++n){var s=i[n],o=e[s];ui(t,s)!==o&&(hi(t,s,o),r=!0)}return r}}const s=t.table.core,{outbound:o,extractKey:l}=s.schema.primaryKey,c=this.db._options.modifyChunkSize||200,u=[];let h=0;const d=[],f=(e,t)=>{const{failures:r,numFailures:n}=t;h+=e-n;for(let e of Wn(r))u.push(r[e])};return this.clone().primaryKeys().then((i=>{const a=u=>{const h=Math.min(c,i.length-u);return s.getMany({trans:r,keys:i.slice(u,u+h),cache:"immutable"}).then((d=>{const m=[],p=[],g=o?[]:null,A=[];for(let e=0;e<h;++e){const t=d[e],r={value:vi(t),primKey:i[u+e]};!1!==n.call(r,r.value,r)&&(null==r.value?A.push(i[u+e]):o||0===xs(l(t),l(r.value))?(p.push(r.value),o&&g.push(i[u+e])):(A.push(i[u+e]),m.push(r.value)))}const v=As(t)&&t.limit===1/0&&("function"!=typeof e||e===Is)&&{index:t.index,range:t.range};return Promise.resolve(m.length>0&&s.mutate({trans:r,type:"add",values:m}).then((e=>{for(let t in e.failures)A.splice(parseInt(t),1);f(m.length,e)}))).then((()=>(p.length>0||v&&"object"==typeof e)&&s.mutate({trans:r,type:"put",keys:g,values:p,criteria:v,changeSpec:"function"!=typeof e&&e}).then((e=>f(p.length,e))))).then((()=>(A.length>0||v&&e===Is)&&s.mutate({trans:r,type:"delete",keys:A,criteria:v}).then((e=>f(A.length,e))))).then((()=>i.length>u+h&&a(u+c)))}))};return a(0).then((()=>{if(u.length>0)throw new zi("Error modifying one or more objects",u,h,d);return i.length}))}))}))}delete(){var e=this._ctx,t=e.range;return As(e)&&(e.isPrimKey&&!cs||3===t.type)?this._write((r=>{const{primaryKey:n}=e.table.core.schema,i=t;return e.table.core.count({trans:r,query:{index:n,range:i}}).then((t=>e.table.core.mutate({trans:r,type:"deleteRange",range:i}).then((({failures:e,lastResult:r,results:n,numFailures:i})=>{if(i)throw new zi("Could not delete some values",Object.keys(e).map((t=>e[t])),t-i);return t-i}))))})):this.modify(Is)}}const Is=(e,t)=>t.value=null;function Cs(e,t){return e<t?-1:e===t?0:1}function Ps(e,t){return e>t?-1:e===t?0:1}function Ms(e,t,r){var n=e instanceof Os?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function Rs(e){return new e.Collection(e,(()=>Ns(""))).limit(0)}function Bs(e,t,r,n,i,a){for(var s=Math.min(e.length,n.length),o=-1,l=0;l<s;++l){var c=t[l];if(c!==n[l])return i(e[l],r[l])<0?e.substr(0,l)+r[l]+r.substr(l+1):i(e[l],n[l])<0?e.substr(0,l)+n[l]+r.substr(l+1):o>=0?e.substr(0,o)+t[o]+r.substr(o+1):null;i(e[l],c)<0&&(o=l)}return s<n.length&&"next"===a?e+r.substr(e.length):s<e.length&&"prev"===a?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}function Ls(e,t,r,n){var i,a,s,o,l,c,u,h=r.length;if(!r.every((e=>"string"==typeof e)))return Ms(e,"String expected.");function d(e){i=function(e){return"next"===e?e=>e.toUpperCase():e=>e.toLowerCase()}(e),a=function(e){return"next"===e?e=>e.toLowerCase():e=>e.toUpperCase()}(e),s="next"===e?Cs:Ps;var t=r.map((function(e){return{lower:a(e),upper:i(e)}})).sort((function(e,t){return s(e.lower,t.lower)}));o=t.map((function(e){return e.upper})),l=t.map((function(e){return e.lower})),c=e,u="next"===e?"":n}d("next");var f=new e.Collection(e,(()=>Ds(o[0],l[h-1]+n)));f._ondirectionchange=function(e){d(e)};var m=0;return f._addAlgorithm((function(e,r,n){var i=e.key;if("string"!=typeof i)return!1;var d=a(i);if(t(d,l,m))return!0;for(var f=null,p=m;p<h;++p){var g=Bs(i,d,o[p],l[p],s,c);null===g&&null===f?m=p+1:(null===f||s(f,g)>0)&&(f=g)}return r(null!==f?function(){e.continue(f+u)}:n),!1})),f}function Ds(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function Ns(e){return{type:1,lower:e,upper:e}}class Os{get Collection(){return this._ctx.table.db.Collection}between(e,t,r,n){r=!1!==r,n=!0===n;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(r||n)&&(!r||!n)?Rs(this):new this.Collection(this,(()=>Ds(e,t,!r,!n)))}catch(e){return Ms(this,as)}}equals(e){return null==e?Ms(this,as):new this.Collection(this,(()=>Ns(e)))}above(e){return null==e?Ms(this,as):new this.Collection(this,(()=>Ds(e,void 0,!0)))}aboveOrEqual(e){return null==e?Ms(this,as):new this.Collection(this,(()=>Ds(e,void 0,!1)))}below(e){return null==e?Ms(this,as):new this.Collection(this,(()=>Ds(void 0,e,!1,!0)))}belowOrEqual(e){return null==e?Ms(this,as):new this.Collection(this,(()=>Ds(void 0,e)))}startsWith(e){return"string"!=typeof e?Ms(this,"String expected."):this.between(e,e+is,!0,!0)}startsWithIgnoreCase(e){return""===e?this.startsWith(e):Ls(this,((e,t)=>0===e.indexOf(t[0])),[e],is)}equalsIgnoreCase(e){return Ls(this,((e,t)=>e===t[0]),[e],"")}anyOfIgnoreCase(){var e=Si.apply(xi,arguments);return 0===e.length?Rs(this):Ls(this,((e,t)=>-1!==t.indexOf(e)),e,"")}startsWithAnyOfIgnoreCase(){var e=Si.apply(xi,arguments);return 0===e.length?Rs(this):Ls(this,((e,t)=>t.some((t=>0===e.indexOf(t)))),e,is)}anyOf(){const e=Si.apply(xi,arguments);let t=this._cmp;try{e.sort(t)}catch(e){return Ms(this,as)}if(0===e.length)return Rs(this);const r=new this.Collection(this,(()=>Ds(e[0],e[e.length-1])));r._ondirectionchange=r=>{t="next"===r?this._ascending:this._descending,e.sort(t)};let n=0;return r._addAlgorithm(((r,i,a)=>{const s=r.key;for(;t(s,e[n])>0;)if(++n,n===e.length)return i(a),!1;return 0===t(s,e[n])||(i((()=>{r.continue(e[n])})),!1)})),r}notEqual(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=Si.apply(xi,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Ms(this,as)}const t=e.reduce(((e,t)=>e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){const r=this._cmp,n=this._ascending,i=this._descending,a=this._min,s=this._max;if(0===e.length)return Rs(this);if(!e.every((e=>void 0!==e[0]&&void 0!==e[1]&&n(e[0],e[1])<=0)))return Ms(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Vi.InvalidArgument);const o=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers;let c,u=n;function h(e,t){return u(e[0],t[0])}try{c=e.reduce((function(e,t){let n=0,i=e.length;for(;n<i;++n){const i=e[n];if(r(t[0],i[1])<0&&r(t[1],i[0])>0){i[0]=a(i[0],t[0]),i[1]=s(i[1],t[1]);break}}return n===i&&e.push(t),e}),[]),c.sort(h)}catch(e){return Ms(this,as)}let d=0;const f=l?e=>n(e,c[d][1])>0:e=>n(e,c[d][1])>=0,m=o?e=>i(e,c[d][0])>0:e=>i(e,c[d][0])>=0;let p=f;const g=new this.Collection(this,(()=>Ds(c[0][0],c[c.length-1][1],!o,!l)));return g._ondirectionchange=e=>{"next"===e?(p=f,u=n):(p=m,u=i),c.sort(h)},g._addAlgorithm(((e,t,r)=>{for(var i=e.key;p(i);)if(++d,d===c.length)return t(r),!1;return!!function(e){return!f(e)&&!m(e)}(i)||(0===this._cmp(i,c[d][1])||0===this._cmp(i,c[d][0])||t((()=>{u===n?e.continue(c[d][0]):e.continue(c[d][1])})),!1)})),g}startsWithAnyOf(){const e=Si.apply(xi,arguments);return e.every((e=>"string"==typeof e))?0===e.length?Rs(this):this.inAnyRange(e.map((e=>[e,e+is]))):Ms(this,"startsWithAnyOf() only works with strings")}}function zs(e){return Na((function(t){return Fs(t),e(t.target.error),!1}))}function Fs(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Us=ps(null,"storagemutated");class js{_lock(){return oi(!Aa.global),++this._reculock,1!==this._reculock||Aa.global||(Aa.lockOwnerFor=this),this}_unlock(){if(oi(!Aa.global),0==--this._reculock)for(Aa.global||(Aa.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Ka(e[1],e[0])}catch(e){}}return this}_locked(){return this._reculock&&Aa.lockOwnerFor!==this}create(e){if(!this.mode)return this;const t=this.db.idbdb,r=this.db._state.dbOpenError;if(oi(!this.idbtrans),!e&&!t)switch(r&&r.name){case"DatabaseClosedError":throw new Vi.DatabaseClosed(r);case"MissingAPIError":throw new Vi.MissingAPI(r.message,r);default:throw new Vi.OpenFailed(r)}if(!this.active)throw new Vi.TransactionInactive;return oi(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Na((t=>{Fs(t),this._reject(e.error)})),e.onabort=Na((t=>{Fs(t),this.active&&this._reject(new Vi.Abort(e.error)),this.active=!1,this.on("abort").fire(t)})),e.oncomplete=Na((()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Us.storagemutated.fire(e.mutatedParts)})),this}_promise(e,t,r){if("readwrite"===e&&"readwrite"!==this.mode)return rs(new Vi.ReadOnly("Transaction is readonly"));if(!this.active)return rs(new Vi.TransactionInactive);if(this._locked())return new wa(((n,i)=>{this._blockedFuncs.push([()=>{this._promise(e,t,r).then(n,i)},Aa])}));if(r)return qa((()=>{var e=new wa(((e,r)=>{this._lock();const n=t(e,r,this);n&&n.then&&n.then(e,r)}));return e.finally((()=>this._unlock())),e._lib=!0,e}));var n=new wa(((e,r)=>{var n=t(e,r,this);n&&n.then&&n.then(e,r)}));return n._lib=!0,n}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();const r=wa.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((()=>r));else{t._waitingFor=r,t._waitingQueue=[];var n=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(n.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new wa(((e,n)=>{r.then((r=>t._waitingQueue.push(Na(e.bind(null,r)))),(e=>t._waitingQueue.push(Na(n.bind(null,e))))).finally((()=>{t._waitingFor===i&&(t._waitingFor=null)}))}))}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Vi.Abort))}table(e){const t=this._memoizedTables||(this._memoizedTables={});if(Kn(t,e))return t[e];const r=this.schema[e];if(!r)throw new Vi.NotFound("Table "+e+" not part of transaction");const n=new this.db.Table(e,r,this);return n.core=this.db.core.table(e),t[e]=n,n}}function Vs(e,t,r,n,i,a,s){return{name:e,keyPath:t,unique:r,multi:n,auto:i,compound:a,src:(r&&!s?"&":"")+(n?"*":"")+(i?"++":"")+qs(t)}}function qs(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Qs(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:ci(r,(e=>[e.name,e]))}}let Xs=e=>{try{return e.only([[]]),Xs=()=>[[]],[[]]}catch(e){return Xs=()=>is,is}};function Ws(e){return null==e?()=>{}:"string"==typeof e?function(e){return 1===e.split(".").length?t=>t[e]:t=>ui(t,e)}(e):t=>ui(t,e)}function $s(e){return[].slice.call(e)}let Hs=0;function Gs(e){return null==e?":id":"string"==typeof e?e:`[${e.join("+")}]`}function Ys(e,t,r){function n(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:r,upper:n,lowerOpen:i,upperOpen:a}=e;return void 0===r?void 0===n?null:t.upperBound(n,!!a):void 0===n?t.lowerBound(r,!!i):t.bound(r,n,!!i,!!a)}const{schema:i,hasGetAll:a}=function(e,t){const r=$s(e.objectStoreNames);return{schema:{name:e.name,tables:r.map((e=>t.objectStore(e))).map((e=>{const{keyPath:t,autoIncrement:r}=e,n=$n(t),i=null==t,a={},s={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:n,keyPath:t,autoIncrement:r,unique:!0,extractKey:Ws(t)},indexes:$s(e.indexNames).map((t=>e.index(t))).map((e=>{const{name:t,unique:r,multiEntry:n,keyPath:i}=e,s={name:t,compound:$n(i),keyPath:i,unique:r,multiEntry:n,extractKey:Ws(i)};return a[Gs(i)]=s,s})),getIndexByKeyPath:e=>a[Gs(e)]};return a[":id"]=s.primaryKey,null!=t&&(a[Gs(t)]=s.primaryKey),s}))},hasGetAll:r.length>0&&"getAll"in t.objectStore(r[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),s=i.tables.map((e=>function(e){const t=e.name;return{name:t,schema:e,mutate:function({trans:e,type:r,keys:i,values:a,range:s}){return new Promise(((o,l)=>{o=Na(o);const c=e.objectStore(t),u=null==c.keyPath,h="put"===r||"add"===r;if(!h&&"delete"!==r&&"deleteRange"!==r)throw new Error("Invalid operation type: "+r);const{length:d}=i||a||{length:1};if(i&&a&&i.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return o({numFailures:0,failures:{},results:[],lastResult:void 0});let f;const m=[],p=[];let g=0;const A=e=>{++g,Fs(e)};if("deleteRange"===r){if(4===s.type)return o({numFailures:g,failures:p,results:[],lastResult:void 0});3===s.type?m.push(f=c.clear()):m.push(f=c.delete(n(s)))}else{const[e,t]=h?u?[a,i]:[a,null]:[i,null];if(h)for(let n=0;n<d;++n)m.push(f=t&&void 0!==t[n]?c[r](e[n],t[n]):c[r](e[n])),f.onerror=A;else for(let t=0;t<d;++t)m.push(f=c[r](e[t])),f.onerror=A}const v=e=>{const t=e.target.result;m.forEach(((e,t)=>null!=e.error&&(p[t]=e.error))),o({numFailures:g,failures:p,results:"delete"===r?i:m.map((e=>e.result)),lastResult:t})};f.onerror=e=>{A(e),v(e)},f.onsuccess=v}))},getMany:({trans:e,keys:r})=>new Promise(((n,i)=>{n=Na(n);const a=e.objectStore(t),s=r.length,o=new Array(s);let l,c=0,u=0;const h=e=>{const t=e.target;o[t._pos]=t.result,++u===c&&n(o)},d=zs(i);for(let e=0;e<s;++e)null!=r[e]&&(l=a.get(r[e]),l._pos=e,l.onsuccess=h,l.onerror=d,++c);0===c&&n(o)})),get:({trans:e,key:r})=>new Promise(((n,i)=>{n=Na(n);const a=e.objectStore(t).get(r);a.onsuccess=e=>n(e.target.result),a.onerror=zs(i)})),query:function(e){return r=>new Promise(((i,a)=>{i=Na(i);const{trans:s,values:o,limit:l,query:c}=r,u=l===1/0?void 0:l,{index:h,range:d}=c,f=s.objectStore(t),m=h.isPrimaryKey?f:f.index(h.name),p=n(d);if(0===l)return i({result:[]});if(e){const e=o?m.getAll(p,u):m.getAllKeys(p,u);e.onsuccess=e=>i({result:e.target.result}),e.onerror=zs(a)}else{let e=0;const t=o||!("openKeyCursor"in m)?m.openCursor(p):m.openKeyCursor(p),r=[];t.onsuccess=n=>{const a=t.result;return a?(r.push(o?a.value:a.primaryKey),++e===l?i({result:r}):void a.continue()):i({result:r})},t.onerror=zs(a)}}))}(a),openCursor:function({trans:e,values:r,query:i,reverse:a,unique:s}){return new Promise(((o,l)=>{o=Na(o);const{index:c,range:u}=i,h=e.objectStore(t),d=c.isPrimaryKey?h:h.index(c.name),f=a?s?"prevunique":"prev":s?"nextunique":"next",m=r||!("openKeyCursor"in d)?d.openCursor(n(u),f):d.openKeyCursor(n(u),f);m.onerror=zs(l),m.onsuccess=Na((t=>{const r=m.result;if(!r)return void o(null);r.___id=++Hs,r.done=!1;const n=r.continue.bind(r);let i=r.continuePrimaryKey;i&&(i=i.bind(r));const a=r.advance.bind(r),s=()=>{throw new Error("Cursor not stopped")};r.trans=e,r.stop=r.continue=r.continuePrimaryKey=r.advance=()=>{throw new Error("Cursor not started")},r.fail=Na(l),r.next=function(){let e=1;return this.start((()=>e--?this.continue():this.stop())).then((()=>this))},r.start=e=>{const t=new Promise(((e,t)=>{e=Na(e),m.onerror=zs(t),r.fail=t,r.stop=t=>{r.stop=r.continue=r.continuePrimaryKey=r.advance=s,e(t)}})),o=()=>{if(m.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=()=>{throw new Error("Cursor behind last entry")},r.stop()};return m.onsuccess=Na((e=>{m.onsuccess=o,o()})),r.continue=n,r.continuePrimaryKey=i,r.advance=a,o(),t},o(r)}),l)}))},count({query:e,trans:r}){const{index:i,range:a}=e;return new Promise(((e,s)=>{const o=r.objectStore(t),l=i.isPrimaryKey?o:o.index(i.name),c=n(a),u=c?l.count(c):l.count();u.onsuccess=Na((t=>e(t.target.result))),u.onerror=zs(s)}))}}}(e))),o={};return s.forEach((e=>o[e.name]=e)),{stack:"dbcore",transaction:e.transaction.bind(e),table(e){if(!o[e])throw new Error(`Table '${e}' not found`);return o[e]},MIN_KEY:-1/0,MAX_KEY:Xs(t),schema:i}}function Ks({_novip:e},t){const r=t.db,n=function(e,t,{IDBKeyRange:r,indexedDB:n},i){const a=function(e,t){return t.reduce(((e,{create:t})=>({...e,...t(e)})),e)}(Ys(t,r,i),e.dbcore);return{dbcore:a}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach((t=>{const r=t.name;e.core.schema.tables.some((e=>e.name===r))&&(t.core=e.core.table(r),e[r]instanceof e.Table&&(e[r].core=t.core))}))}function Js({_novip:e},t,r,n){r.forEach((r=>{const i=n[r];t.forEach((t=>{const n=ni(t,r);(!n||"value"in n&&void 0===n.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?ei(t,r,{get(){return this.table(r)},set(e){Zn(this,r,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[r]=new e.Table(r,i))}))}))}function Zs({_novip:e},t){t.forEach((t=>{for(let r in t)t[r]instanceof e.Table&&delete t[r]}))}function eo(e,t){return e._cfg.version-t._cfg.version}function to(e,t,r,n){const i=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,i);a.create(r),a._completion.catch(n);const s=a._reject.bind(a),o=Aa.transless||Aa;qa((()=>{Aa.trans=a,Aa.transless=o,0===t?(Wn(i).forEach((e=>{no(r,e,i[e].primKey,i[e].indexes)})),Ks(e,r),wa.follow((()=>e.on.populate.fire(a))).catch(s)):function({_novip:e},t,r,n){const i=[],a=e._versions;let s=e._dbSchema=ao(0,e.idbdb,n),o=!1;return a.filter((e=>e._cfg.version>=t)).forEach((a=>{i.push((()=>{const i=s,l=a._cfg.dbschema;so(e,i,n),so(e,l,n),s=e._dbSchema=l;const c=ro(i,l);c.add.forEach((e=>{no(n,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((e=>{if(e.recreate)throw new Vi.Upgrade("Not yet support for changing primary key");{const t=n.objectStore(e.name);e.add.forEach((e=>io(t,e))),e.change.forEach((e=>{t.deleteIndex(e.name),io(t,e)})),e.del.forEach((e=>t.deleteIndex(e)))}}));const u=a._cfg.contentUpgrade;if(u&&a._cfg.version>t){Ks(e,n),r._memoizedTables={},o=!0;let t=di(l);c.del.forEach((e=>{t[e]=i[e]})),Zs(e,[e.Transaction.prototype]),Js(e,[e.Transaction.prototype],Wn(t),t),r.schema=t;const a=Ti(u);let s;a&&Qa();const h=wa.follow((()=>{if(s=u(r),s&&a){var e=Xa.bind(null,null);s.then(e,e)}}));return s&&"function"==typeof s.then?wa.resolve(s):h.then((()=>s))}})),i.push((t=>{o&&ls||function(e,t){[].slice.call(t.db.objectStoreNames).forEach((r=>null==e[r]&&t.db.deleteObjectStore(r)))}(a._cfg.dbschema,t),Zs(e,[e.Transaction.prototype]),Js(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),r.schema=e._dbSchema}))})),function e(){return i.length?wa.resolve(i.shift()(r.idbtrans)).then(e):wa.resolve()}().then((()=>{var e,t;t=n,Wn(e=s).forEach((r=>{t.db.objectStoreNames.contains(r)||no(t,r,e[r].primKey,e[r].indexes)}))}))}(e,t,a,r).catch(s)}))}function ro(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const i=e[n],a=t[n];if(i){const e={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!os)e.recreate=!0,r.change.push(e);else{const t=i.idxByName,n=a.idxByName;let s;for(s in t)n[s]||e.del.push(s);for(s in n){const r=t[s],i=n[s];r?r.src!==i.src&&e.change.push(i):e.add.push(i)}(e.del.length>0||e.add.length>0||e.change.length>0)&&r.change.push(e)}}else r.add.push([n,a])}return r}function no(e,t,r,n){const i=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach((e=>io(i,e))),i}function io(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ao(e,t,r){const n={};return ai(t.objectStoreNames,0).forEach((e=>{const t=r.objectStore(e);let i=t.keyPath;const a=Vs(qs(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),s=[];for(let e=0;e<t.indexNames.length;++e){const r=t.index(t.indexNames[e]);i=r.keyPath;var o=Vs(r.name,i,!!r.unique,!!r.multiEntry,!1,i&&"string"!=typeof i,!1);s.push(o)}n[e]=Qs(e,a,s)})),n}function so({_novip:e},t,r){const n=r.db.objectStoreNames;for(let i=0;i<n.length;++i){const a=n[i],s=r.objectStore(a);e._hasGetAll="getAll"in s;for(let e=0;e<s.indexNames.length;++e){const r=s.indexNames[e],n=s.index(r).keyPath,i="string"==typeof n?n:"["+ai(n).join("+")+"]";if(t[a]){const e=t[a].idxByName[i];e&&(e.name=r,delete t[a].idxByName[i],t[a].idxByName[r]=e)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Xn.WorkerGlobalScope&&Xn instanceof Xn.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class oo{_parseStoresSpec(e,t){Wn(e).forEach((r=>{if(null!==e[r]){var n=e[r].split(",").map(((e,t)=>{const r=(e=e.trim()).replace(/([&*]|\+\+)/g,""),n=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Vs(r,n||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),$n(n),0===t)})),i=n.shift();if(i.multi)throw new Vi.Schema("Primary key cannot be multi-valued");n.forEach((e=>{if(e.auto)throw new Vi.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Vi.Schema("Index must have a name and cannot be an empty string")})),t[r]=Qs(r,i,n)}}))}stores(e){const t=this.db;this._cfg.storesSource=this._cfg.storesSource?Hn(this._cfg.storesSource,e):e;const r=t._versions,n={};let i={};return r.forEach((e=>{Hn(n,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(n,i)})),t._dbSchema=i,Zs(t,[t._allTables,t,t.Transaction.prototype]),Js(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],Wn(i),i),t._storeNames=Wn(i),this}upgrade(e){return this._cfg.contentUpgrade=Zi(this._cfg.contentUpgrade||Xi,e),this}}function lo(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Po("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function co(e){return e&&"function"==typeof e.databases}function uo(e){return qa((function(){return Aa.letThrough=!0,e()}))}function ho(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function fo(e){var t=t=>e.next(t),r=i(t),n=i((t=>e.throw(t)));function i(e){return t=>{var i=e(t),a=i.value;return i.done?a:a&&"function"==typeof a.then?a.then(r,n):$n(a)?Promise.all(a).then(r,n):r(a)}}return i(t)()}function mo(e,t,r){var n=arguments.length;if(n<2)throw new Vi.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var a=mi(i);return[e,a,r]}function po(e,t,r,n,i){return wa.resolve().then((()=>{const a=Aa.transless||Aa,s=e._createTransaction(t,r,e._dbSchema,n),o={trans:s,transless:a};if(n)s.idbtrans=n.idbtrans;else try{s.create(),e._state.PR1398_maxLoop=3}catch(n){return n.name===Ui.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>po(e,t,r,null,i)))):rs(n)}const l=Ti(i);let c;l&&Qa();const u=wa.follow((()=>{if(c=i.call(s,s),c)if(l){var e=Xa.bind(null,null);c.then(e,e)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=fo(c))}),o);return(c&&"function"==typeof c.then?wa.resolve(c).then((e=>s.active?e:rs(new Vi.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn")))):u.then((()=>c))).then((e=>(n&&s._resolve(),s._completion.then((()=>e))))).catch((e=>(s._reject(e),rs(e))))}))}function go(e,t,r){const n=$n(e)?e.slice():[e];for(let e=0;e<r;++e)n.push(t);return n}const Ao={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,i={},a=[];function s(e,t,r){const n=Gs(e),o=i[n]=i[n]||[],l=null==e?0:"string"==typeof e?1:e.length,c=t>0,u={...r,isVirtual:c,keyTail:t,keyLength:l,extractKey:Ws(e),unique:!c&&r.unique};return o.push(u),u.isPrimaryKey||a.push(u),l>1&&s(2===l?e[0]:e.slice(0,l-1),t+1,r),o.sort(((e,t)=>e.keyTail-t.keyTail)),u}const o=s(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[o];for(const e of n.indexes)s(e.keyPath,0,e);function l(t){const r=t.query.index;return r.isVirtual?{...t,query:{index:r,range:(n=t.query.range,i=r.keyTail,{type:1===n.type?2:n.type,lower:go(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:go(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}:t;var n,i}const c={...r,schema:{...n,primaryKey:o,indexes:a,getIndexByKeyPath:function(e){const t=i[Gs(e)];return t&&t[0]}},count:e=>r.count(l(e)),query:e=>r.query(l(e)),openCursor(t){const{keyTail:n,isVirtual:i,keyLength:a}=t.query.index;return i?r.openCursor(l(t)).then((r=>r&&function(r){const i=Object.create(r,{continue:{value:function(i){null!=i?r.continue(go(i,t.reverse?e.MAX_KEY:e.MIN_KEY,n)):t.unique?r.continue(r.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,n)):r.continue()}},continuePrimaryKey:{value(t,i){r.continuePrimaryKey(go(t,e.MAX_KEY,n),i)}},primaryKey:{get:()=>r.primaryKey},key:{get(){const e=r.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:()=>r.value}});return i}(r))):r.openCursor(t)}};return c}}}};function vo(e,t,r,n){return r=r||{},n=n||"",Wn(e).forEach((i=>{if(Kn(t,i)){var a=e[i],s=t[i];if("object"==typeof a&&"object"==typeof s&&a&&s){const e=wi(a);e!==wi(s)?r[n+i]=t[i]:"Object"===e?vo(a,s,r,n+i+"."):a!==s&&(r[n+i]=t[i])}else a!==s&&(r[n+i]=t[i])}else r[n+i]=void 0})),Wn(t).forEach((i=>{Kn(e,i)||(r[n+i]=t[i])})),r}const bo={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema,i={...r,mutate(e){const i=Aa.trans,{deleting:a,creating:s,updating:o}=i.table(t).hook;switch(e.type){case"add":if(s.fire===Xi)break;return i._promise("readwrite",(()=>l(e)),!0);case"put":if(s.fire===Xi&&o.fire===Xi)break;return i._promise("readwrite",(()=>l(e)),!0);case"delete":if(a.fire===Xi)break;return i._promise("readwrite",(()=>l(e)),!0);case"deleteRange":if(a.fire===Xi)break;return i._promise("readwrite",(()=>function(e){return c(e.trans,e.range,1e4)}(e)),!0)}return r.mutate(e);function l(e){const t=Aa.trans,i=e.keys||function(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}(n,e);if(!i)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?{...e,keys:i}:{...e}).type&&(e.values=[...e.values]),e.keys&&(e.keys=[...e.keys]),function(e,t,r){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:r,cache:"immutable"})}(r,e,i).then((l=>{const c=i.map(((r,i)=>{const c=l[i],u={onerror:null,onsuccess:null};if("delete"===e.type)a.fire.call(u,r,c,t);else if("add"===e.type||void 0===c){const a=s.fire.call(u,r,e.values[i],t);null==r&&null!=a&&(r=a,e.keys[i]=r,n.outbound||hi(e.values[i],n.keyPath,r))}else{const n=vo(c,e.values[i]),a=o.fire.call(u,n,r,c,t);if(a){const t=e.values[i];Object.keys(a).forEach((e=>{Kn(t,e)?t[e]=a[e]:hi(t,e,a[e])}))}}return u}));return r.mutate(e).then((({failures:t,results:r,numFailures:n,lastResult:a})=>{for(let n=0;n<i.length;++n){const a=r?r[n]:i[n],s=c[n];null==a?s.onerror&&s.onerror(t[n]):s.onsuccess&&s.onsuccess("put"===e.type&&l[n]?e.values[n]:a)}return{failures:t,results:r,numFailures:n,lastResult:a}})).catch((e=>(c.forEach((t=>t.onerror&&t.onerror(e))),Promise.reject(e))))}))}function c(e,t,i){return r.query({trans:e,values:!1,query:{index:n,range:t},limit:i}).then((({result:r})=>l({type:"delete",keys:r,trans:e}).then((n=>n.numFailures>0?Promise.reject(n.failures[0]):r.length<i?{failures:[],numFailures:0,lastResult:void 0}:c(e,{...t,lower:r[r.length-1],lowerOpen:!0},i)))))}}};return i}})};function yo(e,t,r){try{if(!t)return null;if(t.keys.length<e.length)return null;const n=[];for(let i=0,a=0;i<t.keys.length&&a<e.length;++i)0===xs(t.keys[i],e[a])&&(n.push(r?vi(t.values[i]):t.values[i]),++a);return n.length===e.length?n:null}catch(e){return null}}const wo={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:e=>{if(!e.cache)return r.getMany(e);const t=yo(e.keys,e.trans._cache,"clone"===e.cache);return t?wa.resolve(t):r.getMany(e).then((t=>(e.trans._cache={keys:e.keys,values:"clone"===e.cache?vi(t):t},t)))},mutate:e=>("add"!==e.type&&(e.trans._cache=null),r.mutate(e))}}})};function _o(e){return!("from"in e)}const Eo=function(e,t){if(!this){const t=new Eo;return e&&"d"in e&&Hn(t,e),t}Hn(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function xo(e,t,r){const n=xs(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(_o(e))return Hn(e,{from:t,to:r,d:1});const i=e.l,a=e.r;if(xs(r,e.from)<0)return i?xo(i,t,r):e.l={from:t,to:r,d:1,l:null,r:null},ko(e);if(xs(t,e.to)>0)return a?xo(a,t,r):e.r={from:t,to:r,d:1,l:null,r:null},ko(e);xs(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),xs(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const s=!e.r;i&&!e.l&&So(e,i),a&&s&&So(e,a)}function So(e,t){_o(t)||function e(t,{from:r,to:n,l:i,r:a}){xo(t,r,n),i&&e(t,i),a&&e(t,a)}(e,t)}function To(e){let t=_o(e)?null:{s:0,n:e};return{next(e){const r=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&xs(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||xs(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function ko(e){var t,r;const n=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(r=e.l)||void 0===r?void 0:r.d)||0),i=n>1?"r":n<-1?"l":"";if(i){const t="r"===i?"l":"r",r={...e},n=e[i];e.from=n.from,e.to=n.to,e[i]=n[i],r[i]=n[t],e[t]=r,r.d=Io(r)}e.d=Io(e)}function Io({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Jn(Eo.prototype,{add(e){return So(this,e),this},addKey(e){return xo(this,e,e),this},addKeys(e){return e.forEach((e=>xo(this,e,e))),this},[_i](){return To(this)}});const Co={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new Eo(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const i=e.table(n),{schema:a}=i,{primaryKey:s}=a,{extractKey:o,outbound:l}=s,c={...i,mutate:e=>{const s=e.trans,o=s.mutatedParts||(s.mutatedParts={}),l=e=>{const r=`idb://${t}/${n}/${e}`;return o[r]||(o[r]=new Eo)},c=l(""),u=l(":dels"),{type:h}=e;let[d,f]="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[];const m=e.trans._cache;return i.mutate(e).then((e=>{if($n(d)){"delete"!==h&&(d=e.results),c.addKeys(d);const t=yo(d,m);t||"add"===h||u.addKeys(d),(t||f)&&function(e,t,r,n){t.indexes.forEach((function(t){const i=e(t.name||"");function a(e){return null!=e?t.extractKey(e):null}const s=e=>t.multiEntry&&$n(e)?e.forEach((e=>i.addKey(e))):i.addKey(e);(r||n).forEach(((e,t)=>{const i=r&&a(r[t]),o=n&&a(n[t]);0!==xs(i,o)&&(null!=i&&s(i),null!=o&&s(o))}))}))}(l,a,t,f)}else if(d){const e={from:d.lower,to:d.upper};u.add(e),c.add(e)}else c.add(r),u.add(r),a.indexes.forEach((e=>l(e.name).add(r)));return e}))}},u=({query:{index:t,range:r}})=>{var n,i;return[t,new Eo(null!==(n=r.lower)&&void 0!==n?n:e.MIN_KEY,null!==(i=r.upper)&&void 0!==i?i:e.MAX_KEY)]},h={get:e=>[s,new Eo(e.key)],getMany:e=>[s,(new Eo).addKeys(e.keys)],count:u,query:u,openCursor:u};return Wn(h).forEach((e=>{c[e]=function(a){const{subscr:s}=Aa;if(s){const c=e=>{const r=`idb://${t}/${n}/${e}`;return s[r]||(s[r]=new Eo)},u=c(""),d=c(":dels"),[f,m]=h[e](a);if(c(f.name||"").add(m),!f.isPrimaryKey){if("count"!==e){const t="query"===e&&l&&a.values&&i.query({...a,values:!1});return i[e].apply(this,arguments).then((r=>{if("query"===e){if(l&&a.values)return t.then((({result:e})=>(u.addKeys(e),r)));const e=a.values?r.result.map(o):r.result;a.values?u.addKeys(e):d.addKeys(e)}else if("openCursor"===e){const e=r,t=a.values;return e&&Object.create(e,{key:{get:()=>(d.addKey(e.primaryKey),e.key)},primaryKey:{get(){const t=e.primaryKey;return d.addKey(t),t}},value:{get:()=>(t&&u.addKey(e.primaryKey),e.value)}})}return r}))}d.add(r)}}return i[e].apply(this,arguments)}})),c}}}};class Po{constructor(e,t){this._middlewares={},this.verno=0;const r=Po.dependencies;this._options=t={addons:Po.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};const{addons:n}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Xi,dbReadyPromise:null,cancelOpen:Xi,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;i.dbReadyPromise=new wa((e=>{i.dbReadyResolve=e})),i.openCanceller=new wa(((e,t)=>{i.cancelOpen=t})),this._state=i,this.name=e,this.on=ps(this,"populate","blocked","versionchange","close",{ready:[Zi,Xi]}),this.on.ready.subscribe=si(this.on.ready.subscribe,(e=>(t,r)=>{Po.vip((()=>{const n=this._state;if(n.openComplete)n.dbOpenError||wa.resolve().then(t),r&&e(t);else if(n.onReadyBeingFired)n.onReadyBeingFired.push(t),r&&e(t);else{e(t);const n=this;r||e((function e(){n.on.ready.unsubscribe(t),n.on.ready.unsubscribe(e)}))}}))})),this.Collection=(a=this,gs(ks.prototype,(function(e,t){this.db=a;let r=ds,n=null;if(t)try{r=t()}catch(e){n=e}const i=e._ctx,s=i.table,o=s.hook.reading.fire;this._ctx={table:s,index:i.index,isPrimKey:!i.index||s.schema.primKey.keyPath&&i.index===s.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:i.or,valueMapper:o!==Wi?o:null}}))),this.Table=function(e){return gs(ms.prototype,(function(t,r,n){this.db=e,this._tx=n,this.name=t,this.schema=r,this.hook=e._allTables[t]?e._allTables[t].hook:ps(null,{creating:[Gi,Xi],reading:[$i,Wi],updating:[Ki,Xi],deleting:[Yi,Xi]})}))}(this),this.Transaction=function(e){return gs(js.prototype,(function(t,r,n,i,a){this.db=e,this.mode=t,this.storeNames=r,this.schema=n,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=ps(this,"complete","error","abort"),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new wa(((e,t)=>{this._resolve=e,this._reject=t})),this._completion.then((()=>{this.active=!1,this.on.complete.fire()}),(e=>{var t=this.active;return this.active=!1,this.on.error.fire(e),this.parent?this.parent._reject(e):t&&this.idbtrans&&this.idbtrans.abort(),rs(e)}))}))}(this),this.Version=function(e){return gs(oo.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return gs(Os.prototype,(function(t,r,n){this.db=e,this._ctx={table:t,index:":id"===r?null:r,or:n};const i=e._deps.indexedDB;if(!i)throw new Vi.MissingAPI;this._cmp=this._ascending=i.cmp.bind(i),this._descending=(e,t)=>i.cmp(t,e),this._max=(e,t)=>i.cmp(e,t)>0?e:t,this._min=(e,t)=>i.cmp(e,t)<0?e:t,this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(e=>{e.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()})),this.on("blocked",(e=>{!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${e.oldVersion/10}`)})),this._maxKey=Xs(t.IDBKeyRange),this._createTransaction=(e,t,r,n)=>new this.Transaction(e,t,r,this._options.chromeTransactionDurability,n),this._fireOnBlocked=e=>{this.on("blocked").fire(e),ss.filter((e=>e.name===this.name&&e!==this&&!e._state.vcFired)).map((t=>t.on("versionchange").fire(e)))},this.use(Ao),this.use(bo),this.use(Co),this.use(wo),this.vip=Object.create(this,{_vip:{value:!0}}),n.forEach((e=>e(this)))}version(e){if(isNaN(e)||e<.1)throw new Vi.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Vi.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const t=this._versions;var r=t.filter((t=>t._cfg.version===e))[0];return r||(r=new this.Version(e),t.push(r),t.sort(eo),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||Aa.letThrough||this._vip)?e():new wa(((e,t)=>{if(this._state.openComplete)return t(new Vi.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void t(new Vi.DatabaseClosed);this.open().catch(Xi)}this._state.dbReadyPromise.then(e,t)})).then(e)}use({stack:e,create:t,level:r,name:n}){n&&this.unuse({stack:e,name:n});const i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:t,level:null==r?10:r,name:n}),i.sort(((e,t)=>e.level-t.level)),this}unuse({stack:e,name:t,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((e=>r?e.create!==r:!!t&&e.name!==t))),this}open(){return function(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((()=>t.dbOpenError?rs(t.dbOpenError):e));ki&&(t.openCanceller._stackHolder=Mi()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function i(){if(t.openCanceller!==n)throw new Vi.DatabaseClosed("db.open() was cancelled")}let a=t.dbReadyResolve,s=null,o=!1;return wa.race([n,("undefined"==typeof navigator?wa.resolve():ho()).then((()=>new wa(((n,a)=>{if(i(),!r)throw new Vi.MissingAPI;const l=e.name,c=t.autoSchema?r.open(l):r.open(l,Math.round(10*e.verno));if(!c)throw new Vi.MissingAPI;c.onerror=zs(a),c.onblocked=Na(e._fireOnBlocked),c.onupgradeneeded=Na((n=>{if(s=c.transaction,t.autoSchema&&!e._options.allowEmptyDB){c.onerror=Fs,s.abort(),c.result.close();const e=r.deleteDatabase(l);e.onsuccess=e.onerror=Na((()=>{a(new Vi.NoSuchDatabase(`Database ${l} doesnt exist`))}))}else{s.onerror=zs(a);var i=n.oldVersion>Math.pow(2,62)?0:n.oldVersion;o=i<1,e._novip.idbdb=c.result,to(e,i/10,s,a)}}),a),c.onsuccess=Na((()=>{s=null;const r=e._novip.idbdb=c.result,i=ai(r.objectStoreNames);if(i.length>0)try{const n=r.transaction(1===(a=i).length?a[0]:a,"readonly");t.autoSchema?function({_novip:e},t,r){e.verno=t.version/10;const n=e._dbSchema=ao(0,t,r);e._storeNames=ai(t.objectStoreNames,0),Js(e,[e._allTables],Wn(n),n)}(e,r,n):(so(e,e._dbSchema,n),function(e,t){const r=ro(ao(0,e.idbdb,t),e._dbSchema);return!(r.add.length||r.change.some((e=>e.add.length||e.change.length)))}(e,n)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Ks(e,n)}catch(e){}var a;ss.push(e),r.onversionchange=Na((r=>{t.vcFired=!0,e.on("versionchange").fire(r)})),r.onclose=Na((t=>{e.on("close").fire(t)})),o&&function({indexedDB:e,IDBKeyRange:t},r){!co(e)&&"__dbnames"!==r&&lo(e,t).put({name:r}).catch(Xi)}(e._deps,l),n()}),a)}))))]).then((()=>(i(),t.onReadyBeingFired=[],wa.resolve(uo((()=>e.on.ready.fire(e.vip)))).then((function r(){if(t.onReadyBeingFired.length>0){let n=t.onReadyBeingFired.reduce(Zi,Xi);return t.onReadyBeingFired=[],wa.resolve(uo((()=>n(e.vip)))).then(r)}}))))).finally((()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((()=>e)).catch((r=>{t.dbOpenError=r;try{s&&s.abort()}catch(e){}return n===t.openCanceller&&e._close(),rs(r)})).finally((()=>{t.openComplete=!0,a()}))}(this)}_close(){const e=this._state,t=ss.indexOf(this);if(t>=0&&ss.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new wa((t=>{e.dbReadyResolve=t})),e.openCanceller=new wa(((t,r)=>{e.cancelOpen=r}))}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new Vi.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,t=this._state;return new wa(((r,n)=>{const i=()=>{this.close();var e=this._deps.indexedDB.deleteDatabase(this.name);e.onsuccess=Na((()=>{!function({indexedDB:e,IDBKeyRange:t},r){!co(e)&&"__dbnames"!==r&&lo(e,t).delete(r).catch(Xi)}(this._deps,this.name),r()})),e.onerror=zs(n),e.onblocked=this._fireOnBlocked};if(e)throw new Vi.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(i):i()}))}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Wn(this._allTables).map((e=>this._allTables[e]))}transaction(){const e=mo.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,r){let n=Aa.trans;n&&n.db===this&&-1===e.indexOf("!")||(n=null);const i=-1!==e.indexOf("?");let a,s;e=e.replace("!","").replace("?","");try{if(s=t.map((e=>{var t=e instanceof this.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)a="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new Vi.InvalidArgument("Invalid transaction mode: "+e);a="readwrite"}if(n){if("readonly"===n.mode&&"readwrite"===a){if(!i)throw new Vi.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");n=null}n&&s.forEach((e=>{if(n&&-1===n.storeNames.indexOf(e)){if(!i)throw new Vi.SubTransaction("Table "+e+" not included in parent transaction.");n=null}})),i&&n&&!n.active&&(n=null)}}catch(e){return n?n._promise(null,((t,r)=>{r(e)})):rs(e)}const o=po.bind(null,this,a,s,n,r);return n?n._promise(a,o,"lock"):Aa.trans?Ka(Aa.transless,(()=>this._whenReady(o))):this._whenReady(o)}table(e){if(!Kn(this._allTables,e))throw new Vi.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Mo="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";class Ro{constructor(e){this._subscribe=e}subscribe(e,t,r){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:r})}[Mo](){return this}}function Bo(e,t){return Wn(t).forEach((r=>{So(e[r]||(e[r]=new Eo),t[r])})),e}function Lo(e){return new Ro((t=>{const r=Ti(e);let n=!1,i={},a={};const s={get closed(){return n},unsubscribe:()=>{n=!0,Us.storagemutated.unsubscribe(u)}};t.start&&t.start(s);let o=!1,l=!1;function c(){return Wn(a).some((e=>i[e]&&function(e,t){const r=To(t);let n=r.next();if(n.done)return!1;let i=n.value;const a=To(e);let s=a.next(i.from),o=s.value;for(;!n.done&&!s.done;){if(xs(o.from,i.to)<=0&&xs(o.to,i.from)>=0)return!0;xs(i.from,o.from)<0?i=(n=r.next(o.from)).value:o=(s=a.next(i.from)).value}return!1}(i[e],a[e])))}const u=e=>{Bo(i,e),c()&&h()},h=()=>{if(o||n)return;i={};const d={},f=function(t){r&&Qa();const n=()=>qa(e,{subscr:t,trans:null}),i=Aa.trans?Ka(Aa.transless,n):n();return r&&i.then(Xa,Xa),i}(d);l||(Us("storagemutated",u),l=!0),o=!0,Promise.resolve(f).then((e=>{o=!1,n||(c()?h():(i={},a=d,t.next&&t.next(e)))}),(e=>{o=!1,t.error&&t.error(e),s.unsubscribe()}))};return h(),s}))}let Do;try{Do={indexedDB:Xn.indexedDB||Xn.mozIndexedDB||Xn.webkitIndexedDB||Xn.msIndexedDB,IDBKeyRange:Xn.IDBKeyRange||Xn.webkitIDBKeyRange}}catch(Xn){Do={indexedDB:null,IDBKeyRange:null}}const No=Po;function Oo(e){let t=zo;try{zo=!0,Us.storagemutated.fire(e)}finally{zo=t}}Jn(No,{...Qi,delete:e=>new No(e,{addons:[]}).delete(),exists:e=>new No(e,{addons:[]}).open().then((e=>(e.close(),!0))).catch("NoSuchDatabaseError",(()=>!1)),getDatabaseNames(e){try{return function({indexedDB:e,IDBKeyRange:t}){return co(e)?Promise.resolve(e.databases()).then((e=>e.map((e=>e.name)).filter((e=>"__dbnames"!==e)))):lo(e,t).toCollection().primaryKeys()}(No.dependencies).then(e)}catch(e){return rs(new Vi.MissingAPI)}},defineClass:()=>function(e){Hn(this,e)},ignoreTransaction:e=>Aa.trans?Ka(Aa.transless,e):e(),vip:uo,async:function(e){return function(){try{var t=fo(e.apply(this,arguments));return t&&"function"==typeof t.then?t:wa.resolve(t)}catch(e){return rs(e)}}},spawn:function(e,t,r){try{var n=fo(e.apply(r,t||[]));return n&&"function"==typeof n.then?n:wa.resolve(n)}catch(e){return rs(e)}},currentTransaction:{get:()=>Aa.trans||null},waitFor:function(e,t){const r=wa.resolve("function"==typeof e?No.ignoreTransaction(e):e).timeout(t||6e4);return Aa.trans?Aa.trans.waitFor(r):r},Promise:wa,debug:{get:()=>ki,set:e=>{Ii(e,"dexie"===e?()=>!0:us)}},derive:ti,extend:Hn,props:Jn,override:si,Events:ps,on:Us,liveQuery:Lo,extendObservabilitySet:Bo,getByKeyPath:ui,setByKeyPath:hi,delByKeyPath:function(e,t){"string"==typeof t?hi(e,t,void 0):"length"in t&&[].map.call(t,(function(t){hi(e,t,void 0)}))},shallowClone:di,deepClone:vi,getObjectDiff:vo,cmp:xs,asap:li,minKey:-1/0,addons:[],connections:ss,errnames:Ui,dependencies:Do,semVer:"3.2.2",version:"3.2.2".split(".").map((e=>parseInt(e))).reduce(((e,t,r)=>e+t/Math.pow(10,2*r)))}),No.maxKey=Xs(No.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Us("storagemutated",(e=>{if(!zo){let t;os?(t=document.createEvent("CustomEvent"),t.initCustomEvent("x-storagemutated-1",!0,!0,e)):t=new CustomEvent("x-storagemutated-1",{detail:e}),zo=!0,dispatchEvent(t),zo=!1}})),addEventListener("x-storagemutated-1",(({detail:e})=>{zo||Oo(e)})));let zo=!1;if("undefined"!=typeof BroadcastChannel){const e=new BroadcastChannel("x-storagemutated-1");Us("storagemutated",(t=>{zo||e.postMessage(t)})),e.onmessage=e=>{e.data&&Oo(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){Us("storagemutated",(e=>{try{zo||("undefined"!=typeof localStorage&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach((t=>t.postMessage({type:"x-storagemutated-1",changedParts:e}))))}catch(e){}})),"undefined"!=typeof addEventListener&&addEventListener("storage",(e=>{if("x-storagemutated-1"===e.key){const t=JSON.parse(e.newValue);t&&Oo(t.changedParts)}}));const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",(function({data:e}){e&&"x-storagemutated-1"===e.type&&Oo(e.changedParts)}))}wa.rejectionMapper=function(e,t){if(!e||e instanceof Ni||e instanceof TypeError||e instanceof SyntaxError||!e.name||!qi[e.name])return e;var r=new qi[e.name](t||e.message,e);return"stack"in e&&ei(r,"stack",{get:function(){return this.inner.stack}}),r},Ii(ki,us);var Fo=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module:localdb/listens");const Uo=new le("localdb/listens"),jo=[],Vo=new tr(jo),qo=new class extends Po{constructor(){super("ampcast/listens"),this.version(1).stores({items:"&playedAt, src, lastfmScrobbledAt, listenbrainzScrobbledAt"})}};function Qo(){return Vo.pipe(kt((e=>e!==jo)))}function Xo(e){return Fo(this,void 0,void 0,(function*(){try{e.length>0&&(yield qo.items.bulkPut(e))}catch(e){Uo.error(e)}}))}function Wo(e,t=30){return Math.round(e.playedAt/t)}function $o(e,t,r=5){const n=t.playedAt,i=n-r,a=n+t.duration+r;for(const r of e){if(r.playedAt<i)return;if(r.playedAt>i&&r.playedAt<a&&Yo(t,r,.75))return r}}function Ho(e){if(e.itemType===Yt.Media){const t=Go().find((t=>{return e.playableSrc===t.src||e.playableUrl&&e.playableUrl===t.externalUrl||e.isrc&&e.isrc===t.isrc||e.recording_mbid&&e.recording_mbid===t.recording_mbid||(n=t,!(!(r=e).artist||!n.artist)&&Pe(r.artist,n.artist,undefined)&&Yo(e,t));var r,n}))||function(e,t=5){const r=e.playedAt;if(!r)return;const n=Go();for(let i=0;i<n.length;i++){const a=n[i-1];if(a&&a.playedAt<r)return;const s=n[i],o=s.playedAt-t,l=s.playedAt+s.duration+t;if(r>o&&r<l&&Yo(s,e,.75))return s}}(e);if(t)return Object.assign(Object.assign({},e),{playableSrc:t.src,playableUrl:t.externalUrl,duration:t.duration,thumbnails:t.thumbnails||e.thumbnails})}return e}function Go(){return Vo.getValue()}function Yo(e,t,r){return Pe(e.title,t.title,r)}function Ko(e){return Fo(this,void 0,void 0,(function*(){const t=`${e}ScrobbledAt`,r=Math.floor(Date.now()/1e3)-1209600,n=yield qo.items.where(t).equals(0).toArray();yield Xo(n.filter((e=>e.playedAt<r)).map((e=>Object.assign(Object.assign({},e),{[t]:-1}))))}))}function Jo(e){return new Promise(((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)}))}function Zo(e,t){const r=indexedDB.open(e);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Jo(r);return(e,r)=>n.then((n=>r(n.transaction(t,e).objectStore(t))))}let el;function tl(){return el||(el=Zo("keyval-store","keyval")),el}function rl(e,t=tl()){return t("readonly",(t=>Jo(t.get(e))))}function nl(e,t,r=tl()){return r("readwrite",(r=>(r.put(t,e),Jo(r.transaction))))}Fo(void 0,void 0,void 0,(function*(){try{yield Ko("lastfm"),yield Ko("listenbrainz")}catch(e){Uo.error(e)}Lo((()=>qo.items.orderBy("playedAt").reverse().toArray())).subscribe(Vo)}));var il=__webpack_require__(2463),al=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function sl(e){var t,r,n,i,a;return al(this,void 0,void 0,(function*(){let s;try{s=yield(0,il.Aj)(e,{duration:!0,skipCovers:!0})}catch(t){console.log(`Error parsing file: ${e.name}`),console.log(`music-metadata says: ${t}`),s={format:{},common:{}}}const{common:o,format:l}=s,c=e.type.startsWith("video"),u=l.duration||(yield function(e){return al(this,void 0,void 0,(function*(){return new Promise((t=>{const r=e.type.startsWith("video"),n=document.createElement(r?"video":"audio"),i=URL.createObjectURL(e),a=()=>{const e=n.error?0:n.duration;n.ondurationchange=null,n.onerror=null,n.src="",n.removeAttribute("src"),URL.revokeObjectURL(i),t(e)};n.ondurationchange=a,n.onerror=a,n.onended=a,n.muted=!0,n.src=i}))}))}(e)),h=(e=0)=>Math.floor(Number(e))||0;return{id:"",itemType:Yt.Media,mediaType:c?yr.Video:yr.Audio,src:`blob:${en()}`,title:o.title||e.name.replace(/\.\w+$/,""),artist:o.artist||(null===(t=o.artists)||void 0===t?void 0:t.join(";"))||"",albumArtist:o.album&&o.albumartist||"",album:o.album||"",genre:(null===(r=o.genre)||void 0===r?void 0:r.join(";"))||"",duration:u?Number(u.toFixed(3)):0,track:h(null===(n=o.track)||void 0===n?void 0:n.no),disc:h(null===(i=o.disk)||void 0===i?void 0:i.no),bpm:h(o.bpm),year:h(o.year),mood:o.mood||"",rating:Number(o.rating)||0,isrc:null===(a=o.isrc)||void 0===a?void 0:a[0],recording_mbid:o.musicbrainz_recordingid,playedAt:0,blob:e}}))}const ol=new fe("playlist"),ll=new tr(ol.getJson("settings",{allowDuplicates:!0,showLineNumbers:!0,zeroPadLineNumbers:!0,showSourceIcons:!0})),cl=function(){return ll},ul=function(){return ll.getValue()},hl=function(e){ol.setJson("settings",e),ll.next(e)};var dl=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::playlist");const fl=Zo("ampcast/playlist","keyval"),ml=[],pl=new tr(ml),gl=new tr("");function Al(){var e;return dl(this,void 0,void 0,(function*(){if(pl.getValue()===ml){const t=null!==(e=yield rl("items",fl))&&void 0!==e?e:[];pl.next(t)}return pl.getValue()}))}function vl(e){return dl(this,void 0,void 0,(function*(){e=e.concat(),yield nl("items",e,fl),pl.next(e),0!==e.length&&(bl()||yl(e[0].id))}))}function bl(){return gl.getValue()}function yl(e){return dl(this,void 0,void 0,(function*(){yield nl("currently-playing-id",e,fl),gl.next(e)}))}function wl(e){return dl(this,void 0,void 0,(function*(){yield yl(e.id)}))}function _l(){return gl.pipe(qn(pl),at((([e,t])=>{var r;return null!==(r=t.find((t=>t.id===e)))&&void 0!==r?r:null})),rr())}function El(){const e=pl.getValue(),t=bl();return e.findIndex((e=>e.id===t))}function xl(){return pl.getValue().length}function Sl(e){return dl(this,void 0,void 0,(function*(){const t=bl();if(t){const r=yield Al(),n=r.findIndex((e=>e.id===t));if(-1!==n){const t=r[n+e];t&&(yield wl(t))}}}))}function Tl(e,t){return dl(this,void 0,void 0,(function*(){const r=yield Al(),n=ul().allowDuplicates;let i=yield function(e){return dl(this,void 0,void 0,(function*(){const t=e=>"itemType"in e&&e.itemType===Yt.Album;let r=[];if(Array.isArray(e))if(t(e[0])){const t=yield Promise.all(e.map(Cl));for(const e of t)r=r.concat(e)}else r=yield Promise.all(e.map(Pl));else r=t(e)?yield Cl(e):e instanceof FileList?yield Promise.all(Array.from(e).map(sl)):[yield Pl(e)];return r.filter(Ce).map(Il)}))}(e);if(n||(i=i.filter((e=>-1===r.findIndex((t=>t.src===e.src))))),i.length>0){const e=i.map((e=>Object.assign(Object.assign({},e),{id:en()})));t>=0&&t<r.length?(r.splice(t,0,...e),yield vl(r)):yield vl(r.concat(e))}}))}function kl(e){return dl(this,void 0,void 0,(function*(){const t=yield Al(),r=Array.isArray(e)?e:[e],n=t.filter((e=>!r.includes(e)));if(n.length!==t.length){const e=bl(),t=n.findIndex((t=>t.id===e));-1===t&&(yield yl("")),yield vl(n)}}))}function Il(e){const[t]=e.src.split(":");switch(t){case"lastfm":case"listenbrainz":case"musicbrainz":if(e.playableSrc){const{playableSrc:t,playableUrl:r}=e,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["playableSrc","playableUrl"]);return Object.assign(Object.assign({},n),{src:t,externalUrl:r})}}return e}function Cl(e){return dl(this,void 0,void 0,(function*(){return Me(e.pager)}))}function Pl(e){return dl(this,void 0,void 0,(function*(){return e instanceof File?/^(audio|video)/.test(e.type)?sl(e):null:e}))}const Ml={get atEnd(){return El()===xl()-1},get atStart(){return 0===xl()||0===El()},observe:function(){return pl.pipe(kt((e=>e!==ml)))},observeCurrentItem:_l,observeCurrentIndex:function(){return gl.pipe(qn(pl),at((([e,t])=>t.findIndex((t=>t.id===e)))),rr())},observeSize:function(){return pl.pipe(at((e=>e.length)),rr())},getCurrentItem:function(){return dl(this,void 0,void 0,(function*(){const e=bl();return e&&(yield Al()).find((t=>t.id===e))||null}))},setCurrentItem:wl,add:function(e){return dl(this,void 0,void 0,(function*(){yield Tl(e,-1)}))},clear:function(){return dl(this,void 0,void 0,(function*(){yield vl([])}))},insertAt:Tl,moveSelection:function(e,t){return dl(this,void 0,void 0,(function*(){const r=yield Al(),n=r[t];if(e.includes(n))return;const i=r.filter((t=>!e.includes(t))),a=i.indexOf(n);a>=0?(i.splice(a,0,...e),yield vl(i)):yield vl(i.concat(e))}))},next:function(){return dl(this,void 0,void 0,(function*(){yield Sl(1)}))},prev:function(){return dl(this,void 0,void 0,(function*(){yield Sl(-1)}))},remove:kl,removeAt:function(e){return dl(this,void 0,void 0,(function*(){const t=yield function(e){var t;return dl(this,void 0,void 0,(function*(){const r=yield Al();return null!==(t=r[e])&&void 0!==t?t:null}))}(e);t&&(yield kl(t))}))},shuffle:function(){return dl(this,void 0,void 0,(function*(){const e=yield Al();let t=e.length;for(;t>0;){const r=Math.floor(Math.random()*t);t--;const n=e[t];e[t]=e[r],e[r]=n}yield vl(e)}))}};dl(void 0,void 0,void 0,(function*(){var e;yield Al();const t=null!==(e=yield rl("currently-playing-id",fl))&&void 0!==e?e:"";gl.next(t)}));var Rl={leading:!0,trailing:!1};function Bl(e,t,r){void 0===t&&(t=Ze),void 0===r&&(r=Rl);var i=rt(e,t);return function(e,t){return void 0===t&&(t=Rl),n((function(e,r){var n=t.leading,a=t.trailing,s=!1,o=null,l=null,c=!1,u=function(){null==l||l.unsubscribe(),l=null,a&&(f(),c&&r.complete())},h=function(){l=null,c&&r.complete()},d=function(e){return l=te(i).subscribe(F(r,u,h))},f=function(){if(s){s=!1;var e=o;o=null,r.next(e),!c&&d()}};e.subscribe(F(r,(function(e){s=!0,o=e,(!l||l.closed)&&(n?f():d())}),(function(){c=!0,(!(a&&s&&l)||l.closed)&&r.complete()})))}))}(0,r)}console.log("module::playback");const Ll=new tr({currentItem:null,currentTime:0,startedAt:0,endedAt:0,duration:0,paused:!0});function Dl(){return Ll}function Nl(){return Dl().pipe(kt((e=>0!==e.startedAt)),rr(((e,t)=>e.startedAt===t.startedAt)))}function Ol(){return Dl().pipe(kt((e=>0!==e.endedAt)),rr(((e,t)=>e.endedAt===t.endedAt)))}function zl(){return Dl().pipe(at((e=>e.paused)),rr())}function Fl(){const e=Ll.getValue();e.startedAt&&(e.endedAt||Ll.next(Object.assign(Object.assign({},e),{endedAt:Date.now()})),Ll.next(Object.assign(Object.assign({},e),{startedAt:0,endedAt:0})))}_l().subscribe((e=>{Fl(),Ll.next(Object.assign(Object.assign({},Ll.getValue()),{currentItem:e,currentTime:0,duration:(null==e?void 0:e.duration)||0,startedAt:0,endedAt:0}))}));const Ul={get paused(){return Ll.getValue().paused},observeState:Dl,observePlaybackStart:Nl,observePlaybackEnd:Ol,observePlaybackProgress:function(e=1e4){return Nl().pipe(It((()=>Dl().pipe(Bl(e,void 0,{trailing:!0}),ne(Ol())))))},observeCurrentTime:function(){return Dl().pipe(at((e=>e.currentTime)),rr())},observeDuration:function(){return Dl().pipe(at((e=>e.duration)),rr())},observePaused:zl,getCurrentTime:function(){return Ll.getValue().currentTime},setCurrentTime:function(e){const t=Ll.getValue();(e=Math.max(Math.min(Math.floor(isFinite(e)?e:0),t.duration),0))!==t.currentTime&&Ll.next(Object.assign(Object.assign({},t),{currentTime:e}))},getDuration:function(){return Ll.getValue().duration},setDuration:function(e){const t=Ll.getValue();if((e=Math.max(Math.floor(isFinite(e)?e:0),0))!==t.duration){const r=Math.min(t.currentTime,e);Ll.next(Object.assign(Object.assign({},t),{duration:e,currentTime:r}))}},play:function(){const e=Ll.getValue();e.currentItem&&e.paused&&Ll.next(Object.assign(Object.assign({},e),{paused:!1}))},pause:function(){const e=Ll.getValue();e.paused||Ll.next(Object.assign(Object.assign({},e),{paused:!0}))},stop:function(){const e=Ll.getValue();if(!e.paused||0!==e.currentTime||0!==e.startedAt&&0===e.endedAt){const t=Object.assign(Object.assign({},e),{paused:!0,currentTime:0,endedAt:e.endedAt||(e.startedAt?Date.now():0)});Ll.next(t),e.startedAt&&Ll.next(Object.assign(Object.assign({},t),{startedAt:0,endedAt:0}))}},started:function(){const e=Ll.getValue();e.startedAt||Ll.next(Object.assign(Object.assign({},e),{startedAt:Date.now()}))},ended:Fl},jl=Ul;function Vl(e,t,r,n,i){var a=e*e,s=a*e;return((1-3*e+3*a-s)*t+(4-6*a+3*s)*r+(1+3*e+3*a-3*s)*n+s*i)/6}function ql(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],s=n>0?e[n-1]:2*i-a,o=n<t-1?e[n+2]:2*a-i;return Vl((r-n/t)*t,s,i,a,o)}}function Ql(e,t){let r;if(void 0===t)for(const t of e)null!=t&&(r>t||void 0===r&&t>=t)&&(r=t);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(r>i||void 0===r&&i>=i)&&(r=i)}return r}var Xl=Math.sqrt(50),Wl=Math.sqrt(10),$l=Math.sqrt(2);function Hl(e,t,r){var n,i,a,s,o=-1;if(r=+r,(e=+e)==(t=+t)&&r>0)return[e];if((n=t<e)&&(i=e,e=t,t=i),0===(s=function(e,t,r){var n=(t-e)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=Xl?10:a>=Wl?5:a>=$l?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Xl?10:a>=Wl?5:a>=$l?2:1)}(e,t,r))||!isFinite(s))return[];if(s>0){let r=Math.round(e/s),n=Math.round(t/s);for(r*s<e&&++r,n*s>t&&--n,a=new Array(i=n-r+1);++o<i;)a[o]=(r+o)*s}else{s=-s;let r=Math.round(e*s),n=Math.round(t*s);for(r/s<e&&++r,n/s>t&&--n,a=new Array(i=n-r+1);++o<i;)a[o]=(r+o)/s}return n&&a.reverse(),a}var Gl,Yl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Kl(e){if(!(t=Yl.exec(e)))throw new Error("invalid format: "+e);var t;return new Jl({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Jl(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Zl(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function ec(e,t){var r=Zl(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}Kl.prototype=Jl.prototype,Jl.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const tc={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ec(100*e,t),r:ec,s:function(e,t){var r=Zl(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(Gl=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Zl(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function rc(e){return e}var nc,ic,ac=Array.prototype.map,sc=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function oc(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function lc(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function cc(e){let t,r,n;function i(e,n,i=0,a=e.length){if(i<a){if(0!==t(n,n))return a;do{const t=i+a>>>1;r(e[t],n)<0?i=t+1:a=t}while(i<a)}return i}return 2!==e.length?(t=oc,r=(t,r)=>oc(e(t),r),n=(t,r)=>e(t)-r):(t=e===oc||e===lc?e:uc,r=e,n=e),{left:i,center:function(e,t,r=0,a=e.length){const s=i(e,t,r,a-1);return s>r&&n(e[s-1],t)>-n(e[s],t)?s-1:s},right:function(e,n,i=0,a=e.length){if(i<a){if(0!==t(n,n))return a;do{const t=i+a>>>1;r(e[t],n)<=0?i=t+1:a=t}while(i<a)}return i}}}function uc(){return 0}nc=function(e){var t,r,n=void 0===e.grouping||void 0===e.thousands?rc:(t=ac.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var i=e.length,a=[],s=0,o=t[0],l=0;i>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),a.push(e.substring(i-=o,i+o)),!((l+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(r)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?rc:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(ac.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Kl(e)).fill,r=e.align,h=e.sign,d=e.symbol,f=e.zero,m=e.width,p=e.comma,g=e.precision,A=e.trim,v=e.type;"n"===v?(p=!0,v="g"):tc[v]||(void 0===g&&(g=12),A=!0,v="g"),(f||"0"===t&&"="===r)&&(f=!0,t="0",r="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",y="$"===d?a:/[%p]/.test(v)?l:"",w=tc[v],_=/[defgprs%]/.test(v);function E(e){var i,a,l,d=b,E=y;if("c"===v)E=w(e)+E,e="";else{var x=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:w(Math.abs(e),g),A&&(e=function(e){e:for(var t,r=e.length,n=1,i=-1;n<r;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),x&&0==+e&&"+"!==h&&(x=!1),d=(x?"("===h?h:c:"-"===h||"("===h?"":h)+d,E=("s"===v?sc[8+Gl/3]:"")+E+(x&&"("===h?")":""),_)for(i=-1,a=e.length;++i<a;)if(48>(l=e.charCodeAt(i))||l>57){E=(46===l?s+e.slice(i+1):e.slice(i))+E,e=e.slice(0,i);break}}p&&!f&&(e=n(e,1/0));var S=d.length+e.length+E.length,T=S<m?new Array(m-S+1).join(t):"";switch(p&&f&&(e=n(T+e,T.length?m-E.length:1/0),T=""),r){case"<":e=d+e+E+T;break;case"=":e=d+T+e+E;break;case"^":e=T.slice(0,S=T.length>>1)+d+e+E+T.slice(S);break;default:e=T+d+e+E}return o(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),E.toString=function(){return e+""},E}return{format:h,formatPrefix:function(e,t){var r=h(((e=Kl(e)).type="f",e)),n=3*Math.max(-8,Math.min(8,Math.floor(function(e){return(e=Zl(Math.abs(e)))?e[1]:NaN}(t)/3))),i=Math.pow(10,-n),a=sc[8+n/3];return function(e){return r(i*e)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),ic=nc.format,nc.formatPrefix;const hc=cc(oc),dc=hc.right,fc=(hc.left,cc((function(e){return null===e?NaN:+e})).center,dc);function mc(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function pc(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function gc(){}var Ac=.7,vc=1/Ac,bc="\\s*([+-]?\\d+)\\s*",yc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_c=/^#([0-9a-f]{3,8})$/,Ec=new RegExp(`^rgb\\(${bc},${bc},${bc}\\)$`),xc=new RegExp(`^rgb\\(${wc},${wc},${wc}\\)$`),Sc=new RegExp(`^rgba\\(${bc},${bc},${bc},${yc}\\)$`),Tc=new RegExp(`^rgba\\(${wc},${wc},${wc},${yc}\\)$`),kc=new RegExp(`^hsl\\(${yc},${wc},${wc}\\)$`),Ic=new RegExp(`^hsla\\(${yc},${wc},${wc},${yc}\\)$`),Cc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Pc(){return this.rgb().formatHex()}function Mc(){return this.rgb().formatRgb()}function Rc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=_c.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?Bc(t):3===r?new Oc(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?Lc(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?Lc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ec.exec(e))?new Oc(t[1],t[2],t[3],1):(t=xc.exec(e))?new Oc(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Sc.exec(e))?Lc(t[1],t[2],t[3],t[4]):(t=Tc.exec(e))?Lc(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=kc.exec(e))?qc(t[1],t[2]/100,t[3]/100,1):(t=Ic.exec(e))?qc(t[1],t[2]/100,t[3]/100,t[4]):Cc.hasOwnProperty(e)?Bc(Cc[e]):"transparent"===e?new Oc(NaN,NaN,NaN,0):null}function Bc(e){return new Oc(e>>16&255,e>>8&255,255&e,1)}function Lc(e,t,r,n){return n<=0&&(e=t=r=NaN),new Oc(e,t,r,n)}function Dc(e){return e instanceof gc||(e=Rc(e)),e?new Oc((e=e.rgb()).r,e.g,e.b,e.opacity):new Oc}function Nc(e,t,r,n){return 1===arguments.length?Dc(e):new Oc(e,t,r,null==n?1:n)}function Oc(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function zc(){return`#${Vc(this.r)}${Vc(this.g)}${Vc(this.b)}`}function Fc(){const e=Uc(this.opacity);return`${1===e?"rgb(":"rgba("}${jc(this.r)}, ${jc(this.g)}, ${jc(this.b)}${1===e?")":`, ${e})`}`}function Uc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function jc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Vc(e){return((e=jc(e))<16?"0":"")+e.toString(16)}function qc(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Xc(e,t,r,n)}function Qc(e){if(e instanceof Xc)return new Xc(e.h,e.s,e.l,e.opacity);if(e instanceof gc||(e=Rc(e)),!e)return new Xc;if(e instanceof Xc)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,o=a-i,l=(a+i)/2;return o?(s=t===a?(r-n)/o+6*(r<n):r===a?(n-t)/o+2:(t-r)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new Xc(s,o,l,e.opacity)}function Xc(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function Wc(e){return(e=(e||0)%360)<0?e+360:e}function $c(e){return Math.max(0,Math.min(1,e||0))}function Hc(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}mc(gc,Rc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Pc,formatHex:Pc,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Qc(this).formatHsl()},formatRgb:Mc,toString:Mc}),mc(Oc,Nc,pc(gc,{brighter(e){return e=null==e?vc:Math.pow(vc,e),new Oc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Ac:Math.pow(Ac,e),new Oc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Oc(jc(this.r),jc(this.g),jc(this.b),Uc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zc,formatHex:zc,formatHex8:function(){return`#${Vc(this.r)}${Vc(this.g)}${Vc(this.b)}${Vc(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Fc,toString:Fc})),mc(Xc,(function(e,t,r,n){return 1===arguments.length?Qc(e):new Xc(e,t,r,null==n?1:n)}),pc(gc,{brighter(e){return e=null==e?vc:Math.pow(vc,e),new Xc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Ac:Math.pow(Ac,e),new Xc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Oc(Hc(e>=240?e-240:e+120,i,n),Hc(e,i,n),Hc(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Xc(Wc(this.h),$c(this.s),$c(this.l),Uc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Uc(this.opacity);return`${1===e?"hsl(":"hsla("}${Wc(this.h)}, ${100*$c(this.s)}%, ${100*$c(this.l)}%${1===e?")":`, ${e})`}`}}));const Gc=e=>()=>e;function Yc(e,t){var r=t-e;return r?function(e,t){return function(r){return e+r*t}}(e,r):Gc(isNaN(e)?t:e)}const Kc=function e(t){var r=function(e){return 1==(e=+e)?Yc:function(t,r){return r-t?function(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}(t,r,e):Gc(isNaN(t)?r:t)}}(t);function n(e,t){var n=r((e=Nc(e)).r,(t=Nc(t)).r),i=r(e.g,t.g),a=r(e.b,t.b),s=Yc(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=a(t),e.opacity=s(t),e+""}}return n.gamma=e,n}(1);function Jc(e){return function(t){var r,n,i=t.length,a=new Array(i),s=new Array(i),o=new Array(i);for(r=0;r<i;++r)n=Nc(t[r]),a[r]=n.r||0,s[r]=n.g||0,o[r]=n.b||0;return a=e(a),s=e(s),o=e(o),n.opacity=1,function(e){return n.r=a(e),n.g=s(e),n.b=o(e),n+""}}}function Zc(e,t){var r,n=t?t.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),s=new Array(n);for(r=0;r<i;++r)a[r]=ou(e[r],t[r]);for(;r<n;++r)s[r]=t[r];return function(e){for(r=0;r<i;++r)s[r]=a[r](e);return s}}function eu(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function tu(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function ru(e,t){var r,n={},i={};for(r in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)r in e?n[r]=ou(e[r],t[r]):i[r]=t[r];return function(e){for(r in n)i[r]=n[r](e);return i}}Jc(ql),Jc((function(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],a=e[n%t],s=e[(n+1)%t],o=e[(n+2)%t];return Vl((r-n/t)*t,i,a,s,o)}}));var nu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,iu=new RegExp(nu.source,"g");function au(e,t){var r,n,i,a=nu.lastIndex=iu.lastIndex=0,s=-1,o=[],l=[];for(e+="",t+="";(r=nu.exec(e))&&(n=iu.exec(t));)(i=n.index)>a&&(i=t.slice(a,i),o[s]?o[s]+=i:o[++s]=i),(r=r[0])===(n=n[0])?o[s]?o[s]+=n:o[++s]=n:(o[++s]=null,l.push({i:s,x:tu(r,n)})),a=iu.lastIndex;return a<t.length&&(i=t.slice(a),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var r,n=0;n<t;++n)o[(r=l[n]).i]=r.x(e);return o.join("")})}function su(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(r=0;r<n;++r)i[r]=e[r]*(1-a)+t[r]*a;return i}}function ou(e,t){var r,n=typeof t;return null==t||"boolean"===n?Gc(t):("number"===n?tu:"string"===n?(r=Rc(t))?(t=r,Kc):au:t instanceof Rc?Kc:t instanceof Date?eu:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?su:Array.isArray(t)?Zc:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?ru:tu)(e,t)}function lu(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function cu(e){return+e}var uu=[0,1];function hu(e){return e}function du(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function fu(e,t,r){var n=e[0],i=e[1],a=t[0],s=t[1];return i<n?(n=du(i,n),a=r(s,a)):(n=du(n,i),a=r(a,s)),function(e){return a(n(e))}}function mu(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=du(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(t){var r=fc(e,t,1,n)-1;return a[r](i[r](t))}}function pu(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function gu(){var e,t,r,n,i,a,s=uu,o=uu,l=ou,c=hu;function u(){var e=Math.min(s.length,o.length);return c!==hu&&(c=function(e,t){var r;return e>t&&(r=e,e=t,t=r),function(r){return Math.max(e,Math.min(t,r))}}(s[0],s[e-1])),n=e>2?mu:fu,i=a=null,h}function h(t){return null==t||isNaN(t=+t)?r:(i||(i=n(s.map(e),o,l)))(e(c(t)))}return h.invert=function(r){return c(t((a||(a=n(o,s.map(e),tu)))(r)))},h.domain=function(e){return arguments.length?(s=Array.from(e,cu),u()):s.slice()},h.range=function(e){return arguments.length?(o=Array.from(e),u()):o.slice()},h.rangeRound=function(e){return o=Array.from(e),l=lu,u()},h.clamp=function(e){return arguments.length?(c=!!e||hu,u()):c!==hu},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(r=e,h):r},function(r,n){return e=r,t=n,u()}}function Au(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function vu(e){return Math.log(e)}function bu(e){return Math.exp(e)}function yu(e){return-Math.log(-e)}function wu(e){return-Math.exp(-e)}function _u(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Eu(e){return(t,r)=>-e(-t,r)}function xu(e){const t=e(vu,bu),r=t.domain;let n,i,a=10;function s(){return n=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(a),i=function(e){return 10===e?_u:e===Math.E?Math.exp:t=>Math.pow(e,t)}(a),r()[0]<0?(n=Eu(n),i=Eu(i),e(yu,wu)):e(vu,bu),t}return t.base=function(e){return arguments.length?(a=+e,s()):a},t.domain=function(e){return arguments.length?(r(e),s()):r()},t.ticks=e=>{const t=r();let s=t[0],o=t[t.length-1];const l=o<s;l&&([s,o]=[o,s]);let c,u,h=n(s),d=n(o);const f=null==e?10:+e;let m=[];if(!(a%1)&&d-h<f){if(h=Math.floor(h),d=Math.ceil(d),s>0){for(;h<=d;++h)for(c=1;c<a;++c)if(u=h<0?c/i(-h):c*i(h),!(u<s)){if(u>o)break;m.push(u)}}else for(;h<=d;++h)for(c=a-1;c>=1;--c)if(u=h>0?c/i(-h):c*i(h),!(u<s)){if(u>o)break;m.push(u)}2*m.length<f&&(m=Hl(s,o,f))}else m=Hl(h,d,Math.min(d-h,f)).map(i);return l?m.reverse():m},t.tickFormat=(e,r)=>{if(null==e&&(e=10),null==r&&(r=10===a?"s":","),"function"!=typeof r&&(a%1||null!=(r=Kl(r)).precision||(r.trim=!0),r=ic(r)),e===1/0)return r;const s=Math.max(1,a*e/t.ticks().length);return e=>{let t=e/i(Math.round(n(e)));return t*a<a-.5&&(t*=a),t<=s?r(e):""}},t.nice=()=>r(function(e,t){var r,n=0,i=(e=e.slice()).length-1,a=e[n],s=e[i];return s<a&&(r=n,n=i,i=r,r=a,a=s,s=r),e[n]=t.floor(a),e[i]=t.ceil(s),e}(r(),{floor:e=>i(Math.floor(n(e))),ceil:e=>i(Math.ceil(n(e)))})),t}function Su(){const e=xu(gu()).domain([1,10]);return e.copy=()=>pu(e,Su()).base(e.base()),Au.apply(e,arguments),e}var Tu=d((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function ku(e){return n((function(t,r){var n=!1,i=0;t.subscribe(F(r,(function(t){return(n||(n=!e(t,i++)))&&r.next(t)})))}))}function Iu(e,t){return t?function(r){return Tt(t.pipe(ae(1),n((function(e,t){e.subscribe(F(t,T))}))),r.pipe(Iu(e)))}:ot((function(t,r){return e(t,r).pipe(ae(1),function(e){return at((function(){return e}))}(t))}))}function Cu(e,t){void 0===t&&(t=Ze);var r=rt(e,t);return Iu((function(){return r}))}var Pu=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::spotifyAuth");const Mu=new le("spotifyAuth"),Ru=new fe("spotify/auth"),Bu=location.hostname,Lu=("localhost"===Bu?`http://${Bu}:${location.port}`:`https://${Bu}`)+"/auth/spotify/callback/",Du="https://accounts.spotify.com";let Nu;const Ou=new tr("");function zu(){return Ou.pipe(rr())}function Fu(){return Pu(this,void 0,void 0,(function*(){const e=ju(),t=null==e?void 0:e.refresh_token;if(t){const e=yield fetch(`${Du}/api/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({client_id:or,grant_type:"refresh_token",refresh_token:t})});if(!e.ok)throw qu(),e;const r=yield e.json();return Uu(r),r.access_token}throw qu(),Error("No 'refresh_token'")}))}function Uu(e){const{access_token:t,refresh_token:r,expires_in:n}=e,i=new Date,a=new Date(i.setSeconds(i.getSeconds()+n)).toISOString();Ru.setJson("token",{access_token:t,refresh_token:r,expires_at:a}),Vu(t)}function ju(){const e=Ru.getJson("token");return e&&(e.expires_at=new Date(e.expires_at)),e}function Vu(e){Mu.log("Access token successfully obtained."),Ou.next(e)}function qu(){Ru.removeItem("token"),Ou.next("")}!function(){Pu(this,void 0,void 0,(function*(){const e=function(e){let t="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let e=0;e<64;e++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}();Ru.setString("code_verifier",e),Nu=yield function(e){return Pu(this,void 0,void 0,(function*(){const t=yield crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}))}(e)}))}(),function(){Pu(this,void 0,void 0,(function*(){const e=ju();e&&(e.expires_at.getTime()-Date.now()<=0?yield Fu():Vu(e.access_token))}))}();var Qu,Xu,Wu,$u=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))},Hu=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Gu=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};const Yu=new le("SpotifyPlayer"),Ku="Spotify player not connected.",Ju=(e,t)=>e.paused===t.paused&&e.position===t.position;Qu=new WeakMap,Xu=new WeakMap,Wu=new WeakMap;const Zu=new class{constructor(e){this.accessToken$=e,this.player=null,this.paused$=new tr(!0),this.src$=new tr(""),this.error$=new Zt,this.playerReady$=new tr(!1),this.playerStarted$=new tr(!1),this.state$=new tr(null),this.loadedSrc="",this.currentTrackSrc="",this.isLoggedIn=!1,this.deviceId="",this.hidden=!0,this.loop=!1,Qu.set(this,!1),Xu.set(this,!0),Wu.set(this,1),this.onSpotifyWebPlaybackSDKReady=()=>{Yu.log("onSpotifyWebPlaybackSDKReady"),this.observeAccessToken().pipe(kt((e=>""!==e)),ot((e=>this.connect(e))),Pr((()=>this.playerReady$.next(!0))),ae(1)).subscribe(Yu)},window.onSpotifyWebPlaybackSDKReady=this.onSpotifyWebPlaybackSDKReady,this.observeReady().pipe(Pr((()=>this.player.activateElement())),ae(1)).subscribe(Yu),this.observeReady().pipe(It((()=>this.observeIsLoggedIn())),It((e=>e?this.observePaused():ie)),It((e=>e?ie:this.observeSrc())),qn(this.observeAccessToken()),It((([e,t])=>e&&e!==this.loadedSrc?Lt(void 0).pipe(ot((()=>this.loadError?this.reconnect(t):Lt(void 0))),ot((()=>this.addToQueue(e,t))),Mr((t=>(this.loadedSrc="",this.currentTrackSrc="",this.loadError={src:e,error:t},this.error$.next(t),ie))),ae(1)):ie))).subscribe(Yu),this.observeState().pipe(Pr((e=>{const t=e.track_window.current_track;this.src===this.loadedSrc&&t&&(this.currentTrackSrc=t.uri)}))).subscribe(Yu),this.observeIsLoggedIn().pipe(ku((e=>e===this.isLoggedIn)),Pr((e=>{this.isLoggedIn=e,e||this.paused||this.error$.next(Error(Ku))}))).subscribe(Yu),this.observeError().subscribe(Yu.error),Be("https://sdk.scdn.co/spotify-player.js")}get autoplay(){return Hu(this,Qu,"f")}set autoplay(e){Hu(this,Qu,"f")!==e&&(Gu(this,Qu,e,"f"),e&&this.playerStarted$.next(!0))}get muted(){return Hu(this,Xu,"f")}set muted(e){Hu(this,Xu,"f")!==e&&(Gu(this,Xu,e,"f"),this.safeVolume(e?0:this.volume))}get volume(){return Hu(this,Wu,"f")}set volume(e){Hu(this,Wu,"f")!==e&&(Gu(this,Wu,e,"f"),this.safeVolume(this.muted?0:e))}observeCurrentTime(){return xt(this.observeCurrentTrackState(),this.observePaused().pipe(It((e=>e?this.getCurrentState():nt(250).pipe(ot((()=>this.getCurrentState()))))))).pipe(at((e=>e?e.position/1e3:0)),rr())}observeDuration(){return this.observeCurrentTrackState().pipe(at((e=>e.duration/1e3)),rr())}observeEnded(){return this.observePlaying().pipe(It((()=>this.observeCurrentTrackState())),rr(Ju),qn(this.observePaused()),at((([e,t])=>!t&&e.paused&&0===e.position)),kt((e=>e)),at((()=>{})))}observeError(){return this.error$}observePlaying(){return this.observeCurrentTrackState().pipe(rr(Ju),qn(this.observePaused()),at((([e,t])=>!t&&!e.paused)),rr(),kt((e=>e)),at((()=>{})))}observeCurrentTrackState(){return this.observeState().pipe(kt((e=>{var t,r;return(null===(r=null===(t=e.track_window)||void 0===t?void 0:t.current_track)||void 0===r?void 0:r.uri)===this.currentTrackSrc})),at((e=>e)))}appendTo(){}load(e){Yu.log("load"),this.src$.next(e),this.player&&this.isLoggedIn?this.autoplay&&(this.paused$.next(!1),e===this.loadedSrc&&this.safePlay()):this.autoplay&&this.error$.next(Error(Ku))}play(){var e;Yu.log("play"),this.paused$.next(!1),this.player&&this.isLoggedIn?this.src===(null===(e=this.loadError)||void 0===e?void 0:e.src)?this.error$.next(this.loadError.error):this.src===this.loadedSrc&&this.safePlay():this.error$.next(Error(Ku))}pause(){Yu.log("pause"),this.paused$.next(!0),this.safePause()}stop(){Yu.log("stop"),this.paused$.next(!0),this.safeStop()}seek(e){var t;null===(t=this.player)||void 0===t||t.seek(1e3*e)}resize(){}getCurrentState(){return this.player?this.player.getCurrentState():Promise.resolve(null)}get paused(){return this.paused$.getValue()}get src(){return this.src$.getValue()}observeAccessToken(){return this.accessToken$}observeIsLoggedIn(){return this.observeAccessToken().pipe(at((e=>!!e)),rr())}observePaused(){return this.paused$.pipe(rr())}observeReady(){return kr([this.playerReady$,this.playerStarted$]).pipe(kt((([e,t])=>e&&t)),at((()=>{})),ae(1))}observeSrc(){return this.src$.pipe(rr())}observeState(){return this.state$.pipe(kt(Ce))}addToQueue(e,t,r=3){return $u(this,void 0,void 0,(function*(){if(!t)throw Error(Ku);const n=yield fetch(`https://api.spotify.com/v1/me/player/play?device_id=${this.deviceId}`,{method:"PUT",body:JSON.stringify({uris:[e],position_ms:0}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!n.ok){if(r>0)switch(n.status){case 401:{const t=yield Fu();return this.addToQueue(e,t,--r)}case 404:case 502:return yield this.reconnect(t),this.addToQueue(e,t,--r)}throw n}this.loadError=void 0,this.loadedSrc=e}))}connect(e){return $u(this,void 0,void 0,(function*(){return new Promise(((t,r)=>{let n=!1;const i=new Spotify.Player({name:"ampcast",getOAuthToken:t=>$u(this,void 0,void 0,(function*(){n&&(e=yield Fu()),n=!0,t(e)})),volume:this.muted?0:this.volume});i.addListener("initialization_error",r),i.addListener("authentication_error",r),i.addListener("account_error",r),i.addListener("playback_error",(e=>this.error$.next(e))),i.addListener("player_state_changed",(e=>this.state$.next(e))),i.addListener("not_ready",(()=>{Yu.log("not_ready"),this.deviceId="",r("not_ready")})),i.addListener("ready",(({device_id:e})=>{Yu.log("ready"),this.player=i,this.deviceId=e,t(i)})),i.connect()}))}))}disconnect(){return $u(this,void 0,void 0,(function*(){this.loadedSrc="",this.currentTrackSrc="",this.loadError=void 0;const e=this.player;return e?(e.removeListener("initialization_error"),e.removeListener("authentication_error"),e.removeListener("account_error"),e.removeListener("playback_error"),e.removeListener("player_state_changed"),e.removeListener("not_ready"),e.removeListener("ready"),this.safePause().then((()=>e.disconnect()))):Promise.resolve()}))}reconnect(e){return $u(this,void 0,void 0,(function*(){return Yu.log("reconnect"),t=Et(this.disconnect()).pipe(Cu(1e3),ot((()=>this.connect(e))),Cu(3e3),at((()=>{}))),new Promise((function(e,r){var n=new D({next:function(t){e(t),n.unsubscribe()},error:r,complete:function(){r(new Tu)}});t.subscribe(n)}));var t}))}safePause(){return $u(this,void 0,void 0,(function*(){try{this.player&&this.loadedSrc&&(yield this.player.pause())}catch(e){Yu.error(e)}}))}safePlay(){return $u(this,void 0,void 0,(function*(){try{this.player&&this.loadedSrc&&(yield this.player.resume())}catch(e){this.error$.next(e)}}))}safeStop(){return $u(this,void 0,void 0,(function*(){try{if(this.player&&this.loadedSrc){yield this.player.pause();const e=yield this.getCurrentState();(null==e?void 0:e.position)&&(yield this.player.seek(0))}}catch(e){Yu.error(e)}}))}safeVolume(e){var t;return $u(this,void 0,void 0,(function*(){try{yield null===(t=this.player)||void 0===t?void 0:t.setVolume(e)}catch(e){Yu.error(e)}}))}}(zu());var eh=__webpack_require__(5754),th=__webpack_require__.n(eh),rh=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};class nh{constructor(e,t){this.defaultConfig={minPageSize:nh.minPageSize,maxPageSize:nh.maxPageSize,pageSize:nh.maxPageSize},this.pageNumber=1;const r=Object.assign(Object.assign({},this.defaultConfig),t);this.pager=new zr(((t=this.defaultConfig.pageSize)=>rh(this,void 0,void 0,(function*(){const r=(this.pageNumber-1)*t,n=()=>rh(this,void 0,void 0,(function*(){const{items:n,total:i,next:a}=yield e(r,t);return this.pageNumber++,{items:n.map((e=>this.createMediaObject(e))),total:i,atEnd:!a}}));try{return yield n()}catch(e){if(401===e.status)return yield Fu(),yield n();throw e}}))),r)}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createMediaObject(e){switch(e.type){case"episode":return this.createMediaItemFromEpisode(e);case"artist":return this.createMediaArtist(e);case"album":return this.createMediaAlbum(e);case"playlist":return this.createMediaPlaylist(e);case"track":return this.createMediaItemFromTrack(e)}}createMediaItemFromEpisode(e){return{itemType:Yt.Media,mediaType:yr.Audio,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,duration:e.duration_ms/1e3,thumbnails:e.images,unplayable:!1===e.is_playable,playedAt:e.played_at?Math.floor((new Date(e.played_at).getTime()||0)/1e3):0}}createMediaAlbum(e){var t;return{itemType:Yt.Album,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,artist:e.artists.map((e=>e.name)).join("/"),year:new Date(e.release_date).getFullYear(),thumbnails:e.images,trackCount:null===(t=e.tracks)||void 0===t?void 0:t.total,pager:this.createAlbumPager(e)}}createMediaArtist(e){return{itemType:Yt.Artist,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,thumbnails:e.images,pager:this.createArtistAlbumsPager(e)}}createMediaPlaylist(e){return{itemType:Yt.Playlist,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,thumbnails:e.images,trackCount:e.tracks.total,pager:this.createPlaylistPager(e),owner:{name:e.owner.display_name||"",url:e.owner.external_urls.spotify}}}createMediaItemFromTrack(e){var t,r,n,i,a,s;const o=/album|compilation/i.test((null===(t=e.album)||void 0===t?void 0:t.album_type)||"")?e.album:void 0;return{itemType:Yt.Media,mediaType:yr.Audio,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,artist:e.artists.map((e=>e.name)).join("/"),albumArtist:null===(r=null==o?void 0:o.artists[0])||void 0===r?void 0:r.name,album:null==o?void 0:o.name,duration:e.duration_ms/1e3,playedAt:e.played_at?Math.floor((new Date(e.played_at).getTime()||0)/1e3):0,genre:null===(i=null===(n=e.album)||void 0===n?void 0:n.genres)||void 0===i?void 0:i.join(";"),disc:o?e.disc_number:void 0,track:o?e.track_number:void 0,year:e.album&&new Date(e.album.release_date).getUTCFullYear()||void 0,isrc:null===(a=e.external_ids)||void 0===a?void 0:a.isrc,thumbnails:null===(s=e.album)||void 0===s?void 0:s.images,unplayable:!1===e.is_playable}}createArtistAlbumsPager(e){const t=this.getMarket();return new nh(((r,n)=>rh(this,void 0,void 0,(function*(){const{items:i,total:a,next:s}=yield sh.getArtistAlbums(e.id,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))))}createAlbumPager(e){var t,r;const n=null===(t=e.tracks)||void 0===t?void 0:t.items;if(n&&n.length===e.total_tracks){const t=null===(r=e.tracks)||void 0===r?void 0:r.items;return new Kt(t.map((t=>this.createMediaItemFromTrack(Object.assign(Object.assign({},t),{album:e})))))}{const t=this.getMarket();return new nh(((r,n)=>rh(this,void 0,void 0,(function*(){const{items:i,total:a,next:s}=yield sh.getAlbumTracks(e.id,{offset:r,limit:n,market:t});return{items:i.map((t=>Object.assign(Object.assign({},t),{album:e}))),total:a,next:s}}))))}}createPlaylistPager(e){const t=this.getMarket();return new nh(((r,n)=>rh(this,void 0,void 0,(function*(){const{items:i,total:a,next:s}=yield sh.getPlaylistTracks(e.id,{offset:r,limit:n,market:t});return{items:i.map((e=>e.track)),total:a,next:s}}))))}getMarket(){return Ru.getString("market")}}nh.minPageSize=10,nh.maxPageSize=50;var ih=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::spotify");const ah=new le("spotify"),sh=new(th()),oh={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]};function lh(){return Ru.getString("market")}const ch={id:"spotify/recently-played",title:"Recently Played",icon:"clock",itemType:Yt.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search(){return new nh(((e,t)=>ih(this,void 0,void 0,(function*(){const{items:e,total:r}=yield sh.getMyRecentlyPlayedTracks({limit:t});return{items:e.map((e=>Object.assign({played_at:e.played_at},e.track))),total:r,next:void 0}}))),{maxSize:50,pageSize:50})}},uh={id:"spotify/top-tracks",title:"Top Tracks",icon:"star",itemType:Yt.Media,layout:oh,search(){return new nh(((e,t)=>ih(this,void 0,void 0,(function*(){return sh.getMyTopTracks({offset:e,limit:t})}))))}},hh={id:"spotify/liked-songs",title:"Liked Songs",icon:"heart",itemType:Yt.Media,layout:oh,search(){const e=lh();return new nh(((t,r)=>ih(this,void 0,void 0,(function*(){const{items:n,total:i,next:a}=yield sh.getMySavedTracks({offset:t,limit:r,market:e});return{items:n.map((e=>e.track)),total:i,next:a}}))))}},dh={id:"spotify/liked-albums",title:"Liked Albums",icon:"heart",itemType:Yt.Album,search(){const e=lh();return new nh(((t,r)=>ih(this,void 0,void 0,(function*(){const{items:n,total:i,next:a}=yield sh.getMySavedAlbums({offset:t,limit:r,market:e});return{items:n.map((e=>e.album)),total:i,next:a}}))),{calculatePageSize:!0})}},fh={id:"spotify/playlists",title:"Playlists",icon:"playlists",itemType:Yt.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]},search(){const e=lh();return new nh(((t,r)=>ih(this,void 0,void 0,(function*(){const{items:n,total:i,next:a}=yield sh.getUserPlaylists(void 0,{offset:t,limit:r,market:e});return{items:n,total:i,next:a}}))))}},mh={id:"spotify",title:"Spotify",icon:"spotify",url:"https://www.spotify.com/",roots:[{id:"spotify/search/songs",title:"Songs",icon:"",itemType:Yt.Media,layout:oh,searchable:!0,search({q:e=""}={}){if(e){const t=lh();return new nh(((r,n)=>ih(this,void 0,void 0,(function*(){const{tracks:{items:i,total:a,next:s}}=yield sh.searchTracks(e,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))),{maxSize:250})}return new Kt}},{id:"spotify/search/albums",title:"Albums",icon:"",itemType:Yt.Album,searchable:!0,search({q:e=""}={}){if(e){const t=lh();return new nh(((r,n)=>ih(this,void 0,void 0,(function*(){const{albums:{items:i,total:a,next:s}}=yield sh.searchAlbums(e,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))),{maxSize:250})}return new Kt}},{id:"spotify/search/artists",title:"Artists",icon:"",itemType:Yt.Artist,searchable:!0,search({q:e=""}={}){if(e){const t=lh();return new nh(((r,n)=>ih(this,void 0,void 0,(function*(){const{artists:{items:i,total:a,next:s}}=yield sh.searchArtists(e,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))),{maxSize:250})}return new Kt}},{id:"spotify/search/playlists",title:"Playlists",icon:"",itemType:Yt.Playlist,searchable:!0,search({q:e=""}={}){if(e){const t=lh();return new nh(((r,n)=>ih(this,void 0,void 0,(function*(){const{playlists:{items:i,total:a,next:s}}=yield sh.searchPlaylists(e,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))),{maxSize:250})}return new Kt}}],sources:[ch,uh,hh,dh,fh],observeIsLoggedIn:function(){return zu().pipe(at((e=>""!==e)),rr())},login:function(){return Pu(this,void 0,void 0,(function*(){if(""===Ou.getValue())try{Uu(yield function(){return Pu(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{let r=null;const n=i=>{if(/(localhost|ampcast)/.test(i.origin)){if(clearInterval(a),window.removeEventListener("message",n,!1),null==r||r.close(),r=null,i.origin!==location.origin)return void t({message:`Origin ${i.origin} does not match ${location.origin}`});(function(e){return Pu(this,void 0,void 0,(function*(){const t=Ru.getString("code_verifier"),r=yield fetch(`${Du}/api/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({client_id:or,grant_type:"authorization_code",code:e,redirect_uri:Lu,code_verifier:t})});if(!r.ok)throw r;return yield r.json()}))})(i.data.code).then(e,t)}};window.addEventListener("message",n,!1);const i=new URLSearchParams({client_id:or,scope:["user-read-recently-played","user-read-playback-position","user-top-read","user-read-playback-state","user-modify-playback-state","user-read-currently-playing","streaming","user-read-email","user-read-private","playlist-read-private","user-library-read"].join(" "),redirect_uri:Lu,response_type:"code",code_challenge_method:"S256",code_challenge:Nu});r=window.open(`${Du}/authorize?${i}`,"Spotify","popup");const a=setInterval((()=>{(null==r?void 0:r.closed)&&(clearInterval(a),t({message:"access_denied"}))}),500)}))}))}())}catch(e){Mu.log("Could not obtain access token."),Mu.error(e)}}))},logout:function(){return Pu(this,void 0,void 0,(function*(){qu(),Ru.clear()}))}},ph=mh;zu().subscribe((e=>sh.setAccessToken(e))),lh()||zu().pipe(ku((e=>!e)),ot((()=>sh.getMe())),Pr((e=>Ru.setString("market",e.country))),ae(1)).subscribe(ah);var gh,Ah=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};const vh=[[16.35],[17.32],[18.35],[19.45],[20.6],[21.83],[23.12],[24.5],[25.96],[27.5],[29.14],[30.87]];vh.forEach((e=>{const t=e[0];for(let r=1;r<12;r++)e[r]=t*Math.pow(2,r)})),gh=new WeakMap;const bh=new class{constructor(e){this.intervalTypes=["bars","beats","sections","segments","tatums"],this.animationFrameId=0,this.currentTrackId="",this.currentTrackAnalysis=null,this.trackAnalysis={},this.initialTrackProgress=0,this.initialStart=0,this.trackProgress=0,this.active=!1,this.queues={volume:[],beat:[]},this.activeIntervals$=new tr({bars:{},beats:{},sections:{},segments:{},tatums:{}}),this.fftSize=2048,this.volumeSmoothing=100,gh.set(this,0),e.observeCurrentTrackState().subscribe((t=>Ah(this,void 0,void 0,(function*(){var r,n;const i=null===(n=null===(r=null==t?void 0:t.track_window)||void 0===r?void 0:r.current_track)||void 0===n?void 0:n.id;if(i&&this.currentTrackId!==i){this.currentTrackId=i,this.currentTrackAnalysis=null;try{this.currentTrackAnalysis=yield sh.getAudioAnalysisForTrack(i),t=yield e.getCurrentState()}catch(e){console.error(e),this.currentTrackAnalysis=null,t=null}}t&&this.currentTrackAnalysis&&this.updateState(t),this.active=!(!this.currentTrackAnalysis||!t||t.paused||t.loading),this.active?this.start():this.stop()}))))}get bar(){return this.activeIntervals.bars}get beat(){return this.activeIntervals.beats}get frequencyBinCount(){return this.fftSize/2}get section(){return this.activeIntervals.sections}get segment(){return this.activeIntervals.segments}get tatum(){return this.activeIntervals.tatums}get volume(){return function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}(this,gh,"f")}observeBar(){return this.observeActiveIntervals().pipe(at((e=>e.bars)),rr())}observeBeat(){return this.observeActiveIntervals().pipe(at((e=>e.beats)),rr())}observeSection(){return this.observeActiveIntervals().pipe(at((e=>e.sections)),rr())}observeSegment(){return this.observeActiveIntervals().pipe(at((e=>e.segments)),rr())}observeTatum(){return this.observeActiveIntervals().pipe(at((e=>e.tatums)),rr())}getByteFrequencyData(e){if(!this.active)return;const t=this.segment.pitches;if(t){const r=ql([0,this.volume,0])(this.beat.progress),n=this.frequencyBinCount;for(let i=0;i<n;i++){const n=this.samplePitches(t,i);e[i]=n*r*256}}}samplePitches(e,t){const r=this.sampleSize,n=t*r,i=n+r;let a=0;for(let t=0;t<12;t++)for(let r=0;r<12;r++){const s=vh[t][r];if(s>=n&&s<i){a+=e[t];break}}return a}getByteTimeDomainData(e){e.fill(128)}get activeIntervals(){return this.activeIntervals$.getValue()}get sampleSize(){return 24e3/this.frequencyBinCount}observeActiveIntervals(){return zl().pipe(It((e=>e?ie:this.activeIntervals$)),kt((()=>this.active)))}updateState(e){return Ah(this,void 0,void 0,(function*(){this.trackAnalysis=JSON.parse(JSON.stringify(this.currentTrackAnalysis)),this.intervalTypes.forEach((e=>{const t=this.trackAnalysis[e];t[0].duration=t[0].start+t[0].duration,t[0].start=0,t.forEach((e=>{this.isSegment(e)&&(e.loudness_max_time=1e3*e.loudness_max_time),e.start=1e3*(e.start||0),e.duration=1e3*(e.duration||0)}))})),this.initialTrackProgress=e.position,this.trackProgress=e.position,this.initialStart=window.performance.now()}))}setActiveIntervals(){const e=this.activeIntervals,t=e=>{const t=this.trackAnalysis[e],r=this.trackProgress;for(let e=0;e<t.length;e++){if(e===t.length-1)return e;if(t[e].start<r&&r<t[e+1].start)return e}return 0};this.intervalTypes.forEach((r=>{const n=t(r);null!=e[r].start&&n===e[r].index||(e[r]=Object.assign(Object.assign({},this.trackAnalysis[r][n]),{index:n}));const{start:i,duration:a}=e[r],s=this.trackProgress-i;e[r].elapsed=s,e[r].progress=(e=>(e=Math.min(Math.max(0,e),1),1- --e*e*e*e))(s/a)})),this.activeIntervals$.next(e)}getVolume(){const{loudness_max:e,loudness_start:t,loudness_max_time:r,duration:n,elapsed:i,start:a,index:s}=this.activeIntervals.segments;if(!this.trackAnalysis.segments[s+1])return 0;const o=this.trackAnalysis.segments[s+1].loudness_start,l=a+i;if(i<r){const n=Math.min(1,i/r);return this.interpolate(t,e)(n)}{const t=l-(a+r),i=n-r,s=Math.min(1,t/i);return this.interpolate(e,o)(s)}}start(){this.animationFrameId||(this.animationFrameId=requestAnimationFrame(this.tick.bind(this)))}stop(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}tick(e){if(this.animationFrameId=requestAnimationFrame(this.tick.bind(this)),!this.active)return;this.trackProgress=e-this.initialStart+this.initialTrackProgress,this.setActiveIntervals();const t=this.getVolume(),r=this.queues;function n(e){return e.reduce(((e,t)=>e+t))/e.length}r.volume.unshift(t),r.volume.length>400&&r.volume.pop(),r.beat.unshift(t),r.beat.length>this.volumeSmoothing&&r.beat.pop();const i=Su().domain([Ql(r.volume),n(r.volume)]).range([0,1]),a=n(r.beat);!function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?i.call(e,r):i?i.value=r:t.set(e,r)}(this,gh,i(a),"f")}interpolate(e,t){return r=>e*(1-r)+t*r}isSegment(e){return"loudness_max_time"in e}}(Zu);console.log("module::audio");const yh=new AudioContext,wh=new AnalyserNode(yh,{fftSize:2048,smoothingTimeConstant:0}),_h=new class{constructor(e,t){this.analyserNode=e,this.spotifyAudioAnalyser=t,this.currentAnalyser=e,Nl().subscribe((({currentItem:r})=>{r.src.startsWith("spotify:")?this.currentAnalyser=t:this.currentAnalyser=e}))}get fftSize(){return this.analyserNode.fftSize}set fftSize(e){this.analyserNode.fftSize=e,this.spotifyAudioAnalyser.fftSize=e}get frequencyBinCount(){return this.analyserNode.frequencyBinCount}getByteFrequencyData(e){this.currentAnalyser.getByteFrequencyData(e)}getByteTimeDomainData(e){this.currentAnalyser.getByteTimeDomainData(e)}}(wh,bh);let Eh,xh;wh.connect(yh.destination);const Sh=new tr(yh.createMediaElementSource(new Audio));function Th(){return Sh.pipe(rr())}Nl().subscribe((({currentItem:e})=>{if(e.src.startsWith("apple:")){if(!xh){const e=document.querySelector("audio#apple-music-player");e&&(xh=yh.createMediaElementSource(e))}xh&&Sh.next(xh)}else{if(!Eh){const e=document.querySelector("audio.html5-audio");e&&(Eh=yh.createMediaElementSource(e))}Eh&&Sh.next(Eh)}})),Th().pipe(Vn(1)).subscribe((e=>e.connect(wh)));var kh,Ih,Ch,Ph=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Mh=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};class Rh{constructor(e,t,r){this.players=e,this.selectPlayer=t,this.loadPlayer=r,this.player$=new tr(null),this.error$=new Zt,kh.set(this,!1),Ih.set(this,!1),Ch.set(this,!1),e.forEach((e=>{e.autoplay=!1,e.muted=!0,e.hidden=!0}))}get hidden(){return Ph(this,Ih,"f")}set hidden(e){Mh(this,Ih,e,"f"),this.currentPlayer&&(this.currentPlayer.hidden=e)}get autoplay(){return Ph(this,kh,"f")}set autoplay(e){Mh(this,kh,e,"f"),this.currentPlayer&&(this.currentPlayer.autoplay=e)}get loop(){return this.players[0].loop}set loop(e){this.players.forEach((t=>t.loop=e))}get muted(){return Ph(this,Ch,"f")}set muted(e){Mh(this,Ch,e,"f"),this.currentPlayer&&(this.currentPlayer.muted=e)}get volume(){return this.players[0].volume}set volume(e){this.players.forEach((t=>t.volume=e))}observeCurrentTime(){return this.observeCurrentPlayer().pipe(It((e=>e?e.observeCurrentTime():Lt(0))),rr())}observeDuration(){return this.observeCurrentPlayer().pipe(It((e=>e?e.observeDuration():Lt(0))),rr())}observeEnded(){return this.observeCurrentPlayer().pipe(It((e=>e?e.observeEnded():ie)))}observeError(){return this.observeCurrentPlayer().pipe(It((e=>e?xt(this.error$,e.observeError()):ie)))}observePlaying(){return this.observeCurrentPlayer().pipe(It((e=>e?e.observePlaying():ie)))}appendTo(e){this.players.forEach((t=>t.appendTo(e)))}load(e){const t=this.currentPlayer,r=this.selectPlayer(e);if(this.player$.next(null),t&&t!==r&&(t.muted=!0,t.hidden=!0,t.stop()),this.player$.next(r),r)try{r.autoplay=this.autoplay,this.loadPlayer(r,e),r.muted=this.muted,r.hidden=this.hidden}catch(e){this.error$.next(e)}else this.error$.next(Error("No player found."))}play(){var e;this.autoplay=!0,null===(e=this.currentPlayer)||void 0===e||e.play()}pause(){var e;this.autoplay=!1,null===(e=this.currentPlayer)||void 0===e||e.pause()}stop(){var e;this.autoplay=!1,null===(e=this.currentPlayer)||void 0===e||e.stop()}seek(e){var t;null===(t=this.currentPlayer)||void 0===t||t.seek(e)}resize(e,t){e*t>0&&this.players.forEach((r=>r.resize(e,t)))}get currentPlayer(){return this.player$.getValue()}observeCurrentPlayer(){return this.player$.pipe(rr())}}kh=new WeakMap,Ih=new WeakMap,Ch=new WeakMap;var Bh=__webpack_require__(1062),Lh=__webpack_require__.n(Bh),Dh=__webpack_require__(6998),Nh=__webpack_require__.n(Dh),Oh=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::youtubeAuth");const zh=new le("youtubeAuth"),Fh="https://www.googleapis.com/auth/youtube.readonly",Uh=["https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest"],jh=new tr("");function Vh(){return jh.getValue()}function qh(){var e,t;return Oh(this,void 0,void 0,(function*(){return(null===(t=null===(e=window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.oauth2)||(yield Be("https://accounts.google.com/gsi/client")),google.accounts.oauth2}))}!function(){Oh(this,void 0,void 0,(function*(){const e=(yield function(){return Oh(this,void 0,void 0,(function*(){const e=yield function(){return Oh(this,void 0,void 0,(function*(){return window.gapi||(yield Be("https://apis.google.com/js/api.js")),window.gapi}))}();return e.client?e.client:new Promise(((t,r)=>{e.load("client",{callback:()=>{const n={apiKey:lr,clientId:cr,discoveryDocs:Uh,scope:Fh};e.client.init(n).then((()=>t(e.client)),r)},onerror:r})}))}))}()).getToken();e&&(zh.log("Access token successfully obtained."),jh.next(e.access_token)),gapi.load("client:auth2",(()=>{gapi.auth2.getAuthInstance().isSignedIn.listen((e=>{if(e){const e=gapi.client.getToken();jh.next((null==e?void 0:e.access_token)||"")}else jh.next("")}))}))}))}();var Qh=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))},Xh=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const Wh=Zo("ampcast/youtube-cache","keyval");!function(){Qh(this,void 0,void 0,(function*(){const e=yield function(e=tl()){return e("readonly",(t=>{if(t.getAll&&t.getAllKeys)return Promise.all([Jo(t.getAllKeys()),Jo(t.getAll())]).then((([e,t])=>e.map(((e,r)=>[e,t[r]]))));const r=[];return e("readonly",(e=>function(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Jo(e.transaction)}(e,(e=>r.push([e.key,e.value]))).then((()=>r))))}))}(Wh),t=[],r=Date.now();for(const[n,i]of e)r-i.cachedAt>6048e5&&t.push(n);t.length>0&&(yield function(e,t=tl()){return t("readwrite",(t=>(e.forEach((e=>t.delete(e))),Jo(t.transaction))))}(t,Wh))}))}();class $h{constructor(e,t,r){this.defaultConfig={pageSize:$h.maxPageSize},this.nextPageToken=void 0,this.pageNumber=1,this.config=Object.assign(Object.assign({},this.defaultConfig),r),this.pager=new zr((()=>Qh(this,void 0,void 0,(function*(){return this.fetchPage(e,t)}))),this.config)}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createItems({kind:e,items:t=[]},r){return Qh(this,void 0,void 0,(function*(){switch(e){case"youtube#playlistListResponse":return t.map((e=>this.createMediaPlaylist(e)));case"youtube#playlistItemListResponse":{const e=t.map((e=>e.contentDetails.videoId));return(yield this.fetchVideos(e,r)).map((e=>this.createMediaItem(e)))}case"youtube#searchListResponse":{const e=t.map((e=>e.id.videoId));return(yield this.fetchVideos(e,r)).map((e=>this.createMediaItem(e)))}default:return t.map((e=>this.createMediaItem(e)))}}))}createMediaPlaylist(e){var t,r,n;return{itemType:Yt.Playlist,src:`youtube:playlist:${e.id}`,externalUrl:`${Hh}/playlist?list=${e.id}`,title:(null===(t=e.snippet)||void 0===t?void 0:t.title)||e.id,thumbnails:this.mapThumbnails(null===(r=e.snippet)||void 0===r?void 0:r.thumbnails),trackCount:null===(n=e.contentDetails)||void 0===n?void 0:n.itemCount,owner:this.createOwner(e.snippet),pager:this.createPlaylistPager(e.id)}}createMediaItem(e){var t,r,n,i,a;return{itemType:Yt.Media,mediaType:yr.Video,src:`youtube:video:${e.id}`,externalUrl:`${Hh}/watch?v=${e.id}`,title:(null===(t=e.snippet)||void 0===t?void 0:t.title)||e.id,duration:this.parseDuration(null===(r=e.contentDetails)||void 0===r?void 0:r.duration),thumbnails:this.mapThumbnails(null===(n=e.snippet)||void 0===n?void 0:n.thumbnails),owner:this.createOwner(e.snippet),globalRating:this.parseNumber(null===(i=e.statistics)||void 0===i?void 0:i.likeCount),globalPlayCount:this.parseNumber(null===(a=e.statistics)||void 0===a?void 0:a.viewCount),playedAt:0}}createOwner({channelId:e="",channelTitle:t=""}){return e?{name:t,url:`${Hh}/channel/${e}`}:void 0}createPlaylistPager(e){return new $h("/playlistItems",{playlistId:e,part:"contentDetails",fields:"items(contentDetails(videoId))"})}mapThumbnails(e){if(e)return Object.keys(e).map((t=>e[t]))}parseDuration(e=""){const[,t=0,r=0,n=0]=/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/.exec(e)||[];return 60*Number(t)*60+60*Number(r)+Number(n)||0}fetchPage(e,t){return Qh(this,void 0,void 0,(function*(){const r=this.createCacheKey(e,t,this.pageNumber),n=yield this.getFromCache(r),i=this.nextPageToken,a=yield this.fetch(e,Object.assign(Object.assign({},t),{fields:`etag,kind,pageInfo,nextPageToken,${t.fields||"items"}`,maxResults:String(this.config.pageSize),pageToken:i}),n),{pageInfo:s,nextPageToken:o}=a,l=Xh(a,["pageInfo","nextPageToken"]),c=yield this.createItems(l,r),u=null==s?void 0:s.totalResults,h=!o;return this.nextPageToken=o,this.pageNumber++,yield this.saveToCache(r,a),{items:c,total:u,atEnd:h}}))}fetchVideos(e,t){return Qh(this,void 0,void 0,(function*(){const r=`${t}/videos`,n=yield this.getFromCache(r),i=yield this.fetch("/videos",{id:e.join(","),part:"contentDetails,snippet,statistics",fields:`etag,${$h.videoFields}`},n);return yield this.saveToCache(r,i),i.items||[]}))}fetch(e,t,r){return Qh(this,void 0,void 0,(function*(){const n=(null==r?void 0:r.etag)?{"If-None-Match":r.etag}:void 0;return gapi.client.request({path:`https://www.googleapis.com/youtube/v3${e}`,params:t,headers:n}).then((e=>Qh(this,void 0,void 0,(function*(){const{result:t,status:n,statusText:i}=e;if(t)return t;if(304===n&&r)return r;throw Error(i||`Error (${n})`)}))))}))}getFromCache(e){return Qh(this,void 0,void 0,(function*(){const t=yield rl(e,Wh);return null!=t?t:null}))}saveToCache(e,t){return Qh(this,void 0,void 0,(function*(){this.config.noCache||(yield nl(e,Object.assign(Object.assign({},t),{cachedAt:Date.now()}),Wh))}))}createCacheKey(e,t,r){const{fields:n}=t,i=Xh(t,["fields"]);return`${e}?${new URLSearchParams(i)}#${r}`}parseNumber(e){if(null!=e&&!isNaN(Number(e)))return Number(e)}}$h.minPageSize=5,$h.maxPageSize=50,$h.videoFields="items(id,snippet(title,thumbnails,channelId,channelTitle),contentDetails(duration),statistics(viewCount,likeCount))",$h.playlistFields="items(id,snippet(title,thumbnails,channelId,channelTitle),contentDetails(itemCount))";console.log("module::youtube");const Hh="https://www.youtube.com",Gh={view:"card",fields:["Thumbnail","Title","Duration","Owner"]},Yh={id:"youtube/likes",title:"Likes",icon:"thumbs-up",itemType:Yt.Media,layout:Gh,defaultHidden:!0,search:()=>new $h("/videos",{myRating:"like",part:"snippet,contentDetails,statistics",fields:$h.videoFields})},Kh={id:"youtube/playlists",title:"Playlists",icon:"playlists",itemType:Yt.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]},secondaryLayout:Gh,search:()=>new $h("/playlists",{mine:"true",part:"snippet,contentDetails",fields:$h.playlistFields})};function Jh(e){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){const t=`${Hh}/watch?v=${e}`,r=yield fetch(`${Hh}/oembed?url=${t}&format=json`);if(!r.ok)throw r;const n=yield r.json();return{itemType:Yt.Media,mediaType:yr.Video,src:`youtube:video:${e}`,externalUrl:t,title:n.title,aspectRatio:n.width/n.height||16/9,duration:0,track:0,thumbnails:[{url:n.thumbnail_url,width:n.thumbnail_width,height:n.thumbnail_height}],owner:{name:n.author_name,url:n.author_url},playedAt:0}}))}const Zh={id:"youtube",title:"YouTube",icon:"youtube",url:"https://www.youtube.com/",defaultNoScrobble:!0,roots:[{id:"youtube/search/video",title:"Video",icon:"",itemType:Yt.Media,layout:Gh,searchable:!0,search:({q:e=""}={})=>e?new $h("/search",{q:e,type:"video",videoCategoryId:"10",part:"id",fields:"items(id(videoId))"},{maxSize:$h.maxPageSize,noCache:!0}):new Kt}],sources:[Yh,Kh],observeIsLoggedIn:function(){return jh.pipe(rr()).pipe(at((e=>""!==e)),rr())},login:function(){return Oh(this,void 0,void 0,(function*(){if(""===Vh())try{const e=yield function(){return Oh(this,void 0,void 0,(function*(){const e=yield qh();return new Promise(((t,r)=>{e.initTokenClient({client_id:cr,scope:Fh,callback:e=>{e.error?r(e.error_description):(jh.next(e.access_token),t(e.access_token))}}).requestAccessToken()}))}))}();zh.log("Access token successfully obtained."),jh.next(e)}catch(e){zh.log("Could not obtain access token."),zh.error(e)}}))},logout:function(){return Oh(this,void 0,void 0,(function*(){const e=Vh();e&&(yield qh()).revoke(e,(()=>jh.next("")))}))}},ed=Zh;var td,rd,nd=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},id=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};const ad=(e,t)=>e.width===t.width&&e.height===t.height,sd=16/9,od={autohide:1,autoplay:0,controls:0,disablekb:1,enablejsapi:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0};var ld;!function(e){e[e.UNSTARTED=-1]="UNSTARTED",e[e.ENDED=0]="ENDED",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.BUFFERING=3]="BUFFERING",e[e.CUED=5]="CUED"}(ld||(ld={}));class cd{constructor(e){this.player=null,this.src$=new tr(""),this.size$=new tr({width:0,height:0}),this.error$=new Zt,this.ready$=new Zt,this.state$=new tr(ld.UNSTARTED),this.autoplay=!1,this.loop=!1,td.set(this,!0),rd.set(this,1);const t=this.element=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),i=this.logger=new le(`YouTubePlayer(${e})`);this.targetId=`youtube-iframe-${e}`,t.hidden=!0,t.className="youtube-video",r.className="youtube-video-wrapper",n.id=this.targetId,r.append(n),t.append(r),this.observeReady().pipe(ot((()=>this.observeSrc())),ku((e=>!e)),Pr((e=>{const t=this.player,[,r,n,i="0"]=e.split(":"),a=Number(i)||0;if(n)if("playlist"===r){const e={list:n,listType:r,startSeconds:a};this.autoplay?t.loadPlaylist(e):t.cuePlaylist(e)}else this.autoplay?t.loadVideoById(n,a):t.cueVideoById(n,a);else t.stopVideo()}))).subscribe(i),this.observeReady().pipe(ot((()=>this.observeVideoSize())),Pr((({width:e,height:t})=>this.player.setSize(e,t)))).subscribe(i),this.observeState().pipe(kt((e=>e===ld.ENDED&&this.loop)),Pr((()=>this.player.seekTo(0,!0)))).subscribe(i),this.observeState().pipe(kt((e=>e===ld.PLAYING)),Pr((()=>this.element.style.visibility=""))).subscribe(i),this.observeError().subscribe(i.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e,e&&(this.element.style.visibility="hidden")}get muted(){return nd(this,td,"f")}set muted(e){nd(this,td,"f")!==e&&(id(this,td,e,"f"),this.player&&(e?this.player.mute():0!==this.volume&&this.player.unMute()))}get volume(){return nd(this,rd,"f")}set volume(e){nd(this,rd,"f")!==e&&(id(this,rd,e,"f"),this.player&&(this.player.setVolume(100*e),0===e?this.player.mute():this.muted||this.player.unMute()))}observeCurrentTime(){return this.observeState().pipe(It((e=>{var t;return e===ld.PLAYING?rt(250-Math.round(1e3*this.player.getCurrentTime())%250,250).pipe(at((()=>this.player.getCurrentTime())),ne(this.observeState().pipe(Vn(1)))):Lt((null===(t=this.player)||void 0===t?void 0:t.getCurrentTime())||0)})))}observeDuration(){return this.observeState().pipe(at((()=>{var e;return(null===(e=this.player)||void 0===e?void 0:e.getDuration())||0})),kt((e=>0!==e)),rr())}observeEnded(){return this.observeState().pipe(kt((e=>e===ld.ENDED&&!this.loop)),at((()=>{})))}observeError(){return this.error$}observePlaying(){return this.observeState().pipe(kt((e=>e===ld.PLAYING)),at((()=>{})))}observeVideoId(){return this.observeState().pipe(at((()=>{var e;return this.getVideoId((null===(e=this.player)||void 0===e?void 0:e.getVideoUrl())||"")})),rr())}appendTo(e){if(e.appendChild(this.element),!this.player){const e=Lh()(this.targetId,{playerVars:od});e.on("ready",(({target:e})=>{this.player=e,e.setVolume(100*this.volume),(this.muted||0===this.volume)&&e.mute(),this.ready$.next(void 0)})),e.on("stateChange",(({data:e})=>{this.state$.next(e)})),e.on("error",(e=>{this.error$.next(e)}))}}load(e){this.logger.log("load",{src:e}),this.autoplay&&this.player&&e===this.src?this.player.playVideo():this.src$.next(e)}play(){this.logger.log("play"),this.player?this.player.playVideo():this.error$.next(Error("YouTube player not loaded."))}pause(){var e;this.logger.log("pause"),null===(e=this.player)||void 0===e||e.pauseVideo()}stop(){var e;this.logger.log("stop"),null===(e=this.player)||void 0===e||e.stopVideo()}seek(e){var t;null===(t=this.player)||void 0===t||t.seekTo(e,!0)}resize(e,t){this.size$.next({width:e,height:t})}destroy(){var e;null===(e=this.player)||void 0===e||e.destroy(),this.element.remove()}get src(){return this.src$.getValue()}observeAspectRatio(){return this.observeVideoId().pipe(It((e=>e?this.getAspectRatio(e):Lt(sd))),rr())}observeReady(){return this.ready$.pipe(ae(1))}observeSize(){return this.size$.pipe(rr(ad),kt((({width:e,height:t})=>e*t>0)))}observeSrc(){return this.src$.pipe(rr())}observeState(){return this.state$}observeVideoSize(){return kr([this.observeSize(),this.observeAspectRatio()]).pipe(at((([{width:e,height:t},r])=>{const n=Math.max(Math.round(e/r),t);return{width:Math.max(Math.round(n*r),e),height:n}})),rr(ad))}getAspectRatio(e){return Et(Jh(e)).pipe(ne(rt(3e3)),ne(this.observeVideoId().pipe(Vn(1))),at((({aspectRatio:e})=>e||sd)),Mr((t=>(this.logger.log(`Could not obtain oembed info: videoId='${e}' (status=${t.status})`),t.status>=400&&(401===t.status?this.error$.next(Error("Embedding prevented by channel owner.")):403===t.status?this.error$.next(Error("Private video.")):404===t.status?this.error$.next(Error("Video does not exist.")):this.error$.next(`Error: ${t.statusText} (${t.status})`)),Lt(sd)))))}getPlayerState(){return this.player?this.player.getPlayerState():ld.UNSTARTED}getPlaylist(){var e;return(null===(e=this.player)||void 0===e?void 0:e.getPlaylist())||[]}getVideoId(e){return e.startsWith("youtube:")?e.replace("youtube:video:",""):Nh()(e)||""}}td=new WeakMap,rd=new WeakMap;const ud=new fe("plex"),hd={get clientId(){let e=ud.getString("clientId");return e||(e=en(),ud.setString("clientId",e)),e},get connection(){return ud.getJson("connection")},set connection(e){ud.setJson("connection",e)},get host(){var e;return(null===(e=this.connection)||void 0===e?void 0:e.uri)||""},get libraryId(){return ud.getString("libraryId")},set libraryId(e){ud.setString("libraryId",e)},get server(){return ud.getJson("server")},set server(e){ud.setJson("server",e)},get serverToken(){var e;return(null===(e=this.server)||void 0===e?void 0:e.accessToken)||""},get userToken(){return ud.getString("userToken")},set userToken(e){ud.setString("userToken",e)},get userId(){return ud.getString("userId")},set userId(e){ud.setString("userId",e)},clear(){const e=this.clientId;ud.clear(),e&&ud.setString("clientId",e)}};var dd=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function fd({host:e=hd.host,path:t,method:r="GET",params:n,headers:i,body:a,token:s,keepalive:o}){return dd(this,void 0,void 0,(function*(){if(!e)throw Error("No Plex connection.");(t=n?`${t}?${new URLSearchParams(n)}`:t).startsWith("/")||(t=`/${t}`),s||(s=e===hd.host?hd.serverToken:hd.userToken);const l=yield window.fetch(`${e}${t}`,{method:r,headers:Object.assign(Object.assign({},i),md(s)),body:a,keepalive:o});if(!l.ok)throw Error(l.statusText);return l}))}function md(e){const t={"X-Plex-Product":"ampcast","X-Plex-Version":"0.5.4","X-Plex-Platform":Ie.displayName,"X-Plex-Platform-Version":Ie.version,"X-Plex-Device":Ie.os,"X-Plex-Device-Name":Ie.displayName,"X-Plex-Client-Identifier":hd.clientId,"X-Plex-Model":"hosted","Accept-Encoding":"gzip, deflate, br"};return e&&(t["X-Plex-Token"]=e),t}console.log("module::plexApi");const pd={fetch:fd,fetchJSON:function(e){var{headers:t,body:r}=e,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["headers","body"]);return dd(this,void 0,void 0,(function*(){return t=Object.assign(Object.assign({},t),{Accept:"application/json"}),r&&(t=Object.assign(Object.assign({},t),{"Content-Type":"application/json"}),r=JSON.stringify(r)),(yield fd(Object.assign({headers:t,body:r},n))).json()}))},getPlayableUrlFromSrc:function(e){const{host:t,serverToken:r}=hd;if(t&&r){const[,,n]=e.split(":");return`${t}${n}?X-Plex-Token=${r}`}throw Error("Not logged in.")}},gd=pd;class Ad{constructor(e){this.error$=new Zt,this.src="",this.loadedSrc="",this.autoplay=!1;const t=this.element=document.createElement(e);t.hidden=!0,t.muted=!0,t.autoplay=!1,t.className=`html5-${e}`,t.crossOrigin="anonymous",ft(t,"error").pipe(at((()=>t.error))).subscribe(this.error$);const r=this.logger=new le(`HTML5Player(${e})`);this.observeError().subscribe(r.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}get loop(){return this.element.loop}set loop(e){this.element.loop=e}get muted(){return this.element.muted}set muted(e){this.element.muted=e}get volume(){return this.element.volume}set volume(e){this.element.volume=e}observeCurrentTime(){return ft(this.element,"timeupdate").pipe(at((()=>this.element.currentTime)),at((e=>isFinite(e)?e:0)))}observeDuration(){return ft(this.element,"durationchange").pipe(at((()=>this.element.duration)),at((e=>isFinite(e)?e:0)))}observeEnded(){return ft(this.element,"ended").pipe(at((()=>{})))}observeError(){return this.error$}observePlaying(){return ft(this.element,"playing").pipe(at((()=>{})))}appendTo(e){e.appendChild(this.element)}load(e){this.logger.log("load"),this.src=e;try{const t=this.getMediaSource(this.src);this.loadedSrc=e,this.element.setAttribute("src",t),this.autoplay&&this.element.play().then(void 0,(e=>this.error$.next(e)))}catch(e){this.error$.next(e)}}play(){this.logger.log("play");try{if(this.src!==this.loadedSrc){const e=this.getMediaSource(this.src);this.loadedSrc=this.src,this.element.setAttribute("src",e)}this.element.play().then(void 0,(e=>this.error$.next(e)))}catch(e){this.error$.next(e)}}pause(){this.logger.log("pause"),this.element.pause()}stop(){this.logger.log("stop"),this.element.pause(),this.element.currentTime=0}seek(e){this.element.currentTime=e}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}getMediaSource(e){return e.startsWith("jellyfin:")?on.getPlayableUrlFromSrc(e):e.startsWith("plex:")?gd.getPlayableUrlFromSrc(e):e}}const vd=new le("ambientVideoPlayer"),bd=new Ad("video"),yd=new cd("ambient"),wd=[bd,yd],_d=new fe("ambientVideoPlayer/progress"),Ed=new Rh(wd,(function(e){return e?e.src.startsWith("youtube:")?yd:bd:null}),(function(e,t){const r=t.src;if(r.startsWith("youtube:")){const[,,t]=r.split(":"),n=_d.getNumber(t,120);e.load(`${r}:${n}`)}else e.load(r)}));Ed.loop=!0,Ed.volume=0,Ed.hidden=!0,yd.observeCurrentTime().pipe(at(Math.round),kt((e=>e>120&&e%30==0)),qn(yd.observeVideoId()),Pr((([e,t])=>_d.setNumber(t,e)))).subscribe(vd);const xd=Ed;class Sd{constructor(){this.autoplay=!1,this.loop=!0,this.muted=!0,this.volume=0}observeCurrentTime(){return ie}observeDuration(){return ie}observeEnded(){return ie}observeError(){return ie}observePlaying(){return ie}seek(){}}const Td=new le("AmpShader"),kd=2*Math.PI,Id=Math.PI/2,Cd=kd/3600;class Pd{constructor(e,t={}){let r;if(this._ready=!1,this._gradients={classic:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )",{pos:.6,color:"hsl( 60, 100%, 50% )"},"hsl( 120, 100%, 50% )"]},prism:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )"]},rainbow:{bgColor:"#111",dir:"h",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 47% )","hsl( 240, 100%, 58% )","hsl( 300, 100%, 50% )","hsl( 360, 100%, 50% )"]}},this._container=e||document.body,this._defaultWidth=this._container.clientWidth||640,this._defaultHeight=this._container.clientHeight||270,t.source&&(r=t.source.context));else if(r=t.audioCtx);else try{r=new(window.AudioContext||window.webkitAudioContext)}catch(e){throw new Md("ERR_AUDIO_CONTEXT_FAIL","Could not create audio context. Web Audio API not supported?")}if(!r.createGain)throw new Md("ERR_INVALID_AUDIO_CONTEXT","Provided audio context is not valid");const n=this._analyzer=[r.createAnalyser(),r.createAnalyser()],i=this._splitter=r.createChannelSplitter(2),a=this._merger=r.createChannelMerger(2);this._input=r.createGain(),this._output=r.createGain(),this._sources=[],t.source&&this.connectInput(t.source);for(const e of[0,1])i.connect(n[e],e);a.connect(this._output),this._outNodes=[],!1!==t.connectSpeakers&&this.connectOutput(),this._energy={val:0,peak:0,hold:0};const s=document.createElement("canvas");s.style="max-width: 100%;",this._canvasCtx=s.getContext("2d");for(const e of["_scaleX","_scaleR"])this[e]=document.createElement("canvas").getContext("2d");this._fsEl=t.fsElement||s;const o=()=>{this._fsTimeout||(this._fsTimeout=window.setTimeout((()=>{this._fsChanging||(this._setCanvas("resize"),this._fsTimeout=0)}),60))};window.ResizeObserver&&new ResizeObserver(o).observe(this._container),window.addEventListener("resize",o),s.addEventListener("fullscreenchange",(()=>{this._fsChanging=!0,this._fsTimeout&&window.clearTimeout(this._fsTimeout),this._setCanvas("fschange"),this._fsTimeout=window.setTimeout((()=>{this._fsChanging=!1,this._fsTimeout=0}),60)}));const l=()=>{"suspended"==r.state&&r.resume(),window.removeEventListener("click",l)};window.addEventListener("click",l),this._calcAux(),this._setProps(t,!0),this.useCanvas&&this._container.appendChild(s),this._ready=!0,this._setCanvas("create")}get alphaBars(){return this._alphaBars}set alphaBars(e){this._alphaBars=!!e,this._calcAux()}get barSpace(){return this._barSpace}set barSpace(e){this._barSpace=+e||0,this._calcAux()}get fftSize(){return this._analyzer[0].fftSize}set fftSize(e){for(const t of[0,1])this._analyzer[t].fftSize=e;const t=this._analyzer[0].frequencyBinCount;this._fftData=[new Uint8Array(t),new Uint8Array(t)],this._calcBars()}get gradient(){return this._gradient}set gradient(e){if(!this._gradients.hasOwnProperty(e))throw new Md("ERR_UNKNOWN_GRADIENT",`Unknown gradient: '${e}'`);this._gradient=e,this._makeGrad()}get height(){return this._height}set height(e){this._height=e,this._setCanvas("user")}get ledBars(){return this._showLeds}set ledBars(e){this._showLeds=!!e,this._calcAux()}get loRes(){return this._loRes}set loRes(e){this._loRes=!!e,this._setCanvas("lores")}get lumiBars(){return this._lumiBars}set lumiBars(e){this._lumiBars=!!e,this._calcAux(),this._calcLeds(),this._makeGrad()}get maxDecibels(){return this._analyzer[0].maxDecibels}set maxDecibels(e){for(const t of[0,1])this._analyzer[t].maxDecibels=e}get maxFreq(){return this._maxFreq}set maxFreq(e){if(e<1)throw new Md("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._maxFreq=e,this._calcBars()}get minDecibels(){return this._analyzer[0].minDecibels}set minDecibels(e){for(const t of[0,1])this._analyzer[t].minDecibels=e}get minFreq(){return this._minFreq}set minFreq(e){if(e<1)throw new Md("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=e,this._calcBars()}get mirror(){return this._mirror}set mirror(e){this._mirror=0|Math.sign(e),this._calcAux(),this._calcBars(),this._makeGrad()}get mode(){return this._mode}set mode(e){const t=0|e;if(!(t>=0&&t<=10&&9!=t))throw new Md("ERR_INVALID_MODE",`Invalid mode: ${e}`);this._mode=t,this._calcAux(),this._calcBars(),this._makeGrad()}get outlineBars(){return this._outlineBars}set outlineBars(e){this._outlineBars=!!e,this._calcAux()}get radial(){return this._radial}set radial(e){this._radial=!!e,this._calcAux(),this._calcBars(),this._makeGrad()}get reflexRatio(){return this._reflexRatio}set reflexRatio(e){if((e=+e||0)<0||e>=1)throw new Md("ERR_REFLEX_OUT_OF_RANGE","Reflex ratio must be >= 0 and < 1");this._reflexRatio=e,this._calcAux(),this._makeGrad(),this._calcLeds()}get showLeds(){return this.ledBars}set showLeds(e){this.ledBars=e}get smoothing(){return this._analyzer[0].smoothingTimeConstant}set smoothing(e){for(const t of[0,1])this._analyzer[t].smoothingTimeConstant=e}get spinSpeed(){return this._spinSpeed}set spinSpeed(e){e=+e||0,void 0!==this._spinSpeed&&0!=e||(this._spinAngle=-Id),this._spinSpeed=e}get splitGradient(){return this._splitGradient}set splitGradient(e){this._splitGradient=!!e,this._makeGrad()}get stereo(){return this._stereo}set stereo(e){this._stereo=!!e,this._input.disconnect(),this._input.connect(this._stereo?this._splitter:this._analyzer[0]),this._analyzer[0].disconnect(),this._outNodes.length&&this._analyzer[0].connect(this._stereo?this._merger:this._output),this._calcAux(),this._createScales(),this._calcLeds(),this._makeGrad()}get volume(){return this._output.gain.value}set volume(e){this._output.gain.value=e}get width(){return this._width}set width(e){this._width=e,this._setCanvas("user")}get audioCtx(){return this._input.context}get canvas(){return this._canvasCtx.canvas}get canvasCtx(){return this._canvasCtx}get connectedSources(){return this._sources}get connectedTo(){return this._outNodes}get energy(){return this.getEnergy()}get fps(){return this._fps}get fsHeight(){return this._fsHeight}get fsWidth(){return this._fsWidth}get isAlphaBars(){return this._isAlphaBars}get isFullscreen(){return(document.fullscreenElement||document.webkitFullscreenElement)===this._fsEl}get isLedBars(){return this._isLedDisplay}get isLedDisplay(){return this.isLedBars}get isLumiBars(){return this._isLumiBars}get isOctaveBands(){return this._isOctaveBands}get isOn(){return void 0!==this._runId}get isOutlineBars(){return this._isOutline}get peakEnergy(){return this.getEnergy("peak")}get pixelRatio(){return this._pixelRatio}static get version(){return"3.6.0"}connectInput(e){const t=e instanceof HTMLMediaElement;if(!t&&!e.connect)throw new Md("ERR_INVALID_AUDIO_SOURCE","Audio source must be an instance of HTMLMediaElement or AudioNode");const r=t?this.audioCtx.createMediaElementSource(e):e;return this._sources.includes(r)||(r.connect(this._input),this._sources.push(r)),r}connectOutput(e=this.audioCtx.destination){if(!this._outNodes.includes(e)&&(this._output.connect(e),this._outNodes.push(e),1==this._outNodes.length))for(const e of[0,1])this._analyzer[e].connect(this._stereo||e?this._merger:this._output,0,e)}disconnectInput(e){e?Array.isArray(e)||(e=[e]):e=Array.from(this._sources);for(const t of e){const e=this._sources.indexOf(t);e>=0&&(t.disconnect(this._input),this._sources.splice(e,1))}}disconnectOutput(e){if((!e||this._outNodes.includes(e))&&(this._output.disconnect(e),this._outNodes=e?this._outNodes.filter((t=>t!==e)):[],0==this._outNodes.length))for(const e of[0,1])this._analyzer[e].disconnect()}getBars(){return Array.from(this._bars,(({posX:e,freqLo:t,freqHi:r,hold:n,peak:i,value:a})=>({posX:e,freqLo:t,freqHi:r,hold:n,peak:i,value:a})))}getEnergy(e,t){if(void 0===e)return this._energy.val;if(e!=+e){if("peak"==e)return this._energy.peak;const r={bass:[20,250],lowMid:[250,500],mid:[500,2e3],highMid:[2e3,4e3],treble:[4e3,16e3]};if(!r[e])return null;[e,t]=r[e]}const r=this._freqToBin(e),n=t?this._freqToBin(t):r,i=this._stereo+1;let a=0;for(let e=0;e<i;e++)for(let t=r;t<=n;t++)a+=this._fftData[e][t];return a/(n-r+1)/i/255}registerGradient(e,t){if("string"!=typeof e||0==e.trim().length)throw new Md("ERR_GRADIENT_INVALID_NAME","Gradient name must be a non-empty string");if("object"!=typeof t)throw new Md("ERR_GRADIENT_NOT_AN_OBJECT","Gradient options must be an object");if(void 0===t.colorStops||t.colorStops.length<2)throw new Md("ERR_GRADIENT_MISSING_COLOR","Gradient must define at least two colors");this._gradients[e]={bgColor:t.bgColor||"#111",dir:t.dir,colorStops:t.colorStops},e==this._gradient&&this._makeGrad()}setCanvasSize(e,t){this._width=e,this._height=t,this._setCanvas("user")}setFreqRange(e,t){if(e<1||t<1)throw new Md("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=Math.min(e,t),this._maxFreq=Math.max(e,t),this._calcBars()}setLedParams(e){let t,r,n;e&&(t=0|e.maxLeds,r=+e.spaceV,n=+e.spaceH),this._ledParams=t>0&&r>0&&n>=0?[t,r,n]:void 0,this._calcLeds()}setOptions(e){this._setProps(e)}setSensitivity(e,t){for(const r of[0,1])this._analyzer[r].minDecibels=Math.min(e,t),this._analyzer[r].maxDecibels=Math.max(e,t)}toggleAnalyzer(e){const t=this.isOn;return void 0===e&&(e=!t),t&&!e?(cancelAnimationFrame(this._runId),this._runId=void 0):!t&&e&&(this._frame=this._fps=0,this._time=performance.now(),this._runId=requestAnimationFrame((e=>this._draw(e)))),this.isOn}toggleFullscreen(){if(this.isFullscreen)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this._fsEl;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}}_calcAux(){const e=this.canvas,t=this._radial,r=this._stereo&&!t,n=e.width>>1;this._radius=Math.min(e.width,e.height)*(this._stereo?.375:.125)|0,this._barSpacePx=Math.min(this._barWidth-1,this._barSpace>0&&this._barSpace<1?this._barWidth*this._barSpace:this._barSpace),this._isOctaveBands=this._mode%10!=0,this._isLedDisplay=this._showLeds&&this._isOctaveBands&&!t,this._isLumiBars=this._lumiBars&&this._isOctaveBands&&!t,this._isAlphaBars=this._alphaBars&&!this._isLumiBars&&10!=this._mode,this._isOutline=this._outlineBars&&this._isOctaveBands&&!this._isLumiBars&&!this._isLedDisplay,this._maximizeLeds=!this._stereo||this._reflexRatio>0&&!this._isLumiBars,this._channelHeight=e.height-(r&&!this._isLedDisplay?.5:0)>>r,this._analyzerHeight=this._channelHeight*(this._isLumiBars||t?1:1-this._reflexRatio)|0,this._channelGap=r?e.height-2*this._channelHeight:0,this._analyzerWidth=e.width-n*(0!=this._mirror),this._initialX=n*(-1==this._mirror&&!t)}_calcBars(){const e=this._bars=[];if(!this._ready)return;const t=e=>e*this.audioCtx.sampleRate/this.fftSize||1,r=(t,r,n,i,a,s,o)=>e.push({posX:t,binLo:r,binHi:n,freqLo:i,freqHi:a,ratioLo:s,ratioHi:o,peak:[0,0],hold:[0],value:[0]}),n=this._analyzerWidth,i=this._initialX,a=this._maxFreq,s=this._minFreq;let o,l;if(this._isOctaveBands){let c=[];for(let e=0;e<11;e++)for(let r=0;r<24;r++){const n=16.351597831287332*1.029302236643492**(24*e+r),i=this._freqToBin(n,"floor"),a=t(i),s=(n-a)/(t(i+1)-a);c.push({freq:n,bin:i,ratio:s})}const u=[0,1,2,3,4,6,8,12,24][this._mode];for(let n=0;n<c.length;n+=u){let{freq:i,bin:o,ratio:l}=c[n],{freq:h,bin:d,ratio:f}=c[n+u-1];const m=e.length,p=e[m-1];if(h>a||d>=this.fftSize/2){p.binHi++,p.ratioHi=0,p.freqHi=t(p.binHi);break}if(i>=s){if(m>0){const r=o-p.binHi;r>1&&(p.binHi=o-(r>>1),p.ratioHi=0,p.freqHi=t(p.binHi),m>1&&p.binHi>p.binLo&&p.binLo>e[m-2].binHi&&(p.ratioLo=0,p.freqLo=t(p.binLo)),o=p.binHi+1),d>o&&o>p.binHi&&(l=0,i=t(o))}r(0,o,d,i,h,l,f)}}this._barWidth=n/e.length,e.forEach(((e,t)=>e.posX=i+t*this._barWidth)),o=Math.log10(e[0].freqLo),l=n/(Math.log10(e[e.length-1].freqHi)-o)}else{this._barWidth=1,o=Math.log10(s),l=n/(Math.log10(a)-o);const c=this._freqToBin(s,"floor"),u=this._freqToBin(a);let h=-999;for(let n=c;n<=u;n++){const a=t(n),s=i+Math.round(l*(Math.log10(a)-o));s>h?(r(s,n,n,a,a,0,0),h=s):e.length&&(e[e.length-1].binHi=n,e[e.length-1].freqHi=a)}}this._minLog=o,this._logWidth=l,this._calcAux(),this._createScales(),this._calcLeds()}_calcLeds(){if(!this._isOctaveBands||!this._ready)return;const e=this._pixelRatio/(window.devicePixelRatio>1&&window.screen.height<=540?2:1),t=this._ledParams,[r,n,i]=t||[[],[128,3,.45],[128,4,.225],[96,6,.225],[80,6,.225],[80,6,.125],[64,6,.125],[48,8,.125],[24,16,.125]][this._mode];let a,s,o=this._analyzerHeight;if(t){const t=2*e;let i;a=r+1;do{a--,i=o/a/(1+n),s=i*n}while((i<t||s<t)&&a>1)}else{const t=540/n;s=Math.min(n*e,Math.max(2,o/t+.1|0))}this._maximizeLeds&&(o+=s),t||(a=Math.min(r,o/(2*s)|0)),this._leds=[a,i>=1?i:this._barWidth*i,s,o/a-s]}_createScales(){const e=[16,31,63,125,250,500,1e3,2e3,4e3,8e3,16e3],t=this._canvasCtx.canvas,r=this._scaleX,n=this._scaleR,i=r.canvas,a=n.canvas,s=.03*Math.min(t.width,t.height)|0;a.width=a.height=(this._radius<<1)+this._stereo*s;const o=a.width>>1,l=o-.7*s,c=(e,r)=>{const i=kd*(e/t.width),a=i-Id,s=l*Math.cos(a),c=l*Math.sin(a);n.save(),n.translate(o+s,o+c),n.rotate(i),n.fillText(r,0,0),n.restore()};i.width|=0,r.fillStyle=n.strokeStyle="#000c",r.fillRect(0,0,i.width,i.height),n.arc(o,o,o-s/2,0,kd),n.lineWidth=s,n.stroke(),r.fillStyle=n.fillStyle="#fff",r.font=(i.height>>1)+"px sans-serif",n.font=(s>>1)+"px sans-serif",r.textAlign=n.textAlign="center";for(const n of e){const e=n>=1e3?n/1e3+"k":n,a=this._logWidth*(Math.log10(n)-this._minLog);a>=0&&a<=this._analyzerWidth&&(r.fillText(e,this._initialX+a,.75*i.height),a<this._analyzerWidth&&c(a,e),this._mirror&&(r.fillText(e,(this._initialX||t.width)-a,.75*i.height),a>10&&c(-a,e)))}}_draw(e){const t=this._canvasCtx,r=t.canvas,n=this._scaleX.canvas,i=this._scaleR.canvas,a=this._energy,s=this._mode,o=this._isAlphaBars,l=this._isLedDisplay,c=this._isLumiBars,u=this._isOctaveBands,h=this._isOutline,d=this._radial,f=this._stereo,m=+this.lineWidth,p=this._mirror,g=this._channelHeight,A=this._channelGap,v=this._analyzerHeight,b=d?r.width:this._analyzerWidth,y=this._initialX,w=y+b,_=r.width>>1,E=r.height>>1,x=this._radius,S=d?Math.min(_,E)-x:v,T=this.useCanvas;a.val>0&&(this._spinAngle+=this._spinSpeed*Cd);const k=e=>{if(e&&m){const e=t.globalAlpha;t.globalAlpha=1,t.stroke(),t.globalAlpha=e}},I=(e,t,n)=>{const i=x+t,a=n*kd*(e/r.width)+this._spinAngle;return[_+i*Math.cos(a),E+i*Math.sin(a)]},C=(e,r,n,i,a)=>{t.beginPath();for(const a of p?[1,-1]:[1])t.moveTo(...I(e,r,a)),t.lineTo(...I(e,r+i,a)),t.lineTo(...I(e+n,r+i,a)),t.lineTo(...I(e+n,r,a));k(a),t.fill()},[P,M,R,B]=this._leds||[],L=e=>(e*P|0)*(B+R)-R,D=!this.showBgColor||l&&!this.overlay?"#000":this._gradients[this._gradient].bgColor;let N=this._barWidth-(u?Math.max(l?M:0,this._barSpacePx):0);0!=this._barSpace||l||(N|=0);let O=0;const z=this._bars.length;for(let e=0;e<f+1;e++){const i=g*e+A*e,a=i+g,u=i+v-(l&&!this._maximizeLeds?R:0);if(T){if(this.overlay&&t.clearRect(0,i-A,r.width,g+A),this.overlay&&!this.showBgColor||(this.overlay&&(t.globalAlpha=this.bgAlpha),t.fillStyle=D,d&&0!=e||t.fillRect(y,i-A,b,(this.overlay&&1==this.reflexAlpha?v:g)+A),t.globalAlpha=1),this.showScaleY&&!c&&!d){const e=n.height,a=e>>1,s=this._analyzer[0].minDecibels,o=this._analyzer[0].maxDecibels,l=v/(o-s);t.fillStyle="#888",t.font=`${a}px sans-serif`,t.textAlign="right",t.lineWidth=1;for(let n=o;n>s;n-=5){const s=i+(o-n)*l,c=n%2==0|0;if(c){const o=s+a*(s==i?.8:.35);-1!=p&&t.fillText(n,.85*e,o),1!=p&&t.fillText(n,r.width-.1*e,o),t.strokeStyle="#888",t.setLineDash([2,4]),t.lineDashOffset=0}else t.strokeStyle="#555",t.setLineDash([2,8]),t.lineDashOffset=1;t.beginPath(),t.moveTo(y+e*c*(-1!=p),.5+~~s),t.lineTo(w-e*c*(1!=p),.5+~~s),t.stroke()}t.setLineDash([]),t.lineDashOffset=0}l?(t.setLineDash([B,R]),t.lineWidth=N):t.lineWidth=h?Math.min(m,N/2):m,t.fillStyle=t.strokeStyle=this._canvasGradient}const P=this._fftData[e];this._analyzer[e].getByteFrequencyData(P);const F=(e,t)=>P[e]+(P[e+1]-P[e])*t;t.beginPath();let U=[];for(let r=0;r<z;r++){const n=this._bars[r],{binLo:f,binHi:g,ratioLo:A,ratioHi:v}=n;let b=Math.max(F(f,A),F(g,v));for(let e=f+1;e<g;e++)P[e]>b&&(b=P[e]);if(b/=255,n.value[e]=b,O+=b,n.peak[e]>0&&(n.hold[e]--,n.hold[e]<0&&(n.peak[e]+=n.hold[e]/S)),b>=n.peak[e]&&(n.peak[e]=b,n.hold[e]=30),!T)continue;c||o?t.globalAlpha=b:h&&(t.globalAlpha=this.fillAlpha),l?(b=L(b),b<0&&(b=0)):b=b*S|0,d&&1==e&&(b*=-1);let _=N,E=n.posX;if(10==s){const n=r?0:(P[this._bars[1].binLo]/255*S*(!d||!e||-1)+b)/2;if(d){if(0==r&&t.lineTo(...I(0,E<0?n:b,1)),E>=0){const e=[E,b];t.lineTo(...I(...e,1)),U.push(e)}}else{if(0==r)if(-1!=p){const e=f?P[f-1]/255*S:b;t.moveTo(y-m,u-e)}else t.moveTo(y,u-(E<y?n:b));(-1!=p||E>=y)&&t.lineTo(E,u-b)}}else if(s>0&&(l?E+=Math.max(M/2,this._barSpacePx/2):0==this._barSpace?(E|=0,r>0&&E>this._bars[r-1].posX+N&&(E--,_++)):E+=this._barSpacePx/2),l){const e=E+N/2;if(this.showBgColor&&!this.overlay){const r=t.globalAlpha;t.beginPath(),t.moveTo(e,i),t.lineTo(e,u),t.strokeStyle="#7f7f7f22",t.globalAlpha=1,t.stroke(),t.strokeStyle=t.fillStyle,t.globalAlpha=r}t.beginPath(),t.moveTo(e,c?i:u),t.lineTo(e,c?a:u-b),t.stroke()}else if(E>=y)if(d)C(E,0,_,b,h);else{const e=E,r=c?i:u,n=_,s=c?a:-b;t.beginPath(),t.moveTo(e,r),t.lineTo(e,r+s),t.lineTo(e+n,r+s),t.lineTo(e+n,r),k(h),t.fill()}const x=n.peak[e];x>0&&this.showPeaks&&!c&&E>=y&&E<w&&(h&&m>0?t.globalAlpha=1:o&&(t.globalAlpha=x),l?t.fillRect(E,u-L(x),N,B):d?10!=s&&C(E,x*S*(!e||-1),_,-2):t.fillRect(E,u-x*S,_,2))}if(T){if(t.globalAlpha=1,10==s){if(d){if(p){let e;for(;e=U.pop();)t.lineTo(...I(...e,-1))}t.closePath()}m>0&&t.stroke(),this.fillAlpha>0&&(d?(t.moveTo(_+x,E),t.arc(_,E,x,0,kd,!0)):(t.lineTo(w,u),t.lineTo(y,u)),t.globalAlpha=this.fillAlpha,t.fill(),t.globalAlpha=1)}if(this._reflexRatio>0&&!c){let n,a;this.reflexFit||f?(n=f&&0==e?g+A:0,a=g-v):(n=r.height-2*v,a=v),t.globalAlpha=this.reflexAlpha,1!=this.reflexBright&&(t.filter=`brightness(${this.reflexBright})`),t.setTransform(1,0,0,-1,0,r.height),t.drawImage(r,0,i,r.width,v,0,n,r.width,a),t.setTransform(1,0,0,1,0,0),t.filter="none",t.globalAlpha=1}}}a.val=O/(z<<f),a.val>=a.peak?(a.peak=a.val,a.hold=30):a.hold>0?a.hold--:a.peak>0&&(a.peak*=(30+a.hold--)/30),T&&(p&&!d&&(t.setTransform(-1,0,0,1,r.width-y,0),t.drawImage(r,y,0,_,r.height,0,0,_,r.height),t.setTransform(1,0,0,1,0,0)),t.setLineDash([]),this.showScaleX&&(d?(t.save(),t.translate(_,E),this._spinSpeed&&t.rotate(this._spinAngle+Id),t.drawImage(i,-i.width>>1,-i.width>>1),t.restore()):t.drawImage(n,0,r.height-n.height))),this._frame++;const F=e-this._time;if(F>=1e3&&(this._fps=this._frame/(F/1e3),this._frame=0,this._time=e),this.showFPS){const e=n.height;t.font=`bold ${e}px sans-serif`,t.fillStyle="#0f0",t.textAlign="right",t.fillText(Math.round(this._fps),r.width-e,2*e)}this.onCanvasDraw&&(t.save(),t.fillStyle=t.strokeStyle=this._canvasGradient,this.onCanvasDraw(this),t.restore()),this._runId=requestAnimationFrame((e=>this._draw(e)))}_freqToBin(e,t="round"){const r=this._analyzer[0].frequencyBinCount-1,n=Math[t](e*this.fftSize/this.audioCtx.sampleRate);return n<r?n:r}_makeGrad(){if(!this._ready)return;const e=this._canvasCtx,t=e.canvas,r=this._isLumiBars,n=r?t.height:t.height*(1-this._reflexRatio*!this._stereo)|0,i=1-this._reflexRatio,a=this._initialX,s=t.width>>1,o=t.height>>1,l=Math.min(s,o),c=this._radius,u=this._gradients[this._gradient],h=u.colorStops,d="h"==u.dir;let f;if(f=this._radial?e.createRadialGradient(s,o,l,s,o,c-(l-c)*this._stereo):e.createLinearGradient(...d?[a,0,a+this._analyzerWidth,0]:[0,0,0,n]),h){const e=this._stereo&&!this._splitGradient&&!d,t=(e,t)=>f.addColorStop(e,t.color||t);for(let n=0;n<1+e;n++)h.forEach(((a,s)=>{const o=h.length-1;let l=void 0!==a.pos?a.pos:s/o;if(e&&(l/=2),!this._stereo||r||this._radial||d||(l*=i,!e&&l>.5*i&&(l+=.5*this._reflexRatio)),1==n)if(this._radial||r){const e=o-s;l=1-(void 0!==(a=h[e]).pos?a.pos:e/o)/2}else 0==s&&l>0&&t(.5,a),l+=.5;t(l,a),this._stereo&&s==o&&l<.5&&t(.5,a)}))}this._canvasGradient=f}_setCanvas(e){if(!this._ready)return;const t=this._canvasCtx,r=t.canvas,n=this._scaleX.canvas,i=window.devicePixelRatio/(this._loRes+1);let a=window.screen.width*i,s=window.screen.height*i;90==Math.abs(window.orientation)&&a<s&&([a,s]=[s,a]);const o=this.isFullscreen,l=o&&this._fsEl==r,c=l?a:(this._width||this._container.clientWidth||this._defaultWidth)*i|0,u=l?s:(this._height||this._container.clientHeight||this._defaultHeight)*i|0;this._pixelRatio=i,this._fsWidth=a,this._fsHeight=s,r.width==c&&r.height==u||(r.width=c,r.height=u,this._calcAux(),this.overlay||(t.fillStyle="#000",t.fillRect(0,0,c,u)),t.lineJoin="bevel",n.width=c,n.height=Math.max(20*i,Math.min(c,u)/27|0),this._makeGrad(),this._calcBars(),void 0!==this._fsStatus&&this._fsStatus!==o&&(e="fschange"),this._fsStatus=o,this.onCanvasResize&&this.onCanvasResize(e,this))}_setProps(e,t){const r={alphaBars:!1,barSpace:.1,bgAlpha:.7,fftSize:8192,fillAlpha:1,gradient:"classic",ledBars:!1,lineWidth:0,loRes:!1,lumiBars:!1,maxDecibels:-25,maxFreq:22e3,minDecibels:-85,minFreq:20,mirror:0,mode:0,outlineBars:!1,overlay:!1,radial:!1,reflexAlpha:.15,reflexBright:1,reflexFit:!0,reflexRatio:0,showBgColor:!0,showFPS:!1,showPeaks:!0,showScaleX:!0,showScaleY:!1,smoothing:.5,spinSpeed:0,splitGradient:!1,start:!0,stereo:!1,useCanvas:!0,volume:1},n=["onCanvasDraw","onCanvasResize"],i=Object.keys(r).filter((e=>"start"!=e)).concat(n,["height","width"]);e&&void 0!==e.showLeds&&void 0===e.ledBars&&(e.ledBars=e.showLeds),(t||void 0===e)&&(e={...r,...e});for(const t of Object.keys(e))n.includes(t)&&"function"!=typeof e[t]?this[t]=void 0:i.includes(t)&&(this[t]=e[t]);void 0!==e.start&&this.toggleAnalyzer(e.start)}}class Md extends Error{constructor(e,t){super(t),this.name="AudioMotionError",this.code=e}}const Rd=new le("AudioMotion");var Bd=__webpack_require__(2238),Ld=__webpack_require__.n(Bd);const Dd=new le("Milkdrop"),Nd=new le("SpotifyViz"),Od=new le("Waveform");console.log("module::visualizer/player");const zd=new le("visualizer/player"),Fd=new class extends Sd{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl"),this.animationFrameId=0,this.fragTime=null,this.shader=null,this.startTime=performance.now();const t=this.gl;this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-ampshader";const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n);const i=new Float32Array([-1,-1,1,-1,-1,1,1,1]);t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),t.vertexAttribPointer(0,2,t.FLOAT,!1,0,0)}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render())}appendTo(e){e.append(this.canvas)}load(e){Td.log("load"),e&&(Td.log(`Using Ampshader preset: ${e.name}`),this.createShader(e.shader)),this.play()}play(){Td.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){const r=this.canvas,n=this.gl;if(r.width=e,r.height=t,n.viewport(0,0,e,t),this.shader){const e=n.getUniformLocation(this.shader,"resolution");n.uniform2f(e,r.width,r.height),this.renderFrame()}}get currentTime(){return(performance.now()-this.startTime)/1e3}clear(){}createShader(e){const t=this.gl,r=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(r,"attribute vec2 position;void main(void){gl_Position=vec4(position,0,1);}"),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(r));const n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));const i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n),t.linkProgram(i),t.useProgram(i);const a=t.getAttribLocation(i,"position");t.enableVertexAttribArray(a),this.fragTime=t.getUniformLocation(i,"time"),t.uniform1f(this.fragTime,this.currentTime);const s=t.getUniformLocation(i,"resolution");t.uniform2f(s,this.canvas.width,this.canvas.height),this.shader=i}render(){this.renderFrame(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}renderFrame(){if(this.shader){const e=this.gl,t=new Uint8Array(this.analyser.frequencyBinCount),r=new Uint8Array(4*t.length);this.analyser.getByteFrequencyData(t),e.uniform1f(this.fragTime,this.currentTime);for(let e=0;e<t.length;e++)r[4*e+0]=t[e],r[4*e+1]=t[e],r[4*e+2]=t[e],r[4*e+3]=255;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.length,1,0,e.RGBA,e.UNSIGNED_BYTE,r),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}}(_h),Ud=new class extends Sd{constructor(e,t){super();const r=this.element=document.createElement("div");r.hidden=!0,r.className="visualizer visualizer-audiomotion",this.audioSourceNode=e.createMediaElementSource(new Audio);const n=this.visualizer=new Pd(r,{source:this.audioSourceNode,showBgColor:!1,overlay:!0,showScaleX:!1,showScaleY:!1,connectSpeakers:!1});t.subscribe((e=>{this.audioSourceNode=e,this.element.hidden||n.connectInput(e)}))}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden!==e&&(this.element.hidden=e,e?this.visualizer.disconnectInput():this.visualizer.connectInput(this.audioSourceNode))}appendTo(e){e.append(this.element)}load(e){Rd.log("load"),e&&(Rd.log(`Using AudioMotion preset: ${e.name}`),this.visualizer.setOptions(e.options)),this.autoplay&&this.play()}play(){Rd.log("play"),this.visualizer.toggleAnalyzer(!0)}pause(){Rd.log("pause"),this.visualizer.toggleAnalyzer(!1)}stop(){this.visualizer.toggleAnalyzer(!0)}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}}(yh,Th()),jd=new class extends Sd{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.context2D=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-milkdrop",(this.visualizer=Ld().createVisualizer(e.context,this.canvas,{width:400,height:200})).connectAudio(e)}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e?this.visualizer.disconnectAudio(this.analyser):(this.visualizer.connectAudio(this.analyser),this.animationFrameId||this.render()))}appendTo(e){e.append(this.canvas)}load(e){e&&(Dd.log(`Using butterchurn preset: ${e.name}`),this.visualizer.loadPreset(e.data,.5)),this.play()}play(){Dd.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.visualizer.render(),this.visualizer.setRendererSize(e,t),this.visualizer.render()}clear(){const e=this.canvas.width,t=this.canvas.height;this.context2D.clearRect(0,0,e,t)}render(){this.visualizer.render(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}}(wh),Vd=new class extends Sd{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.context2D=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-spotify-viz",e.observeBar().subscribe((e=>{var t,r;null===(r=null===(t=this.config)||void 0===t?void 0:t.onBar)||void 0===r||r.call(t,e)})),e.observeBeat().subscribe((e=>{var t,r;null===(r=null===(t=this.config)||void 0===t?void 0:t.onBeat)||void 0===r||r.call(t,e)})),e.observeSection().subscribe((e=>{var t,r;null===(r=null===(t=this.config)||void 0===t?void 0:t.onSection)||void 0===r||r.call(t,e)})),e.observeSegment().subscribe((e=>{var t,r;null===(r=null===(t=this.config)||void 0===t?void 0:t.onSegment)||void 0===r||r.call(t,e)})),e.observeTatum().subscribe((e=>{var t,r;null===(r=null===(t=this.config)||void 0===t?void 0:t.onTatum)||void 0===r||r.call(t,e)}))}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render(performance.now()))}appendTo(e){e.append(this.canvas)}load(e){var t,r;Nd.log("load"),e&&(Nd.log(`Using SpotifyViz preset: ${e.name}`),this.config=e.config,this.analyser.volumeSmoothing=null!==(r=null===(t=e.config)||void 0===t?void 0:t.volumeSmoothing)&&void 0!==r?r:100),this.autoplay&&this.play()}play(){Nd.log("play"),this.animationFrameId||this.render(performance.now())}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.renderFrame(performance.now())}clear(){const e=this.canvas.width,t=this.canvas.height;this.context2D.clearRect(0,0,e,t)}render(e){this.renderFrame(e),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((e=>this.render(e))))}renderFrame(e){var t,r;const n=this.context2D,i=this.canvas.width,a=this.canvas.height,s=this.analyser;null===(r=null===(t=this.config)||void 0===t?void 0:t.onPaint)||void 0===r||r.call(t,{context2D:n,width:i,height:a,now:e,analyser:s})}}(bh),qd=new class extends Sd{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.context2D=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-waveform"}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render(performance.now()))}appendTo(e){e.append(this.canvas)}load(e){Od.log("load"),e&&(Od.log(`Using Waveform preset: ${e.name}`),this.config=e.config),this.autoplay&&this.play()}play(){Od.log("play"),this.animationFrameId||this.render(performance.now())}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.renderFrame(performance.now())}clear(){const e=this.canvas.width,t=this.canvas.height;this.context2D.clearRect(0,0,e,t)}render(e){this.renderFrame(e),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((e=>this.render(e))))}renderFrame(e){var t,r;const n=this.context2D,i=this.canvas.width,a=this.canvas.height,s=this.analyser;null===(r=null===(t=this.config)||void 0===t?void 0:t.onPaint)||void 0===r||r.call(t,{context2D:n,width:i,height:a,now:e,analyser:s})}}(_h),Qd=new Rh([Fd,Ud,jd,Vd,qd,xd],(function(e){switch(e.provider){case"ambient-video":return xd;case"ampshader":return Fd;case"audiomotion":return Ud;case"milkdrop":return jd;case"spotify-viz":return Vd;case"waveform":return qd;default:return null}}),(function(e,t){e.load(t)}));Qd.loop=!0,Qd.muted=!0,Qd.volume=.07,Qd.observeError().subscribe(zd.error);const Xd=Qd;var Wd,$d,Hd=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Gd=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};const Yd=new le("MusicKitPlayer"),Kd="Apple Music player not connected.",Jd="Video playback not supported.";Wd=new WeakMap,$d=new WeakMap;const Zd=new class{constructor(e){this.isLoggedIn$=e,this.duration$=new Zt,this.currentTime$=new Zt,this.ended$=new Zt,this.playing$=new Zt,this.error$=new Zt,this.playerReady$=new Zt,this.playbackState$=new tr(0),this.src$=new tr(""),this.loadedSrc="",this.isLoggedIn=!1,this.hasPlayed=!1,this.loop=!1,this.autoplay=!1,Wd.set(this,!0),$d.set(this,1),this.onPlaybackStateChange=({state:e})=>{if(this.playbackState$.next(e),e===MusicKit.PlaybackStates.ended)this.ended$.next(void 0);else if(e===MusicKit.PlaybackStates.playing){const[,,e]=this.src.split(":"),t=this.player.nowPlayingItem;!1===(null==t?void 0:t.isPlayable)&&(null==t?void 0:t.id)===e?(this.error$.next(Error("Unplayable")),this.player.stop()):this.playing$.next(void 0)}},this.onPlaybackDurationChange=({duration:e})=>{this.duration$.next(e)},this.onPlaybackTimeChange=({currentPlaybackTime:e})=>{this.currentTime$.next(e)},this.onPlaybackError=e=>{this.error$.next(e)};const t=this.element=document.createElement("div");t.hidden=!0,t.className="apple-video",t.id="apple-music-video-container",this.observeIsLoggedIn().pipe(kt((e=>e)),Pr((()=>{const e=this.player=MusicKit.getInstance(),t=MusicKit.Events;e.addEventListener(t.playbackStateDidChange,this.onPlaybackStateChange),e.addEventListener(t.playbackDurationDidChange,this.onPlaybackDurationChange),e.addEventListener(t.playbackTimeDidChange,this.onPlaybackTimeChange),e.addEventListener(t.mediaPlaybackError,this.onPlaybackError),e.volume=this.muted?0:this.volume,this.playerReady$.next(void 0)})),ae(1)).subscribe(Yd),this.observeReady().pipe(ot((()=>kr([this.observeSrc(),this.observeIsLoggedIn()]))),It((([e,t])=>{if(t&&e&&e!==this.loadedSrc){if(!this.canPlay(e))return this.error$.next(Error(Jd)),ie;const[,t,r]=e.split(":");return Et(this.player.setQueue({[t]:r})).pipe(ot((()=>(this.loadedSrc=e,this.autoplay?this.safePlay():ie))),Mr((e=>(this.error$.next(e),ie))))}return ie}))).subscribe(Yd),this.observeIsLoggedIn().pipe(ku((e=>e===this.isLoggedIn))).subscribe((e=>{var t;this.isLoggedIn=e,!e&&(null===(t=this.player)||void 0===t?void 0:t.isPlaying)&&(this.stop(),this.error$.next(Error(Kd)))})),this.observeError().subscribe(Yd.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}get muted(){return Hd(this,Wd,"f")}set muted(e){Hd(this,Wd,"f")!==e&&(Gd(this,Wd,e,"f"),this.player&&(this.player.volume=e?0:this.volume))}get volume(){return Hd(this,$d,"f")}set volume(e){Hd(this,$d,"f")!==e&&(Gd(this,$d,e,"f"),this.player&&(this.player.volume=this.muted?0:e))}observeCurrentTime(){return this.currentTime$.pipe(rr())}observeDuration(){return this.duration$.pipe(rr())}observePlaying(){return this.playing$}observeEnded(){return this.ended$}observeError(){return this.error$}appendTo(e){e.appendChild(this.element)}load(e){Yd.log("load"),this.src$.next(e),this.player&&this.isLoggedIn?this.autoplay&&(e===this.loadedSrc?this.safePlay():this.canPlay(e)||this.error$.next(Error(Jd))):this.autoplay&&this.error$.next(Error(Kd))}play(){Yd.log("play"),this.player&&this.isLoggedIn?this.src===this.loadedSrc?this.safePlay():this.canPlay(this.src)||this.error$.next(Error(Jd)):this.error$.next(Error(Kd))}pause(){var e;Yd.log("pause"),(null===(e=this.player)||void 0===e?void 0:e.isPlaying)&&this.player.pause()}stop(){Yd.log("stop"),this.hasPlayed&&this.player.stop()}seek(e){var t;null===(t=this.player)||void 0===t||t.seekToTime(e)}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}get src(){return this.src$.getValue()}observeIsLoggedIn(){return this.isLoggedIn$}observeReady(){return this.playerReady$.pipe(at((()=>{})),ae(1))}observeSrc(){return this.src$.pipe(rr())}canPlay(e){var t;return!(null===(t=this.player)||void 0===t?void 0:t.version.startsWith("1"))||!/musicVideo/.test(e)}safePlay(){return this.player?this.player.play().then((()=>{this.hasPlayed=!0}),(e=>this.error$.next(e))):Promise.resolve()}}(Ar());console.log("module::mediaPlayer");const ef=new Ad("audio"),tf=new Ad("video"),rf=new cd("main"),nf=new Rh([ef,tf,rf,Zd,Zu],(function(e){return e?e.src.startsWith("youtube:")?rf:e.src.startsWith("apple:")?Zd:e.src.startsWith("spotify:")?Zu:e.mediaType===yr.Video?tf:ef:null}),(function(e,t){if(null==t?void 0:t.unplayable)throw Error("Unplayable.");e.load(function(e){return e?e.blob?URL.createObjectURL(e.blob):e.src||"":""}(t))})),af=nf;console.log("module::mediaPlayback");const sf=new le("mediaPlayback"),of=new fe("mediaPlayback"),lf=new fe("mediaPlayback","session"),cf=new tr(!1),uf=new Zt;let hf="forward";function df(){return Ml.observeCurrentItem()}function ff(){return jl.observeCurrentTime()}function mf(){return jl.observeDuration()}function pf(){return af.observeEnded()}function gf(){return jl.observePaused()}function Af(){return jl.observePlaybackStart()}function vf(){return jl.observePlaybackEnd()}function bf(e){return jl.observePlaybackProgress(e)}function yf(){return jl.observeState()}function wf(){return af.observePlaying()}function _f(e){sf.log("load",null==e?void 0:e.title),af.load(e),af.autoplay&&jl.play()}function Ef(){sf.log("play"),hf="forward",Rf(),jl.play(),jl.paused||af.play()}function xf(){sf.log("pause"),Rf(),jl.pause(),af.pause()}function Sf(e){sf.log("seek",{time:e}),af.seek(e)}function Tf(){sf.log("stop"),Rf(),jl.stop(),af.stop()}function kf(){hf="backward",Ml.atStart||(Mf(),Ml.prev())}function If(){hf="forward",Ml.atEnd||(Mf(),Ml.next())}function Cf(){Ml.shuffle()}function Pf(){return kr([Ml.observeCurrentIndex(),Ml.observeSize()]).pipe(at((([e,t])=>e===t-1)),rr())}function Mf(){jl.paused||!1!==cf.getValue()||(jl.stop(),af.stop(),jl.play()),cf.next(!0)}function Rf(){cf.next(!1)}const Bf={get autoplay(){return af.autoplay},set autoplay(e){af.autoplay=e,Xd.autoplay=e},get hidden(){return!1},get loop(){return!1},get muted(){return af.muted},set muted(e){lf.setBoolean("muted",e),af.muted=e},get paused(){return jl.paused},get volume(){return af.volume},set volume(e){of.setNumber("volume",e),af.volume=e},observeCurrentItem:df,observeCurrentTime:ff,observeDuration:mf,observeEnded:pf,observeError:function(){return af.observeError()},observePaused:gf,observePlaying:wf,observePlaybackStart:Af,observePlaybackEnd:vf,observePlaybackProgress:bf,observePlaybackState:yf,appendTo:function(e){const t=e.querySelector("#players"),r=e.querySelector("#visualizers");af.appendTo(t),Xd.appendTo(r)},load:_f,play:Ef,pause:xf,stop:Tf,seek:Sf,resize:function(e,t){af.resize(e,t),Xd.resize(e,t)},next:If,prev:kf,shuffle:Cf},Lf=Bf;Bf.muted=lf.getBoolean("muted"),Bf.volume=of.getNumber("volume",1),af.observeCurrentTime().subscribe((e=>jl.setCurrentTime(e))),af.observeDuration().subscribe((e=>jl.setDuration(e))),af.observePlaying().subscribe((()=>jl.started())),af.observeEnded().subscribe((()=>jl.ended())),af.observePlaying().subscribe((()=>hf="forward")),af.observeEnded().pipe(qn(Pf()),ne(uf)).subscribe((([,e])=>{e?Tf():Ml.next()})),af.observeError().pipe(qn(gf(),Ml.observeCurrentIndex().pipe(at((e=>0===e)),rr()),Pf()),ne(uf)).subscribe((([,e,t,r])=>{r||t&&"backward"===hf?Tf():e||("backward"===hf?Ml.prev():Ml.next())})),Ml.observeSize().pipe(at((e=>0===e)),rr(),kt((e=>e))).subscribe(Tf),cf.pipe(Qn(250),kt((e=>e))).subscribe((()=>{Bf.autoplay=!jl.paused,cf.next(!1)})),cf.pipe(rr(),It((e=>e?ie:df()))).subscribe(_f),vf().pipe(ot((function(e){return Fo(this,void 0,void 0,(function*(){Uo.log("addListen",{state:e});try{const t=e.currentItem;if(!t||!e.startedAt||!e.endedAt)throw Error("Invalid PlaybackState.");if(t.title&&t.artist&&t.duration>30){const r=Math.floor(e.startedAt/1e3),n=Math.floor(e.endedAt/1e3)-r;(n>240||n>t.duration/2)&&(yield qo.items.add(Object.assign(Object.assign({},t),{playedAt:r,lastfmScrobbledAt:0,listenbrainzScrobbledAt:0})))}}catch(e){Uo.error(e)}}))}))).subscribe(sf),ft(window,"pagehide").subscribe((function(){uf.next(void 0),Tf()})),mf().subscribe(sf.all("duration")),ff().pipe(kt((e=>Math.round(e)%10==0))).subscribe(sf.all("currentTime")),wf().subscribe(sf.all("playing")),pf().subscribe(sf.all("ended")),Af().subscribe(sf.all("playbackStart")),vf().subscribe(sf.all("playbackEnd"));var Df=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::jellyfinPlayback");const Nf=new le("jellyfinPlayback");function Of(e,t,r,n){return Df(this,void 0,void 0,(function*(){try{const[,,i]=e.src.split(":");yield on.post("Sessions/Playing/Progress",{ItemId:i,IsPaused:r,PositionTicks:Math.floor(1e7*t),PlayMethod:"Transcode",EventName:n})}catch(e){Nf.error(e)}}))}console.log("module::jellyfinReporting");const zf=new le("jellyfinReporting"),Ff=e=>{var t;return!!(null===(t=e.currentItem)||void 0===t?void 0:t.src.startsWith("jellyfin:"))};Un().pipe(It((e=>e?Af():ie)),kt(Ff),ot((({currentItem:e})=>function(e){return Df(this,void 0,void 0,(function*(){try{const[,,t]=e.src.split(":");yield on.post("Sessions/Playing",{ItemId:t,IsPaused:!1,PositionTicks:0,PlayMethod:"Transcode"})}catch(e){Nf.error(e)}}))}(e)))).subscribe(zf),Un().pipe(It((e=>e?vf():ie)),kt(Ff),ot((({currentItem:e,currentTime:t})=>function(e,t){return Df(this,void 0,void 0,(function*(){try{const[,,r]=e.src.split(":");yield on.post("Sessions/Playing/Stopped",{ItemId:r,IsPaused:!1,PositionTicks:Math.floor(1e7*t),PlayMethod:"Transcode"})}catch(e){Nf.error(e)}}))}(e,t)))).subscribe(zf),Un().pipe(It((e=>e?bf(1e4):ie)),kt(Ff),ot((({currentItem:e,currentTime:t,paused:r})=>Of(e,t,r,"timeupdate")))).subscribe(zf),Un().pipe(It((e=>e?Af():ie)),It((e=>Ff(e)?yf().pipe(rr(((e,t)=>e.paused===t.paused)),Vn(1),ne(vf())):ie)),ot((({currentItem:e,currentTime:t,paused:r})=>Of(e,t,r,r?"pause":"unpause")))).subscribe(zf),console.log("module::jellyfin");const Uf={view:"details",fields:["Artist","Title","Album","Track","Duration","Genre","PlayCount"]},jf={id:"jellyfin/liked-songs",title:"Liked Songs",icon:"heart",itemType:Yt.Media,layout:Uf,search:()=>Wf({Filters:"IsFavorite"})},Vf={id:"jellyfin/liked-albums",title:"Liked Albums",icon:"heart",itemType:Yt.Album,search:()=>Wf({Filters:"IsFavorite",IncludeItemTypes:"MusicAlbum"})},qf={id:"jellyfin/recently-played",title:"Recently Played",icon:"clock",itemType:Yt.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>Wf({SortBy:"DatePlayed",SortOrder:"Descending",Filters:"IsPlayed"})},Qf={id:"jellyfin/most-played",title:"Most Played",icon:"most-played",itemType:Yt.Media,layout:Uf,search:()=>Wf({SortBy:"PlayCount,DatePlayed",SortOrder:"Descending",Filters:"IsPlayed"})},Xf={id:"jellyfin/playlists",title:"Playlists",icon:"playlists",itemType:Yt.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount"]},secondaryLayout:Uf,search:()=>Wf({SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Playlist"})};function Wf(e){return new ln(`Users/${rn.userId}/Items`,e)}const $f={id:"jellyfin",title:"Jellyfin",icon:"jellyfin",url:"https://jellyfin.org/",roots:[Hf("Audio",{title:"Songs",itemType:Yt.Media}),Hf("MusicAlbum",{title:"Albums",itemType:Yt.Album}),{id:"Artist",title:"Artists",icon:"",itemType:Yt.Artist,searchable:!0,search:({q:e=""}={})=>e?new ln("Artists",{searchTerm:e}):new Kt},Hf("Playlist",{title:"Playlists",itemType:Yt.Playlist})],sources:[Qf,qf,jf,Vf,Xf],observeIsLoggedIn:Un,login:function(){return On(this,void 0,void 0,(function*(){if(""===Fn.getValue())try{const e=yield function(){return Dn(this,void 0,void 0,(function*(){return Bn(Nn,!0)}))}();if(e){const{userId:t,token:r}=JSON.parse(e);rn.userId=t,jn(r)}}catch(e){zn.log("Could not obtain access token."),zn.error(e)}}))},logout:function(){return On(this,void 0,void 0,(function*(){jn(""),rn.clear()}))}};function Hf(e,t){return Object.assign(Object.assign({},t),{id:e,icon:"",searchable:!0,search:({q:t=""}={})=>function(e,t="Audio"){return e?Wf({SearchTerm:e,IncludeItemTypes:t}):new Kt}(t,e)})}const Gf=$f;var Yf=__webpack_require__(2568),Kf=__webpack_require__.n(Yf);const Jf=new fe("lastfm"),Zf={get token(){return Jf.getString("token")},set token(e){Jf.setString("token",e)},get userId(){return Jf.getString("userId")},set userId(e){Jf.setString("userId",e)},get sessionKey(){return Jf.getString("sessionKey")},set sessionKey(e){Jf.setString("sessionKey",e)},get firstScrobbledAt(){return Jf.getString("firstScrobbledAt")},set firstScrobbledAt(e){Jf.setString("firstScrobbledAt",e)},get removeDuplicates(){return Jf.getBoolean("removeDuplicates")},set removeDuplicates(e){Jf.setBoolean("removeDuplicates",e)},clear(){Jf.clear()}};var em=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::lastfmAuth");const tm=new le("lastfmAuth"),rm=new tr(""),nm=new tr("");function im(){return rm.pipe(rr()).pipe(at((e=>""!==e)),rr())}function am(e){const t=Object.keys(e);let r="";return t.sort(),t.forEach((t=>r+=t+e[t])),r+=sr,Kf()(r)}nm.next(Zf.sessionKey),rm.next(Zf.token);var sm=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::lastfmApi");const om=new le("lastfmApi"),lm=new class{constructor(){this.host="https://ws.audioscrobbler.com/2.0"}scrobble(e){return sm(this,void 0,void 0,(function*(){om.log("scrobble",{items:e});const t="track.scrobble";if(1===e.length){const r=e[0],n=String(r.playedAt);yield this.post(Object.assign({method:t,timestamp:n},this.getScrobbleParams(r)))}else if(e.length>0){const r={};e.forEach(((e,t)=>{const n=this.getScrobbleParams(e);r[`timestamp[${t}]`]=String(e.playedAt),Object.keys(n).forEach((e=>{r[`${e}[${t}]`]=n[e]}))})),yield this.post(Object.assign({method:t},r))}}))}updateNowPlaying(e){return sm(this,void 0,void 0,(function*(){om.log("updateNowPlaying",{item:e});try{this.canScrobble(e)&&(yield this.post(Object.assign({method:"track.updateNowPlaying"},this.getScrobbleParams(e))))}catch(t){om.log('Failed to update "now playing":',{item:e}),om.error(t)}}))}getUserInfo(){return sm(this,void 0,void 0,(function*(){return this.get({method:"user.getInfo",user:Zf.userId})}))}get(e){return sm(this,void 0,void 0,(function*(){const t=`${this.host}?${new URLSearchParams(Object.assign(Object.assign({},e),{api_key:ar,format:"json"}))}`,r=yield fetch(t,{method:"GET"});if(!r.ok)throw r;return r.json()}))}post(e){return sm(this,void 0,void 0,(function*(){const t=Zf.token,r=Zf.sessionKey,n=am(e=Object.assign(Object.assign({},e),{api_key:ar,token:t,sk:r})),i=`${new URLSearchParams(e)}&api_sig=${n}`;return fetch(this.host,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i})}))}getScrobbleParams(e){const t={};return t.track=e.title,t.artist=e.artist,e.album&&(t.album=e.album),e.albumArtist&&(t.albumArtist=e.albumArtist),e.duration&&(t.duration=String(Math.round(e.duration))),e.track&&(t.trackNumber=String(e.track)),e.recording_mbid&&(t.mbid=e.recording_mbid),t}canScrobble(e){return!!e&&!!e.title&&!!e.artist&&e.duration>30}};class cm{constructor(e,t,r){this.defaultConfig={minPageSize:cm.minPageSize,maxPageSize:cm.maxPageSize,pageSize:50},this.pageNumber=1,this.playCountName="playcount";const n=Object.assign(Object.assign({},this.defaultConfig),r);this.playCountName=n.playCountName||"playcount",this.pager=new zr(((r=this.defaultConfig.pageSize)=>function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){const n=this.pageNumber,i=yield lm.get(Object.assign(Object.assign({},e),{page:n,limit:r}));this.pageNumber++;const{items:a,total:s,atEnd:o,itemType:l}=t(i);return{items:this.createMediaObjects(l,a),total:s,atEnd:o}}))),n)}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createMediaObjects(e,t){switch(e){case Yt.Artist:return t.map((e=>this.createMediaArtist(e)));case Yt.Album:return t.map((e=>this.createMediaAlbum(e)));case Yt.Media:return t.map((e=>this.createMediaItem(e)));case Yt.Playlist:return[]}}createMediaItem(e){var t,r;return Ho(Object.assign(Object.assign({},this.createMediaObject(Yt.Media,e)),{mediaType:yr.Audio,src:`lastfm:track:${en()}`,artist:null===(t=e.artist)||void 0===t?void 0:t.name,album:null===(r=e.album)||void 0===r?void 0:r["#text"],duration:Number(e.duration)||0,playedAt:e.date&&Number(e.date.uts)||0}))}createMediaAlbum(e){var t;return Object.assign(Object.assign({},this.createMediaObject(Yt.Album,e)),{src:`lastfm:album:${en()}`,artist:e.artist.name,year:(null===(t=e.wiki)||void 0===t?void 0:t.published)&&new Date(e.wiki.published).getFullYear()||void 0,pager:this.createAlbumPager(e)})}createMediaArtist(e){return Object.assign(Object.assign({},this.createMediaObject(Yt.Artist,e)),{src:`lastfm:artist:${en()}`,pager:this.createArtistAlbumsPager(e)})}createMediaObject(e,t){return{itemType:e,title:t.name,rating:Number(t.loved)||0,playCount:Number(t[this.playCountName])||void 0,globalPlayCount:"userplaycount"===this.playCountName&&Number(t.playcount)||void 0,thumbnails:this.createThumbnails(t.image),externalUrl:t.url}}createThumbnails(e){const t=e?[this.createThumbnail(e[0],34),this.createThumbnail(e[1],64),this.createThumbnail(e[2],174),this.createThumbnail(e[3],300)].filter(Ce):[];return 0===t.length?void 0:t}createThumbnail(e,t,r=t){if(e){const n=e["#text"];if(n&&!n.endsWith("2a96cbd8b46e442fc41c2b86b821562f.png"))return{url:n,width:t,height:r}}}createArtistAlbumsPager(e){return new cm({method:"artist.getTopAlbums",artist:e.name},(({topalbums:e})=>{const t=e["@attr"];return{items:e.album,total:Number(t.total)||void 0,atEnd:t.page===t.totalPages,itemType:Yt.Album}}),{maxSize:100,playCountName:"userplaycount"})}createAlbumPager(e){return new cm({method:"album.getInfo",album:e.name,artist:e.artist.name,user:Zf.userId},(({album:e})=>{if(e.tracks){const t=(e.tracks.track||[]).map((t=>Object.assign(Object.assign({},t),{album:{"#text":e.name},image:t.image||e.image})));return{items:t,total:t.length,atEnd:!0,itemType:Yt.Media}}throw Error("No track info")}),{playCountName:"userplaycount"})}}cm.minPageSize=10,cm.maxPageSize=200;class um extends cm{constructor(e,t){super(Object.assign(Object.assign({},e),{method:"user.getRecentTracks",extended:"1",user:Zf.userId}),(({recenttracks:e})=>{var t,r;const n=e["@attr"]||{},i=e.track,a=i?Array.isArray(i)?i:[i]:[],s="true"===(null===(r=null===(t=a[0])||void 0===t?void 0:t["@attr"])||void 0===r?void 0:r.nowplaying),o=Number(n.page)||1,l=Number(n.totalPages)||1,c=1===l||o===l,u=Number(n.total)||void 0;return s&&a.shift(),{items:a,total:u,atEnd:c,itemType:Yt.Media}}),t)}}const hm=new fe("scrobbling"),dm=new tr(hm.getJson("noScrobble",{})),fm=new tr(hm.getJson("options",{}));function mm(e,t){var r;const n=dm.getValue()[e.id];return!(null!==(r=null==n?void 0:n[t.id])&&void 0!==r?r:t.defaultNoScrobble)}function pm(e,t){const r=dm.getValue(),n=r[e.id],i=Object.assign(Object.assign({},n),t),a=Object.assign(Object.assign({},r),{[e.id]:i});hm.setJson("noScrobble",a),dm.next(a)}function gm(e){var t;return!!(null===(t=fm.getValue()[e.id])||void 0===t?void 0:t.updateNowPlaying)}function Am(e,t){const r=fm.getValue(),n=r[e.id],i=Object.assign(Object.assign({},n),t),a=Object.assign(Object.assign({},r),{[e.id]:i});hm.setJson("options",a),fm.next(a)}const vm={canScrobble:mm,setNoScrobble:pm,canUpdateNowPlaying:gm,updateOptions:Am};console.log("module::lastfmScrobbler");const bm=new le("lastfmScrobbler");function ym(e){const[t]=e.src.split(":"),r=vp.get(t);return!r||vm.canScrobble(Sm,r)}im().pipe(It((e=>e?Af():ie)),kt((()=>vm.canUpdateNowPlaying(Sm))),at((({currentItem:e})=>e)),kt(Ce),kt((e=>ym(e))),ot((e=>lm.updateNowPlaying(e)))).subscribe(bm),im().pipe(It((e=>e?Qo():ie)),at((e=>e.filter((e=>!e.lastfmScrobbledAt)))),Qn(1e4),ot((function(e){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){try{if(0===e.length)return;const t=e[0].playedAt+Math.floor(e[0].duration),r=e.at(-1).playedAt,n=new um({from:r-30,to:t+30,limit:um.maxPageSize}),i=yield Me(n),a=i.map((e=>Wo(e,30))),[s,o]=Le(e,(e=>!ym(e)||a.includes(Wo(e,30))||!!$o(i,e)));if(yield Xo(s.map((e=>Object.assign(Object.assign({},e),{lastfmScrobbledAt:-1})))),o.length>0){o.reverse(),o.length=Math.min(o.length,50),yield lm.scrobble(o);const e=Math.floor(Date.now()/1e3);yield Xo(o.map((t=>Object.assign(Object.assign({},t),{lastfmScrobbledAt:e}))))}}catch(e){bm.error(e)}}))}))).subscribe(bm),console.log("module::lastfm");const wm={view:"card compact",fields:["Thumbnail","Title","Artist","Year","PlayCount"]},_m={view:"details",fields:["Index","Title","Artist"]},Em={id:"lastfm/history",title:"History",icon:"clock",itemType:Yt.Media,search:({startAt:e=0}={})=>(console.log("search/lastfm/history",{to:e}),new um(e?{to:e}:void 0))};function xm(e,t){return Object.assign(Object.assign({},t),{id:`lastfm/top/${e.slice(11).toLowerCase()}`,icon:"star",searchable:!1,unplayable:!0,search:({period:r="overall"}={})=>new cm({method:e,period:r,user:Zf.userId},(r=>{const[,n]=e.toLowerCase().split("."),i=r[n.slice(3)],a=i["@attr"],s=i[n.slice(6,-1)],o=Number(a.page)||1,l=Number(a.totalPages)||1,c=1===l||o===l;return{items:s,total:Number(a.total)||void 0,atEnd:c,itemType:t.itemType}}))})}const Sm={id:"lastfm",title:"last.fm",icon:"lastfm",url:"https://www.last.fm/",scrobbler:!0,roots:[{id:"lastfm/recently-played",title:"Recently Played",icon:"clock",itemType:Yt.Media,search:()=>new um}],sources:[xm("user.getTopTracks",{title:"Top Tracks",itemType:Yt.Media,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","PlayCount"]}}),xm("user.getTopAlbums",{title:"Top Albums",itemType:Yt.Album,layout:wm,secondaryLayout:_m}),xm("user.getTopArtists",{title:"Top Artists",itemType:Yt.Artist,layout:{view:"card minimal",fields:["Thumbnail","Title","PlayCount"]},secondaryLayout:wm,tertiaryLayout:_m}),Em],observeIsLoggedIn:im,login:function(){return em(this,void 0,void 0,(function*(){if(""===rm.getValue())try{const e=yield function(){return em(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{const r=location.hostname,n=("localhost"===r?`http://${r}:${location.port}`:`https://${r}`)+"/auth/lastfm/callback/";let i=null;const a=r=>{if(/(localhost|ampcast)/.test(r.origin)){if(clearInterval(s),window.removeEventListener("message",a,!1),null==i||i.close(),i=null,r.origin!==location.origin)return void t({message:`Origin ${r.origin} does not match ${location.origin}`});e(r.data.token)}};window.addEventListener("message",a,!1),i=window.open(`https://www.last.fm/api/auth?api_key=${ar}&cb=${n}`,"last.fm","popup");const s=setInterval((()=>{(null==i?void 0:i.closed)&&(clearInterval(s),t({message:"access_denied"}))}),500)}))}))}(),t=yield function(e){return em(this,void 0,void 0,(function*(){const t="auth.getSession",r=am({api_key:ar,token:e,method:t}),n=yield fetch(`https://ws.audioscrobbler.com/2.0?method=${t}&api_key=${ar}&token=${e}&api_sig=${r}&format=json`);if(!n.ok)throw n;const{session:i}=yield n.json();return Zf.userId=i.name,Zf.token=e,Zf.sessionKey=i.key,i.key}))}(e);tm.log("Access token successfully obtained."),nm.next(t),rm.next(e)}catch(e){tm.log("Could not obtain access token."),tm.error(e)}}))},logout:function(){return em(this,void 0,void 0,(function*(){Zf.clear(),nm.next(""),rm.next("")}))}},Tm=new fe("listenbrainz"),km={get token(){return Tm.getString("token")},set token(e){Tm.setString("token",e)},get userId(){return Tm.getString("userId")},set userId(e){Tm.setString("userId",e)},get firstScrobbledAt(){return Tm.getString("firstScrobbledAt")},set firstScrobbledAt(e){Tm.setString("firstScrobbledAt",e)},clear(){Tm.clear()}};function Im(t){var{href:r,children:n=r}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["href","children"]);return e.createElement("span",{className:"external-link"},e.createElement("a",Object.assign({},i,{href:r,target:"_blank",rel:"noopener"}),n))}var Cm=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function Pm(t){const r=(0,e.useRef)(null),n=(0,e.useRef)(null),i=(0,e.useRef)(null),a=(0,e.useRef)(null),s="https://listenbrainz.org/profile/",o=(0,e.useCallback)((()=>Cm(this,void 0,void 0,(function*(){try{const e=n.current.value,t=i.current.value;km.userId=e;const a=yield fetch("https://api.listenbrainz.org/1/validate-token",{headers:{"Content-Type":"application/json",Authorization:`Token ${t}`}});if(!a.ok)throw a;const{valid:s,user_name:o}=yield a.json();if(!s)throw Error("Invalid token.");if(o!==e)throw Error("Token not valid for this user.");r.current.close(JSON.stringify({userId:e,token:t}))}catch(e){console.error(e)}}))),[]),l=(0,e.useCallback)((e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.repeat||a.current.click())}),[]),c=(0,e.useCallback)((e=>{e.preventDefault(),o()}),[o]);return e.createElement(Pn,Object.assign({},t,{className:"listenbrainz-login-dialog",title:"Login to ListenBrainz",ref:r}),e.createElement("form",{method:"dialog",onKeyDown:l,onSubmit:c},e.createElement("div",{className:"table-layout"},e.createElement("p",null,e.createElement("label",{htmlFor:"listenbrainz-username"},"User:"),e.createElement(Ln,{type:"text",id:"listenbrainz-username",autoFocus:!0,ref:n,required:!0,defaultValue:km.userId})),e.createElement("p",null,e.createElement("label",{htmlFor:"listenbrainz-token"},"Token:"),e.createElement(Ln,{type:"password",id:"listenbrainz-token",required:!0,ref:i}))),e.createElement("p",{className:"listenbrainz-link"},e.createElement(Im,{href:s},e.createElement(un,{name:"listenbrainz"}),s)),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel"},"Cancel"),e.createElement(cn,{ref:a},"Login"))))}var Mm=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::listenbrainzAuth");const Rm=new le("listenbrainzAuth"),Bm=new tr("");function Lm(){return Bm.pipe(rr()).pipe(at((e=>""!==e)),rr())}Bm.next(km.token);var Dm=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::musicbrainzApi");const Nm=new class{constructor(){this.host="https://musicbrainz.org/ws/2",this.lastCall=0}getISRC(e){var t;return Dm(this,void 0,void 0,(function*(){const r=yield this.get(`/recording/${e}`,{inc:"isrcs"});return(null===(t=r.isrcs)||void 0===t?void 0:t[0])||""}))}getRecordingByISRC(e){return Dm(this,void 0,void 0,(function*(){return(yield this.get(`/isrc/${e}`)).recordings[0]||null}))}getAlbumCover(e){return{url:`https://coverartarchive.org/release/${e}/front-250`,width:250,height:250}}get(e,t={}){return Dm(this,void 0,void 0,(function*(){yield this.applyRateLimiting(),e.startsWith("/")&&(e=e.slice(1)),t.fmt="json",e=`${e}?${new URLSearchParams(t)}`,this.lastCall=Date.now();const r=yield fetch(`${this.host}/${e}`,{method:"GET",headers:{"User-Agent":"ampcast/0.5.4 ( rekky.rosso@gmail.com )"}});if(!r.ok)throw r;return yield r.json()}))}applyRateLimiting(){return new Promise((e=>{const t=Date.now()-this.lastCall;t>1e3?e():setTimeout((()=>e),t)}))}};var Om=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::listenbrainzApi");const zm=new le("listenbrainzApi"),Fm=new class{constructor(){this.host="https://api.listenbrainz.org/1",this.rateLimitRemainingCalls=2,this.rateLimitResetTime=0}getListeningActivity({range:e="all_time"}={}){return Om(this,void 0,void 0,(function*(){const{payload:{listening_activity:t}}=yield this.get(`stats/user/${km.userId}/listening-activity`,{range:e});return t}))}getListenCount(){return Om(this,void 0,void 0,(function*(){const{payload:{count:e}}=yield this.get(`user/${km.userId}/listen-count`);return e}))}getListens(e){return Om(this,void 0,void 0,(function*(){return zm.log("getListens",{params:e}),yield this.get(`user/${km.userId}/listens`,e)}))}scrobble(e){return Om(this,void 0,void 0,(function*(){e.length>0&&(zm.log("scrobble",{items:e}),yield this.post("submit-listens",{listen_type:1===e.length?"single":"import",payload:e.map((e=>({listened_at:e.playedAt,track_metadata:this.getScrobbleParams(e)})))}))}))}updateNowPlaying(e){return Om(this,void 0,void 0,(function*(){zm.log("updateNowPlaying",{item:e});try{this.canScrobble(e)&&(yield this.post("submit-listens",{listen_type:"playing_now",payload:[{track_metadata:this.getScrobbleParams(e)}]}))}catch(t){zm.log('Failed to update "now playing":',{item:e}),zm.error(t)}}))}get(e,t,r){return Om(this,void 0,void 0,(function*(){t&&(e=`${e}?${new URLSearchParams(t)}`);const n=yield this.fetch(e,{method:"GET"},r);if(!n.ok||204===n.status)throw n;return n.json()}))}post(e,t){return Om(this,void 0,void 0,(function*(){const r=JSON.stringify(t);return this.fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:r},!0)}))}fetch(e,t,r=!1){return Om(this,void 0,void 0,(function*(){yield this.applyRateLimiting(),r&&(t.headers=Object.assign(Object.assign({},t.headers),{Authorization:`Token ${km.token}`})),e.startsWith("/")&&(e=e.slice(1));const n=yield window.fetch(`${this.host}/${e}`,t);if(!n.ok)throw n;const i=n.headers;return i.has("x-ratelimit-remaining")&&(this.rateLimitRemainingCalls=Number(i.get("x-ratelimit-remaining"))||1),i.has("x-ratelimit-reset-in")&&(this.rateLimitResetTime=Date.now()+1e3*(Number(i.get("x-ratelimit-reset-in"))||1)),zm.log({rateLimitRemaining:this.rateLimitRemainingCalls,rateLimitReset:new Date(this.rateLimitResetTime).toISOString()}),n}))}getScrobbleParams(e){const t={media_player:"ampcast",media_player_version:"0.5.4",submission_client:"ampcast"};e.duration&&(t.duration=Math.round(e.duration)),e.track&&(t.tracknumber=e.track),e.recording_mbid&&(t.recording_mbid=e.recording_mbid),e.isrc&&(t.isrc=e.isrc),e.externalUrl&&(t.origin_url=e.externalUrl);const[r]=e.src.split(":");switch(r){case"spotify":e.externalUrl&&(t.spotify_id=e.externalUrl),t.music_service="spotify.com";break;case"apple":t.music_service="music.apple.com";break;case"youtube":t.music_service="youtube.com";break;case"jellyfin":t.music_service_name="Jellyfin";break;case"plex":t.music_service_name="Plex";break;case"blob":case"file":t.music_service_name="Local file"}const n={track_name:e.title,artist_name:e.artist,additional_info:t};return e.album&&(n.release_name=e.album),n}canScrobble(e){return!!e&&!!e.title&&!!e.artist&&e.duration>30}applyRateLimiting(){return new Promise((e=>{if(this.rateLimitRemainingCalls)this.rateLimitRemainingCalls--,e();else{const t=this.rateLimitResetTime-Date.now();t>0?setTimeout(e,t):e()}}))}};class Um{constructor(e){this.nextPageParams=void 0,this.pager=new zr(((t=50)=>function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){try{const{payload:r}=yield Fm.get(`user/${km.userId}/listens`,Object.assign(Object.assign(Object.assign({},e),{count:t}),this.nextPageParams)),n=r.listens,i=this.createItems(n),a=i.length<t;return this.nextPageParams=a?void 0:{max_ts:n.at(-1).listened_at-1},{items:i,atEnd:a}}catch(e){if(this.isNoContentError(e))return{items:[],atEnd:!0};throw e}}))),{pageSize:50})}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createItems(e){return e.map((e=>this.createItem(e)))}createItem(e){var t,r,n;const i=e.track_metadata,a=i.additional_info;return Ho({itemType:Yt.Media,mediaType:yr.Audio,src:`listenbrainz:listen:${en()}`,title:i.track_name,addedAt:e.inserted_at,artist:i.artist_name,albumArtist:null==a?void 0:a.release_artist_name,album:i.release_name,duration:(null==a?void 0:a.duration)||((null==a?void 0:a.duration_ms)?Math.round(a.duration_ms/1e3):0),track:(null==a?void 0:a.tracknumber)||(null==a?void 0:a.track_number),disc:null==a?void 0:a.discnumber,isrc:null==a?void 0:a.isrc,recording_mbid:null===(t=i.mbid_mapping)||void 0===t?void 0:t.recording_mbid,release_mbid:null===(r=i.mbid_mapping)||void 0===r?void 0:r.release_mbid,playableUrl:null==a?void 0:a.origin_url,playedAt:e.listened_at,thumbnails:this.createThumbnails(null===(n=i.mbid_mapping)||void 0===n?void 0:n.release_mbid),playableSrc:this.getPlayableSrc(a)})}createThumbnails(e){return e?[Nm.getAlbumCover(e)]:void 0}getPlayableSrc(e){var t,r;if(e){if(e.spotify_id)return this.getSpotifySrc(null==e?void 0:e.spotify_id);if(null===(t=e.origin_url)||void 0===t?void 0:t.includes("spotify.com"))return this.getSpotifySrc(e.origin_url);if(null===(r=e.origin_url)||void 0===r?void 0:r.includes("apple.com"))return this.getAppleSrc(e.origin_url)}}getSpotifySrc(e){if(e){const t=e.split("/").pop();if(t)return`spotify:track:${t}`}}getAppleSrc(e){if(e){const t=e.split("i=").pop();if(t)return`apple:song:${t}`}}isNoContentError(e){return 204===(null==e?void 0:e.status)}}Um.maxPageSize=100;class jm{constructor(e,t){this.mbid=e,this.pager=new zr((()=>function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){var r;const{media:n=[]}=yield Nm.get(`release/${e}`,{inc:"recordings"});return{items:this.createItems((null===(r=n[0])||void 0===r?void 0:r.tracks)||[],t),atEnd:!0}}))))}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createItems(e,t){return e.map((e=>this.createItem(e,t)))}createItem(e,t){const r=e.recording;return{itemType:Yt.Media,mediaType:yr.Audio,src:`musicbrainz:track:${r.id}`,title:e.title,artist:null==t?void 0:t.artist,albumArtist:null==t?void 0:t.artist,album:null==t?void 0:t.title,duration:e.length/1e3||0,track:e.number?Number(e.number):void 0,recording_mbid:r.id,release_mbid:this.mbid,year:(null==t?void 0:t.year)||new Date(r["first-release-date"]).getUTCFullYear()||void 0,playedAt:0,thumbnails:(null==t?void 0:t.thumbnails)||this.createThumbnails()}}createThumbnails(){return[Nm.getAlbumCover(this.mbid)]}}class Vm{constructor(e,t){let r=0;this.pager=new zr(((n=50)=>function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){try{const i=yield Fm.get(e,Object.assign(Object.assign({},t),{offset:r,count:n}));return r+=n,this.createPage(i)}catch(e){if(this.isNoContentError(e))return{items:[],atEnd:!0};throw e}}))),{pageSize:50})}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createPage(e){if(this.isRecordingsResponse(e)){const t=e.payload,r=t.recordings.map((e=>this.createMediaItem(e))),n=t.total_recording_count;return{items:r,total:n,atEnd:t.offset+r.length>=n}}if(this.isReleasesResponse(e)){const t=e.payload,r=t.releases.map((e=>this.createMediaAlbum(e))),n=t.total_release_count;return{items:r,total:n,atEnd:t.offset+r.length>=n}}if(this.isArtistsResponse(e)){const t=e.payload,r=t.artists.map((e=>this.createMediaArtist(e))),n=t.total_artist_count;return{items:r,total:n,atEnd:t.offset+r.length>=n}}throw Error("Unknown response.")}createMediaArtist(e){return{itemType:Yt.Artist,src:`listenbrainz:artist:${en()}`,title:e.artist_name,artist_mbids:e.artist_mbids,playCount:e.listen_count,pager:new Kt}}createMediaAlbum(e){const t=e.release_mbid||void 0,r={itemType:Yt.Album,src:`listenbrainz:album:${en()}`,title:e.release_name,artist:e.artist_name,release_mbid:t,artist_mbids:e.artist_mbids,playCount:e.listen_count,thumbnails:this.createThumbnails(e.release_mbid)};return Object.assign(Object.assign({},r),{pager:t?new jm(t,r):new Kt})}createMediaItem(e){return Ho({itemType:Yt.Media,mediaType:yr.Audio,src:`listenbrainz:track:${en()}`,title:e.track_name,artist:e.artist_name,album:e.release_name,duration:0,recording_mbid:e.recording_mbid,release_mbid:e.release_mbid,artist_mbids:e.artist_mbids,playCount:e.listen_count,playedAt:0,thumbnails:this.createThumbnails(e.release_mbid)})}createThumbnails(e){return e?[Nm.getAlbumCover(e)]:void 0}isRecordingsResponse(e){return"total_recording_count"in e.payload}isReleasesResponse(e){return"total_release_count"in e.payload}isArtistsResponse(e){return"total_artist_count"in e.payload}isNoContentError(e){return 204===(null==e?void 0:e.status)}}console.log("module::listenbrainzScrobbler");const qm=new le("listenbrainzScrobbler");function Qm(e){const[t]=e.src.split(":"),r=vp.get(t);return!r||vm.canScrobble(Wm,r)}Lm().pipe(It((e=>e?Af():ie)),kt((()=>vm.canUpdateNowPlaying(Wm))),at((({currentItem:e})=>e)),kt(Ce),kt((e=>Qm(e))),ot((e=>Fm.updateNowPlaying(e)))).subscribe(qm),Lm().pipe(It((e=>e?Qo():ie)),at((e=>e.filter((e=>!e.listenbrainzScrobbledAt)))),Qn(1e4),ot((function(e){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){try{if(0===e.length)return;const t=e[0].playedAt+Math.floor(e[0].duration),r=e.at(-1).playedAt,n=new Um({min_ts:r-30,max_ts:t+30,count:Um.maxPageSize}),i=yield Me(n),a=i.map((e=>Wo(e,30))),[s,o]=Le(e,(e=>!Qm(e)||a.includes(Wo(e,30))||!!$o(i,e)));if(yield Xo(s.map((e=>Object.assign(Object.assign({},e),{listenbrainzScrobbledAt:-1})))),o.length>0){o.reverse(),o.length=Math.min(o.length,50),yield Fm.scrobble(o);const e=Math.floor(Date.now()/1e3);yield Xo(o.map((t=>Object.assign(Object.assign({},t),{listenbrainzScrobbledAt:e}))))}}catch(e){qm.error(e)}}))}))).subscribe(qm),console.log("module::listenbrainz");const Xm={id:"listenbrainz/history",title:"History",icon:"clock",itemType:Yt.Media,search:({startAt:e=0}={})=>(console.log("search/listenbrainz/history",{max_ts:e}),new Um(e?{max_ts:e}:void 0))},Wm={id:"listenbrainz",title:"ListenBrainz",icon:"listenbrainz",url:"https://listenbrainz.org/",scrobbler:!0,roots:[{id:"listenbrainz/recently-played",title:"Recently Played",icon:"clock",itemType:Yt.Media,search:()=>(console.log("search/listenbrainz/history"),new Um)}],sources:[{id:"listenbrainz/top/tracks",title:"Top Tracks",icon:"star",itemType:Yt.Media,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","PlayCount"]},search:e=>new Vm(`stats/user/${km.userId}/recordings`,e)},{id:"listenbrainz/top/albums",title:"Top Albums",icon:"star",itemType:Yt.Album,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","Year","PlayCount"]},search:e=>new Vm(`stats/user/${km.userId}/releases`,e)},{id:"listenbrainz/top/artists",title:"Top Artists",icon:"star",itemType:Yt.Artist,layout:{view:"card minimal",fields:["Thumbnail","Title","PlayCount"]},search:e=>new Vm(`stats/user/${km.userId}/artists`,e)},Xm],observeIsLoggedIn:Lm,login:function(){return Mm(this,void 0,void 0,(function*(){if(""===Bm.getValue())try{const e=yield function(){return Cm(this,void 0,void 0,(function*(){return Bn(Pm,!0)}))}();if(e){const{userId:t,token:r}=JSON.parse(e);km.userId=t,km.token=r,Rm.log("Access token successfully obtained."),Bm.next(r)}}catch(e){Rm.log("Could not obtain access token."),Rm.error(e)}}))},logout:function(){return Mm(this,void 0,void 0,(function*(){Bm.next(""),km.clear()}))}};var $m=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::plexAuth");const Hm=new le("plexAuth"),Gm="https://plex.tv/api/v2",Ym=new tr(""),Km=new tr(!1);let Jm;function Zm(){return Ym.pipe(rr()).pipe(at((e=>""!==e)),rr())}function ep(e){hd.userToken=e,e&&Hm.log("Access token successfully obtained."),Ym.next(e)}ep(hd.userToken),Zm().pipe(kt((e=>e)),Pr((()=>$m(void 0,void 0,void 0,(function*(){const e=function(e,t){return $m(this,void 0,void 0,(function*(){try{return yield gd.fetch({host:e.uri,path:"/",method:"HEAD",token:t}),e}catch(e){return null}}))},t=hd.connection;if(t){if(yield e(t,hd.serverToken))return Hm.log(`Using existing ${t.local?"local":"public"} connection.`),void Km.next(!0);hd.server=null,hd.connection=null}Hm.log("Searching for a connection...");try{const t=(yield function(){return $m(this,void 0,void 0,(function*(){return gd.fetchJSON({host:Gm,path:"/resources",params:{includeHttps:"1"}})}))}()).filter((e=>"server"===e.provides));for(const r of t){const t=yield Promise.all([...r.connections.map((t=>e(t,r.accessToken)))]),n=t.filter(Ce);if(n.length){const e=n.find((e=>e.local))||n[0];return hd.server=r,hd.connection=e,Hm.log(`Using ${e.local?"local":"public"} connection.`),void Km.next(!0)}}Hm.log("Could not establish a connection.")}catch(e){Hm.log(e),ep("")}}))))).subscribe(Hm),Km.pipe(kt((e=>e)),Pr((()=>$m(void 0,void 0,void 0,(function*(){Hm.log("Connected");const{MediaContainer:{Directory:e}}=yield gd.fetchJSON({path:"/library/sections"}),t=e.find((e=>"artist"===e.type));hd.libraryId=(null==t?void 0:t.key)||""}))))).subscribe(Hm);class tp{constructor(e,t){var r;this.path=e,this.params=t,this.pageSize=(null===(r=hd.connection)||void 0===r?void 0:r.local)?tp.maxPageSize:tp.minPageSize,this.pager=new Zr((e=>this.fetch(e)),{pageSize:this.pageSize})}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetch(e){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){const t=yield gd.fetchJSON({path:this.path,params:this.params,headers:{"X-Plex-Container-Size":String(this.pageSize),"X-Plex-Container-Start":String((e-1)*this.pageSize)}}),{MediaContainer:{Metadata:r=[],totalSize:n}}=t;return{items:r.map((e=>this.createItem(e))),total:n}}))}createItem(e){switch(e.type){case"clip":return this.createMediaItemFromVideo(e);case"album":return this.createMediaAlbum(e);case"artist":return this.createMediaArtist(e);case"playlist":return this.createMediaPlaylist(e);default:return this.createMediaItemFromTrack(e)}}createMediaItemFromTrack(e){const[t]=e.Media,[r]=t.Part,n="[Unknown Album]"===e.parentTitle?"":e.parentTitle||"";return{itemType:Yt.Media,mediaType:yr.Audio,src:`plex:audio:${r.key}`,title:e.title,addedAt:e.addedAt,artist:e.grandparentTitle,albumArtist:n?e.grandparentTitle:void 0,album:n,duration:e.duration/1e3,track:n?e.index:void 0,rating:e.userRating,year:e.parentYear,playedAt:e.lastViewedAt||0,playCount:e.viewCount,plex:{ratingKey:e.ratingKey},thumbnails:this.createThumbnails(e.thumb)}}createMediaAlbum(e){var t;return{itemType:Yt.Album,src:`plex:album:${e.ratingKey}`,title:e.title||"",addedAt:e.addedAt,artist:e.parentTitle,rating:e.userRating,year:e.year,playedAt:e.lastViewedAt,playCount:e.viewCount,genre:null===(t=e.Genre)||void 0===t?void 0:t.map((e=>e.tag)).join(";"),plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.thumb)}}createMediaArtist(e){var t;return{itemType:Yt.Artist,src:`plex:album:${e.ratingKey}`,title:e.title,addedAt:e.addedAt,rating:e.userRating,genre:null===(t=e.Genre)||void 0===t?void 0:t.map((e=>e.tag)).join(";"),plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.thumb)}}createMediaItemFromVideo(e){const[t]=e.Media,[r]=t.Part;return{itemType:Yt.Media,mediaType:yr.Video,src:`plex:video:${r.key}`,title:e.title||"Video",addedAt:e.addedAt,artist:e.grandparentTitle,duration:e.duration/1e3,playedAt:e.lastViewedAt||0,playCount:e.viewCount,plex:{ratingKey:e.ratingKey},thumbnails:this.createThumbnails(e.thumb)}}createMediaPlaylist(e){return{itemType:Yt.Playlist,src:`plex:playlist:${e.key}`,title:e.title,addedAt:e.addedAt,duration:e.duration/1e3,playedAt:e.lastViewedAt,playCount:e.viewCount,trackCount:e.leafCount,plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.composite)}}createThumbnails(e){return e?[this.createThumbnail(e,60),this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t,r=t){return{url:`${hd.host}/photo/:/transcode?url=${encodeURIComponent(e)}&width=${t}&height=${r}&minSize=1&upscale=1&X-Plex-Token={plex-token}`,width:t,height:r}}createPager(e){return new tp(e)}}tp.minPageSize=100,tp.maxPageSize=1e3;var rp=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::plexPlayback");const np=new le("plexPlayback");let ip=null;function ap(e,t,r){return rp(this,void 0,void 0,(function*(){try{yield sp(e,t,r)}catch(e){np.error(e)}}))}function sp(e,t,r,n){return rp(this,void 0,void 0,(function*(){const[,,i]=e.src.split(":");yield gd.fetch({path:"/:/timeline",params:{key:i,ratingKey:e.plex.ratingKey,playQueueItemID:String(ip.playQueueSelectedItemID),state:r,hasMDE:"1",time:String(Math.floor(1e3*t)),duration:String(Math.floor(1e3*e.duration))},keepalive:n})}))}console.log("module::plexReporting");const op=new le("plexReporting"),lp=e=>{var t;return!!(null===(t=e.currentItem)||void 0===t?void 0:t.src.startsWith("plex:"))};Zm().pipe(It((e=>e?Af():ie)),kt(lp),ot((({currentItem:e})=>function(e){return rp(this,void 0,void 0,(function*(){try{const[,,t]=e.src.split(":");ip=yield function(e){return rp(this,void 0,void 0,(function*(){return gd.fetchJSON({path:"/playQueues",method:"POST",params:{type:"music",continuous:"0",uri:`server://${hd.server.clientIdentifier}/com.plexapp.plugins.library/${e}`,repeat:"0",own:"1",includeExternalMedia:"1"}})}))}(t),yield sp(e,0,"playing")}catch(e){np.error(e)}}))}(e)))).subscribe(op),Zm().pipe(It((e=>e?vf():ie)),kt(lp),ot((({currentItem:e})=>function(e){return rp(this,void 0,void 0,(function*(){try{yield sp(e,0,"stopped",!0)}catch(e){np.error(e)}}))}(e)))).subscribe(op),Zm().pipe(It((e=>e?bf(1e4):ie)),kt(lp),ot((({currentItem:e,currentTime:t,paused:r})=>ap(e,t,r?"paused":"playing")))).subscribe(op),Zm().pipe(It((e=>e?Af():ie)),It((e=>lp(e)?yf().pipe(rr(((e,t)=>e.paused===t.paused)),Vn(1),ne(vf())):ie)),ot((({currentItem:e,currentTime:t,paused:r})=>ap(e,t,r?"paused":"playing")))).subscribe(op),console.log("module::plex");const cp={id:"plex/video",title:"Music Video",icon:"video",itemType:Yt.Media,searchable:!0,search:({q:e=""}={})=>new tp(`/library/sections/${hd.libraryId}/extras/all`,{title:e,type:"8",extraType:"4"})},up={id:"plex/recently-played",title:"Recently Played",icon:"clock",itemType:Yt.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>new tp(`/library/sections/${hd.libraryId}/all`,{type:"10","lastViewedAt>":"0",sort:"lastViewedAt:desc"})},hp={id:"plex/most-played",title:"Most Played",icon:"most-played",itemType:Yt.Media,search:()=>new tp(`/library/sections/${hd.libraryId}/all`,{type:"10","viewCount>":"1",sort:"viewCount:desc,lastViewedAt:desc"})},dp={id:"plex/top-rated",title:"Top Rated",icon:"star",itemType:Yt.Media,search:()=>new tp(`/library/sections/${hd.libraryId}/all`,{type:"10","track.userRating>":"1",sort:"track.userRating:desc,viewCount:desc,lastViewedAt:desc"})},fp={id:"plex/playlists",title:"Playlists",icon:"playlists",itemType:Yt.Playlist,search:()=>new tp("/playlists/all",{type:"15",playlistType:"audio"})};function mp(e,t){return Object.assign(Object.assign({},t),{id:e,icon:"",searchable:!0,search:({q:t=""}={})=>function(e,t){return e?new tp(`/library/sections/${hd.libraryId}/all`,{title:e,type:t}):new Kt}(t,e)})}const pp={id:"plex",title:"Plex",icon:"plex",url:"https://www.plex.tv/",roots:[mp("10",{title:"Songs",itemType:Yt.Media}),mp("9",{title:"Albums",itemType:Yt.Album}),mp("8",{title:"Artists",itemType:Yt.Artist}),mp("15",{title:"Playlists",itemType:Yt.Playlist})],sources:[cp,hp,up,dp,fp],observeIsLoggedIn:Zm,login:function(){return $m(this,void 0,void 0,(function*(){if(""===Ym.getValue())try{const{id:e,authToken:t}=yield function(){return $m(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{const r=location.hostname,n=("localhost"===r?`http://${r}:${location.port}`:`https://${r}`)+"/auth/plex/callback/";let i=null;const a=r=>{if(/(localhost|ampcast)/.test(r.origin)){if(clearInterval(o),window.removeEventListener("message",a,!1),null==i||i.close(),i=null,r.origin!==location.origin)return void t({message:`Origin ${r.origin} does not match ${location.origin}`});let n=10;const s=()=>$m(this,void 0,void 0,(function*(){n--;try{const{authToken:r,id:i}=yield gd.fetchJSON({host:Gm,path:`/pins/${Jm.id}`});r?e({id:i,authToken:r}):n?setTimeout(s,200):t("Timeout.")}catch(e){t(e)}}));s()}};window.addEventListener("message",a,!1);const s=`clientID=${hd.clientId}&code=${Jm.code}&forwardUrl=${encodeURIComponent(n)}&context%5Bdevice%5D%5Bproduct%5D=ampcast`;i=window.open(`https://app.plex.tv/auth#?${s}`,"Plex","popup");const o=setInterval((()=>{(null==i?void 0:i.closed)&&(clearInterval(o),t({message:"access_denied"}))}),500)}))}))}();hd.userId=e,ep(t)}catch(e){Hm.log("Could not obtain access token."),Hm.error(e)}}))},logout:function(){return $m(this,void 0,void 0,(function*(){Km.next(!1),ep(""),hd.clear()}))}},gp=new Map([Yr,ph,ed,pp,Gf,Sm,Wm].map((e=>[e.id,e]))),Ap=[...gp.values()],vp={get all(){return Ap},get:e=>gp.get(e)},bp=new fe("services"),yp=new tr(bp.getJson("hidden",{}));function wp(e){return!function(e){var t;return null!==(t=yp.getValue()[e.id])&&void 0!==t?t:!!e.defaultHidden}(e)}function _p(e){const t=yp.getValue(),r=Object.assign(Object.assign({},t),e);bp.setJson("hidden",r),yp.next(r)}var Ep=__webpack_require__(5800);function xp({service:t}){return e.createElement("p",null,e.createElement(cn,{className:"branded login",onClick:t.login},"Log in to ",t.title))}function Sp({service:t}){return e.createElement("p",null,e.createElement(Im,{href:t.url},e.createElement(un,{name:t.icon}),t.url))}function Tp({service:t}){return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You need to be logged in to play music from ",t.title,"."),e.createElement(xp,{service:t}),e.createElement(Sp,{service:t})))}function kp(){return(0,e.useEffect)((()=>{const e=new Zt,t=e.pipe(ot((e=>rt(e))),ot((()=>function(){return $m(this,void 0,void 0,(function*(){return Jm=yield gd.fetchJSON({host:Gm,path:"/pins",method:"POST",params:{strong:"true"}}),Jm}))}())),at((e=>1e3*e.expiresIn)),Pr((t=>e.next(t)))).subscribe();return e.next(0),()=>t.unsubscribe()})),e.createElement(Tp,{service:pp})}function Ip(){return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You need to be logged in to play music from Spotify.*"),e.createElement(xp,{service:ph}),e.createElement(Sp,{service:ph}),e.createElement("p",null,e.createElement("small",null,"*Spotify Premium required."))))}function Cp(){return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You can still play YouTube videos without being logged in.",e.createElement("br",null),"But you need to be logged in to search for music and access your playlists."),e.createElement(xp,{service:ed}),e.createElement(Sp,{service:ed})))}function Pp({service:t}){switch(t.id){case"plex":return e.createElement(kp,null);case"spotify":return e.createElement(Ip,null);case"youtube":return e.createElement(Cp,null);default:return e.createElement(Tp,{service:t})}}function Mp({onSubmit:t}){const r=(0,e.useRef)(null),n=(0,e.useCallback)((e=>{const n=r.current.value;e.preventDefault(),null==t||t(n)}),[t]);return e.createElement("form",{className:"search-bar",onSubmit:n},e.createElement("p",{className:"search-bar-input"},e.createElement(Ln,{type:"search",spellCheck:!1,autoComplete:"off",autoCapitalize:"off",ref:r}),e.createElement(cn,{type:"submit"},"Search")))}function Rp({min:t="1970",max:r=Bp(),value:n=r,onSelect:i}){const[a,s]=(0,e.useState)(String(new Date(n).getFullYear())),o=function(t,r){const[n,i]=(0,e.useState)([]);return(0,e.useLayoutEffect)((()=>{const e=[],n=new Date(t),a=new Date(r),s=n.getFullYear();let o=a.getFullYear();for(;o>=s;)e.push(o),o--;i(e)}),[t,r]),n}(t,r);(0,e.useEffect)((()=>{null==i||i(a)}),[i,a]);const l=(0,e.useCallback)((e=>{s(e.target.value)}),[]);return e.createElement("span",{className:"year-picker"},e.createElement("select",{defaultValue:a,onChange:l},o.map((t=>e.createElement("option",{value:t,key:t},t)))))}function Bp(){const e=new Date;return String(e.getFullYear())}const Lp=(()=>{const e=new Intl.DateTimeFormat(navigator.language,{month:"short"}).format;return[...Array(12).keys()].map((t=>e(new Date(2022,t,2))))})();function Dp({min:t="1970-01",max:r=Ne(),value:n=r,onSelect:i}){const a=(0,e.useRef)(null),[s,o]=(0,e.useState)((()=>String(new Date(n).getFullYear()))),[l,c]=(0,e.useState)((()=>new Date(n).getMonth())),u=function(t,r,n){const[i,a]=(0,e.useState)([]);return(0,e.useLayoutEffect)((()=>{const e=[],i=new Date(r),s=new Date(n),o=Number(t)===i.getFullYear()?i.getMonth():0;let l=Number(t)===s.getFullYear()?s.getMonth():11;for(;l>=o;)e.push(l),l--;a(e)}),[t,r,n]),i}(s,t,r);(0,e.useLayoutEffect)((()=>{const e=u[0];void 0!==e&&(a.current.value=String(e),c(e))}),[u]),(0,e.useEffect)((()=>{-1!==l&&(null==i||i(`${s}-${String(l+1).padStart(2,"0")}`))}),[i,s,l]);const h=(0,e.useCallback)((e=>{c(-1),o(e)}),[]),d=(0,e.useCallback)((e=>{c(Number(e.target.value))}),[]);return e.createElement("span",{className:"month-picker"},e.createElement(Rp,{min:t,max:r,value:s,onSelect:h}),e.createElement("select",{defaultValue:l,onChange:d,key:s,ref:a},u.map((t=>e.createElement("option",{value:t,key:t},Lp[t])))))}function Np({min:t="1970-01-01",max:r=De(),value:n=r,onSelect:i}){const a=(0,e.useRef)(null),[s,o]=(0,e.useState)((()=>Ne(n))),[l,c]=(0,e.useState)((()=>new Date(n).getDate())),u=function(t,r,n){const[i,a]=(0,e.useState)([]);return(0,e.useLayoutEffect)((()=>{const e=[],i=new Date(r),s=new Date(n),o=t.split("-").map(Number),l=o[0],c=o[1]-1,u=l===i.getFullYear()&&c===i.getMonth()?i.getDate():1;let h=l===s.getFullYear()&&c===s.getMonth()?s.getDate():new Date(l,c+1,0).getDate();for(;h>=u;)e.push(h),h--;a(e)}),[t,r,n]),i}(s,t,r);(0,e.useLayoutEffect)((()=>{const e=u[0];e&&(a.current.value=String(e),c(e))}),[u]),(0,e.useEffect)((()=>{l&&(null==i||i(`${s}-${String(l).padStart(2,"0")}`))}),[i,s,l]);const h=(0,e.useCallback)((e=>{c(0),o(e)}),[]),d=(0,e.useCallback)((e=>{c(Number(e.target.value))}),[]);return e.createElement("span",{className:"date-picker"},e.createElement(Dp,{min:t,max:r,value:s,onSelect:h}),e.createElement("select",{defaultValue:l,onChange:d,key:s,ref:a},u.map((t=>e.createElement("option",{value:t,key:t},t)))))}function Op(t,r){const[n,i]=(0,e.useState)(null);return(0,e.useEffect)((()=>{i((null==t?void 0:t.search(r))||null)}),[t,r]),n}const zp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1H\nAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",Fp={url:zp,width:1,height:1};function Up({thumbnails:t,maxSize:r,className:n="",fallbackIcon:i}){return(null==t?void 0:t.length)?e.createElement(jp,{className:n,thumbnails:t,maxSize:r}):i?e.createElement(Vp,{className:n,fallbackIcon:i}):e.createElement("div",{className:`thumbnail-image ${n}`})}function jp({thumbnails:t,maxSize:r,className:n=""}){const i=function(e=[],t=360,r=1){if(0===e.length)return Fp;e.sort(((e,t)=>t.width*t.height-e.width*e.height));const[n,i]=Le(e,(e=>e.width<=t&&e.height<=t));return n.length>0?(n.sort(((e,t)=>{const n=e.width/e.height,i=Math.abs(n-r),a=t.width/t.height;return i-Math.abs(a-r)})),n[0]):i[i.length-1]||Fp}(t,r),a=i.url.replace("{plex-token}",hd.serverToken);return e.createElement("div",{className:`thumbnail-image ${n}`,style:{backgroundImage:`url(${a})`}})}function Vp({fallbackIcon:t,className:r=""}){return e.createElement(un,{className:`thumbnail-image ${r}`,name:t})}function qp({item:t}){switch(t.itemType){case Yt.Media:return e.createElement(Qp,{item:t});case Yt.Artist:return e.createElement(Wp,{item:t});case Yt.Album:return e.createElement(Xp,{item:t});case Yt.Playlist:return e.createElement($p,{item:t})}}function Qp({item:t}){return e.createElement("article",{className:"media-info media-item-info"},e.createElement("div",{className:"media-info-main"},e.createElement(eg,{thumbnails:t.thumbnails}),e.createElement(Hp,{title:t.title}),e.createElement(Gp,{artist:t.artist}),e.createElement(Jp,{album:t.album,year:t.year}),e.createElement(Yp,{owner:t.owner,src:t.src})),e.createElement(Kp,{url:t.externalUrl,src:t.src}))}function Xp({item:t}){return e.createElement("article",{className:"media-info album-info"},e.createElement("div",{className:"media-info-main"},e.createElement(eg,{thumbnails:t.thumbnails}),e.createElement(Hp,{title:t.title}),e.createElement(Gp,{artist:t.artist}),e.createElement(Zp,{year:t.year})),e.createElement(Kp,{url:t.externalUrl,src:t.src}))}function Wp({item:t}){return e.createElement("article",{className:"media-info artist-info"},e.createElement("div",{className:"media-info-main"},e.createElement(eg,{thumbnails:t.thumbnails,fallbackIcon:"person"}),e.createElement(Hp,{title:t.title})),e.createElement(Kp,{url:t.externalUrl,src:t.src}))}function $p({item:t}){return e.createElement("article",{className:"media-info playlist-info"},e.createElement("div",{className:"media-info-main"},e.createElement(eg,{thumbnails:t.thumbnails}),e.createElement(Hp,{title:t.title}),e.createElement(Yp,{owner:t.owner,src:t.src})),e.createElement(Kp,{url:t.externalUrl,src:t.src}))}function Hp({title:t}){return e.createElement("h3",{className:"title"},t||"(no title)")}function Gp({artist:t}){return t?e.createElement("h4",{className:"artist"},"By: ",t):null}function Yp({src:t,owner:r}){if(!r||!r.name)return null;const[n]=t.split(":"),i="youtube"===n?"Channel":"Curator";return e.createElement("p",{className:"owner"},i,":"," ",r.url?e.createElement(Im,{href:r.url},r.name):r.name)}function Kp({src:t,url:r}){if(!r)return null;const[n]=t.split(":");let i="";switch(n){case"apple":i="Apple Music";break;case"spotify":i="Spotify";break;case"youtube":i="YouTube";break;case"lastfm":i="last.fm";break;case"listenbrainz":i="ListenBrainz"}return e.createElement("p",{className:"external-view"},i?e.createElement(e.Fragment,null,"View on ",i,": ",e.createElement(un,{name:n})," "):e.createElement(e.Fragment,null,"Url: "),e.createElement(Im,{href:r}))}function Jp({album:t,year:r}){return t&&r?e.createElement("h4",{className:"album"},"From: ",t," (",r,")"):t?e.createElement("h4",{className:"album"},"From: ",t):r?e.createElement("h4",{className:"album"},"Year: ",r):null}function Zp({year:t}){return t?e.createElement("p",{className:"year"},"Year: ",t):null}function eg(t){return e.createElement("div",{className:"thumbnail"},e.createElement(Up,Object.assign({},t)))}function tg(t){Bn((r=>e.createElement(rg,Object.assign({},r,{item:t}))))}function rg(t){var{item:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["item"]);return e.createElement(Pn,Object.assign({},n,{className:"media-info-dialog",title:"Media Info"}),e.createElement("form",{method:"dialog"},e.createElement(qp,{item:r}),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,null,"Close"))))}function ng(t,r){const[n,i]=(0,e.useState)(r),a=(0,e.useMemo)(t,[t]);return(0,e.useEffect)((()=>{const e=a.subscribe(i);return()=>e.unsubscribe()}),[a]),n}function ig(){return ng(_l,null)}let ag=null,sg="none";const og=function(e){return"#globalDrag"===e.dataTransfer.getData("text")?ag:null},lg=function(e){return"#globalDrag"===e.dataTransfer.getData("text")?sg:"none"},cg=function(e,t,r){e.dataTransfer.setData("text","#globalDrag"),e.dataTransfer.effectAllowed=r,ag=t,sg=r},ug=function(){ag=null,sg="none"};function hg(t){const r=(0,e.useRef)();return(0,e.useEffect)((()=>{r.current=t}),[t]),r.current}function dg({style:t,title:r}){return e.createElement("div",{className:"list-view-cell",style:t},r)}function fg({col:t,onResize:r}){const[n,i]=(0,e.useState)(t.width),[a,s]=(0,e.useState)(-1),[o,l]=(0,e.useState)(0),c=-1!==a,u=(0,e.useCallback)((e=>{e.preventDefault(),0===e.button&&(s(e.screenX),l(n))}),[n]);(0,e.useEffect)((()=>r(t.index,n)),[t.index,n,r]);const h=(0,e.useCallback)((e=>{i(Math.max(20,o+(e.screenX-a)))}),[a,o]),d=(0,e.useCallback)((()=>{s(-1),l(0)}),[]);return(0,e.useEffect)((()=>{if(c)return document.documentElement.style.cursor="col-resize",document.body.classList.add("dragging"),document.addEventListener("mouseup",d),document.addEventListener("mousemove",h),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",d),document.removeEventListener("mousemove",h)}}),[c,h,d]),e.createElement("span",{className:"column-resizer",onMouseDown:u,style:{left:t.left+n-4+"px"}})}function mg({width:t,height:r,cols:n,sizeable:i,onColumnResize:a}){const s=(0,e.useCallback)(((e,t)=>{null==a||a(e,t)}),[a]);return e.createElement("header",{className:"list-view-head",style:{width:`${t}px`}},e.createElement("div",{className:"list-view-row",style:{width:`${t}px`,height:`${r}px`}},n.map((t=>e.createElement(dg,Object.assign({},t,{key:t.title}))))," ",i&&n.map((t=>e.createElement(fg,{col:t,onResize:s,key:t.title})))))}function pg({rowIndex:t,col:{className:r="",render:n,style:i},item:a}){return e.createElement("div",{className:`list-view-cell ${r}`,style:i},n(a,t))}function gg({item:t,className:r,rowIndex:n,height:i,selected:a,cols:s,setSize:o,dragIndex:l}){const c=`${r} ${a?"selected":""} ${l===o?n===o-1?"drag-over-last":"":l===n?"drag-over":""}`;return e.createElement("li",{role:"option",className:`list-view-row ${c}`,"aria-selected":a?"true":void 0,"aria-setsize":o,"aria-posinset":n+1,style:{height:`${i}px`,transform:`translateY(${i*n}px)`}},s.map((r=>e.createElement(pg,{rowIndex:n,col:r,item:t,key:r.title}))))}function Ag({width:t,height:r,rowHeight:n,cols:i,items:a,itemKey:s,itemClassName:o,scrollTop:l,overScan:c=20,selection:u,draggable:h,dragIndex:d}){const f=(0,e.useRef)(null),m=a.length,p=Math.floor(l/n),g=Math.floor(r/n),A=Math.max(0,p-c),v=Math.min(m,g+2*c),b=(0,e.useMemo)((()=>a.slice(A,A+v)),[a,A,v]);return e.createElement("ol",{role:"listbox",className:"list-view-body",draggable:h,style:{width:t?`${t}px`:void 0},ref:f},b.map(((t,r)=>e.createElement(gg,{className:o(t),rowIndex:A+r,height:n,selected:u.includes(t),cols:i,item:t,setSize:m,dragIndex:d,key:t[s]}))))}const vg=()=>"";function bg({items:t=[],itemKey:r,itemClassName:n=vg,layout:i,className:a="",draggable:s,droppable:o,droppableTypes:l=[],multiSelect:c,reorderable:u,onClick:h,onDoubleClick:d,onContextMenu:f,onDrop:m,onDelete:p,onEnter:g,onInfo:A,onRowIndexChange:v,onScrollIndexChange:b,onPageSizeChange:y,onSelect:w,onMove:_,listViewRef:E}){var x;const S=(0,e.useRef)(null),T=(0,e.useRef)(null),k=(0,e.useRef)(null),I=(0,e.useRef)(null),C="details"===i.view&&i.showTitles,P="details"===i.view&&i.sizeable,[M,R]=(0,e.useState)(-1),[B,L]=(0,e.useState)(0),[D,N]=(0,e.useState)(0),[O,z]=(0,e.useState)(0),[F,U]=(0,e.useState)(0),[j,V]=function(t,r=!1){const[n,i]=(0,e.useState)([]);(0,e.useEffect)((()=>{i(t.reduce(((e,t,n)=>{const i=e[n-1],a=i?i.left+i.width:0,{className:s="",align:o="left",sortOrder:l="none",sortPriority:c=0,width:u=200}=t,h=r?{left:`${a}px`,width:`${u}px`,textAlign:o}:{textAlign:o};return e.push(Object.assign(Object.assign({},t),{className:s,align:o,index:n,left:a,width:u,style:h,sortOrder:l,sortPriority:c})),e}),[]))}),[t,r]);const a=(0,e.useCallback)(((e,t)=>{r&&n[e].width!==t&&i(n.reduce(((r,n,i)=>{if(i>=e){const a=r[i-1],s=a?a.left+a.width:0,o=i===e?t:n.width,l={left:`${s}px`,width:`${o}px`,textAlign:n.align};r.push(Object.assign(Object.assign({},n),{left:s,width:o,style:l}))}else r.push(n);return r}),[]))}),[n,r]);return[n,a]}(i.cols,P),q=(0,e.useMemo)((()=>j.reduce(((e,t)=>e+t.width),0)),[j]),Q=F?Math.floor(D/F)-(C?1:0):0,X=t.length,{selectedItems:W,selectAll:$,selectAt:H,selectRange:G,toggleSelectionAt:Y}=function(t,r,n){const[i,a]=(0,e.useState)([]),s=hg(t);(0,e.useLayoutEffect)((()=>{if(t!==s){const s=t.filter((e=>i.some((t=>t[r]===e[r]))));if(o=s,(e=i).length!==o.length||!e.every(((e,t)=>o[t]===e))){const e=t.length;e>0&&0===s.length?a(n<e?[t[n]]:n===e?[t[n-1]]:s):a(s)}}var e,o}),[s,t,i,r,n]);const o=(0,e.useCallback)((()=>{a(t.slice())}),[t]),l=(0,e.useCallback)((e=>{const r=t[e];a(r?[r]:[])}),[t]),c=(0,e.useCallback)(((e,r)=>{const n=Math.min(e,r),i=Math.max(e,r),s=t.slice(n,i+1);a(s)}),[t]),u=(0,e.useCallback)(((e,r)=>{const n=t[e],s=i.includes(n);s!==r&&a(s?i.filter((e=>e!==n)):i.concat(n))}),[t,i]);return{selectedItems:i,selectAll:o,selectAt:l,selectRange:c,toggleSelectionAt:u}}(t,r,M),K=Qe(),[J,Z]=(0,e.useState)(-1),[ee,te]=(0,e.useState)(-1),[re,ne]=(0,e.useState)(-1),ie=0===X,ae=null===(x=hg(ie))||void 0===x||x,se=-1!==re,oe=F?Math.floor(B/F):0,le=Dt()&&!(0===M||M===X-1),[ce,ue]=(0,e.useState)((()=>W)),[he,de,fe,me]=s?W:[];(0,e.useEffect)((()=>{E&&(E.current={selectAll:$})}),[E,$]),(0,e.useLayoutEffect)((()=>null==v?void 0:v(M)),[M,v]),(0,e.useLayoutEffect)((()=>null==b?void 0:b(oe)),[oe,b]),(0,e.useLayoutEffect)((()=>null==y?void 0:y(Q)),[Q,y]),(0,e.useLayoutEffect)((()=>null==w?void 0:w(ce)),[ce,w]),(0,e.useEffect)((()=>R(Math.min(X-1,M))),[X,M]),(0,e.useEffect)((()=>{le||ue(W)}),[W,le]),(0,e.useEffect)((()=>{ie?R(-1):ae&&(R(0),H(0))}),[ie,ae,H]);const pe=(0,e.useCallback)((e=>{switch(e.key){case"Enter":e.stopPropagation(),e.repeat||null==g||g(W,e[Ie.ctrlKey],e.shiftKey);break;case"Delete":e.stopPropagation(),null==p||p(W);break;case"i":if(e.stopPropagation(),e[Ie.ctrlKey]&&!e.repeat){null==A||A(W);break}break;case"Info":e.preventDefault(),e.stopPropagation(),e.repeat||null==A||A(W);break;case"a":e[Ie.ctrlKey]&&(e.preventDefault(),e.stopPropagation(),e.repeat||$());break;case"Shift":e.repeat||Z(M);break;case" ":e.preventDefault(),e.repeat||(e[Ie.ctrlKey]?(e.stopPropagation(),Y(M)):W.includes(t[M])||(e.stopPropagation(),Y(M,!0)));break;default:{const r=t.length,n=function(e,t,r,n){switch(e){case"ArrowUp":t-=1;break;case"ArrowDown":t+=1;break;case"PageUp":t-=r-1;break;case"PageDown":t+=r-1;break;case"Home":t=0;break;case"End":t=n-1;break;default:return-1}return Math.min(Math.max(t,0),n-1)}(e.key,M,Q,r);if(-1!==n){if(e.preventDefault(),n!==M){e.stopPropagation();const t=T.current,i=Math.floor(B/F);if(n>=i+Q-1){const e=(r+(C?1:0))*F,i=r-Q-1,a=Math.min(r-1,n+1)-Q,s=a===i?e:a*F;t.scrollTo({top:s})}else if(n<=i){const e=Math.max(0,n-1)*F;t.scrollTo({top:e})}R(n)}c&&e.shiftKey&&-1!==J?G(J,n):e[Ie.ctrlKey]||H(n)}}}}),[M,t,Q,F,C,g,p,A,$,H,G,Y,W,c,J,B]),ge=(0,e.useCallback)((e=>{const t=yg(e);-1!==t&&(R(t),c&&e[Ie.ctrlKey]?Y(t):c&&e.shiftKey?-1===J?G(t,M):G(J,t):function(e){const t=wg(e);return!!(null==t?void 0:t.classList.contains("selected"))}(e)||H(t))}),[H,Y,G,M,J,c]),Ae=(0,e.useCallback)((e=>{if(0===e.button){const t=yg(e);-1!==t&&(!c||e[Ie.ctrlKey]||e.shiftKey||H(t))}}),[H,c]),ve=(0,e.useCallback)((e=>{"Shift"===e.key&&Z(-1)}),[]),be=(0,e.useCallback)((({width:e,height:t})=>{z(e),N(t)}),[]),ye=(0,e.useCallback)((({top:e})=>{L(e)}),[]);Ve(k,(0,e.useCallback)((()=>{U(k.current.getBoundingClientRect().height)}),[])),(0,e.useLayoutEffect)((()=>{S.current.classList.toggle("thin",20*K>O)}),[K,O]);const we=(0,e.useCallback)((e=>{const r=yg(e);-1!==r&&(e.preventDefault(),null==h||h(t[r],r))}),[t,h]),_e=(0,e.useCallback)((e=>{e.preventDefault(),-1!==yg(e)&&(null==f||f(W,e.pageX,e.pageY))}),[W,f]),Ee=(0,e.useCallback)((e=>{const r=yg(e);-1!==r&&(e.preventDefault(),null==d||d(t[r],r))}),[t,d]);(0,e.useEffect)((()=>{const e=I.current;for(;e.hasChildNodes();)e.removeChild(e.lastChild);const t=Array.from(S.current.querySelectorAll(".list-view-body:not(list-view-drag-image) li.selected"));t.length=Math.min(t.length,4);for(let r=0;r<t.length;r++){const n=t[r].cloneNode(!0);n.style.transform=`translateY(${F*r}px)`,e.appendChild(n)}}),[he,de,fe,me,F]);const xe=(0,e.useCallback)((e=>{const t=e.dataTransfer;if(s||u){t.setDragImage(I.current,-10,-10);let r="none";r=s&&u?"copyMove":s?"copy":"move",cg(e,W,r),ne(M)}else t.effectAllowed="none"}),[s,u,W,M]),Se=(0,e.useCallback)((e=>{e.preventDefault(),e.stopPropagation();const t=e.dataTransfer;if(o||u){const r=t.types.includes("text/plain");let n=yg(e);-1===n&&(n=X),se?u&&r?(t.dropEffect="move",te(n)):(t.dropEffect="none",te(-1)):o&&(r||_g(t.items,l))?(t.dropEffect="copy",te(n)):(t.dropEffect="none",te(-1))}else se?t.dropEffect="copy":(t.dropEffect="none",te(-1))}),[X,se,o,l,u]),Te=(0,e.useCallback)((e=>{if(o||u){const t=e.dataTransfer;let r=yg(e);-1===r&&(r=X);const n=lg(e);if("copy"===n){const t=og(e);t&&(null==m||m(t,r))}else if("move"===n){const e=re<r?-1:0;null==_||_(W,r),R(r+e)}else o&&_g(t.items,l)&&(null==m||m(t.files,r))}te(-1),e.preventDefault(),e.stopPropagation()}),[X,W,o,l,u,re,m,_]),ke=(0,e.useCallback)((()=>{ug(),ne(-1)}),[]),Ce=(0,e.useCallback)((()=>{te(-1)}),[]);return e.createElement("div",{className:`list-view list-view-${i.view} ${a}`,tabIndex:0,onClick:we,onContextMenu:_e,onDoubleClick:Ee,onDragStart:xe,onDragEnter:Se,onDragOver:Se,onDragLeave:Ce,onDragEnd:ke,onDrop:Te,onKeyDown:pe,onKeyUp:ve,onMouseDown:ge,onMouseUp:Ae,ref:S},e.createElement(Bt,{scrollWidth:P?q:void 0,scrollHeight:(X+(o?1:0)+(C?1:0))*F,scrollAmount:F,droppable:o||u&&se,onResize:be,onScroll:ye,scrollableRef:T},C&&e.createElement(it,null,e.createElement(mg,{width:q,height:F,sizeable:P,cols:j,onColumnResize:V})),e.createElement(Ag,{width:P?q:void 0,height:D,rowHeight:F,cols:j,items:t,itemKey:r,itemClassName:n,scrollTop:B,selection:W,dragIndex:ee,draggable:s||u}),e.createElement("div",{className:"list-view-cursor",style:{width:P?`${Math.min(O,q)}px`:void 0,transform:`translateY(${M*F}px)`},ref:k}),e.createElement("ul",{className:"list-view-drag-image list-view-body",ref:I})))}function yg(e){let t=0;const r=wg(e);return r&&(t=Number(r.getAttribute("aria-posinset"))||0),t-1}function wg(e){let t=e.target;for(;t&&!(null==t?void 0:t.hasAttribute("aria-posinset"));)t=t.parentElement;return t}function _g(e,t){return-1!==Array.from(e).findIndex((e=>t.some((t=>((e,t)=>{const[r,n]=e.split("/"),[i,a]=t.split("/");return r===i&&(n===a||"*"===n)})(t,e.type)))))}function Eg({children:t}){return e.createElement("footer",{className:"status-bar"},t)}function xg({items:t,size:r,maxSize:n,error:i,loading:a,loadingText:s="Loading",selectedCount:o,itemName:l="item",itemNamePlural:c=l+"s"}){let u="";if(a)u=e.createElement("span",{className:"message"},s,"...");else if(t.length>0){const i=t.reduce((e=>e+1),0),a=e.createElement("span",{className:"selected"},"(",o," selected)"),s=i===r?`${r.toLocaleString()} ${1===r?l:c}`:`Loaded ${i}/${void 0===r?n||`${t.length}+`:n?Math.min(r,n):r} ${c}`;u=e.createElement("span",{className:"message"},s," ",a)}else if(i){const t=null==i?void 0:i.message;u=e.createElement("span",{className:"error"},t?`Error: ${t}`:"Error")}else u=e.createElement("span",{className:"message"},"0 ",c);return e.createElement(Eg,null,u)}function Sg({time:t,className:r}){return e.createElement("time",{className:r},function(e){return new Date(Math.round(1e3*(e||0))).toISOString().slice(11,19).replace(/^[0:]+(.{4,})$/,"$1")}(t))}new Image(0,0).src=zp;const Tg={view:"details",fields:["Title","Genre","Owner"]};const kg=t=>e.createElement(Sg,{time:t.duration||0}),Ig={Index:{title:"#",render:(e,t)=>t+1,className:"index",align:"right",width:60},Artist:{title:"Artist",render:e=>e.artist,className:"artist"},Title:{title:"Title",render:e=>e.title,className:"title"},Album:{title:"Album",render:e=>e.album,className:"album"},AlbumAndYear:{title:"Album",render:e=>e.album?e.year?`${e.album} (${e.year})`:e.album:e.year||"",className:"album"},Track:{title:"Track",render:e=>e.track||"-",align:"right",width:80,className:"track"},Duration:{title:"Time",render:kg,align:"right",width:120,className:"duration"},PlayCount:{title:"Play Count",render:e=>e.playCount||"",align:"right",width:120,className:"play-count"},TrackCount:{title:"Tracks",render:e=>e.trackCount||"",align:"right",width:120,className:"track-count"},Year:{title:"Year",render:e=>e.year||"",align:"right",width:120,className:"year"},Genre:{title:"Genre",render:e=>{var t;return null===(t=e.genre)||void 0===t?void 0:t.split(";").join(", ")},className:"genre"},Owner:{title:"Owner",render:e=>{var t;return null===(t=e.owner)||void 0===t?void 0:t.name},className:"owner"},LastPlayed:{title:"Last played",render:e=>{if(!e.playedAt)return"";const t=Date.now()-1e3*e.playedAt;if(t<12e4)return"just now";const r=36e5;if(t<54e5)return`${Math.round(t/6e4)} mins ago`;const n=24*r;if(t<1.5*n)return`${Math.round(t/r)} hours ago`;if(t<12*n)return`${Math.round(t/n)} days ago`;const i=7*n;if(t<10*i)return`${Math.round(t/i)} weeks ago`;const a=365*n;return t<a?`${Math.round(t/2592e6)} months ago`:t<2*a?"1 year ago":`${Math.floor(t/a)} years ago`},className:"played-at"},ListenDate:{title:"Played On",render:e=>e.playedAt?new Date(1e3*e.playedAt).toLocaleDateString():"",className:"played-at"},Thumbnail:{title:"Thumbnail",render:t=>e.createElement(Up,{thumbnails:t.thumbnails,fallbackIcon:t.itemType===Yt.Artist?"person":void 0}),className:"thumbnail"}};function Cg(t){var{className:r="",pager:n=null,keepAlive:i,statusBar:a=!0,loadingText:s,onSelect:o,unplayable:l}=t,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","pager","keepAlive","statusBar","loadingText","onSelect","unplayable"]);const[u,h]=(0,e.useState)(0),d=function(t=Tg){return(0,e.useMemo)((()=>function(e){const{view:t,fields:r}=e,n=r.map((e=>Ig[e]));return"details"===t?{view:t,cols:n,showTitles:!0,sizeable:!0}:{view:t,cols:n}}(t)),[t])}(c.layout),[f,m]=(0,e.useState)(0),[g,A]=(0,e.useState)(0),[{items:v,loaded:b,error:y,size:w,maxSize:_},E]=function(t,r=!1){const[n,i]=function(){const t=(0,e.useRef)(null);null===t.current&&(t.current=new Zt),(0,e.useEffect)((()=>()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.complete()}),[]);const r=(0,e.useCallback)((e=>{t.current.next(e)}),[]);return[t.current,r]}(),[a,s]=(0,e.useState)([]),[o,l]=(0,e.useState)(void 0),[c,u]=(0,e.useState)(void 0),[h,d]=(0,e.useState)(),[f,m]=(0,e.useState)(!1),g=(0,e.useMemo)((()=>({items:a,size:o,maxSize:c,error:h,loaded:f})),[a,o,c,h,f]),A=(0,e.useCallback)(((e,t)=>{i([e,t])}),[i]);return(0,e.useEffect)((()=>{if(s([]),l(void 0),u(void 0),d(void 0),m(!1),!t)return;const e=t.observeItems(),i=t.observeSize(),a=t.observeError(),o=xt(e,a).pipe(ae(1),at((()=>!0))),c=new p;return c.add(e.subscribe(s)),c.add(i.subscribe(l)),c.add(a.subscribe(d)),c.add(o.subscribe(m)),c.add(n.subscribe((([e,r])=>t.fetchAt(e,r)))),r||c.add((()=>t.disconnect())),u(t.maxSize),()=>c.unsubscribe()}),[t,n,r]),[g,A]}(n,i),[x,S]=(0,e.useState)(0);(0,e.useEffect)((()=>h((e=>e+1))),[n]),(0,e.useEffect)((()=>{f>=0&&g>0&&E(f,g)}),[E,f,g,n]);const T=(0,e.useCallback)((e=>{S(e.length),null==o||o(e)}),[o]);return e.createElement("div",{className:`panel ${r}`},e.createElement(bg,Object.assign({},c,{className:"media-list "+(l?"":"playable"),layout:d,items:v,itemKey:"src",onPageSizeChange:A,onScrollIndexChange:m,onSelect:T,key:u})),a?e.createElement(xg,{items:v,error:y,size:w,maxSize:_,loading:!!n&&!b,loadingText:s,selectedCount:x}):null)}function Pg({className:t="",children:r,onClose:n,x:i,y:a}){const s=(0,e.useRef)(null),[o,l]=(0,e.useState)({visibility:"hidden"});(0,e.useLayoutEffect)((()=>{const e={},t=s.current;i+t.offsetWidth>document.body.clientWidth?e.left=i-t.offsetWidth+"px":e.left=`${i}px`,a+t.offsetHeight>document.body.clientHeight?e.top=a-t.offsetHeight+"px":e.top=`${a}px`,l(e)}),[i,a]),(0,e.useEffect)((()=>{const e=xt(ft(document,"mousedown").pipe(It((()=>ft(document,"click")))),ft(document,"keydown",{capture:!0}),ft(document,"contextmenu",{capture:!0}),ft(window,"blur")).subscribe((()=>n("")));return()=>e.unsubscribe()}),[n]);const c=(0,e.useCallback)((e=>{let t=e.target;for(;t&&!t.value;)t=t.parentElement;(null==t?void 0:t.value)&&n(t.value)}),[n]);return e.createElement("menu",{className:`popup-menu ${t}`,onClick:c,style:o,ref:s},r)}function Mg({label:t,acceleratorKey:r="",action:n}){return e.createElement("li",{className:"popup-menu-item"},e.createElement(cn,{value:n},e.createElement("span",{className:"popup-menu-item-label"},t),e.createElement("span",{className:"popup-menu-item-accelerator-key"},r)))}const Rg=document.getElementById("popup");function Bg(r,n,i){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){return new Promise(((a,s)=>{const o=document.createElement("div"),l=(0,t.s)(o);try{const t=e=>{l.unmount(),o.remove(),a(e)};Rg.append(o),l.render(e.createElement(r,{x:n,y:i,onClose:t}))}catch(e){l.unmount(),o.remove(),s(e)}}))}))}function Lg(t,r,n,i){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){return Bg((r=>e.createElement(Dg,Object.assign({},r,{items:t,unplayable:i}))),r,n)}))}function Dg(t){var{items:r,unplayable:n}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["items","unplayable"]);const a=1===r.length,s=!n&&r.every((e=>e.itemType===Yt.Media||e.itemType===Yt.Album));return e.createElement(Pg,Object.assign({},i,{className:"actions"}),e.createElement("ul",{className:"actions-menu-items"},s?e.createElement(e.Fragment,null,e.createElement(Mg,{label:"Queue",action:"queue",acceleratorKey:"Enter",key:"queue"}),e.createElement(Mg,{label:"Play next",action:"play-next",acceleratorKey:"Shift+Enter",key:"play-next"}),e.createElement(Mg,{label:"Play now",action:"play",acceleratorKey:`${Ie.ctrlKeyStr}+Enter`,key:"play"})):null,a?e.createElement(Mg,{label:"Info...",action:"info",acceleratorKey:`${Ie.ctrlKeyStr}+I`,key:"info"}):null))}var Ng=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};const Og={view:"details",fields:["Artist","Title","Album","Track","Duration","Genre","PlayCount"]};function zg(t){var{className:r="",layout:n=Og,unplayable:i}=t,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","layout","unplayable"]);const s=ig(),o=ng(Ml.observeCurrentIndex,-1),l=(0,e.useCallback)((e=>{const[t]=e.src.split(":");return`source-${t} ${e.src===(null==s?void 0:s.src)?"playing":""} ${e.unplayable?"unplayable":""}`}),[s]),c=(0,e.useCallback)(((e,t,r)=>Ng(this,void 0,void 0,(function*(){switch(yield Lg(e,t,r,i)){case"play":Lf.autoplay=!0,yield Ml.insertAt(e,o+1),yield Ml.next();break;case"play-next":yield Ml.insertAt(e,o+1);break;case"queue":yield Ml.add(e);break;case"info":tg(e[0])}}))),[o,i]),u=(0,e.useCallback)((e=>{i||Ml.add(e)}),[i]),h=(0,e.useCallback)(((e,t,r)=>Ng(this,void 0,void 0,(function*(){i||(t||r?t&&!r?(Lf.autoplay=!0,yield Ml.insertAt(e,o+1),yield Ml.next()):r&&!t&&(yield Ml.insertAt(e,o+1)):yield Ml.add(e))}))),[o,i]),d=(0,e.useCallback)((([e])=>{e&&tg(e)}),[]);return e.createElement(Cg,Object.assign({},a,{className:`media-items ${r}`,itemClassName:l,layout:n,multiSelect:!0,draggable:!i,unplayable:i,onContextMenu:c,onDoubleClick:u,onEnter:h,onInfo:d}))}function Fg(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);return e.createElement("div",{className:"panel media-item-browser"},e.createElement(zg,Object.assign({},n,{unplayable:r.unplayable})),";")}const Ug={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","ListenDate"]};function jg(t){var{source:r,minDate:n="2010-01-1"}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source","minDate"]);const[a,s]=(0,e.useState)(0),o=function(t,r=0){const[n,i]=(0,e.useState)(),a=Op(t,n);return(0,e.useEffect)((()=>i({startAt:r})),[r]),a}(r,a),l=(0,e.useCallback)((e=>{const t=new Date,r=new Date(e);r.getFullYear()===t.getFullYear()&&r.getMonth()===t.getMonth()&&r.getDate()===t.getDate()?s(0):s(Math.floor(r.valueOf()/1e3))}),[]);return e.createElement(e.Fragment,null,e.createElement(Np,{min:n,onSelect:l}),e.createElement(Fg,Object.assign({},i,{className:"history-browser",source:r,pager:o,layout:r.layout||Ug})))}const Vg="2002-11-20";function qg(){const t=function(){const[t,r]=(0,e.useState)((()=>Zf.firstScrobbledAt)),n=""===t||t===Vg;return(0,e.useEffect)((()=>{if(n){r(Vg);const e=Et(lm.getUserInfo()).pipe(at((e=>De(1e3*Number(e.user.registered.unixtime)))),Pr((e=>Zf.firstScrobbledAt=e)),ae(1)).subscribe(r);return()=>e.unsubscribe()}}),[n]),t}();return e.createElement(jg,{source:Em,minDate:t})}const Qg=[{value:"overall",text:"All time"},{value:"12month",text:"Past year"},{value:"1month",text:"Past month"},{value:"7day",text:"Past week"}];function Xg(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const[i,a]=(0,e.useState)(),s=function(t,r="overall"){const[n,i]=(0,e.useState)(),a=Op(t,n);return(0,e.useEffect)((()=>i({period:r})),[r]),a}(r,i),o=(0,e.useCallback)((e=>{a(e.target.value)}),[]);return e.createElement(e.Fragment,null,e.createElement("div",{className:"lastfm-period-selector options"},e.createElement("ul",{className:"lastfm-periods"},Qg.map((({value:t,text:r})=>e.createElement("li",{className:"lastfm-period",key:t},e.createElement(Ln,{id:`lastfm-period-${t}`,type:"radio",name:"lastfm-period",value:t,defaultChecked:"overall"===t,onChange:o}),e.createElement("label",{htmlFor:`lastfm-period-${t}`},r)))))),e.createElement(vA,Object.assign({},n,{source:r,pager:s,layout:r.layout})))}const Wg="2015-09-17";function $g(){const t=function(){const[t,r]=(0,e.useState)(km.firstScrobbledAt),n=""===t||t===Wg;return(0,e.useEffect)((()=>{if(n){r(Wg);const e=Et(Fm.getListeningActivity()).pipe(at((e=>e.find((e=>e.listen_count>0)))),kt(Ce),at((e=>De(1e3*Number(e.from_ts)))),Pr((e=>km.firstScrobbledAt=e)),ae(1)).subscribe(r);return()=>e.unsubscribe()}}),[n]),t}();return e.createElement(jg,{source:Xm,minDate:t})}var Hg=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};const Gg={view:"card compact",fields:["Thumbnail","Title","Artist","Year"]};function Yg(t){var{className:r="",layout:n=Gg,unplayable:i}=t,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","layout","unplayable"]);const s=ng(Ml.observeCurrentIndex,-1),o=(0,e.useCallback)((([e],t,r)=>Hg(this,void 0,void 0,(function*(){switch(yield Lg([e],t,r,i)){case"play":Lf.autoplay=!0,yield Ml.insertAt(e,s+1),yield Ml.next();break;case"play-next":yield Ml.insertAt(e,s+1);break;case"queue":yield Ml.add(e);break;case"info":tg(e)}}))),[s,i]),l=(0,e.useCallback)((e=>{i||Ml.add(e)}),[i]),c=(0,e.useCallback)((([e],t,r)=>Hg(this,void 0,void 0,(function*(){i||(t||r?t&&!r?(Lf.autoplay=!0,yield Ml.insertAt(e,s+1),yield Ml.next()):r&&!t&&(yield Ml.insertAt(e,s+1)):yield Ml.add(e))}))),[s,i]),u=(0,e.useCallback)((([e])=>{e&&tg(e)}),[]);return e.createElement(Cg,Object.assign({},a,{className:`albums ${r}`,layout:n,draggable:!i,unplayable:i,onContextMenu:o,onDoubleClick:l,onEnter:c,onInfo:u}))}const Kg={view:"details",fields:["Index","Title","Artist","Duration"]};function Jg(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const[i,a]=(0,e.useState)(null),s=(0,e.useCallback)((([e])=>{a(e||null)}),[]);return e.createElement("div",{className:"panel album-browser"},e.createElement($e,{id:"album-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(Yg,Object.assign({},n,{unplayable:r.unplayable,onSelect:s})),e.createElement(zg,{className:"album-items",pager:null==i?void 0:i.pager,keepAlive:!0,layout:r.secondaryLayout||Kg,unplayable:r.unplayable})))}const Zg={view:"card minimal",fields:["Thumbnail","Title"]};function eA(t){var{className:r="",layout:n=Zg}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","layout"]);const a=(0,e.useCallback)((([e],t,r)=>function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){"info"===(yield Lg([e],t,r))&&tg(e)}))),[]),s=(0,e.useCallback)((([e])=>{e&&tg(e)}),[]);return e.createElement(Cg,Object.assign({},i,{className:`artists ${r}`,layout:n,onContextMenu:a,onInfo:s}))}const tA=[{value:"all_time",text:"All time"},{value:"this_year",text:"This year"},{value:"this_month",text:"This month"},{value:"this_week",text:"This week"}];function rA(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const[i,a]=(0,e.useState)(),s=function(t,r="all_time"){const[n,i]=(0,e.useState)(),a=Op(t,n);return(0,e.useEffect)((()=>i({range:r})),[r]),a}(r,i),o=(0,e.useCallback)((e=>{a(e.target.value)}),[]);return e.createElement(e.Fragment,null,e.createElement("div",{className:"listenbrainz-range-selector options"},e.createElement("ul",{className:"listenbrainz-ranges"},tA.map((({value:t,text:r})=>e.createElement("li",{className:"listenbrainz-range",key:t},e.createElement(Ln,{id:`listenbrainz-range-${t}`,type:"radio",name:"listenbrainz-range",value:t,defaultChecked:"all_time"===t,onChange:o}),e.createElement("label",{htmlFor:`listenbrainz-range-${t}`},r)))))),e.createElement(nA,Object.assign({},n,{source:r,pager:s,layout:r.layout})))}function nA(t){switch(t.source.itemType){case Yt.Artist:return e.createElement("div",{className:"panel artist-browser"},e.createElement(eA,Object.assign({},t)));case Yt.Album:return e.createElement(Jg,Object.assign({},t));default:return e.createElement(Fg,Object.assign({},t))}}const iA={view:"card compact",fields:["Thumbnail","Title","Year"]},aA={view:"details",fields:["Index","Title","Artist","Duration"]};function sA(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const[i,a]=(0,e.useState)(null),[s,o]=(0,e.useState)(null),l=(0,e.useCallback)((([e])=>{a(e||null)}),[]),c=(0,e.useCallback)((([e])=>{o(e||null)}),[]);return e.createElement("div",{className:"panel artist-browser"},e.createElement($e,{id:"artist-browser-layout",arrange:"columns",primaryIndex:0},e.createElement(eA,Object.assign({},n,{unplayable:r.unplayable,onSelect:l})),e.createElement($e,{id:"artist-album-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(Yg,{className:"artist-albums",pager:null==i?void 0:i.pager,keepAlive:!0,layout:r.secondaryLayout||iA,unplayable:r.unplayable,onSelect:c}),e.createElement(zg,{className:"album-items",pager:null==s?void 0:s.pager,keepAlive:!0,layout:r.tertiaryLayout||aA,unplayable:r.unplayable}))))}function oA({sources:t,onSourceChange:r}){const n=(0,e.useId)(),i=(0,e.useCallback)((e=>{const n=Number(e.target.value),i=t[n];null==r||r(i)}),[t,r]);return e.createElement("div",{className:"media-source-selector options"},e.createElement("ul",{className:"media-sources"},t.map(((t,r)=>e.createElement("li",{className:"media-source",key:t.id},e.createElement(Ln,{id:`${n}-${t.id}`,type:"radio",name:"search-type",value:r,defaultChecked:0===r,onChange:i}),e.createElement("label",{htmlFor:`${n}-${t.id}`},t.title))))))}const lA={view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]};function cA(t){var{className:r="",layout:n=lA,unplayable:i}=t,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","layout","unplayable"]);const s=(0,e.useCallback)((([e],t,r)=>function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){"info"===(yield Lg([e],t,r,i))&&tg(e)}))),[i]),o=(0,e.useCallback)((([e])=>{e&&tg(e)}),[]);return e.createElement(Cg,Object.assign({},a,{className:`playlists ${r}`,layout:n,unplayable:i,onContextMenu:s,onInfo:o}))}const uA={view:"details",fields:["Index","Artist","Title","Album","Duration","Genre","PlayCount"]};function hA(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const[i,a]=(0,e.useState)(null),s=(0,e.useCallback)((([e])=>{a(e||null)}),[]);return e.createElement("div",{className:"panel playlist-browser"},e.createElement($e,{id:"playlist-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(cA,Object.assign({},n,{unplayable:r.unplayable,onSelect:s})),e.createElement(zg,{className:"playlist-items",pager:null==i?void 0:i.pager,keepAlive:!0,layout:r.secondaryLayout||uA,unplayable:r.unplayable})))}const dA={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]};function fA(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const i=Op(r),[,a]=(0,e.useReducer)((e=>e+1),0);return(0,e.useEffect)((()=>{const e=setInterval(a,6e4);return()=>clearInterval(e)}),[]),e.createElement(Fg,Object.assign({},n,{className:"recently-played-browser",source:r,pager:i,layout:r.layout||dA}))}function mA({error:t,children:r}){return e.createElement("div",{className:"panel error-screen"},e.createElement("div",{className:"error-screen-content"},e.createElement("h2",null,"Error"),e.createElement("pre",{className:"note error"},(null==t?void 0:t.message)||String(t)),r))}function pA({service:t,sources:r}){const n=ng(t.observeIsLoggedIn,!1),i=function(t){return(0,e.useMemo)((()=>function({error:r}){return e.createElement(mA,{error:r},t&&e.createElement("p",null,e.createElement(cn,{className:"disconnect",onClick:t.logout},"Reconnect to ",t.title,"...")))}),[t])}(t),a=String(r.map((e=>e.id)));return e.createElement("div",{className:`media-browser ${t.id}-browser`,key:a},n?e.createElement(Ep.ErrorBoundary,{fallbackRender:i},e.createElement(gA,{service:t,sources:r})):e.createElement(Pp,{service:t}))}function gA({service:t,sources:r}){const n=1===r.length?r[0]:null;switch(null==n?void 0:n.id){case"lastfm/top/tracks":case"lastfm/top/albums":case"lastfm/top/artists":return e.createElement(Xg,{source:n});case"listenbrainz/top/tracks":case"listenbrainz/top/albums":case"listenbrainz/top/artists":return e.createElement(rA,{source:n});case"lastfm/history":return e.createElement(qg,null);case"listenbrainz/history":return e.createElement($g,null);case"lastfm/recently-played":case"listenbrainz/recently-played":return e.createElement(fA,{source:n});default:return e.createElement(AA,{service:t,sources:r})}}function AA({sources:t}){const[r,n]=(0,e.useState)((()=>t[0])),[i,a]=(0,e.useState)(""),s=function(t,r=""){const[n,i]=(0,e.useState)(),a=Op(t,n);return(0,e.useEffect)((()=>i({q:r})),[r]),a}(r,i),o=!!r.searchable;return e.createElement(e.Fragment,null,o&&e.createElement(Mp,{onSubmit:a}),t.length>1?e.createElement(oA,{sources:t,onSourceChange:n}):null,e.createElement(vA,{source:r,pager:s,layout:r.layout,loadingText:i?"Searching":void 0}))}function vA(t){switch(t.source.itemType){case Yt.Artist:return e.createElement(sA,Object.assign({},t));case Yt.Album:return e.createElement(Jg,Object.assign({},t));case Yt.Playlist:return e.createElement(hA,Object.assign({},t));default:return e.createElement(Fg,Object.assign({},t))}}function bA({icon:t,text:r,showConnectivity:n}){return e.createElement("span",{className:"media-source-label"},e.createElement(un,{name:t,className:n?"show-connectivity":""}),e.createElement("span",{className:"text"},r))}console.log("component::MediaSources");const yA=new fe("sources");function wA({onSelect:t}){const r=function(){const[t,r]=(0,e.useState)([]);return(0,e.useEffect)((()=>{const t=yp.pipe(at((()=>{}))).pipe(at((()=>vp.all.filter(wp).map((t=>({id:t.id,label:e.createElement(bA,{icon:t.icon,text:t.title,showConnectivity:!0}),value:e.createElement(pA,{sources:t.roots,service:t}),startExpanded:!0,children:t.sources.filter(wp).map((r=>({id:r.id,label:e.createElement(bA,{icon:r.icon,text:r.title}),value:e.createElement(pA,{sources:[r],service:t})})))})))))).subscribe(r);return()=>t.unsubscribe()}),[]),t}();return e.createElement("div",{className:"panel media-sources"},e.createElement(Wt,{roots:r,onSelect:t,storeId:yA.id}))}function _A({label:t,items:r,className:n=""}){const i=(0,e.useId)(),[a,s]=(0,e.useState)(0),o=r.length,l=(0,e.useCallback)((e=>{switch(e.key){case"left":e.preventDefault(),a>0&&(s(a-1),e.stopPropagation());break;case"right":e.preventDefault(),a<o-1&&(s(a+1),e.stopPropagation())}}),[a,o]);return e.createElement("div",{className:`tab-list ${n}`},e.createElement("ul",{className:"tab-list-tabs",role:"tablist","aria-label":t,onKeyDown:l},r.map(((t,r)=>e.createElement("li",{role:"presentation",key:r},e.createElement(EA,{id:i,item:t,index:r,selected:r===a,onSelect:s}))))),e.createElement("div",{className:"tab-list-panels"},r.map(((t,r)=>e.createElement(xA,{id:i,item:t,index:r,hidden:r!==a,key:r})))))}function EA({id:t,item:r,index:n,selected:i,onSelect:a}){const s=(0,e.useCallback)((()=>a(n)),[n,a]);return e.createElement(cn,{className:"tab",id:`${t}-tab-${n}`,role:"tab","aria-selected":i,"aria-controls":`${t}-panel-${n}`,onFocus:s},r.tab)}function xA({id:t,item:r,index:n,hidden:i}){return e.createElement("div",{className:"tab-panel",id:`${t}-panel-${n}`,tabIndex:0,hidden:i,role:"tabpanel","aria-labelledby":`${t}-tab-${n}`},r.panel)}function SA(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function TA(e){return Math.min(1,Math.max(0,e))}function kA(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function IA(e){return e<=1?"".concat(100*Number(e),"%"):e}function CA(e){return 1===e.length?"0"+e:String(e)}function PA(e,t,r){e=SA(e,255),t=SA(t,255),r=SA(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),a=0,s=0,o=(n+i)/2;if(n===i)s=0,a=0;else{var l=n-i;switch(s=o>.5?l/(2-n-i):l/(n+i),n){case e:a=(t-r)/l+(t<r?6:0);break;case t:a=(r-e)/l+2;break;case r:a=(e-t)/l+4}a/=6}return{h:a,s,l:o}}function MA(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*r*(t-e):r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function RA(e,t,r){e=SA(e,255),t=SA(t,255),r=SA(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),a=0,s=n,o=n-i,l=0===n?0:o/n;if(n===i)a=0;else{switch(n){case e:a=(t-r)/o+(t<r?6:0);break;case t:a=(r-e)/o+2;break;case r:a=(e-t)/o+4}a/=6}return{h:a,s:l,v:s}}function BA(e,t,r,n){var i=[CA(Math.round(e).toString(16)),CA(Math.round(t).toString(16)),CA(Math.round(r).toString(16))];return n&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function LA(e){return Math.round(255*parseFloat(e)).toString(16)}function DA(e){return NA(e)/255}function NA(e){return parseInt(e,16)}var OA={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var zA="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),FA="[\\s|\\(]+(".concat(zA,")[,|\\s]+(").concat(zA,")[,|\\s]+(").concat(zA,")\\s*\\)?"),UA="[\\s|\\(]+(".concat(zA,")[,|\\s]+(").concat(zA,")[,|\\s]+(").concat(zA,")[,|\\s]+(").concat(zA,")\\s*\\)?"),jA={CSS_UNIT:new RegExp(zA),rgb:new RegExp("rgb"+FA),rgba:new RegExp("rgba"+UA),hsl:new RegExp("hsl"+FA),hsla:new RegExp("hsla"+UA),hsv:new RegExp("hsv"+FA),hsva:new RegExp("hsva"+UA),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function VA(e){return Boolean(jA.CSS_UNIT.exec(String(e)))}var qA=function(){function e(t,r){var n;if(void 0===t&&(t=""),void 0===r&&(r={}),t instanceof e)return t;"number"==typeof t&&(t=function(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}(t)),this.originalInput=t;var i=function(e){var t={r:0,g:0,b:0},r=1,n=null,i=null,a=null,s=!1,o=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(OA[e])e=OA[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var r=jA.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=jA.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=jA.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=jA.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=jA.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=jA.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=jA.hex8.exec(e))?{r:NA(r[1]),g:NA(r[2]),b:NA(r[3]),a:DA(r[4]),format:t?"name":"hex8"}:(r=jA.hex6.exec(e))?{r:NA(r[1]),g:NA(r[2]),b:NA(r[3]),format:t?"name":"hex"}:(r=jA.hex4.exec(e))?{r:NA(r[1]+r[1]),g:NA(r[2]+r[2]),b:NA(r[3]+r[3]),a:DA(r[4]+r[4]),format:t?"name":"hex8"}:!!(r=jA.hex3.exec(e))&&{r:NA(r[1]+r[1]),g:NA(r[2]+r[2]),b:NA(r[3]+r[3]),format:t?"name":"hex"}}(e)),"object"==typeof e&&(VA(e.r)&&VA(e.g)&&VA(e.b)?(t=function(e,t,r){return{r:255*SA(e,255),g:255*SA(t,255),b:255*SA(r,255)}}(e.r,e.g,e.b),s=!0,o="%"===String(e.r).substr(-1)?"prgb":"rgb"):VA(e.h)&&VA(e.s)&&VA(e.v)?(n=IA(e.s),i=IA(e.v),t=function(e,t,r){e=6*SA(e,360),t=SA(t,100),r=SA(r,100);var n=Math.floor(e),i=e-n,a=r*(1-t),s=r*(1-i*t),o=r*(1-(1-i)*t),l=n%6;return{r:255*[r,s,a,a,o,r][l],g:255*[o,r,r,s,a,a][l],b:255*[a,a,o,r,r,s][l]}}(e.h,n,i),s=!0,o="hsv"):VA(e.h)&&VA(e.s)&&VA(e.l)&&(n=IA(e.s),a=IA(e.l),t=function(e,t,r){var n,i,a;if(e=SA(e,360),t=SA(t,100),r=SA(r,100),0===t)i=r,a=r,n=r;else{var s=r<.5?r*(1+t):r+t-r*t,o=2*r-s;n=MA(o,s,e+1/3),i=MA(o,s,e),a=MA(o,s,e-1/3)}return{r:255*n,g:255*i,b:255*a}}(e.h,n,a),s=!0,o="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(r=e.a)),r=kA(r),{ok:s,format:e.format||o,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}(t);this.originalInput=t,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(n=r.format)&&void 0!==n?n:i.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,r=e.g/255,n=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=kA(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.toHsv=function(){var e=RA(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=RA(this.r,this.g,this.b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(r,"%, ").concat(n,"%)"):"hsva(".concat(t,", ").concat(r,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var e=PA(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=PA(this.r,this.g,this.b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(r,"%, ").concat(n,"%)"):"hsla(".concat(t,", ").concat(r,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(e){return void 0===e&&(e=!1),BA(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),function(e,t,r,n,i){var a=[CA(Math.round(e).toString(16)),CA(Math.round(t).toString(16)),CA(Math.round(r).toString(16)),CA(LA(n))];return i&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),r=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(r,")"):"rgba(".concat(e,", ").concat(t,", ").concat(r,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var e=function(e){return"".concat(Math.round(100*SA(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*SA(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+BA(this.r,this.g,this.b,!1),t=0,r=Object.entries(OA);t<r.length;t++){var n=r[t],i=n[0];if(e===n[1])return i}return!1},e.prototype.toString=function(e){var t=Boolean(e);e=null!=e?e:this.format;var r=!1,n=this.a<1&&this.a>=0;return t||!n||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.l+=t/100,r.l=TA(r.l),new e(r)},e.prototype.brighten=function(t){void 0===t&&(t=10);var r=this.toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(-t/100*255))),r.g=Math.max(0,Math.min(255,r.g-Math.round(-t/100*255))),r.b=Math.max(0,Math.min(255,r.b-Math.round(-t/100*255))),new e(r)},e.prototype.darken=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.l-=t/100,r.l=TA(r.l),new e(r)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.s-=t/100,r.s=TA(r.s),new e(r)},e.prototype.saturate=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.s+=t/100,r.s=TA(r.s),new e(r)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var r=this.toHsl(),n=(r.h+t)%360;return r.h=n<0?360+n:n,new e(r)},e.prototype.mix=function(t,r){void 0===r&&(r=50);var n=this.toRgb(),i=new e(t).toRgb(),a=r/100;return new e({r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a})},e.prototype.analogous=function(t,r){void 0===t&&(t=6),void 0===r&&(r=30);var n=this.toHsl(),i=360/r,a=[this];for(n.h=(n.h-(i*t>>1)+720)%360;--t;)n.h=(n.h+i)%360,a.push(new e(n));return a},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var r=this.toHsv(),n=r.h,i=r.s,a=r.v,s=[],o=1/t;t--;)s.push(new e({h:n,s:i,v:a})),a=(a+o)%1;return s},e.prototype.splitcomplement=function(){var t=this.toHsl(),r=t.h;return[this,new e({h:(r+72)%360,s:t.s,l:t.l}),new e({h:(r+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var r=this.toRgb(),n=new e(t).toRgb();return new e({r:n.r+(r.r-n.r)*r.a,g:n.g+(r.g-n.g)*r.a,b:n.b+(r.b-n.b)*r.a})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var r=this.toHsl(),n=r.h,i=[this],a=360/t,s=1;s<t;s++)i.push(new e({h:(n+s*a)%360,s:r.s,l:r.l}));return i},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function QA(e,t){var r=new qA(e),n=new qA(t);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)}function XA(e,t,r){void 0===r&&(r={includeFallbackColors:!1,level:"AA",size:"small"});for(var n=null,i=0,a=r.includeFallbackColors,s=r.level,o=r.size,l=0,c=t;l<c.length;l++){var u=c[l],h=QA(e,u);h>i&&(i=h,n=new qA(u))}return function(e,t,r){var n,i;void 0===r&&(r={level:"AA",size:"small"});var a=QA(e,t);switch((null!==(n=r.level)&&void 0!==n?n:"AA")+(null!==(i=r.size)&&void 0!==i?i:"small")){case"AAsmall":case"AAAlarge":return a>=4.5;case"AAlarge":return a>=3;case"AAAsmall":return a>=7;default:return!1}}(e,n,{level:s,size:o})||!a?n:(r.includeFallbackColors=!1,XA(e,["#fff","#000"],r))}const WA=JSON.parse('{"name":"Black Gold","backgroundColor":"#0d0c0c","textColor":"#cbccad","frameColor":"#0e0e0c","frameTextColor":"#e8e8bf","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),$A=JSON.parse('{"name":"Boring Skyblue","backgroundColor":"#08090a","textColor":"#7ccaf8","frameColor":"#333738","frameTextColor":"#d2d2d2","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#163d5a","selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0,"flat":false}'),HA=JSON.parse('{"name":"Grey Green","backgroundColor":"#0f0f10","textColor":"#d1f5d2","frameColor":"#24322c","frameTextColor":"#c3feca","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),GA=JSON.parse('{"name":"Indigo","backgroundColor":"#06181e","textColor":"#d1d3f5","frameColor":"#43477a","frameTextColor":"#f3f3f7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#4b4049","selectedTextColor":"#ffffff","evenRowBackgroundColor":null,"spacing":0.625,"roundness":0.84375,"flat":true}'),YA=JSON.parse('{"name":"Lemon","backgroundColor":"#e7fdfc","textColor":"#000000","frameColor":"#e8d502","frameTextColor":"#180c06","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#aaaaaa","selectedTextColor":"#000000","evenRowBackgroundColor":null,"spacing":0.375,"roundness":0,"flat":true}'),KA=JSON.parse('{"name":"Lilac","backgroundColor":"#12051a","textColor":"#f5d1ed","frameColor":"#79437a","frameTextColor":"#f3f7f3","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.625,"roundness":0.84375,"flat":true}'),JA=JSON.parse('{"name":"Moody Blue","backgroundColor":"#16141a","textColor":"#bec1c0","frameColor":"#125673","frameTextColor":"#d8eee7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.53125,"roundness":0.40625,"flat":false}'),ZA=JSON.parse('{"name":"Olive Oil","backgroundColor":"#181e10","textColor":"#a6c464","frameColor":"#81810e","frameTextColor":"#181816","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),ev=JSON.parse('{"name":"Pale Pink","backgroundColor":"#f7f7f7","textColor":"#120f0c","frameColor":"#cfbdd0","frameTextColor":"#121211","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.53125,"flat":true}'),tv=JSON.parse('{"name":"Purplelicious (Winamp)","backgroundColor":"#000000","textColor":"#ffb464","frameColor":"#3e0445","frameTextColor":"#ffb464","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#3e0445","selectedTextColor":"#ffb464","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),rv=JSON.parse('{"name":"Saddle","backgroundColor":"#271607","textColor":"#cbbe86","frameColor":"#331d0a","frameTextColor":"#fedfc3","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.34375,"flat":false}'),nv=JSON.parse('{"name":"Seaweed","backgroundColor":"#244319","textColor":"#bef3c5","frameColor":"#3b722c","frameTextColor":"#fcfcf7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":"#54e3da","mediaButtonTextColor":null,"selectedBackgroundColor":"#04958b","selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.78125,"roundness":0.8125,"flat":true}'),iv=JSON.parse('{"name":"Tangerine","backgroundColor":"#eaf2c5","textColor":"#2e1f05","frameColor":"#e89f02","frameTextColor":"#180c06","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#adaaaa","selectedTextColor":"#000000","evenRowBackgroundColor":null,"spacing":0.46875,"roundness":1,"flat":false}'),av=JSON.parse('{"name":"Winamp Amber","backgroundColor":"#000000","textColor":"#e79a36","frameColor":"#383757","frameTextColor":"#d2d2d2","buttonColor":"#464379","buttonTextColor":"#ebebeb","mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#76490e","selectedTextColor":"#ebebeb","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),sv=JSON.parse('{"name":"Winamp Classic","backgroundColor":"#000000","textColor":"#00e200","frameColor":"#383757","frameTextColor":"#d2d2d2","buttonColor":"#464379","buttonTextColor":"#d2d2d2","mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#040dae","selectedTextColor":"#d2d2d2","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),ov=JSON.parse('{"name":"Winamp Modern (WACUP)","backgroundColor":"#14121c","textColor":"#8ac440","frameColor":"#1f1f36","frameTextColor":"#f0f0f0","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#2f2f76","selectedTextColor":"#f0f0f0","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),lv={name:"",backgroundColor:"#000000",textColor:"#ebebeb",frameColor:"#000000",frameTextColor:"#ebebeb",buttonColor:null,buttonTextColor:null,mediaButtonColor:null,mediaButtonTextColor:null,selectedBackgroundColor:null,selectedTextColor:null,evenRowBackgroundColor:null,spacing:0,roundness:0,flat:!1},cv=[lv,WA,$A,HA,GA,YA,KA,JA,ZA,ev,tv,rv,nv,iv,av,sv,ov],uv=new class{constructor(){this.storage=new fe("theme"),this.app=document.getElementById("app"),this.popup=document.getElementById("popup"),this.system=document.getElementById("system"),this.theme$=new tr(lv);const e=document.createElement("style");document.head.append(e),this.sheet=e.sheet,this.rootStyle=this.createStyle(":root"),this.appStyle=this.createStyle(".app"),this.playheadStyle=this.createStyle("#playhead"),this.restore()}observe(){return this.theme$}get backgroundColor(){return this.current.backgroundColor}set backgroundColor(e){this.setColor("backgroundColor",e),this.app.classList.toggle("dark",this.isDark),this.app.classList.toggle("light",this.isLight),this.popup.classList.toggle("dark",this.isDark),this.popup.classList.toggle("light",this.isLight)}get buttonColor(){return this.current.buttonColor}set buttonColor(e){this.setColor("buttonColor",e)}get buttonTextColor(){return this.current.buttonTextColor}set buttonTextColor(e){this.setColor("buttonTextColor",e)}get current(){return this.theme$.value}get evenRowBackgroundColor(){return this.current.evenRowBackgroundColor}set evenRowBackgroundColor(e){this.setColor("evenRowBackgroundColor",e)}get flat(){return this.current.flat}set flat(e){this.app.classList.toggle("flat",!!e),this.popup.classList.toggle("flat",!!e),this.theme$.next(Object.assign(Object.assign({},this.current),{flat:e}))}get fontSize(){return Number(this.rootStyle.getPropertyValue("--font-size"))||16}set fontSize(e){this.rootStyle.setProperty("--font-size",String(e)),this.createPlayheadSmiley()}get frameColor(){return this.current.frameColor}set frameColor(e){this.setColor("frameColor",e),this.app.classList.toggle("frame-light",this.isFrameLight),this.app.classList.toggle("frame-dark",this.isFrameDark),this.popup.classList.toggle("frame-light",this.isFrameLight),this.popup.classList.toggle("frame-dark",this.isFrameDark),this.createPlayheadSmiley()}get frameTextColor(){return this.current.frameTextColor}set frameTextColor(e){this.setColor("frameTextColor",e)}get mediaButtonColor(){return this.current.mediaButtonColor}set mediaButtonColor(e){this.setColor("mediaButtonColor",e)}get mediaButtonTextColor(){return this.current.mediaButtonTextColor}set mediaButtonTextColor(e){this.setColor("mediaButtonTextColor",e)}get name(){return this.current.name}set name(e){this.theme$.next(Object.assign(Object.assign({},this.current),{name:e}))}get roundness(){return this.current.roundness}set roundness(e){this.setProperty("roundness",e),this.theme$.next(Object.assign(Object.assign({},this.current),{roundness:e}))}get selectedBackgroundColor(){var e;return null!==(e=this.current.selectedBackgroundColor)&&void 0!==e?e:null}set selectedBackgroundColor(e){if(this.setColor("selectedBackgroundColor",e),this.selectedBackgroundColor){let e=new qA(this.selectedBackgroundColor).desaturate(40);e=e.isLight()?e.tint(25):e.shade(25),this.setProperty("selected-background-color-blurred",e.toHexString())}}get selectedTextColor(){return this.current.selectedTextColor}set selectedTextColor(e){this.setColor("selectedTextColor",e)}get spacing(){return this.current.spacing}set spacing(e){this.setProperty("spacing",e),this.theme$.next(Object.assign(Object.assign({},this.current),{spacing:e}))}get textColor(){return this.current.textColor}set textColor(e){this.setColor("textColor",e)}get isDark(){return new qA(this.backgroundColor).isDark()}get isLight(){return new qA(this.backgroundColor).isLight()}get isFrameDark(){return new qA(this.frameColor).isDark()}get isFrameLight(){return new qA(this.frameColor).isLight()}load(e){let t;t="string"==typeof e?cv.find((t=>t.name===e)):e,t&&Object.assign(this,this.applyDefaults(t))}restore(){const e=this.storage.getJson("current",lv);Object.assign(this,this.applyDefaults(e)),this.fontSize=this.storage.getNumber("fontSize",16),this.app.classList.toggle("dark",this.isDark),this.app.classList.toggle("light",this.isLight),this.app.classList.toggle("frame-light",this.isFrameLight),this.app.classList.toggle("frame-dark",this.isFrameDark),this.popup.classList.toggle("dark",this.isDark),this.popup.classList.toggle("light",this.isLight),this.popup.classList.toggle("frame-light",this.isFrameLight),this.popup.classList.toggle("frame-dark",this.isFrameDark),this.system.classList.toggle("dark",this.isDark),this.system.classList.toggle("light",this.isLight),this.createPlayheadSmiley()}save(){this.storage.setNumber("fontSize",this.fontSize),this.storage.setJson("current",this.current),this.system.classList.toggle("dark",this.isDark),this.system.classList.toggle("light",this.isLight)}applyDefaults(e){if(!e.selectedBackgroundColor){const t=new qA(e.textColor),r=t.monochromatic();r.sort(((e,t)=>e.getBrightness()-t.getBrightness())),t.isLight()?e.selectedBackgroundColor=r[1].toHexString():e.selectedBackgroundColor=r[r.length-2].toHexString(),r.push(new qA("white"),new qA("black")),e.selectedTextColor=XA(e.selectedBackgroundColor,r,{includeFallbackColors:!0,level:"AA",size:"large"}).toHexString()}return e}setColor(e,t){"string"==typeof t&&(t=new qA(t));const r=null==t?void 0:t.toHsl(),n=this.toDashName(e);this.setProperty(`${n}-h`,r?String(r.h):null),this.setProperty(`${n}-s`,r?100*r.s+"%":null),this.setProperty(`${n}-l`,r?100*r.l+"%":null),this.theme$.next(Object.assign(Object.assign({},this.current),{[e]:t?t.toHexString():null}))}setProperty(e,t){this.appStyle.setProperty(`--${e}`,null==t?null:String(t))}createStyle(e){const t=this.sheet.insertRule(`${e}{}`);return this.sheet.cssRules[t].style}get defaultMediaButtonColor(){const e=new qA(this.frameColor).toHsl();return e.s+=1-.33*e.s,e.l+=1-.5*e.l,new qA(e).toHexString()}get defaultMediaButtonTextColor(){const e=new qA(this.defaultMediaButtonColor).toHsl();return e.s-=.5*e.s,e.l-=.9*e.l,new qA(e).toHexString()}get smileyColor(){return this.mediaButtonTextColor||this.defaultMediaButtonTextColor}createPlayheadSmiley(){const e=new qA(this.smileyColor).toRgbString(),t=[`<path fill='${e}' d='M 160.5,164.5 C 183.647,162.813 194.147,173.48 192,196.5C 186.494,211.009 175.994,216.842 160.5,214C 145.991,208.494 140.158,197.994 143,182.5C 145.683,173.318 151.517,167.318 160.5,164.5 Z'/>`,`<path fill='${e}' d='M 335.5,164.5 C 358.647,162.813 369.147,173.48 367,196.5C 361.494,211.009 350.994,216.842 335.5,214C 320.991,208.494 315.158,197.994 318,182.5C 320.683,173.318 326.517,167.318 335.5,164.5 Z'/>`,`<path fill='${e}' d='M 164.5,296.5 C 172.699,295.1 179.865,297.1 186,302.5C 201.99,327.582 224.823,341.582 254.5,344.5C 279.499,342.418 299.999,331.751 316,312.5C 318.955,308.756 321.789,304.922 324.5,301C 334.716,294.616 344.55,295.116 354,302.5C 358.296,308.845 359.63,315.845 358,323.5C 334.118,361.698 299.618,382.365 254.5,385.5C 209.382,382.365 174.882,361.698 151,323.5C 148.138,310.557 152.638,301.557 164.5,296.5 Z'/>`].join(""),r=this.createBase64SVG(512,512,t);this.playheadStyle.setProperty("--smiley",r),this.playheadStyle.setProperty("--thumb-size",`${Math.round(1.25*this.fontSize)}px`)}createBase64SVG(e,t,r){return`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='${e}' height='${t}'>${r}</svg>")`}toDashName(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}};function hv(t){var{colorName:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["colorName"]);const i=(0,e.useCallback)((e=>{uv[r]=e.target.value}),[r]);return e.createElement(Ln,Object.assign({},n,{type:"color",onChange:i}))}const dv=[{tab:"Theme",panel:e.createElement((function(){const t=(0,e.useMemo)((()=>uv.fontSize),[]),r=ng((()=>uv.observe()),lv);(0,e.useLayoutEffect)((()=>{const e=document.getElementById("system").style;return e.setProperty("--font-size",String(uv.fontSize)),()=>{uv.restore(),e.removeProperty("--font-size")}}),[]);const n=(0,e.useCallback)((()=>uv.save()),[]),i=(0,e.useCallback)((e=>{uv.load(e.target.value)}),[]),a=(0,e.useCallback)((e=>{uv.spacing=e.target.valueAsNumber}),[]),s=(0,e.useCallback)((e=>{uv.fontSize=e.target.valueAsNumber}),[]),o=(0,e.useCallback)((e=>{uv.roundness=e.target.valueAsNumber}),[]),l=(0,e.useCallback)((e=>{uv.flat=e.target.checked}),[]);return e.createElement("form",{className:"theme-settings",method:"dialog",onSubmit:n},e.createElement("fieldset",null,e.createElement("legend",null,e.createElement("label",{htmlFor:"theme-name"},"Name:"),e.createElement("select",{id:"theme-name",onChange:i,value:uv.name},cv.map((({name:t})=>e.createElement("option",{value:t,key:t},t||"(none)"))))),e.createElement("div",{className:"table-layout"},e.createElement("p",null,e.createElement("label",{htmlFor:"theme-fontFamily"},"Font:"),e.createElement("select",{id:"theme-fontFamily"},e.createElement("option",null,"Arial, sans-serif"))),e.createElement("p",null,e.createElement("label",null,"Frame:"),e.createElement(hv,{id:"frameColor",colorName:"frameColor",value:r.frameColor,title:"Frame background"}),e.createElement(hv,{colorName:"frameTextColor",value:r.frameTextColor,title:"Frame text"})),e.createElement("p",null,e.createElement("label",null,"Content:"),e.createElement(hv,{colorName:"backgroundColor",value:r.backgroundColor,title:"Content background"}),e.createElement(hv,{colorName:"textColor",value:r.textColor,title:"Content text"})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-spacing"},"Spacing:"),e.createElement(Ln,{type:"range",id:"theme-spacing",min:0,max:1,step:.03125,value:r.spacing,onChange:a})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-roundness"},"Roundness:"),e.createElement(Ln,{type:"range",id:"theme-roundness",min:0,max:1,step:.03125,value:r.roundness,onChange:o})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-flat"},"Flat:"),e.createElement(Ln,{type:"checkbox",id:"theme-flat",checked:r.flat,onChange:l}))),e.createElement("p",{className:"dialog-buttons"},e.createElement(cn,{className:"small",type:"button",disabled:!0},"Save"))),e.createElement("div",{className:"table-layout font-size"},e.createElement("p",null,e.createElement("label",{htmlFor:"theme-fontSize"},"Font Size:"),e.createElement(Ln,{type:"range",id:"theme-fontSize",min:12,max:32,step:1,defaultValue:t,onChange:s,key:t}))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel"},"Cancel"),e.createElement(cn,null,"Confirm")))}),null)}],fv=[{tab:"General",panel:e.createElement((function(){const t=(0,e.useMemo)((()=>ul()),[]),r=ng(cl,t),n=(0,e.useRef)(null),i=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useRef)(null),o=(0,e.useCallback)((()=>{hl(t)}),[t]),l=(0,e.useCallback)((()=>{hl({allowDuplicates:n.current.checked,showLineNumbers:i.current.checked,zeroPadLineNumbers:a.current.checked,showSourceIcons:s.current.checked})}),[]);return e.createElement("form",{className:"playlist-general-settings",method:"dialog"},e.createElement("fieldset",null,e.createElement("legend",null,"Content"),e.createElement("p",null,e.createElement(Ln,{id:"playlist-allow-duplicates",type:"checkbox",checked:r.allowDuplicates,onChange:l,ref:n}),e.createElement("label",{htmlFor:"playlist-allow-duplicates"},"Allow duplicates"))),e.createElement("fieldset",null,e.createElement("legend",null,"Display"),e.createElement("p",null,e.createElement(Ln,{id:"playlist-item-numbers",type:"checkbox",checked:r.showLineNumbers,onChange:l,ref:i}),e.createElement("label",{htmlFor:"playlist-item-numbers"},"Show playlist line numbers")),e.createElement("p",null,e.createElement(Ln,{id:"playlist-zero-pad",type:"checkbox",checked:r.zeroPadLineNumbers,disabled:!r.showLineNumbers,onChange:l,ref:a}),e.createElement("label",{htmlFor:"playlist-zero-pad"},"Zero pad line numbers")),e.createElement("p",null,e.createElement(Ln,{id:"playlist-source-icons",type:"checkbox",checked:r.showSourceIcons,onChange:l,ref:s}),e.createElement("label",{htmlFor:"playlist-source-icons"},"Show media source icons"))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel",onClick:o},"Cancel"),e.createElement(cn,null,"Confirm")))}),null)}];function mv(e,t){return function(r,n){return!e.call(t,r,n)}}function pv(e,t,r){return[kt(t,r)(te(e)),kt(mv(t,r))(te(e))]}const gv="\nmo2re_RX3Bs blXien2Jh_o etiatMRgFcM DYsMJiwiZSI _MZ7UZ5frCI 33XT9PQUfVU HCx1Z92PjJE dIP7wWY4Znw\nA1m0SEqmmbE 9uZ8CCa0t4Y MXlFDpaQ1ec wz_ItcoR0-c jS4-FmNEDKo Tz77vqH_LJw K73lfmxDVR0 W8ayfyRWUrg\ncbuldALGsaQ AJZon2grzmA H5ASEM9dMiA GE2YEq7vaLc MYGOdJNAzrI Oszl95YWfbs b0-IkxXyhmY hoYPURX2RuE\nAgpGXSAS7Cs p-OUNPqRzII XaTxLSPh_Is 1n3ezT1cvAM CWU1pZVw0xM ry1Q7KaQdxM VlC5LSTvoj0 7DUhv7lTAuk\ng5yQtQc3K-0 f6OZ01vvmko o4jE24WixcI BIej9P2LrzM dxw91a7C5BQ jmh_usvhHLw VVkZKzTbWQs vXCB1zGGFiY\nJHARFKMl8dU KSB1AZ0-I74 IGqfU6cJJc8 8zg22-ZCUfE WMlR8eJRS3I l4D6bnIdehk A5pbF_YBulo dRFRsKobN9I\ntlN0LoTv3c0 IlDvBTDGanI Az3UNGBKRX8 mOmwk3WyYnw im2eWwIiTOc lxQS58t39_U yk076o8NF3k oggiHfuV4m8\np_GnUkm-G1M xVMsAgHy_IY VdZkfef44JI ZxOd8tmdsIM fszuqfJWKxc 0LGL_lx9XcA i_hU5eUrVIs qtwWkv9OdF0\nuZjCNtOeZG4 ZpXnEvW0XD0 -C8TYbhnVTU WzxSiEWK3cg ZE8vuq4aqNA 7HMw3bcIgRE ZJiCEDweLl8 lyh2kAjcmSY\nvFwqZ4qAUkE QLbPYQcUcgM xwf7EssFnXU FvNFuSTDPuk vvm8b2jAfv0 XkRFSnxXQ_w Ee0Qh_nIoHw 78rppSvbh7A\nNXIaYDJql1c e5eg-tOusSo ZkRjihsMdp8 e1M6jHcRrlM z9Ug-3qhrwY mA30W2dHQIo XIhEPwTMjWk -Tm4H4CrKT0\nT6tapzmF_n0 7QetsPh7BPM xBDqge4w-XA suWbFuw1O_I yCUQ8n2OxjI ZX8fSO8uTPg xX9xfFT-Qw0 0G9a9o3wOIQ\n-WIamcIaipI Zjc6DwVDvq0 eHjoav_sb88 7E0WVROBsEE BvLIJSmzAnY YPurG3WT8xI 0ocUnSG4oQQ d8jFMKNy9EI\naC7s2UVXt3c EJArkl7K29k 9eFVeErnUzg 7eyYe-MN1Nc B1-yyoNMUzs Ab5I38wGxko sVuqgnXD9AE EqXNmIh0X4I\nY0U0HAwpw2s Shf_P0PLhNA Nde5P8Ob2xg f-Xul0mdBCA ExStG9rRkoY tMzCwwvHwN0 iaVmsp7dU1Y TV4J01qGE8E\nQ6YbP3m-KvA eYpCCSAW3aw XfBNIrQ5JKQ -b68N6Q4Qus H3mdjo7kYiQ 9CJLtzzUphU yy-aMo2ds2k FFjGdNl5Sso\nLtPGmDskDiY U9rtWGI6H5A NHa506wwN0Y PLSxe5Z8Asw ubQKAfwSLDA aFsNz5VMyC8 h6yhFP_qUro GlotnVckHG4\nPEgQ0dIOB5c KWz3SXWnFys MGRDy2PqCGk 4DcMcAHrURw ETwbuC3p1ls iszl1WqjQIk njcvxMb8TVQ sTS5tBOS4GM\nhNNN5xPyyeY 8ls8xBn70gM 2XREaQqoU1U MXL2qjIL4qI 9YqbQcfIre0 JVI9BvU8-Oo J7QA7WmTGA8 WdtkaLxc464\nPaIH77c53LA FSlhSL8bFoI XLuV3_a-ro0 mo7mUJZV6DM IqWPDr8KCmQ v-QS_Kh_i6o RvZFYE5jo1M Xn8tufsbSz0\n7gG4l70v8mw thurNCHVo08 YgryBZTMVZY XAmU3yQc90M KBUg3U3MRao v_My9t4gadA Xwb1xsWClCM KlH1g1x6RJk\nyYP2A8TkSQ0 LMSmWzCqlPE oN3glsVrnRY PPBV3hem5iM 1JbI8Ml25WQ nSJ67PGjQfQ EoBF2xRsbAc KDUYy3xwCFs\nRZOcoZS_52Q pSP9_otXcTU H36qe8NatNQ qgfd-uWTVwg Blu_yCEFYvk HeYMIBFtwh4 fb0QX7DbqLg kdqyAA0ILD4\nriZWEoGKyuU 4qo9bKRxgYA t0j_GdkG1BM hLq9J32lGRs zfc53CpvlZ4 IjNKQbm4AQ8 Ms0uDHae8FY tG991Undnbc\nsh8l2-cCAGQ XDE5pd4V_xc C2BVXFIX7bY ySPxZpoqXZ8 hiEUaLX4cCM wHxEyBMi1A4 YJSw3ougt9Y 2hUJBRUtrPU\nWsCCYv2adkM kD5x3_b1J0o 9Rvtm2zGEl4 DGlAMkUjcY0 h2s_WOkfTXk 0VhxPdtX0xg 6vuFh6NNa70 ukOHqdPbYYg\nH6OmEQ8RqVk qPp315pPVSI FQqj6gN7M6M Xrwks9O2-JQ ipRwt3TDgY4 aVqRyfRviwA X33dmu12C5c QEwzFKoG7tk\nh98nR30UD8Q Z7WpAwRjprI ilqlSBYfCGs V6SoeDWDon0 d-Hwz42Vfw4 hcmxvqJDpDw 22dlye7h3qU p7l6JQApzak\nblSZ365wpfQ ADF4KgfhzPs jSRvD7Uma1g uLMC6bL_q38 k9DuPxFQ7HQ 7f2taFPyqxc YVYDz_coSfY NXg0IKlrz-Q\nORHIVufNfRM YiezM4raRrY H3GL5jO53NU acTsYqhq-AA vp2yiZnjK0w eR5vsN1Lq4E D_l0pBDHFgs HFnt39uG5W0\n7qXiAaxxGBs m6m6bqHiT6U l5jUOT0XiUM NLxwmtJSvk4 dv_QzcJGHAE kaPD4n9uQ2k r7HpeG2ofU0 O1AQcFpPs04\n44ih4WRTyGg W5BmjLsEsB0 JkNlFaei_k8 2ttB1FzBpZ4 k3Q1vse7In8 7xltSb3VBJQ ojbiGfhnjTU _Qb7TJ-T1HM\ngvT3gIDSwq8 4X95pykbYTY BPDznHIgVMA OIA5xQWkk2U 2uQ58Xwx1V4 UVjCFpYMR6A -uww0BzTb7g EqWBy5i8LyQ\nszErNcJMCdA 5k1DGpr_qDw YNEkjkh0bYo jmjrpHYegzc Eye8xYrjm24 rVLOQB5kGGw F8MN0o6RS9o viim_l9gbF8\nsBtYWK817-0 cFRcqnCpqoo y7vz1qQGUd8 -0ewPjoBBNI S1emxk9UWBE 1muEwEFDKgk nnDBkUfVU1Y MPEvXbw3hYA\nwwXpkTd1CaQ W2A_PcIhUVM ZIb8u6uJwBo TWjid2dVjMk gdJjc6l6iII n3Dru5y3ROc OOf4Z7tyLVM iDXDrTKJehk\nwYhliE9O_3k nw0uvJZonBc cK7x6lUUsYo XPjkpBDEs2U e2AUzM6QgGs 3cxyYOXiJss AsD5u6k6dKI d_hx39kXDUg\nhlvfDL3nSoo 6L2xYzu724E URy2Ak-WRpE V-ntXk-4TPo yttvb9ByOtY ctqujFKaFZQ NWF3dNJ-EhQ WUkwH9WmmBA\nef1wAfrMg5I eN-RZVkFGj0 dc8LEG9jDFM 0-skl5qAC9Q u1rRUwx_Vy4 iTjgWeJMUJo WL9EOfzoSsA xrCNwCD-z-M\nCC3AanQdQZA ZGLrP5eawdY HoOghpRTkvs N787WRdI35A Cw0d-nqSNE8 2vifO3_gjiM OeJ5xXrbkfU vkYBLYAGavM\njP4gBqxfheI gIJxDy25nwM oN8q7p57nZw 6vnxzfejWN4 gVamQ6jodK0 iU5QjAbuhec qLIU_90P4Ac z8k_ximc8Og\nZFBoN7yIMZw 4mexI7cACZk bx-0YlFprqc NDWpXTg3koc Vo2AcHSCRiQ 2ve6LNoU6Qk WXI7byeZk5s y8d7Ihe0IwE\nubmUJcwor3k CGslieDL-04 w7ljU-lmaK4 I0B21LjeSUQ PyFN_FYwqvc vlyVzeLzNe8 ahmrb5EYoxY HGxuVWpN8vQ\nDNR1zyr5Go4 eyPhudLTuis aPWXL4ahxdY JB0A8Me8EKk dGy_6qyyY7c rxrDLgt5YFA uhcocK-td5E 4Z5FLeh7P18\nVB0zDS9ITmk VukLV0AoeFA CouF-tNHV3g lTvYjERVAnY S27YOjpgaaE 24uCC_-zaaE DslTxXsDLsw xilGAQPx5Xw\nzlHISDs2HtQ tdi8B0YzxHg R1OHRQoJOP0 fbqmVbEj9fg asL1AN3hifU rUkLoqxFOTw 3ma3yXXc3V8 1U1We59en3s\niNm7PPqO6rM CLRk8SgtVS4 VYO8Biwffns -imG6CNF9kI ZMOC332wC7A doORhRob3Qg E2sSvVCRI4s nPQ4BpTfK1Q\nE6Ww7lpuZ2k Ueqm3PQKYPk eFiKAcbp2MY dAfMgDBeqwU Wuq5NHJPXyQ LAFK1EvwulU rU07g1g-PIY L_mlofcsRaA\neZe4Q_58UTU NXObT_Fl-xI t6jlhqNxRYk _WkkH31sTMI ALJcKvnOjHM 85Y1N8avsXs NCY42RnUpCE 2QSukL7dl5o\n0Tpq2mLtXDc Zp1Oajc7VQw WGi4XiEGe8M b6L40CEYVyM Mw9qiV7XlFs UgHKb_7884o mvIYmMo906E 2RakvEQhTTA\nfsjdpo1o-J8 k9rKpHXwA1E MTG3VA-m6qk cU3XY6Ii8v0 NBIdmswtcnM k5sznEJz8BA R8W3U0Mu6t4 1esKStoxuO4\n6KBo0GhU9XM d5R3FK9vLBs N5b7Iy4W0ow VogwWGEO1-c YKRe7n3jQ_M A-mPDdnzipI 6gqU-HL68wE 3ODGCQ-kjGA\nVIlQIVVLWVs 6A-kQCdEIpI _lisL6tLbdg VarS6olPfTA va306f9aN3A zzscMK0ZtjE KpFU_kIw6To hNC6-bxHJac\nbHK0ZvQzfOY PkF4EKJQOOg 0aMUCiKjBDI D1KsEOUqCEU _SFTmh-b-Z4 omlVslJvzxQ FoS3732REf0 kNMOaRRBat4\nqqC80mXlOKo MS2asGj1-_M BizH494DmJI IahW6hJ1-SM 9MIJm1NeUpE 2qzbMPpgtDw H3UY2gQfj-s 9kekiNImlsI\n5zUCClmhjF0 76Atd-tAkmg e18IjYKZnTA MAFdQs_yWvg xkAUTCdoteI X0IEHj4PhCc JX19TZp8gDQ 7TML_MTQdg4\nSH4f_DnPIto v-A03t6-Kss 5rf_gOfa7O4 MYG6FeY4SKg AVzdfRpE9Q0 1UxoHtG2qas o7XgU4ut6jQ IcOYM87wTRc\noPetbPLA8dM F41dgN-mwrE tpRBHKAJ_tU sTy4stPcD0E p4jroQX6Hwk y2Zl-KXvdSk zffchwaq6KE jv7hNnJEWPU\nDN-BxbMH264 mWaC_VSncEg 8x5Yzxi3LhA YtWub0hsSbQ McT_FUPZR5k H6Xy97CD9Hs vHf4WQtJvdI nAMkwo2eSbY\nSqMzG8xsynw P0MbbslO62E Bur1ChHBNsQ 1bClbVe4QyI 0Txa_T4pHY4 9Wm8Ij8rHIE 88jpBZdsrT8 MPch_urCew8\nhf3r9TNSsyY gW4nffCscYs\n".match(/\S+/g).map((e=>({provider:"ambient-video",name:e,src:`youtube:video:${e}`}))),Av="precision mediump float;\r\nuniform float time;\r\nuniform vec2 resolution;\r\nuniform sampler2D spectrum;\r\n\r\n// For ShaderToy\r\nvec3 iMouse = vec3(0., 0., 0.);\r\n#define iTime time\r\n#define iResolution resolution\r\n#define iChannel0 spectrum\r\n#define texture texture2D\r\n",vv="https://www.shadertoy.com/view",bv="ampshader",yv=[{provider:bv,name:"Creation by Silexars",externalUrl:`${vv}/XsXXDn`,shader:`${Av}// Creation by Silexars\r\n// https://www.shadertoy.com/view/XsXXDn\r\n\r\n\r\n// http://www.pouet.net/prod.php?which=57245\r\n// If you intend to reuse this shader, please add credits to 'Danilo Guanabara'\r\n\r\nvoid main(void) {\r\n    vec3 c;\r\n    float z = 0.1 * time;\r\n    vec2 uv = gl_FragCoord.xy / resolution;\r\n    vec2 p = uv - 0.5;\r\n    p.x *= resolution.x / resolution.y;\r\n    float l = 0.2 * length(p);\r\n    for (int i = 0; i < 3; i++) {\r\n        z += 0.07;\r\n        uv += p / l * (sin(z) + 1.0) * abs(sin(l * 9.0 - z * 2.0));\r\n        c[i] = 0.01 / length(abs(mod(uv, 1.0) - 0.5));\r\n    }\r\n    float intensity = texture2D(spectrum, vec2(l, 0.5)).x;\r\n    gl_FragColor = vec4(c / l * intensity, time);\r\n}\r\n`},{provider:bv,name:"Nautilus by weyland",externalUrl:`${vv}/MdXGz4`,shader:`${Av}// Nautilus by weyland\r\n// https://www.shadertoy.com/view/MdXGz4\r\n\r\n\r\nfloat e(vec3 c) {\r\n\tc=cos(vec3(cos(c.r+time/8.)*c.r-cos(c.g+time/9.)*c.g,c.b/3.*c.r-cos(time/7.)*c.g,c.r+c.g+c.b/1.25+time));\r\n\treturn dot(c*c,vec3(1.))-1.0;\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 c=-1.+2.*gl_FragCoord.xy / resolution.xy;\r\n    vec3 o=vec3(c.r,c.g+cos(time/2.)/30.,0),g=vec3(c.r+cos(time)/30.,c.g,1)/64.;\r\n    float m=1.0;\r\n\tfloat t=0.0;\r\n    for(int j=0;j<333;j++) {\r\n        if( m>.4) {\r\n            t = (1.0+float(j))*2.0;\r\n   \t\t\tm = e(o+g*t);\r\n\t\t}\r\n    }\r\n    vec3 r=vec3(.1,0.,0.);\r\n\tvec3 n=m-vec3( e(vec3(o+g*t+r.rgg)),\r\n                   e(vec3(o+g*t+r.grg)),\r\n                   e(vec3(o+g*t+r.ggr)) );\r\n    vec3 v=vec3(dot(vec3(0,0,-.5),n)+dot(vec3(0.0,-.5,.5),n));\r\n    vec2 uv = gl_FragCoord.xy / resolution;\r\n    vec2 p = uv - 0.5;\r\n    p.x *= resolution.x / resolution.y;\r\n    float l = 0.1 * length(p);\r\n    float intensity = texture2D(spectrum, vec2(l, 0.5)).x;\r\n\tgl_FragColor=vec4(v + intensity * vec3(.1+cos(time/14.)/8.,.1,.1-cos(time/3.)/19.)*(t/41.),time);\r\n}\r\n`},{provider:bv,name:"Quasicrystal by Ebanflo",externalUrl:`${vv}/4sXfzj`,shader:`${Av}// Quasicrystal by Ebanflo\r\n// https://www.shadertoy.com/view/4sXfzj\r\n\r\n\r\nconst int numWaves = 6;\r\nconst float numStripes = 1.0;\r\nconst float numFreqs = 8.0;\r\nconst float meanFreq = 4.0;\r\nconst float stdDev = 2.0;\r\nconst float period = 3.0;\r\nconst float pi = 4.0 * atan(1.0);\r\nconst float pi2 = 2.0 * pi;\r\nconst float ln2 = log(2.0);\r\nconst float mean = meanFreq * .69314718;\r\n\r\nfloat wavething(int n, float x) {\r\n    float l = ln2 * float(n) + log(x);\r\n    l -= mean;\r\n    return exp(-l * l / stdDev) / 2.0;\r\n}\r\n\r\nvoid main(void) {\r\n    gl_FragColor = vec4(0.0);\r\n    float scale = exp2(-fract(time / period));\r\n    float sum1 = 0.0;\r\n    for(int n = 0; n < int(numFreqs); n++){\r\n        sum1 += wavething(n, scale + 0.5*float(n));\r\n    }\r\n    vec2 xy = pi2 * numStripes\r\n        * ((2.0 * gl_FragCoord.xy - resolution.xy) / resolution.y);\r\n\r\n    float sum2 = 0.0;\r\n    for(int n = 0; n < numWaves; n++){\r\n        float theta = pi * float(n) / float(numWaves);\r\n        vec2 waveVec = vec2(cos(theta), sin(theta));\r\n        float phase = dot(xy, waveVec);\r\n        for(int k = 0; k < int(numFreqs); k++){\r\n            sum2 += cos(phase * scale * exp2(float(k))) * wavething(k, scale + 0.5*float(n));\r\n        }\r\n    }\r\n    gl_FragColor += vec4(1.0 - sum2 / sum1);\r\n    xy /= pi2 * numStripes;\r\n    float r = length(xy);\r\n    gl_FragColor.x *= texture2D(spectrum, vec2(.161616 * r, .2)).x;\r\n    gl_FragColor.y *= texture2D(spectrum, vec2(.161616 * r + .161616, .2)).x;\r\n    gl_FragColor.z *= texture2D(spectrum, vec2(.161616 * r + .333333, .2)).x;\r\n    gl_FragColor = 1.0 - gl_FragColor;\r\n    gl_FragColor = 1.0 - (r + 1.0) * gl_FragColor;\r\n    if(length(gl_FragColor) > 3.0) gl_FragColor = vec4(0.0);\r\n}\r\n`},{provider:bv,name:"Rainbow by avin",externalUrl:`${vv}/ttfGzH`,shader:`${Av}// Rainbow by avin\r\n// https://www.shadertoy.com/view/ttfGzH\r\n\r\n\r\n#define PI 3.1415926\r\n#define PI2 6.2831852\r\n#define hue(h)clamp(abs(fract(h + vec4(3, 2, 1, 0) / 3.0) * 6.0 - 3.0) - 1.0 , 0.0, 1.0)\r\n\r\nvoid main(void) {\r\n    vec2 uv = (gl_FragCoord.xy - resolution.xy * 0.5) / resolution.y;\r\n    float CIRCLES = 20.0;\r\n    float cS = 0.375;\r\n    float sm = 1.0 / resolution.y * 2.0; // smooth\r\n    float ps = 1.0 / resolution.y * sqrt(resolution.y) * 0.225; // circle thin\r\n    float d = length(uv);\r\n    float a = atan(uv.y, uv.x);\r\n    a = a < 0.0 ? PI + (PI - abs(a)) : a;\r\n    float lPos = a /PI2;\r\n    float m = 0.0;\r\n    float partSize = 1.0 / CIRCLES;\r\n    vec3 col;\r\n    for (float i = 20.0; i > 1.0; i -= 1.0) {\r\n        float ilPos = fract(lPos + i*0.1 + time * 0.1);\r\n        float cPos = partSize * i + ilPos * partSize;\r\n        float invPos = partSize * (i + 1.0) - ilPos * partSize;\r\n        float nzF = (1.0 - ilPos);\r\n        float mP0 = texture2D(spectrum, vec2(partSize * i, 0.0)).x;\r\n        float mP = texture2D(spectrum, vec2(cPos, 0.0)).x;\r\n        float mPInv = texture2D(spectrum, vec2(invPos, 0.0)).x;\r\n        mP = (mP + mPInv) / 2.0;\r\n        float rDiff = i*(1.0 / CIRCLES * 0.35);\r\n        float r = mP * (1.0 / CIRCLES * 3.0) - rDiff;\r\n        float subm = smoothstep(cS - ps + r, cS - ps + sm + r, d) * smoothstep(cS + r, cS - sm + r, d);\r\n        if (subm > 0.0) {\r\n            col = hue(i / CIRCLES * 0.5 + time * 0.05 + mP0 * 0.84).rgb;\r\n        }\r\n        m += subm;\r\n    }\r\n    m = clamp(m, 0.0, 1.0);\r\n    float r = (sin(time * 0.5) * 0.5 + 0.5);\r\n    float b = (cos(time * 0.5) * 0.5 + 0.5);\r\n    vec3 backCol = vec3(r, 0.0, b) * length(uv * 0.75) * 0.5;\r\n    col = mix(backCol, col, m);\r\n    gl_FragColor = vec4(col, 1.0);\r\n}\r\n`},{provider:bv,name:"Audio-Visualizer by CoolerZ",externalUrl:`${vv}/wd3XzS`,shader:`${Av}// Audio-Visualizer by CoolerZ\r\n// https://www.shadertoy.com/view/wd3XzS\r\n\r\n\r\nfloat sigmoid(float x) {\r\n    return 1. / (1. + exp(x));\r\n}\r\n\r\nvec3 sigmoid(vec3 xyz) {\r\n    return vec3(sigmoid(xyz.x), sigmoid(xyz.y), sigmoid(xyz.z));\r\n}\r\n\r\nfloat sample_at(float f) {\r\n    return texture2D(spectrum, vec2(f / 16.0, 0.)).x;\r\n}\r\n\r\nfloat sample_multiple(float f) {\r\n    float delta = .1;\r\n    return 0.2 * (sample_at(f - 2. * delta) + sample_at(f - delta) + sample_at(f) + sample_at(f + delta) + sample_at(f + 2. * delta));\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 uv = (gl_FragCoord.xy - 0.5) / resolution.xy;\r\n    uv = 2. * uv - 1.;\r\n    uv.x *= resolution.x/resolution.y;\r\n    vec2 center = vec2(0.);// 0.5 * vec2(cos(time), sin(time));\r\n    float d = length(uv - center);\r\n    float amplitude = sample_multiple(d * d);\r\n    d -= amplitude;\r\n    float weird = sigmoid(abs(uv.x) * abs(uv.y));\r\n    float speed = 6. * amplitude * sin(time * weird * 0.005) * 0.001;\r\n    float dist_diagonal = abs(abs(uv.x) - abs(uv.y));\r\n    dist_diagonal += d * amplitude;\r\n    dist_diagonal *= dist_diagonal;\r\n    amplitude += .1 / (.1 + smoothstep(1., 0.1, dist_diagonal));\r\n    float brightness = 3. * amplitude * sigmoid(sin(d * d * 16. - speed * time + 2. * speed * amplitude));\r\n    vec3 col = sigmoid(vec3(uv, sin(time)));\r\n    gl_FragColor = vec4(col * brightness,1.0);\r\n}`},{provider:bv,name:"Radiant by TekF",externalUrl:`${vv}/4sVBWy`,shader:`${Av}// Radiant by TekF\r\n// https://www.shadertoy.com/view/4sVBWy\r\n\r\n\r\n// Radiant Music Visualiser\r\n// by Hazel Quantock 2018\r\n// This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. http://creativecommons.org/licenses/by-nc-sa/4.0/\r\n\r\nvoid main(void) {\r\n    vec2 uv = (gl_FragCoord.xy*2.-iResolution.xy)/iResolution.y;\r\n    float l = length(uv)/length(iResolution.xy/iResolution.y);\r\n    float a = atan(uv.x,uv.y)+iTime;\r\n    float s = texture(iChannel0,vec2(abs(fract(5.*a/6.283)*2.-1.),.75)).r;\r\n    // float A = .16;\r\n    // float B = .2025;\r\n    float A = .4;\r\n    float B = .45;\r\n    if (iMouse.z > 0.) {\r\n        A = iMouse.x / iResolution.x; // strength of chromatic dispersion\r\n        B = iMouse.y / iResolution.y; // strength of waveform\r\n    }\r\n    A *= A; // apply a curve so mouse movements feel better\r\n    B *= B;\r\n    gl_FragColor.r = texture(iChannel0,vec2(pow(mix(mix(l,.0,A),    s ,B),2.),.25)).r;\r\n    gl_FragColor.g = texture(iChannel0,vec2(pow(mix(mix(l,.5,A),(1.-s),B),2.),.25)).r;\r\n    gl_FragColor.b = texture(iChannel0,vec2(pow(mix(mix(l,1.,A),    s ,B),2.),.25)).r;\r\n    // tweak the contrast\r\n    gl_FragColor.rgb = smoothstep(.05,1.,gl_FragColor.rgb+.2*l);\r\n    gl_FragColor.rgb = pow(gl_FragColor.rgb, vec3(2));\r\n    gl_FragColor.a = 1.;\r\n}\r\n`},{provider:bv,name:"ambilight 2.0 by MillhausVKodi",externalUrl:`${vv}/ltc3WH`,shader:`${Av}// ambilight 2.0 by MillhausVKodi\r\n// https://www.shadertoy.com/view/ltc3WH\r\n\r\n\r\nconst float bands = 20.0;\r\nconst float leds = 25.0;\r\nconst float colorRange = 0.3; // >0. (=1. full color range, >1. repeat colors)\r\n\r\n//convert HSV to RGB\r\nvec3 hsv2rgb(vec3 c) {\r\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n}\r\n\r\nvoid main(void) {\r\n    // middle = (0/0)\r\n    vec2 k=(gl_FragCoord.xy-.5*resolution.xy)/(max(resolution.x,resolution.y));\r\n    //distance from the middle\r\n    float dis = distance(k , vec2(0));\r\n    //and approximated by "leds"\r\n    float disA = floor(dis*leds)/leds;\r\n    //disA = dis;\r\n    //degree from bottom 0 and top 1.0.  /left right symmetric\r\n    float deg = acos(k.y/dis)/3.14;\r\n    //and approximated by "bands"\r\n    float degA = floor(deg*bands)/bands;\r\n    //colorwheel, dark in the middle, changing colors over time\r\n    vec3 color = hsv2rgb(  vec3( degA*colorRange + time*0.07 , 1.0 , smoothstep(0.0, 0.6, disA) )  );\r\n\t//brightness of a band by fourier (degree to frequency / magnitude to brightness)\r\n    float bandBrightness = texture2D(spectrum, vec2(degA,0.25)).x;\r\n    //more blinky blinky x^2\r\n    color*=bandBrightness*bandBrightness;\r\n    //brighter\r\n    color*=4.;\r\n    float deltaDeg = fract((deg-degA)*bands) - 0.5;\r\n    float deltaDis = fract((dis-disA)*leds) - 0.5;\r\n    float shape = smoothstep(0.5, 0.35, abs(deltaDeg)) * smoothstep(0.5, 0.35, abs(deltaDis));\r\n    color*=shape;\r\n    gl_FragColor = vec4(color, 1.0);\r\n}\r\n`},{provider:bv,name:"dot grid thing by laney",externalUrl:`${vv}/Xd2cRG`,shader:`${Av}// dot grid thing by laney\r\n// https://www.shadertoy.com/view/Xd2cRG\r\n\r\n\r\nfloat circle(vec2 p, float radius) {\r\n \treturn length(p)-radius;\r\n}\r\n\r\nvec2 dist(vec2 p, vec2 ns, vec2 split, float totalSquares) {\r\n \tfloat amp1 = texture2D(spectrum, vec2((ns.x + ns.y*split.x)/totalSquares, 0.25)).x;\r\n    float amp2 = texture2D(spectrum, vec2(mod(ns.x + ns.y*split.x +1., totalSquares)/totalSquares, 0.25)).x;\r\n \treturn vec2(circle(p, 0.5 + 0.9*amp1), circle(p, 0.40 + 0.60*amp2));\r\n}\r\n\r\nfloat smin( float a, float b, float k ) {\r\n    float res = exp( -k*a ) + exp( -k*b );\r\n    return -log( res )/k;\r\n}\r\n\r\nconst float ySplit = 10.0;\r\n\r\nvoid main(void) {\r\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\r\n    vec2 aspect = vec2(resolution.x/resolution.y, 1.0);\r\n    vec2 split = vec2(floor(aspect*vec2(ySplit)));\r\n    float totalSquares = split.x*split.y;\r\n\tvec2 ns = floor(uv*split);\r\n    vec2 p = vec2(fract(uv*split))*2.0-vec2(1.0);\r\n   \tvec2 c = dist(p, ns, split, totalSquares);\r\n   \tvec2 w = dist(p+vec2(2.0,0.0), ns+vec2(-1.0,0.0), split, totalSquares);\r\n   \tvec2 nw = dist(p+vec2(2.0,-2.0), ns+vec2(-1.0,1.0), split, totalSquares);\r\n   \tvec2 ne = dist(p+vec2(-2.0,-2.0), ns+vec2(1.0,1.0), split, totalSquares);\r\n   \tvec2 sw = dist(p+vec2(2.0,2.0), ns+vec2(-1.0,-1.0), split, totalSquares);\r\n   \tvec2 se = dist(p+vec2(-2.0,2.0), ns+vec2(1.0,-1.0), split, totalSquares);\r\n   \tvec2 e = dist(p+vec2(-2.0,0.0), ns+vec2(1.0,0.0), split, totalSquares);\r\n   \tvec2 s = dist(p+vec2(0.0,2.0), ns+vec2(0.,-1.0), split, totalSquares);\r\n   \tvec2 n = dist(p+vec2(0.0,-2.0), ns+vec2(0.,1.0), split, totalSquares);\r\n    float k = 3.0;\r\n    float d1 = smin(c.x, w.x, k);\r\n    d1 = smin(d1, e.x, k);\r\n    d1 = smin(d1, n.x, k);\r\n    d1 = smin(d1, s.x, k);\r\n    d1 = smin(d1, nw.x, k);\r\n    d1 = smin(d1, ne.x, k);\r\n    d1 = smin(d1, sw.x, k);\r\n    d1 = smin(d1, se.x, k);\r\n    float d2 = smin(c.y, w.y, k);\r\n    d2 = smin(d2, e.y, k);\r\n    d2 = smin(d2, n.y, k);\r\n    d2 = smin(d2, s.y, k);\r\n    d2 = smin(d2, nw.y, k);\r\n    d2 = smin(d2, ne.y, k);\r\n    d2 = smin(d2, sw.y, k);\r\n    d2 = smin(d2, se.y, k);\r\n\tgl_FragColor =\r\n        vec4(0.1,0.1,0.1,1.0) *  (1.0 - d1) +\r\n        vec4(.3,0.5,0.3,1.0) *  (1.0 - smoothstep(0., 0.15, d1)) +\r\n        vec4(0.5,0.2,0.1,1.0) *  (1.0 - smoothstep(0., 0.1, d2));\r\n}\r\n`},{provider:bv,name:"Bubbles by liyouvane",externalUrl:`${vv}/llXBWB`,shader:`${Av}// Bubbles by liyouvane\r\n// https://www.shadertoy.com/view/llXBWB\r\n\r\n\r\n#define SHOW_BLOCKS\r\n\r\nvec4 mod289(vec4 x) {\r\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\r\n}\r\n\r\nvec4 permute(vec4 x) {\r\n    return mod289(((x*34.0)+1.0)*x);\r\n}\r\n\r\nvec4 taylorInvSqrt(vec4 r) {\r\n    return 1.79284291400159 - 0.85373472095314 * r;\r\n}\r\n\r\nvec2 fade(vec2 t) {\r\n    return t*t*t*(t*(t*6.0-15.0)+10.0);\r\n}\r\n\r\n// Classic Perlin noise\r\nfloat cnoise(vec2 P) {\r\n    vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\r\n    vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\r\n    Pi = mod289(Pi); // To avoid truncation effects in permutation\r\n    vec4 ix = Pi.xzxz;\r\n    vec4 iy = Pi.yyww;\r\n    vec4 fx = Pf.xzxz;\r\n    vec4 fy = Pf.yyww;\r\n    vec4 i = permute(permute(ix) + iy);\r\n    vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0;\r\n    vec4 gy = abs(gx) - 0.5;\r\n    vec4 tx = floor(gx + 0.5);\r\n    gx = gx - tx;\r\n    vec2 g00 = vec2(gx.x,gy.x);\r\n    vec2 g10 = vec2(gx.y,gy.y);\r\n    vec2 g01 = vec2(gx.z,gy.z);\r\n    vec2 g11 = vec2(gx.w,gy.w);\r\n    vec4 norm = taylorInvSqrt(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\r\n    g00 *= norm.x;\r\n    g01 *= norm.y;\r\n    g10 *= norm.z;\r\n    g11 *= norm.w;\r\n    float n00 = dot(g00, vec2(fx.x, fy.x));\r\n    float n10 = dot(g10, vec2(fx.y, fy.y));\r\n    float n01 = dot(g01, vec2(fx.z, fy.z));\r\n    float n11 = dot(g11, vec2(fx.w, fy.w));\r\n    vec2 fade_xy = fade(Pf.xy);\r\n    vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\r\n    float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\r\n    return 2.3 * n_xy;\r\n}\r\n\r\nfloat rand(float x) {\r\n    return fract(sin(x) * 4358.5453123);\r\n}\r\n\r\nfloat rand(vec2 co) {\r\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5357);\r\n}\r\n\r\nfloat circle(vec2 p, vec2 b, float r) {\r\n    return length(p-b)-r;\r\n}\r\n\r\nfloat box(vec2 p, vec2 b, float r) {\r\n    return length(max(abs(p)-b,0.0))-r;\r\n}\r\n\r\nfloat sampleMusic() {\r\n\treturn 0.5 * (\r\n//\t\ttexture2D( spectrum, vec2( 0.01, 0.25 ) ).x +\r\n//\t\ttexture2D( spectrum, vec2( 0.07, 0.25 ) ).x +\r\n\t\ttexture2D( spectrum, vec2( 0.15, 0.25 ) ).x +\r\n\t\ttexture2D( spectrum, vec2( 0.30, 0.25 ) ).x);\r\n}\r\n\r\nvoid main(void) {\r\n\tconst float speed = 0.4;\r\n\tconst float ySpread = 1.6;\r\n\tconst int numBlocks = 30;\r\n\tconst int numBubbles = 50;\r\n\tfloat pulse = sampleMusic();\r\n\r\n\tvec2 uv = gl_FragCoord.xy / resolution.xy - 0.5;\r\n\tfloat aspect = resolution.x / resolution.y;\r\n\tvec3 baseColor = uv.x > 0.0 ? vec3(0.0,0.3, 0.3) : vec3(0.3, 0.0, 0.3);\r\n\r\n\tvec3 color = 5. * pulse*baseColor*0.5*(0.9-cos(uv.x*8.0));\r\n\tuv.x *= aspect;\r\n\r\n\tfor (int i = 0; i < numBubbles; i++) {\r\n\t\tfloat z = 1.0-0.7*rand(float(i)*1.4333); // 0=far, 1=near\r\n\t\tfloat tickTime = time*z*speed + float(i)*1.23753;\r\n\t\tfloat tick = floor(tickTime);\r\n\r\n\t\tvec2 pos = vec2(0.6*aspect*(rand(tick)-0.5), -abs(sign(uv.x))*ySpread*(0.5-fract(tickTime)));\r\n\t\tpos.x += 0.18*sign(pos.x); // move aside\r\n\t\tif (abs(pos.x) < 0.1) pos.x++; // stupid fix; sign sometimes returns 0\r\n\r\n\t\tvec2 size = 1.8*z*vec2(0.04, 0.04 + 0.1*rand(tick+0.2));\r\n\t\tfloat b = circle(uv, pos, 0.01 + 0.15 * pulse);\r\n\t\tfloat dust = z*smoothstep(0.22, 0.0, b)*pulse*0.5;\r\n\t\tfloat block = 0.2*z*smoothstep(0.012, 0.0, b);\r\n\t\tfloat shine = 0.6*z*pulse*smoothstep(-0.002, b, 0.007);\r\n        float u_Scale = 9.;\r\n        float noise = sin(abs(cnoise(u_Scale * uv.xy)+0.5*cnoise(2. * u_Scale * uv.xy)+0.25*cnoise(4. * u_Scale * uv.xy)+0.125*cnoise(8. * u_Scale * uv.xy)));\r\n\t\tcolor += dust*baseColor*(1.+3. * noise) + block*z + shine;\r\n\t}\r\n    baseColor = vec3(0.1, 0.3, 0.0);\r\n    for (int i = 0; i < numBlocks; i++) {\r\n\t\tfloat z = 1.0-0.7*rand(float(i)*1.4333); // 0=far, 1=near\r\n\t\tfloat tickTime = time*z*speed + float(i)*1.23753;\r\n\t\tfloat tick = floor(tickTime);\r\n\r\n\t\tvec2 pos = vec2(0.6*aspect*(rand(tick)-0.5), -abs(sign(uv.x))*ySpread*(0.5-fract(tickTime)));\r\n\t\tpos.x += 0.24*sign(pos.x); // move aside\r\n\t\tif (abs(pos.x) < 0.1) pos.x++; // stupid fix; sign sometimes returns 0\r\n\r\n\t\tvec2 size = 1.8*z*vec2(0.04, 0.04 + 0.1*rand(tick+0.2));\r\n\t\tfloat b = circle(uv-pos, size, 0.02);\r\n\t\tfloat dust = z*smoothstep(0.22, 0.0, b)*pulse*0.5;\r\n\t\tfloat block = 0.2*z*smoothstep(0.002, 0.0, b);\r\n\t\tfloat shine = 0.6*z*pulse*smoothstep(-0.002, b, 0.007);\r\n        float u_Scale = 9.;\r\n        float noise = sin(abs(cnoise(u_Scale * uv.xy)+0.5*cnoise(2. * u_Scale * uv.xy)+0.25*cnoise(4. * u_Scale * uv.xy)+0.125*cnoise(8. * u_Scale * uv.xy)));\r\n\t\tcolor += dust*baseColor*(1.+noise) + block*z + shine;\r\n\t}\r\n\tcolor /= 1.5;\r\n\tcolor -= rand(uv)*0.04;\r\n\tgl_FragColor = vec4(color, 1.0);\r\n}\r\n`},{provider:bv,name:"Soap Bubble by Ruzzyr",externalUrl:`${vv}/XtVSDt`,shader:`${Av}// Soap Bubble by Ruzzyr\r\n// https://www.shadertoy.com/view/XtVSDt\r\n\r\n\r\nmat3 rotateYmat(float ang) {\r\n    return mat3(cos(ang), 0.0, sin(ang), 0.0, 1.0, 0.0, -sin(ang), 0.0, cos(ang));\r\n}\r\n\r\nmat3 rotateXmat(float ang) {\r\n    return mat3(1.0, -0.0, 0.0, 0.0, cos(ang), -sin(ang), 0.0, sin(ang), cos(ang));\r\n}\r\n\r\nmat3 rotateZmat(float ang) {\r\n    return mat3(cos(ang), -sin(ang), 0.0, sin(ang), cos(ang), 0.0, 0.0, 0.0, 1.0);\r\n}\r\n\r\nfloat map( vec3 p, vec3 origin, float s ) {\r\n    vec3 offset = vec3(sin(p.x*2. + time*2.),cos(p.z*10. + time*2.),1.0)*0.1;\r\n\tfloat d = length(p + offset - origin)- s;\r\n\toffset = vec3(sin(p.x*3. + time*2.),cos(p.z*2. + time*2.),1.0)*0.2;\r\n    for(int i = 0; i < 3; i++) {\r\n        float prism2 = length(p + offset*float(i) - origin)- s;\r\n        d = max(d, -prism2);\r\n    }\r\n  \treturn d;\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 uv = gl_FragCoord.xy/resolution.xy;\r\n    uv = uv*2.0-1.0;\r\n    uv.x *= resolution.x/resolution.y;\r\n    mat3 rotation = //mat3(1.0);\r\n      rotateXmat(time*0.4)*rotateYmat(time*0.5);\r\n    vec3 direction = normalize(vec3(uv.x,uv.y, 1.0)*rotation);\r\n    float t = 0.0;\r\n\tvec3 p;\r\n    vec3 finalColor;\r\n    vec3 origin = vec3(0.,0.,-4.)*rotation;\r\n    vec3 offset;\r\n    vec3 sphereOrigin = vec3(0., 0., 0.0);\r\n    vec4 sound = texture2D(spectrum,vec2(gl_FragCoord.x/resolution.x, 0.75));\r\n    float soundColor = texture2D(spectrum,vec2(0.5, 0.75)).x;\r\n    vec3 color = vec3(.5 + sin(uv.x+time +soundColor*50.)*.4,.5 +cos(uv.y+time + soundColor*5.)*.5,.5);\r\n    for (int k = 0; k <15; k++) {\r\n        p = origin + t*direction;\r\n        float d = map(p,sphereOrigin, 2.0);\r\n        {\r\n            vec3 directionalOffset = -normalize(p)*sound.x*normalize(vec3(uv, 1.0));\r\n            vec3 position = p + directionalOffset;\r\n            float radius = 0.1+float(k)*.5;\r\n            float lineThickness = 0.02 + float(k)*0.01;\r\n            //position.y += position.y*abs(uv.x);\r\n            float distanceFromCenter = length(position);\r\n            float condition = step( distanceFromCenter, radius)\r\n                - step(distanceFromCenter, radius - lineThickness);\r\n            finalColor += color*condition;\r\n        }\r\n        t += d;\r\n    }\r\n    float fog = 1.0/(1.0+t*t*0.1);\r\n    gl_FragColor = vec4(finalColor+color*vec3(fog), fog);\r\n}\r\n`},{provider:bv,name:"Fractal Land by Kali",externalUrl:`${vv}/XsBXWt`,shader:`${Av}// Fractal Land by Kali\r\n// https://www.shadertoy.com/view/XsBXWt\r\n\r\n\r\n// "Fractal Cartoon" - former "DE edge detection" by Kali\r\n\r\n// There are no lights and no AO, only color by normals and dark edges.\r\n\r\n\r\n//#define SHOWONLYEDGES\r\n#define WAVES\r\n#define BORDER\r\n\r\n#define RAY_STEPS 150\r\n\r\n#define BRIGHTNESS 1.2\r\n#define GAMMA 1.4\r\n#define SATURATION .65\r\n\r\n\r\n#define detail .001\r\n#define t time*.5\r\n\r\n\r\nconst vec3 origin=vec3(-1.,.7,0.);\r\nfloat det=0.0;\r\n\r\n\r\n// 2D rotation function\r\nmat2 rot(float a) {\r\n\treturn mat2(cos(a),sin(a),-sin(a),cos(a));\r\n}\r\n\r\n// "Amazing Surface" fractal\r\nvec4 formula(vec4 p) {\r\n\t\tp.xz = abs(p.xz+1.)-abs(p.xz-1.)-p.xz;\r\n\t\tp.y-=.25;\r\n\t\tp.xy*=rot(radians(35.));\r\n\t\tp=p*2./clamp(dot(p.xyz,p.xyz),.2,1.);\r\n\treturn p;\r\n}\r\n\r\n// Distance function\r\nfloat de(vec3 pos) {\r\n#ifdef WAVES\r\n\tpos.y+=sin(pos.z-t*6.)*.15; //waves!\r\n#endif\r\n\tfloat hid=0.;\r\n\tvec3 tpos=pos;\r\n\ttpos.z=abs(3.-mod(tpos.z,6.));\r\n\tvec4 p=vec4(tpos,1.);\r\n\tfor (int i=0; i<4; i++) {p=formula(p);}\r\n\tfloat fr=(length(max(vec2(0.),p.yz-1.5))-1.)/p.w;\r\n\tfloat ro=max(abs(pos.x+1.)-.3,pos.y-.35);\r\n\t\t  ro=max(ro,-max(abs(pos.x+1.)-.1,pos.y-.5));\r\n\tpos.z=abs(.25-mod(pos.z,.5));\r\n\t\t  ro=max(ro,-max(abs(pos.z)-.2,pos.y-.3));\r\n\t\t  ro=max(ro,-max(abs(pos.z)-.01,-pos.y+.32));\r\n\tfloat d=min(fr,ro);\r\n\treturn d;\r\n}\r\n\r\n\r\n// Camera path\r\nvec3 path(float ti) {\r\n\tti*=1.5;\r\n\tvec3  p=vec3(sin(ti),(1.-sin(ti*2.))*.5,-ti*5.)*.5;\r\n\treturn p;\r\n}\r\n\r\n// Calc normals, and here is edge detection, set to variable "edge"\r\n\r\nfloat edge=0.;\r\nvec3 normal(vec3 p) {\r\n\tvec3 e = vec3(0.0,det*5.,0.0);\r\n\r\n\tfloat d1=de(p-e.yxx),d2=de(p+e.yxx);\r\n\tfloat d3=de(p-e.xyx),d4=de(p+e.xyx);\r\n\tfloat d5=de(p-e.xxy),d6=de(p+e.xxy);\r\n\tfloat d=de(p);\r\n\tedge=abs(d-0.5*(d2+d1))+abs(d-0.5*(d4+d3))+abs(d-0.5*(d6+d5));//edge finder\r\n\tedge=min(1.,pow(edge,.55)*15.);\r\n\treturn normalize(vec3(d1-d2,d3-d4,d5-d6));\r\n}\r\n\r\n\r\n// Used Nyan Cat code by mu6k, with some mods\r\n\r\nvec4 rainbow(vec2 p)\r\n{\r\n\tfloat q = max(p.x,-0.1);\r\n\tfloat s = sin(p.x*7.0+t*70.0)*0.08;\r\n\tp.y+=s;\r\n\tp.y*=1.1;\r\n\r\n\tvec4 c;\r\n\tif (p.x>0.0) c=vec4(0,0,0,0); else\r\n\tif (0.0/6.0<p.y&&p.y<1.0/6.0) c= vec4(255,43,14,255)/255.0; else\r\n\tif (1.0/6.0<p.y&&p.y<2.0/6.0) c= vec4(255,168,6,255)/255.0; else\r\n\tif (2.0/6.0<p.y&&p.y<3.0/6.0) c= vec4(255,244,0,255)/255.0; else\r\n\tif (3.0/6.0<p.y&&p.y<4.0/6.0) c= vec4(51,234,5,255)/255.0; else\r\n\tif (4.0/6.0<p.y&&p.y<5.0/6.0) c= vec4(8,163,255,255)/255.0; else\r\n\tif (5.0/6.0<p.y&&p.y<6.0/6.0) c= vec4(122,85,255,255)/255.0; else\r\n\tif (abs(p.y)-.05<0.0001) c=vec4(0.,0.,0.,1.); else\r\n\tif (abs(p.y-1.)-.05<0.0001) c=vec4(0.,0.,0.,1.); else\r\n\t\tc=vec4(0,0,0,0);\r\n\tc.a*=.8-min(.8,abs(p.x*.08));\r\n\tc.xyz=mix(c.xyz,vec3(length(c.xyz)),.15);\r\n\treturn c;\r\n}\r\n\r\n\r\n// Raymarching and 2D graphics\r\n\r\nvec3 raymarch(in vec3 from, in vec3 dir)\r\n\r\n{\r\n\tedge=0.;\r\n\tvec3 p, norm;\r\n\tfloat d=100.;\r\n\tfloat totdist=0.;\r\n\tfor (int i=0; i<RAY_STEPS; i++) {\r\n\t\tif (d>det && totdist<25.0) {\r\n\t\t\tp=from+totdist*dir;\r\n\t\t\td=de(p);\r\n\t\t\tdet=detail*exp(.13*totdist);\r\n\t\t\ttotdist+=d;\r\n\t\t}\r\n\t}\r\n\tvec3 col=vec3(0.);\r\n\tp-=(det-d)*dir;\r\n\tnorm=normal(p);\r\n#ifdef SHOWONLYEDGES\r\n\tcol=1.-vec3(edge); // show wireframe version\r\n#else\r\n\tcol=(1.-abs(norm))*max(0.,1.-edge*.8); // set normal as color with dark edges\r\n#endif\r\n\ttotdist=clamp(totdist,0.,26.);\r\n\tdir.y-=.02;\r\n\tfloat sunsize=7.-max(0.,texture2D(spectrum,vec2(.6,.2)).x)*5.; // responsive sun size\r\n\tfloat an=atan(dir.x,dir.y)+time*1.5; // angle for drawing and rotating sun\r\n\tfloat s=pow(clamp(1.0-length(dir.xy)*sunsize-abs(.2-mod(an,.4)),0.,1.),.1); // sun\r\n\tfloat sb=pow(clamp(1.0-length(dir.xy)*(sunsize-.2)-abs(.2-mod(an,.4)),0.,1.),.1); // sun border\r\n\tfloat sg=pow(clamp(1.0-length(dir.xy)*(sunsize-4.5)-.5*abs(.2-mod(an,.4)),0.,1.),3.); // sun rays\r\n\tfloat y=mix(.45,1.2,pow(smoothstep(0.,1.,.75-dir.y),2.))*(1.-sb*.5); // gradient sky\r\n\r\n\t// set up background with sky and sun\r\n\tvec3 backg=vec3(0.5,0.,1.)*((1.-s)*(1.-sg)*y+(1.-sb)*sg*vec3(1.,.8,0.15)*3.);\r\n\t\t backg+=vec3(1.,.9,.1)*s;\r\n\t\t backg=max(backg,sg*vec3(1.,.9,.5));\r\n\r\n\tcol=mix(vec3(1.,.9,.3),col,exp(-.004*totdist*totdist));// distant fading to sun color\r\n\tif (totdist>25.) col=backg; // hit background\r\n\tcol=pow(col,vec3(GAMMA))*BRIGHTNESS;\r\n\tcol=mix(vec3(length(col)),col,SATURATION);\r\n#ifdef SHOWONLYEDGES\r\n\tcol=1.-vec3(length(col));\r\n#else\r\n\tcol*=vec3(1.,.9,.85);\r\n#endif\r\n\treturn col;\r\n}\r\n\r\n// get camera position\r\nvec3 move(inout vec3 dir) {\r\n\tvec3 go=path(t);\r\n\tvec3 adv=path(t+.7);\r\n\tfloat hd=de(adv);\r\n\tvec3 advec=normalize(adv-go);\r\n\tfloat an=adv.x-go.x; an*=min(1.,abs(adv.z-go.z))*sign(adv.z-go.z)*.7;\r\n\tdir.xy*=mat2(cos(an),sin(an),-sin(an),cos(an));\r\n    an=advec.y*1.7;\r\n\tdir.yz*=mat2(cos(an),sin(an),-sin(an),cos(an));\r\n\tan=atan(advec.x,advec.z);\r\n\tdir.xz*=mat2(cos(an),sin(an),-sin(an),cos(an));\r\n\treturn go;\r\n}\r\n\r\nvoid main(void)\r\n{\r\n\tvec2 uv = gl_FragCoord.xy / resolution.xy*2.-1.;\r\n\tvec2 oriuv=uv;\r\n\tuv.y*=resolution.y/resolution.x;\r\n\tfloat fov=.9-max(0.,.7-time*.3);\r\n\tvec3 dir=normalize(vec3(uv*fov,1.));\r\n\tvec3 from=origin+move(dir);\r\n\tvec3 color=raymarch(from,dir);\r\n\t#ifdef BORDER\r\n\tcolor=mix(vec3(0.),color,pow(max(0.,.95-length(oriuv*oriuv*oriuv*vec2(1.05,1.1))),.3));\r\n\t#endif\r\n\tgl_FragColor = vec4(color,1.);\r\n}\r\n`},{provider:bv,name:"Music MandelBox Colour by pixelbeast",externalUrl:`${vv}/4s33Rj`,shader:`${Av}// Music MandelBox Colour by pixelbeast\r\n// https://www.shadertoy.com/view/4s33Rj\r\n\r\n\r\n// Iain Melvin, 2015\r\n// fft distortions of mandlebox 3d, colour\r\n// with help from:\r\n// https://www.shadertoy.com/view/XsB3Rm  // Original Raymarch tutorial (iq)\r\n// https://www.shadertoy.com/view/ldSGRK  // for mandlebox formula (klems)\r\n// Raymarch tutorial: - iq/2013\r\n\r\n\r\nfloat mandel3D(vec3 z,float fft) {\r\n  const float scale=3.5; //2.0; // -1.5\r\n  const float r=0.5;\r\n  const float f=1.125;\r\n  vec3 offset = z;\r\n  const int niter = 13;\r\n  float dr = 1.0;\r\n  for (int i=0;i<niter;i++){\r\n\t//fold\r\n\tz = clamp(z, -1.0, 1.0) * 2.0 - z;\r\n\t//warp\r\n\tfloat l = length(z);\r\n\tif (l<r){\r\n\t  z/=r*r;\r\n\t}else if (l<1.0){\r\n\t  z/=l*l;\r\n\t}\r\n\tz*=scale;\r\n\tdr = dr * abs(scale) + 1.0;\r\n\t// scale by fft\r\n\tfloat fft_scale = 1.0-(fft*0.34);\r\n\tz*=fft_scale;\r\n\t//dr = dr * fft_scale; // I think there is something to do here\r\n\tz+=offset;\r\n  }\r\n  float zr = length(z);\r\n  return zr / abs(dr);\r\n}\r\n\r\nvec2 map( in vec3 pos ) {\r\n    float d = length(pos);\r\n    float fft = 0.8*texture2D(spectrum, vec2((d/32.0),0.3) )[0];\r\n\treturn vec2(mandel3D(pos*1.5,fft),fft);\r\n}\r\n\r\nvec2 castRay( in vec3 ro, in vec3 rd, in float maxd ){\r\n\tfloat precis = 0.015;\r\n    float h=precis*2.0;\r\n    float t = 0.0;\r\n    float m = -1.0;\r\n    for( int i=0; i<120; i++ )\r\n    {\r\n        if( abs(h)<precis||t>maxd ) break;\r\n        t += h;\r\n\t    vec2 res = map( ro+rd*t );\r\n        h = res.x; //dist to solid\r\n\t    m = res.y; //fft\r\n    }\r\n    if (t>maxd) { t=-0.5; m=0.0; }\r\n    return vec2( t, m );\r\n}\r\n\r\nvec3 calcNormal( in vec3 pos ){\r\n\tvec3 eps = vec3( 0.001, 0.0, 0.0 );\r\n\tvec3 nor = vec3(\r\n\t    map(pos+eps.xyy).x - map(pos-eps.xyy).x,\r\n\t    map(pos+eps.yxy).x - map(pos-eps.yxy).x,\r\n\t    map(pos+eps.yyx).x - map(pos-eps.yyx).x );\r\n\treturn normalize(nor);\r\n}\r\n\r\n// iq's smooth hsv to rgb\r\nvec3 hsv2rgb( in vec3 c ) {\r\n    vec3 rgb = clamp( abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),6.0)-3.0)-1.0, 0.0, 1.0 );\r\n\trgb = rgb*rgb*(3.0-2.0*rgb);\r\n\treturn c.z * mix( vec3(1.0), rgb, c.y);\r\n}\r\n\r\nvec3 render( in vec3 ro, in vec3 rd ) {\r\n    vec3 col = vec3(0.0);\r\n    vec2 res = castRay(ro,rd,15.0);\r\n    float t = res.x; // dist to func\r\n\tfloat m = res.y; // fft intense at collision\r\n    vec3 pos = ro + t*rd;\r\n    vec3 nor = calcNormal( pos );\r\n    if (t==-0.5) { nor=vec3(1.0,0.0,0.0); }\r\n\r\n\tcol = hsv2rgb(vec3(m*2.0,1.0,1.0)); // hue sat lum\r\n\r\n    float ao = 1.0;\r\n\r\n\tvec3 lig = normalize( vec3(-0.6, 0.7, -0.5) );\r\n\tfloat amb = clamp( 0.5+0.5*nor.y, 0.0, 1.0 );\r\n    float dif = clamp( dot( nor, lig ), 0.0, 1.0 );\r\n    float bac = clamp( dot( nor, normalize(vec3(-lig.x,0.0,-lig.z))), 0.0, 1.0 )*clamp( 1.0-pos.y,0.0,1.0);\r\n\tfloat sh = 1.0;\r\n\r\n\tvec3 brdf = vec3(0.0);\r\n\tbrdf += 0.20*amb*vec3(0.10,0.11,0.13)*ao;\r\n    brdf += 0.20*bac*vec3(0.15,0.15,0.15)*ao;\r\n    brdf += 2.20*dif*vec3(1.00,0.90,0.70);\r\n\r\n\tfloat pp = clamp( dot( reflect(rd,nor), lig ), 0.0, 1.0 );\r\n\tfloat spe = sh*pow(pp,16.0);\r\n\tfloat fre = ao*pow( clamp(1.0+dot(nor,rd),0.0,1.0), 2.0 );\r\n\r\n\tcol = col*brdf + vec3(1.0)*col*spe + 0.2*fre*(0.5+0.5*col);\r\n\r\n\treturn vec3( clamp(col,0.0,10.0) );\r\n}\r\n\r\nvoid main(void) {\r\n\tvec2 q = gl_FragCoord.xy/resolution.xy;\r\n    vec2 p = -1.0+2.0*q;\r\n\tp.x *= resolution.x/resolution.y;\r\n    vec2 mo = resolution.xy/resolution.xy;\r\n\r\n\tfloat time = -55.0; //+ time;\r\n\r\n    vec3 d = vec3(0.25*mo.x,0.25*mo.y,0.0);\r\n\r\n    d.x += 5.5*(1.0-cos(0.6*time));\r\n    d.y += 2.5*(1.0-cos(0.05*time));\r\n\r\n\t// camera\r\n\tvec3 ro = vec3( d.x, d.y, 6.0 );\r\n    vec3 ta = vec3( -0.0, -0.0, 0.0 );\r\n\r\n\t// camera tx\r\n\tvec3 cw = normalize( ta-ro );\r\n\tvec3 cp = vec3( 0.0, 1.0, 0.0 );\r\n\tvec3 cu = normalize( cross(cw,cp) );\r\n\tvec3 cv = normalize( cross(cu,cw) );\r\n\tvec3 rd = normalize( p.x*cu + p.y*cv + 2.0*cw );\r\n\r\n    vec3 col = render( ro, rd );\r\n\tcol = sqrt( col );\r\n\r\n    gl_FragColor=vec4( col, 1.0 );\r\n}\r\n`},{provider:bv,name:"FFT-IFS by nshelton",externalUrl:`${vv}/4lyXWW`,shader:`${Av}// FFT-IFS by nshelton\r\n// https://www.shadertoy.com/view/4lyXWW\r\n\r\n\r\n//#define MAX_ITER 20\r\n#define MAX_ITER 50\r\n\r\nmat3 rotationMatrix(vec3 axis, float angle) {\r\n    float s = sin(angle);\r\n    float c = cos(angle);\r\n    float oc = 1.0 - c;\r\n\r\n    return mat3(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,\r\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,\r\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c);\r\n}\r\n\r\nfloat udBox( vec3 p, vec3 b )\r\n{\r\n  return length(max(abs(p)-b,0.0));\r\n}\r\n\r\nmat3 ir;\r\n\r\nfloat DE(vec3 p)\r\n{\r\n\tvec3 p_o = p;\r\n    float d = 1e10;\r\n\r\n    float s = 1.; //sin(time /60.0) / 10.0 + 0.6;\r\n    vec3 t = vec3(0.1 + 0.2 * resolution.xy/resolution.xy, 0.1 + 0.1 * sin(time/200.));\r\n\r\n    float fftVal = texture2D(spectrum,vec2(length(p/5.), 0.2)).x *0.1;\r\n    vec3 dim = vec3( fftVal, 0.9, fftVal);\r\n\r\n    for ( int i = 0; i < 6; i ++)\r\n    {\r\n        p -= t*s;\r\n        p = (ir * (p-t/s));\r\n\r\n     \t//d = min\t(d, udBox(p*s, dim/s) /s);\r\n\r\n \t\tp = abs(p);\r\n\r\n\r\n\r\n        float circleSize = fftVal + 0.03 * (sin(time + length(p_o) * 5.) )\r\n            + 0.01;\r\n        d = min(d, length(p - t) - circleSize/s);\r\n        s *= s;\r\n\r\n    }\r\n\r\n\r\n    return d;\r\n}\r\n\r\n\r\nfloat lighting( in vec3 ro, in vec3 rd)\r\n{\r\n    float res = 1.0;\r\n    float t = 0.01;\r\n\r\n    float k = 12.0;\r\n\r\n    for( int i = 0; i < 2; i++ )\r\n    {\r\n        float h = DE(ro + rd*t);\r\n        if( h<0.001 )\r\n            return 0.0;\r\n\r\n        res = min( res,k * h/t );\r\n        t += h;\r\n    }\r\n    return res;\r\n}\r\n\r\nvec3 gradient(vec3 p) {\r\n\tvec2 e = vec2(0., 0.0001);\r\n\r\n\treturn normalize(\r\n\t\tvec3(\r\n\t\t\tDE(p+e.yxx) - DE(p-e.yxx),\r\n\t\t\tDE(p+e.xyx) - DE(p-e.xyx),\r\n\t\t\tDE(p+e.xxy) - DE(p-e.xxy)\r\n\t\t)\r\n\t);\r\n}\r\n\r\n\r\n\r\n\r\n//https://iquilezles.org/articles/fog\r\nvec3 applyFog( in vec3  rgb,      // original color of the pixel\r\n               in float distance, // camera to point distance\r\n               in vec3  rayDir,   // camera to point vector\r\n               in vec3  sunDir )  // sun light direction\r\n{\r\n    float b = .9 + 20.0 / float(MAX_ITER);\r\n    float fogAmount = 1.0 - exp( -distance*b );\r\n    float sunAmount = max( dot( rayDir, sunDir ), 0.0 );\r\n    vec3  fogColor  = mix( vec3(0.1,0.1,0.0),\r\n                           vec3(1.0,0.9,0.7),\r\n                           pow(sunAmount,8.0) );\r\n    return mix( rgb, fogColor, fogAmount );\r\n}\r\n\r\n\r\nvoid main(void) {\r\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\r\n    uv -= 0.5;\r\n    float aspect = resolution.x/resolution.y;\r\n    uv.x *= aspect;\r\n\r\n    vec3 cam = vec3(0,0, - sin(time /32. ) - 2.0);\r\n    vec3 ray = normalize( vec3(uv, 1.0));\r\n\r\n    vec3 color = vec3(0.1, 0.1, 0.2);\r\n    vec3 p;\r\n    float depth = 0.0;\r\n    bool hit = false;\r\n    float iter = 0.0;\r\n\r\n    float fog = 0.0;\r\n    vec3 sun = normalize( vec3(1,1,1));\r\n\r\n    ir = rotationMatrix(normalize(vec3(sin(time/50.0),sin(time/100.0),sin(time/150.0))), 1.5 + time/30.0);\r\n\r\n    mat3 mv = rotationMatrix(vec3(0,1,0), time/10.0);\r\n\r\n    cam = mv * cam;\r\n    ray = mv * ray;\r\n\r\n    for( int i= 0; i < MAX_ITER; i ++) {\r\n        p = depth * ray + cam;\r\n        float dist = DE(p);\r\n\r\n\r\n        \tdepth += dist * 0.9;\r\n\r\n\r\n        if ( dist < 0.001)\r\n        {\r\n        \thit = true;\r\n            break;\r\n        }\r\n\r\n        iter ++;\r\n    }\r\n    float fakeAO = 1.0 - iter / float(MAX_ITER);\r\n    vec3 n = gradient(p);\r\n\r\n\r\n    if (hit) {\r\n    \tcolor = vec3(fakeAO + dot(-ray,n) / 2.0);\r\n    }\r\n\r\n\r\n\tcolor = applyFog(color, depth, ray, sun) ;\r\n\r\n   //color *= vec3(1.0 - fog);\r\n\r\n    color = pow(color, vec3(0.6));\r\n\r\n\r\n\tgl_FragColor = vec4(color ,1.0);\r\n}\r\n`},{provider:bv,name:"I/O by movAX13h",externalUrl:`${vv}/XsfGDS`,shader:`${Av}// I/O by movAX13h\r\n// https://www.shadertoy.com/view/XsfGDS\r\n\r\n\r\n// I/O fragment shader by movAX13h, August 2013\r\n\r\n#define SHOW_BLOCKS\r\n\r\nfloat rand(float x)\r\n{\r\n    return fract(sin(x) * 4358.5453123);\r\n}\r\n\r\nfloat rand(vec2 co)\r\n{\r\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5357);\r\n}\r\n\r\nfloat box(vec2 p, vec2 b, float r)\r\n{\r\n  return length(max(abs(p)-b,0.0))-r;\r\n}\r\n\r\nfloat sampleMusic()\r\n{\r\n\treturn 0.5 * (\r\n\t\t//texture2D( spectrum, vec2( 0.01, 0.25 ) ).x +\r\n\t\t//texture2D( spectrum, vec2( 0.07, 0.25 ) ).x +\r\n\t\ttexture2D( spectrum, vec2( 0.15, 0.25 ) ).x +\r\n\t\ttexture2D( spectrum, vec2( 0.30, 0.25 ) ).x);\r\n}\r\n\r\nvoid main(void)\r\n{\r\n\tconst float speed = 0.7;\r\n\tconst float ySpread = 1.6;\r\n\tconst int numBlocks = 70;\r\n\r\n\tfloat pulse = sampleMusic();\r\n\r\n\tvec2 uv = gl_FragCoord.xy / resolution.xy - 0.5;\r\n\tfloat aspect = resolution.x / resolution.y;\r\n\tvec3 baseColor = uv.x > 0.0 ? vec3(0.0,0.3, 0.6) : vec3(0.6, 0.0, 0.3);\r\n\r\n\tvec3 color = pulse*baseColor*0.5*(0.9-cos(uv.x*8.0));\r\n\tuv.x *= aspect;\r\n\r\n\tfor (int i = 0; i < numBlocks; i++)\r\n\t{\r\n\t\tfloat z = 1.0-0.7*rand(float(i)*1.4333); // 0=far, 1=near\r\n\t\tfloat tickTime = time*z*speed + float(i)*1.23753;\r\n\t\tfloat tick = floor(tickTime);\r\n\r\n\t\tvec2 pos = vec2(0.6*aspect*(rand(tick)-0.5), sign(uv.x)*ySpread*(0.5-fract(tickTime)));\r\n\t\tpos.x += 0.24*sign(pos.x); // move aside\r\n\t\tif (abs(pos.x) < 0.1) pos.x++; // stupid fix; sign sometimes returns 0\r\n\r\n\t\tvec2 size = 1.8*z*vec2(0.04, 0.04 + 0.1*rand(tick+0.2));\r\n\t\tfloat b = box(uv-pos, size, 0.01);\r\n\t\tfloat dust = z*smoothstep(0.22, 0.0, b)*pulse*0.5;\r\n\t\t#ifdef SHOW_BLOCKS\r\n\t\tfloat block = 0.2*z*smoothstep(0.002, 0.0, b);\r\n\t\tfloat shine = 0.6*z*pulse*smoothstep(-0.002, b, 0.007);\r\n\t\tcolor += dust*baseColor + block*z + shine;\r\n\t\t#else\r\n\t\tcolor += dust*baseColor;\r\n\t\t#endif\r\n\t}\r\n\r\n\tcolor -= rand(uv)*0.04;\r\n\tgl_FragColor = vec4(color, 1.0);\r\n}`},{provider:bv,name:"Otherworldy by lherm",externalUrl:`${vv}/MlySWd`,shader:`${Av}// Otherworldy by lherm\r\n// https://www.shadertoy.com/view/MlySWd\r\n\r\n\r\n#define T iTime\r\n\r\n#define PSD (abs(texture(iChannel0, vec2(.5)).r)*abs(texture(iChannel0, vec2(.5)).r))\r\n\r\n// HG_SDF rotate function\r\n#define r(p, a) {p = cos(a)*p + sin(a)*vec2(p.y,-p.x);}\r\n\r\n// Cabbibo's HSV\r\nvec3 hsv(float h, float s, float v) {\r\n    return mix( vec3( 1.0 ), clamp( ( abs( fract(h + vec3( 3.0, 2.0, 1.0 ) / 3.0 ) * 6.0 - 3.0 ) - 1.0 ), 0.0, 1.0 ), s ) * v;\r\n}\r\n\r\nvoid main(void) {\r\n\tvec2 u = (-iResolution.xy+2.*gl_FragCoord.xy) / iResolution.y;\r\n    vec3 ro = vec3(u, 1.), rd = normalize(vec3(u, -1.)), p; // Camera and ray dir\r\n    float d = 0., m; // Distance for march\r\n    for (float i = 1.; i > 0.; i-=0.02)\r\n    {\r\n        p = ro + rd * d;\r\n        r(p.zy, T);\r\n        r(p.zx, T);\r\n        m = length(cos(abs(p)+sin(abs(p))+T))-(PSD + .5); // Distance function\r\n        d += m;\r\n        gl_FragColor = vec4(hsv(T, 1.,1.)*i*i, 1.);\r\n        if (m < 0.02) break;\r\n    }\r\n}\r\n`}],wv=[{provider:"audiomotion",name:"Anemone",options:{radial:!0,ledBars:!1,spinSpeed:1,mode:8,barSpace:0,gradient:"rainbow",reflexRatio:.4,showPeaks:!0,mirror:-1,maxFreq:8e3,lineWidth:2,fillAlpha:.2}},{provider:"audiomotion",name:"Classic LEDs",options:{mode:7,barSpace:0,gradient:"classic",ledBars:!0,lumiBars:!1,radial:!1,reflexRatio:0,showPeaks:!0}},{provider:"audiomotion",name:"Mirror wave",options:{mode:10,fillAlpha:.6,gradient:"rainbow",lineWidth:2,mirror:-1,radial:!1,reflexAlpha:1,reflexBright:1,reflexRatio:.5,showPeaks:!1}},{provider:"audiomotion",name:"Radial overlay",options:{mode:5,barSpace:.1,gradient:"prism",radial:!0,ledBars:!1,showPeaks:!0,spinSpeed:1}},{provider:"audiomotion",name:"Reflex Bars",options:{mode:5,barSpace:.25,gradient:"rainbow",lumiBars:!1,radial:!1,reflexAlpha:.25,reflexBright:1,reflexFit:!0,reflexRatio:.3,ledBars:!1,showPeaks:!0}}];var _v=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};const Ev=new tr([]);function xv(){return Ev.getValue()}setTimeout((()=>_v(void 0,void 0,void 0,(function*(){yield Be("./lib/butterchurn-presets-base.min.js");const e="milkdrop",t=window.butterchurnPresets;t&&(Ev.next(Object.keys(t).map((r=>({provider:e,name:r,data:t[r]})))),setTimeout((()=>_v(void 0,void 0,void 0,(function*(){yield Be("./lib/butterchurn-presets-extra.min.js");const t=window.butterchurnPresetsExtra;t&&Ev.next(Ev.getValue().concat(Object.keys(t).map((r=>({provider:e,name:r,data:t[r]})))))}))),1e3))}))),1e3);const Sv={get size(){return xv().length},observe:function(){return Ev},find:function(e){return Ev.getValue().find((t=>t.name===e))||null},get:xv},Tv=["#18FF2A","#7718FF","#06C5FE","#FF4242","#18FF2A"];let kv="",Iv="";const Cv={volumeSmoothing:10,onBar(){kv=Iv||Pv(Tv),Iv=Pv(Tv.filter((e=>e!==Iv)))},onPaint({context2D:e,height:t,width:r,now:n,analyser:i}){const a=ql([0,10*i.volume,0])(i.bar.progress),s=ql([0,300*i.volume,0])(i.beat.progress);e.fillStyle="rgba(0, 0, 0, .08)",e.fillRect(0,0,r,t),e.lineWidth=a,e.strokeStyle=Kc(kv,Iv)(i.bar.progress),function(e,t,r,n,i,a=5){const s=e=>n*Math.sin(e/i+t)+r,{width:o}=e.canvas;e.beginPath();for(let t=-50;t<o+50;t+=a)-50===t?e.moveTo(t,s(t)):e.lineTo(t,s(t))}(e,n/50,t/2,50*i.volume,100),e.stroke(),e.fillStyle="rgba(0, 0, 0, 1)",e.beginPath(),e.lineWidth=s,function(e,t,r,n,i=0,a=2*Math.PI){e.beginPath(),e.arc(t,r,n,i,a),e.closePath()}(e,r/2,t/2,i.volume*t/5+s/10),e.stroke(),e.fill()}};function Pv(e){return e[Math.floor(Math.random()*e.length)]}const Mv=[{provider:"spotify-viz",name:"example by zachwinter",config:Cv,externalUrl:"https://github.com/zachwinter/spotify-viz/blob/master/client/example.js"}],Rv="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Visualizations_with_Web_Audio_API";function Bv(){return uv.isLight&&uv.isFrameLight?uv.frameColor:uv.textColor}const Lv=[{provider:"waveform",name:"wave",externalUrl:`${Rv}#creating_a_waveformoscilloscope`,config:{onPaint:({context2D:e,width:t,height:r,analyser:n})=>{const i=n.frequencyBinCount,a=new Uint8Array(i),s=t/i;let o=0;e.lineWidth=Math.round(uv.fontSize/4),e.clearRect(0,0,t,r),e.strokeStyle=Bv(),e.beginPath(),n.getByteTimeDomainData(a);for(let t=0;t<i;t++){const n=a[t]/128*r/2;0===t?e.moveTo(o,n):e.lineTo(o,n),o+=s}e.lineTo(t,r/2),e.stroke()}}},{provider:"waveform",name:"bars",externalUrl:`${Rv}#creating_a_frequency_bar_graph`,config:{onPaint:({context2D:e,width:t,height:r,analyser:n})=>{const i=n.frequencyBinCount,a=new Uint8Array(i);n.getByteFrequencyData(a),e.clearRect(0,0,t,r),e.fillStyle=Bv();const s=(t-30)/16,o=.0075*r,l=i/16;let c,u=0;for(let t=0;t<i;t+=l){const n=a.slice(t,t+l).reduce(((e,t)=>e+t),0)/l;c=o*n,e.fillRect(u,r-c/2,s,c/2),u+=s+2}}}}],Dv=Lv;var Nv=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};console.log("module::visualizer");const Ov=new le("visualizer"),zv=new fe("visualizer"),Fv={provider:"none",name:""},Uv=new tr(Fv),jv=new tr({}),Vv=new Zt,qv=df().pipe(kt((e=>null==e))),Qv=df().pipe(kt(Ce)),[Xv,Wv]=pv(Qv,(e=>e.mediaType===yr.Audio)),[$v,Hv]=pv(gf(),Boolean),Gv=[...Array(79).fill("milkdrop"),...Array(10).fill("ambient-video"),...Array(6).fill("audiomotion"),...Array(4).fill("ampshader"),...Array(1).fill("waveform")],Yv=[...Array(59).fill("spotify-viz"),...Array(20).fill("ambient-video"),...Array(20).fill("ampshader"),...Array(1).fill("waveform")];function Kv(){return Uv}function Jv(){return eb().pipe(at((e=>!!e.locked)))}function Zv(){return eb().pipe(at((e=>e.provider||"")),rr())}function eb(){return jv}function tb(){Vv.next("next")}function rb(){ib(!0)}function nb(){ib(!1)}function ib(e){const t=jv.getValue(),{locked:r}=t,n=Nv(t,["locked"]);if(!!r!==e){const t=Uv.getValue(),r=e?Object.assign(Object.assign({},n),{locked:t}):n;zv.setJson("settings",r),jv.next(r)}}function ab(e){switch(e){case"ambient-video":return gv;case"ampshader":return yv;case"audiomotion":return wv;case"milkdrop":return Sv.get();case"spotify-viz":return Mv;case"waveform":return Dv;default:return[Fv]}}jv.next(zv.getJson("settings",{})),qv.subscribe((()=>Xd.stop())),Xv.subscribe((()=>Xd.hidden=!1)),Wv.subscribe((()=>{Xd.pause(),Xd.hidden=!0})),$v.subscribe((()=>Xd.pause())),xt(Xv,Vv,Zv(),Xd.observeError()).pipe(qn(Xv,eb()),at((([e,t,r])=>function(e,t,r){if(t.locked)return function({provider:e,name:t}){return ab(e).find((e=>e.name===t))||Fv}(t.locked);const n=Uv.getValue();let i=t.provider;if(!i){const t=e.src.startsWith("spotify:")?Yv:Gv;i=Fe(t),r&&i===n.provider&&1===ab(i).length&&(i=Fe(t,i))}return Fe(ab(i),n)||Fv}(t,r,"next"===e))),rr()).subscribe(Uv),Kv().pipe(Pr((e=>Xd.load(e)))).subscribe(Ov),Xv.pipe(It((()=>Hv))).subscribe((()=>Xd.play())),Ov.log("Ambient videos:",gv.length),Ov.log("Ampshader presets:",yv.length),Ov.log("AudioMotion presets:",wv.length),Sv.observe().pipe(ku((e=>0===e.length)),qn(Kv()),Pr((([,e])=>{e===Fv&&tb(),Ov.log("Butterchurn presets:",Sv.size)})),ae(2)).subscribe(Ov);const sb=[{tab:"General",panel:e.createElement((function(){const t=(0,e.useRef)(null),r=ng(Zv,""),n=(0,e.useCallback)((()=>{!function(e){const t=jv.getValue(),{provider:r}=t,n=Nv(t,["provider"]);if(e!==r){const t=e?Object.assign(Object.assign({},n),{provider:e}):n;zv.setJson("settings",t),jv.next(t)}}(t.current.value)}),[]);return e.createElement("form",{className:"visualizer-general-settings",method:"dialog",onSubmit:n},e.createElement("p",null,e.createElement("label",{htmlFor:"visualizer-provider"},"Provider:"),e.createElement("select",{id:"visualizer-provider",defaultValue:r,key:r,ref:t},e.createElement("option",{value:"none"},"(none)"),e.createElement("option",{value:""},"(random)"),e.createElement("option",{value:"ambient-video"},"Ambient Video"),e.createElement("option",{value:"ampshader"},"Ampshader"),e.createElement("option",{value:"audiomotion"},"AudioMotion"),e.createElement("option",{value:"milkdrop"},"Milkdrop"),e.createElement("option",{value:"spotify-viz"},"SpotifyViz"),e.createElement("option",{value:"waveform"},"Waveform"))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel"},"Cancel"),e.createElement(cn,null,"Confirm")))}),null)}];function ob(){return e.createElement(_A,{items:sb,label:"Visualizers"})}function lb(t){return e.createElement(Pn,Object.assign({},t,{className:"visualizer-settings-dialog",title:"Visualizer Settings"}),e.createElement(ob,null))}function cb(){const t=(0,e.useId)(),r=(0,e.useRef)(null),n=(0,e.useCallback)((()=>{const e=r.current.elements,t={};for(const r of e)t[r.value]=!r.checked;_p(t)}),[]);return e.createElement("form",{className:"media-library-general-settings",method:"dialog",onSubmit:n},e.createElement("fieldset",{ref:r},e.createElement("legend",null,"Display"),e.createElement("ul",null,vp.all.map((r=>e.createElement("li",{key:r.id},e.createElement(Ln,{id:`${t}-${r.id}`,type:"checkbox",value:r.id,defaultChecked:wp(r)}),e.createElement("label",{htmlFor:`${t}-${r.id}`},r.title)))))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel"},"Cancel"),e.createElement(cn,null,"Confirm")))}function ub({service:t}){const r=(0,e.useId)(),n=(0,e.useRef)(null),i=ng(t.observeIsLoggedIn,!1),a=(0,e.useCallback)((()=>{const e=n.current.elements,t={};for(const r of e)t[r.value]=!r.checked;_p(t)}),[]);return e.createElement("form",{className:`media-library-settings ${t.id}-settings general-settings`,method:"dialog",onSubmit:a},e.createElement("p",null,e.createElement(cn,{className:"disconnect",onClick:t.logout,disabled:!i},i?"Disconnect...":"Not connected")),e.createElement("fieldset",{ref:n},e.createElement("legend",null,"Display"),e.createElement("ul",null,t.sources.map((t=>e.createElement("li",{key:t.id},e.createElement(Ln,{id:`${r}-${t.id}`,type:"checkbox",value:t.id,defaultChecked:wp(t)}),e.createElement("label",{htmlFor:`${r}-${t.id}`},t.title)))))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel"},"Cancel"),e.createElement(cn,null,"Confirm")))}function hb(){const t=(0,e.useMemo)((()=>[{tab:"General",panel:e.createElement(ub,{service:Yr})},{tab:"Beta",panel:e.createElement(db,null)}]),[]);return e.createElement(_A,{items:t,label:Yr.title})}function db(){const t=(0,e.useRef)(null),r=(0,e.useCallback)((()=>{hr.useMusicKitBeta=t.current.checked}),[]);return e.createElement("form",{className:"apple-beta-settings",method:"dialog",onSubmit:r},e.createElement("fieldset",null,e.createElement("legend",null,"MusicKit"),e.createElement("p",null,e.createElement(Ln,{type:"radio",name:"use-musickit",id:"use-musickit-stable",defaultChecked:!hr.useMusicKitBeta}),e.createElement("label",{htmlFor:"use-musickit-stable"},"Stable version")),e.createElement("p",null,e.createElement(Ln,{type:"radio",name:"use-musickit",id:"use-musickit-beta",defaultChecked:hr.useMusicKitBeta,ref:t}),e.createElement("label",{htmlFor:"use-musickit-beta"},"Beta version"))),e.createElement("div",{className:"note"},e.createElement("p",null,"MusicKit beta enables playback of music videos."),e.createElement("p",null,"However, this release of MusicKit is still undergoing changes and may be unstable. If you experience any problems then use the stable release.")),e.createElement("div",{className:"note"},e.createElement("p",null,"You will need to refresh the page for changes to take effect.")),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel"},"Cancel"),e.createElement(cn,null,"Confirm")))}function fb({service:t}){const r=(0,e.useId)(),n=(0,e.useRef)(null),i=(0,e.useRef)(null),a=(0,e.useMemo)((()=>vp.all.filter((e=>!e.scrobbler))),[]),s=(0,e.useCallback)((()=>{const e=n.current.elements,r={};for(const t of e)r[t.value]=!t.checked;pm(t,r);const a=i.current.elements,s={};for(const e of a)s[e.value]=e.checked;Am(t,s)}),[t]);return e.createElement("form",{className:`media-library-settings ${t.id}-settings scrobble-settings`,method:"dialog",onSubmit:s},e.createElement("fieldset",{ref:n},e.createElement("legend",null,"Scrobble"),e.createElement("ul",null,a.map((n=>e.createElement("li",{key:n.id},e.createElement(Ln,{id:`${r}-${n.id}`,type:"checkbox",value:n.id,defaultChecked:mm(t,n)}),e.createElement("label",{htmlFor:`${r}-${n.id}`},n.title)))))),e.createElement("fieldset",{ref:i},e.createElement("legend",null,"Options"),e.createElement("ul",null,e.createElement("li",null,e.createElement(Ln,{id:`${r}-scrobbling-options`,type:"checkbox",value:"updateNowPlaying",defaultChecked:gm(t)}),e.createElement("label",{htmlFor:`${r}-scrobbling-options`},'Update "Now Playing"')))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,{value:"#cancel"},"Cancel"),e.createElement(cn,null,"Confirm")))}function mb({service:t}){const r=(0,e.useMemo)((()=>{const r=[{tab:"General",panel:e.createElement(ub,{service:t})}];return t.scrobbler&&r.push({tab:"Scrobbling",panel:e.createElement(fb,{service:t})}),r}),[t]);return e.createElement(_A,{items:r,label:t.title})}function pb(){return e.createElement(mb,{service:Gf})}function gb(){return e.createElement(mb,{service:Sm})}function Ab(){return e.createElement(mb,{service:Wm})}function vb(){return e.createElement(mb,{service:pp})}function bb(){return e.createElement(mb,{service:ph})}function yb(){return e.createElement(mb,{service:ed})}const wb=[{id:"services",label:"Media Services",value:e.createElement((function(){const t=(0,e.useMemo)((()=>[{tab:"General",panel:e.createElement(cb,null)}]),[]);return e.createElement(_A,{items:t,label:"Media Services"})}),null),startExpanded:!0,children:vp.all.map((t=>({id:t.id,label:e.createElement(bA,{icon:t.icon,text:t.title}),value:e.createElement(Eb,{service:t})})))},{id:"visualizer",label:"Visualizer",value:e.createElement(ob,null)},{id:"playlist",label:"Playlist",value:e.createElement((function(){return e.createElement(_A,{items:fv,label:"Playlist Settings"})}),null)},{id:"appearance",label:"Appearance",value:e.createElement((function(){return e.createElement(_A,{items:dv,label:"Appearance"})}),null)}],_b=()=>wb;function Eb({service:t}){switch(t.id){case"apple":return e.createElement(hb,null);case"spotify":return e.createElement(bb,null);case"youtube":return e.createElement(yb,null);case"plex":return e.createElement(vb,null);case"jellyfin":return e.createElement(pb,null);case"lastfm":return e.createElement(gb,null);case"listenbrainz":return e.createElement(Ab,null)}}function xb(t){const r=_b(),[n,i]=(0,e.useState)(e.createElement("div",null));return e.createElement(Pn,Object.assign({},t,{className:"settings-dialog",title:"Settings"}),e.createElement(Wt,{className:"settings-dialog-sources",roots:r,storeId:"settings-dialog-sources",onSelect:i}),e.createElement("div",{className:"settings-dialog-source"},n))}function Sb(t){var{icon:r,className:n=""}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["icon","className"]);return e.createElement(cn,Object.assign({},i,{className:`icon-button icon-button-${r} ${n}`,onMouseDown:Oe,onDoubleClick:ze}),e.createElement(un,{name:r}))}function Tb(){const[t,r]=(0,e.useState)(null),n=(0,e.useCallback)((()=>{Bn(xb,!0)}),[]);return e.createElement("div",{className:"media-library"},e.createElement("header",{className:"media-library-head"},e.createElement("h1",{className:"media-library-title"},e.createElement("span",{className:"app-name"},e.createElement(un,{className:"app-icon",name:"ampcast"}),e.createElement("span",{className:"app-text"},"ampcast")),e.createElement("span",{className:"app-version"},"0.5.4")),e.createElement(Sb,{icon:"settings",className:"in-frame",title:"Settings",onClick:n})),e.createElement("div",{className:"media-library-body"},e.createElement($e,{id:"media-library-layout",arrange:"columns",primaryIndex:1},e.createElement(wA,{onSelect:r}),t)))}function kb({className:t="",children:r}){return e.createElement("div",{className:`icon-buttons ${t}`},r)}function Ib(){return ng(Kv,null)}function Cb(t){const[r,n]=(0,e.useState)(null);return(0,e.useEffect)((()=>{null==r&&null!=t&&n(t)}),[r,t]),r}function Pb({visualizer:t}){return e.createElement("article",{className:"visualizer-info"},e.createElement(Mb,{visualizer:t}),e.createElement(Rb,{visualizer:t}))}function Mb({visualizer:t}){return e.createElement("h3",null,"Visualizer: ",function(e){switch(null==e?void 0:e.provider){case"ambient-video":return"Ambient Video";case"ampshader":return"Ampshader";case"audiomotion":return"AudioMotion";case"milkdrop":return"Milkdrop";case"spotify-viz":return"SpotifyViz";case"waveform":return"Waveform";default:return"none"}}(t))}function Rb({visualizer:t}){return"ambient-video"===(null==t?void 0:t.provider)&&t.src.startsWith("youtube:")?e.createElement(Bb,{visualizer:t}):(null==t?void 0:t.name)?e.createElement(e.Fragment,null,e.createElement("h4",null,"Name: ",t.name),e.createElement(Kp,{url:t.externalUrl,src:""})):null}function Bb({visualizer:t}){const r=function(t){const[r,,n]=t.split(":"),[i,a]=(0,e.useState)(null);return(0,e.useEffect)((()=>{if(a(null),n&&"youtube"===r){const e=Et(Jh(n)).subscribe(a);return()=>e.unsubscribe()}}),[r,n]),i}(t.src);return r?e.createElement("div",{className:"youtube-video-info"},e.createElement("h4",null,"Title: ",r.title),e.createElement(Yp,{owner:r.owner,src:r.src}),e.createElement(Kp,{url:r.externalUrl,src:r.src})):null}function Lb(t){const r=ig(),n=Ib(),i=Cb(r),a=Cb(n);return e.createElement(Pn,Object.assign({},t,{className:"currently-playing-dialog media-info-dialog",title:"Media Info"}),e.createElement("form",{method:"dialog"},i?e.createElement(qp,{item:i}):e.createElement("p",null,"The playlist is empty."),i&&i.mediaType!==yr.Video?e.createElement(Pb,{visualizer:a}):null,e.createElement("footer",{className:"dialog-buttons"},e.createElement(cn,null,"Close"))))}function Db(){const t=ng(Jv,!1),r=function(){const t=ig(),r=Ib(),[n,i]=(0,e.useState)("");return(0,e.useEffect)((()=>{(null==t?void 0:t.src.startsWith("youtube:"))?i("youtube"):(null==t?void 0:t.src.startsWith("apple:"))&&(null==t?void 0:t.mediaType)===yr.Video?i("apple"):"ambient-video"===(null==r?void 0:r.provider)&&(null==r?void 0:r.src.startsWith("youtube:"))?i("youtube"):i("")}),[t,r]),n}(),n=(0,e.useCallback)((()=>{Bn(Lb)}),[]),i=(0,e.useCallback)((()=>{Bn(lb,!0)}),[]);return e.createElement("div",{className:"visualizer-controls"},e.createElement(kb,{className:"visualizer-controls-settings"},e.createElement(Sb,{className:"with-overlay",icon:"info",title:"Info",tabIndex:-1,onClick:n}),e.createElement(Sb,{className:"with-overlay",icon:"settings",title:"Settings",tabIndex:-1,onClick:i})),e.createElement(kb,{className:"visualizer-controls-selector"},e.createElement(Sb,{className:"with-overlay",icon:t?"locked":"unlocked",title:t?"Unlock":"Lock the current visualizer",tabIndex:-1,onClick:t?nb:rb}),t?null:e.createElement(Sb,{className:"with-overlay",icon:"right",title:"Next visualizer",tabIndex:-1,onClick:tb})),r?e.createElement(un,{className:"source-icon",name:r}):null)}function Nb(){const t=ig(),[r,n]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=setTimeout((()=>n(!1)),5e3);return n(!0),()=>clearTimeout(e)}),[t]),e.createElement("div",{className:"interstitial "+(r?"is-recent":"")},t?e.createElement(Ob,{item:t}):e.createElement("p",null,"The playlist is empty."))}function Ob({item:t}){return e.createElement("div",{className:"currently-playing"},e.createElement("h3",null,t.title),t.artist?e.createElement(e.Fragment,null,e.createElement("span",{className:"by"},"by"),e.createElement("h4",null,t.artist)):null)}function zb(){const t=(0,e.useRef)(null),[r,n]=(0,e.useState)(!1),i=function(t,r=200){const[n,i]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{if(t){const e=ft(t,"mousemove").pipe(Pr((()=>i(!0))),Qn(r),Pr((()=>i(!1)))).subscribe();return()=>e.unsubscribe()}i(!1)}),[t,r]),n}(t.current,1e4),a=ig(),s=(null==a?void 0:a.mediaType)===yr.Video,o="none"===ng(Zv,"none");(0,e.useLayoutEffect)((()=>{Lf.appendTo(t.current)}),[]),(0,e.useLayoutEffect)((()=>{const e=ft(document,"fullscreenchange").pipe(at((()=>document.fullscreenElement===t.current))).subscribe(n);return()=>e.unsubscribe()}),[]),Ve(t,(0,e.useCallback)((()=>{const e=t.current;Lf.resize(e.clientWidth,e.clientHeight)}),[]));const l=(0,e.useCallback)((()=>{r?document.exitFullscreen():t.current.requestFullscreen()}),[r]);return e.createElement("div",{className:`panel media ${s?"playing-video":""} ${o?"no-visualizer":""}  ${i?"":"idle"}`,onDoubleClick:l,ref:t},e.createElement("div",{id:"players"}),e.createElement("div",{id:"visualizers"}),e.createElement(Nb,null),e.createElement(Db,null))}function Fb({icon:t,onClick:r}){return e.createElement(cn,{className:`media-button media-button-${t}`,onClick:r},e.createElement(un,{name:t}))}function Ub(){const t=(0,e.useRef)(null),r=(0,e.useRef)(null),n=ng(ff,0),i=ng(mf,0),a=ng(gf,!0),[s,o]=(0,e.useState)((()=>Lf.muted)),[l,c]=(0,e.useState)((()=>Lf.volume)),u=l<=.33?"low":l<=.67?"medium":"high";(0,e.useEffect)((()=>{Lf.muted=s}),[s]),(0,e.useEffect)((()=>{Lf.volume=l}),[l]);const h=(0,e.useCallback)((()=>{Sf(t.current.valueAsNumber)}),[]),d=(0,e.useCallback)((()=>{const e=r.current.valueAsNumber;c(e),o(0===e)}),[]),f=(0,e.useCallback)((()=>{o((e=>!e))}),[]);return e.createElement("div",{className:`media-playback-bar volume-${u}`},e.createElement("p",{className:"media-playback-bar-current-time"},e.createElement(Sg,{time:n}),e.createElement(Ln,{id:"playhead",type:"range",min:0,max:i,step:1,value:n,disabled:a,onChange:h,ref:t})),e.createElement("div",{className:"media-playback-bar-controls"},e.createElement("p",{className:"media-playback-bar-volume"},e.createElement(Sb,{icon:s?"muted":"volume",className:"in-frame",title:s?"unmute":"mute",onClick:f}),e.createElement(Ln,{type:"range",min:0,max:1,step:.01,value:s?0:l,onChange:d,ref:r})),e.createElement("p",{className:"media-playback-bar-buttons"},e.createElement(Fb,{icon:"prev",onClick:kf}),e.createElement(Fb,{icon:a?"play":"pause",onClick:a?Ef:xf}),e.createElement(Fb,{icon:"stop",onClick:Tf}),e.createElement(Fb,{icon:"next",onClick:If})),e.createElement("p",{className:"media-playback-bar-more"},e.createElement(cn,{className:"media-button media-button-shuffle",onClick:Cf},"Shuffle"))))}console.log("component::MediaLibrary"),__webpack_require__(6234),console.log("component::Media");function jb(t){var{items:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["items"]);const i=1===r.length;return e.createElement(Pg,Object.assign({},n,{className:"actions"}),e.createElement("ul",{className:"actions-menu-items"},e.createElement(Mg,{label:"Select all",action:"select-all",acceleratorKey:"Ctrl+A",key:"select-all"}),i?e.createElement(Mg,{label:"Play",action:"play",acceleratorKey:"Enter",key:"play"}):null,e.createElement(Mg,{label:"Remove",action:"remove",acceleratorKey:"Del",key:"remove"}),i?e.createElement(Mg,{label:"Info...",action:"info",acceleratorKey:"Ctrl+I",key:"info"}):null))}const Vb={view:"details",showTitles:!1,cols:[{title:"#",render:()=>null,align:"right",className:"track"},{title:"Source",render:function({src:t}){const[r]=t.split(":");return e.createElement(un,{name:r,className:"youtube"===r?"":"show-connectivity"})},align:"center",className:"source"},{title:"Title",render:function({title:t,artist:r}){return r?e.createElement(e.Fragment,null,e.createElement("span",{className:"artist-text"},r),e.createElement("span",{role:"separator"},"-"),e.createElement("span",{className:"title-text"},t)):e.createElement("span",{className:"title-text"},t)},className:"title"},{title:"Time",render:kg,align:"right",className:"duration"}]};const qb=["audio/*","video/*"];function Qb(t){var{onSelect:r,onPlay:n}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["onSelect","onPlay"]);const a=(0,e.useRef)(null),s=ng(Ml.observe,[]),o=function(t){const r=String(t).length,{zeroPadLineNumbers:n,showLineNumbers:i,showSourceIcons:a}=ng(cl,ul());return(0,e.useMemo)((()=>Object.assign(Object.assign({},Vb),{cols:Vb.cols.filter((e=>{switch(e.className){case"track":return i;case"source":return a;default:return!0}})).map((e=>"track"===e.className?Object.assign(Object.assign({},e),{render:(e,t)=>function(e,t=0){return String(e+1).padStart(t,"0")}(t,n?r:0)}):e))})),[n,i,a,r])}(s.length),l=ig(),[c,u]=(0,e.useState)(0),h=(0,e.useCallback)((e=>{const[t]=e.src.split(":");return`source-${t} ${e.id===(null==l?void 0:l.id)?"playing":""} ${e.unplayable?"unplayable":""}`}),[l]),d=(0,e.useCallback)((e=>{u(e.length),null==r||r(e)}),[r]),f=(0,e.useCallback)((e=>{null==n||n(e)}),[n]),m=(0,e.useCallback)((e=>{1===e.length&&(null==n||n(e[0]))}),[n]),p=(0,e.useCallback)((([e])=>{e&&tg(e)}),[]),g=(0,e.useCallback)(((t,r,i)=>function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){const s=yield function(t,r,n){return function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){return Bg((r=>e.createElement(jb,Object.assign({},r,{items:t}))),r,n)}))}(t,r,i);switch(s){case"play":null==n||n(t[0]);break;case"remove":Ml.remove(t);break;case"info":tg(t[0]);break;case"select-all":a.current.selectAll()}}))),[n]);return e.createElement("div",{className:"playlist"},e.createElement(bg,Object.assign({},i,{className:"media-list playable",layout:o,items:s,itemKey:"id",itemClassName:h,droppable:!0,droppableTypes:qb,multiSelect:!0,reorderable:!0,onContextMenu:g,onDelete:Ml.remove,onDoubleClick:f,onDrop:Ml.insertAt,onEnter:m,onInfo:p,onMove:Ml.moveSelection,onSelect:d,listViewRef:a})),e.createElement(xg,{items:s,size:s.length,selectedCount:c}))}function Xb(){return ng(gf,!0)}function Wb(){const t=Xb(),r=(0,e.useCallback)((e=>function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){Lf.autoplay=!0,yield Ml.setCurrentItem(e),Lf.play()}))),[]);return e.createElement("div",{className:"media-playback "+(t?"paused":"")},e.createElement($e,{id:"media-playback-layout",arrange:"rows"},e.createElement("div",{className:"panel playback"},e.createElement(Ub,null),e.createElement(Qb,{onPlay:r})),e.createElement(zb,null)))}function $b(e){const t=e.dataTransfer;t&&(e.preventDefault(),t.effectAllowed="none",t.dropEffect="none")}console.log("component::MediaPlayback");const Hb=navigator.mediaSession;console.log("module::App"),(0,t.s)(document.getElementById("app")).render(e.createElement((function(){return(0,e.useEffect)((()=>{document.body.classList.add(`browser-${Ie.name.replace(/\s+/g,"-")}`)}),[]),(0,e.useEffect)((()=>{const e=new p;return vp.all.forEach((t=>{const r=t.observeIsLoggedIn().subscribe((e=>{document.body.classList.toggle(`${t.id}-connected`,e),document.body.classList.toggle(`${t.id}-not-connected`,!e)}));e.add(r)})),()=>e.unsubscribe()}),[]),(0,e.useEffect)((()=>{const e=ft(document,"dragenter"),t=ft(document,"dragover"),r=ft(document,"drop"),n=xt(e,t).pipe(Pr($b)),i=xt(n,r.pipe(Pr(Oe))).subscribe();return()=>i.unsubscribe()}),[]),function(){const t=ig(),r=Xb(),n=ng(ff,0),i=ng(mf,0);(0,e.useEffect)((()=>{Hb.setPositionState({duration:i,position:n,playbackRate:1})}),[i,n]),(0,e.useEffect)((()=>{const e=t?r?"paused":"playing":"none",n=rt(0,100).pipe(ae(2),Pr((()=>{!function(e){var t;Hb.metadata=e?new MediaMetadata({title:e.title,artist:e.artist,album:e.artist?"":e.album,artwork:(null===(t=e.thumbnails)||void 0===t?void 0:t.map((e=>({src:e.url,sizes:`${e.width}x${e.height}`}))))||[]}):null}(t),Hb.setActionHandler("play",Ef),Hb.setActionHandler("pause",xf),Hb.setActionHandler("stop",Tf),Hb.setActionHandler("previoustrack",kf),Hb.setActionHandler("nexttrack",If),Hb.setActionHandler("seekto",(e=>{null!=e.seekTime&&Sf(e.seekTime)})),Hb.playbackState=e}))).subscribe();return()=>n.unsubscribe()}),[t,r])}(),function(){const t=Xb();(0,e.useEffect)((()=>{document.getElementById("system").addEventListener("keydown",ze),document.getElementById("popup").addEventListener("keydown",ze)}),[]),(0,e.useEffect)((()=>{document.body.addEventListener("keydown",(e=>function(e,t){switch(e.key){case" ":case"MediaPlayPause":e.preventDefault(),t?Lf.play():Lf.pause();break;case"MediaStop":e.preventDefault(),Lf.stop();break;case"MediaTrackPrevious":e.preventDefault(),Lf.prev();break;case"MediaTrackNext":e.preventDefault(),Lf.next();break;case"AudioVolumeMute":e.preventDefault(),Lf.muted=!0}}(e,t)))}),[t])}(),function(){(0,e.useEffect)((()=>{(()=>{!function(e,t,r,n){new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){var e,t,r,n;const{state:i="granted"}=(yield null===(e=navigator.permissions)||void 0===e?void 0:e.query({name:"persistent-storage"}))||{};let a=yield null===(r=null===(t=navigator.storage)||void 0===t?void 0:t.persisted)||void 0===r?void 0:r.call(t);"granted"!==i||a||(a=yield null===(n=navigator.storage)||void 0===n?void 0:n.persist()),console.log("Persisted storage:",{state:i,persisted:a})}))})()}),[])}(),e.createElement("main",null,e.createElement($e,{id:"main-layout",arrange:"columns"},e.createElement(Tb,null),e.createElement(Wb,null)))}),null))})()})();